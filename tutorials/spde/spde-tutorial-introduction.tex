
\chapter{Introduction} 

If we have data measured at some locations, 
so we have a point refereed data set. 
By locations we mean some coordinates reference 
system where are each data from, for example, 
the longitude and latitude coordiantes.
The point refereed data is very common in many 
areas of science. These type of data appear on 
mining, climate modeling, ecology, agriculture 
and other areas. 
If we want do model that data incorporating 
the reference about where are each data from, 
we want do use a model to point refereed data. 

It is possible that we build a regression model 
considering each coordinates as covariate. 
But in some cases it is necessary a very 
complicated function based on coordinates to 
get a adequate description of the mean. 
For example, any complex non-linear function or 
a non-parametric function. 
If these type of model are only to incorporate 
some trend on the mean based on the coordinates. 
Also, this type of model is a fixed effect model. 

But, we want a model to measure the first geography 
law in a simple way. 
This law says: ``Everything is related to everything else, 
but near things are more related than distant things'', 
\cite{tobler:1970}. 
So, we need a model to incorporate the property that a 
observation is more correlated with a observation 
collected on a neighbour local, than another that 
is collected on more distant local. 
One option to modelled this dependence is the use 
of a random effect spatially structured. 
This type of model is a model to spatial dependency, 
different of the spatial trend. 
But, it is possible to include both terms in a model. 
Also, the models for spatial dependency are used 
within more general models as random effects, 
the spatially structured random effects. 

In spatial statistics we have models to incorporate the 
spatial dependency when the locations are areas 
(states, cities, etc.) and when the locations are points. 
In the last case, it is also possible that such 
locations are fixed or are random. 
The models to point refereed data with a spatially 
structured random effect is commonly called a 
geostatistical models. 
There are a specific area of spatial statistics 
that study these models, the geostatistics. 
See \cite{cressie:1993} for a good introduction on 
the spatial statistics. 

\section{The Gaussian random field}

To introduce some notation, let $s$ any 
location on the study area and $X(s)$ is 
the random effect at this location. 
We have $X(s)$ a stochastic process, with $s\in \bD$, 
were $\bD$ is the domain area of the locations 
and $\bD\in \Re^d$. 
Suppose, for example, that we have $\bD$ any country 
and we have any data measured on geographical 
locations, $d=2$, within this country. 

Suppose that we assume that we have a realization 
of $x(s_i)$, $i=1,2,...,n$, a realization of $X(s)$ 
in $n$ locations. It is common assumed that 
$x(s)$ has a multivariate Gaussian distribution. 
Also, if we assume that $X(s)$ continuous over space, 
we have a continuously indexed Gaussian field (GF). 
It is because we suppose that it is possible that 
we get data in any location within the study region. 
To complete the specification of the distribution of 
$x(s)$, is necessary to defines it mean and covariance. 

A very simple option, is the definition of a 
correlation function based only on euclidean 
distance between locations. 
This assume that if we have two pairs of 
points separated same distance $h$, both pairs 
have same correlation. 
Also, is intuitive to choose any function 
decreasing with $h$. 
There is some work about the GF and correlation 
functions in \cite{abrahamsen:1997}. 

A very popular correlation function is the 
Mat\'ern correlation function, that depends 
on a scale parameter $\kappa>0$ and a smoothness 
parameter $\nu>0$. 
Considering two locations $s_i$ and $s_j$, the 
stationary and isotropic Mat\'ern correlation function is: 
\begin{equation}
Cor_M(X(s_i), X(s_j)) = 
\frac{2^{1-\nu}}{\Gamma(\nu)}
(\kappa \parallel s_i - s_j\parallel)^\nu 
K_\nu(\kappa \parallel s_i - s_j \parallel)
\end{equation}
where $\parallel . \parallel$ denotes 
the euclidean distance and $K_\nu$ is the modified 
Bessel function of second kind order. 
Also, we defines the Mat\'ern covariance function 
by $\sigma_x Cor(X(s_i), X(s_j))$, where 
$\sigma_x$ is the marginal variance of the process. 

If we have a realization $x(s)$ on $n$ locations, 
we write the joint correlation, or joint covariance, 
matrix $\Sigma$ making each entry 
$\Sigma_{i,j} = \sigma_xCor_M(X(s_i), X(s_j))$. 
It is common to assume that $X(x)$ has a zero mean. 
So, we have completely defined a multivariate 
distribution to $x(s)$. 

Now, suppose now that we have a data $y_i$ observed at 
locations $s_i$, $i=1,...,n$. 
If we suppose that we have an underlie GF that 
generate these data, we are going to fit the 
parameters of this process, making the identity 
$y(s_i) = x(s_i)$, and $y(s_i)$ is just a 
realization of the GF. 
In this case, we the likelihood function 
is just the multivariate distribution with 
mean $\mu_x$ and covariance $\Sigma$. 
If we assume $\mu_x = \beta_0$, 
we have four parameters to estimate. 

In many situations we assume that we have an 
underlie GF but we no observe it and observe 
a data with a measurement error, i. e., 
$y(s_i) = x(s_i) + e_i$. 
Additionally, it is common to assume that $e_i$ 
independent of $e_j$ for all $i\neq j$ and 
$e_i \sim N(0, \sigma_e)$. 
These additional parameter, $\sigma_e$, measures 
the noise effect, called nugget effect. 
In this case the covariance of marginal distribution 
of $y(s)$ is $\sigma^2_eI + \Sigma$. 
This model is a short extension of the basic GF model, 
and in this case, we have one additional parameter 
to estimate. 
To look more about this model 
see \cite{diggleribeiro:2007}. 

It is possible to describe this model within a 
larger class of models, the hierarchical models. 
Suppose that we have observations $y_i$ on locations 
$s_i$, $i=1,...,n$. We start with 
\begin{equation}\begin{array}{c}
y_i|\theta,\beta,x_i,F_i \sim P(y_i|\mu_i,\phi) \\
\bbx \sim GF(0, \Sigma)
\end{array}\end{equation}
where $\mu_i = h(F_i^{T}\beta + x_i)$, 
$F$ is a matrix of covariates, 
$x$ is the random effects, 
$\theta$ are parameters of random effects, 
$\beta$ are covariate coefficients, 
$h()$ is a function mapping the linear predictor 
$F_i^{T}\beta + x_i$ to $E(y_i) = \mu_i$ and 
$\phi$ is a dispersion parameter of the distribution, 
in the exponential family, assumed to $y_i$. 
To write the GF with nugget effect on this class, 
we replace $F_i^{T}\beta$ by $\beta_0$, 
consider the Gaussian distribution to $y_i$, with 
variance $\sigma_e^2$ and $x$ as GF.

We have many extensions of this basic hierarchical model. 
Now, we stop these extensions and return on some 
extensions in later sections. 
But, if we know the properties of the GF, 
we are able to study all the practical models 
that contain, or are based on, this random effect. 

It is mentioned that the data, or the random effect,  
on a finite number of $n$ points that we have observed 
data is considered a realization of a 
multivariate Gaussian distribution. 
But, to evaluate the likelihood function, or the random 
effect distribution, we need to make 
computations of the multivariate Gaussian density. 
So, we have, in the log scale, the expression 
\begin{equation}
-\frac{1}{2}\left(nlog(2\pi) + log(|\Sigma|) 
+ [x(s) - \mu_x]^{T}\Sigma^{-1}[x(s)-\mu_x]\right)
\end{equation}
where $\Sigma$ is a dense $n\times n$. 
To compute this, we need a factorization of this matrix. 
Because this matrix is a dense, this is a operation of 
order $O(n^3)$, so is one 'big n problem'. 

An alternative used in some software's to do 
geostatistical analysis, is the use of the empirical 
variogram to fit the parameters of the correlation 
function. This option don't use any likelihood for 
the data and the multivariate Gaussian 
distribution to the random effects. 
A good description of these techniques is made 
on \cite{cressie:1993}. 

However, it is adequate to assume any likelihood for the 
data and a GF for the spatial dependence, the model 
based approach on geostatistics, \cite{diggleribeiro:2007}. 
So, in some times we need the use the multivariate 
Gaussian distribution to the random effects. 
But, if the dimension of the GF is big, 
it is impractical to make model based inference. 

In another area of the spatial statistics, the 
analysis of areal data, there is models specified 
by conditional distributions that implies a joint 
distribution with a sparse precision matrix. 
These models are called the 
Gaussian Markov random fields (GMRF), 
\cite{RueHeld:2005}. 
So, the inference when we use GMRF is more easy 
to do than we use the GF, because to work with two dimensional 
GMRF models, we have cost of $O(n^{3/2})$ 
on the computations with its precision matrix. 
So, it is more easy to make analysis with big 'n'. 
