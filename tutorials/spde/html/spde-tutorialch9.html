<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>9 Explanatory variables in the covariance</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- xhtml,html,frames,2 --> 
<meta name="src" content="spde-tutorial.tex" /> 
<meta name="date" content="2017-01-22 14:18:00" /> 
<link rel="stylesheet" type="text/css" href="spde-tutorial.css" /> 
</head><body 
>
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialch10.html" >next</a>] [<a 
href="spde-tutorialch8.html" >prev</a>] [<a 
href="spde-tutorialch8.html#tailspde-tutorialch8.html" >prev-tail</a>] [<a 
href="#tailspde-tutorialch9.html">tail</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch9.html" >up</a>] </p></div>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;9</span><br /><a 
 id="x13-580009"></a>Explanatory variables in the covariance</h2>
   <h3 class="sectionHead"><span class="titlemark">9.1   </span> <a 
 id="x13-590009.1"></a>Introduction</h3>
<!--l. 7--><p class="noindent" >In this Chapter we present an example of the model proposed in&#x00A0;<span class="cite">[<a 
href="spde-tutorialli2.html#XingebrigtsenLS:2013">Ingebrigtsen et&#x00A0;al., 2014</a>]</span>.
This model consider that the two parameters in the SPDE can depends on a set of explanatory
variables/covariates.
</p><!--l. 12--><p class="indent" >   First, we have to remember the definition for the precision matrix considering the equations
(<a 
href="spde-tutorialch2.html#x6-9007r7">2.7<!--tex4ht:ref: eq:Qalpha --></a>) and (<a 
href="spde-tutorialch2.html#x6-9008r8">2.8<!--tex4ht:ref: eq:Qfrac --></a>). Considering <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 1 </span>and <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 2 </span>we have </p>
     <ul class="itemize1">
     <li class="itemize"><span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 1</span>: <span 
class="cmmib-10x-x-109">Q</span><sub><span 
class="cmr-8">1</span><span 
class="cmmi-8">,&#x03BA;</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmib-10x-x-109">K</span><sub><span 
class="cmmi-8">&#x03BA;</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">&#x03BA;</span><sup><span 
class="cmr-8">2</span></sup><span 
class="cmmib-10x-x-109">C </span><span 
class="cmr-10x-x-109">+ </span><span 
class="cmmib-10x-x-109">G</span>
     </li>
     <li class="itemize"><span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 2</span>: <span 
class="cmmib-10x-x-109">Q</span><sub><span 
class="cmr-8">2</span><span 
class="cmmi-8">,&#x03BA;</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmib-10x-x-109">K</span><sub><span 
class="cmmi-8">&#x03BA;</span></sub><span 
class="cmmib-10x-x-109">C</span><sup><span 
class="cmsy-8">-</span><span 
class="cmr-8">1</span></sup><span 
class="cmmib-10x-x-109">K</span><sub><span 
class="cmmi-8">&#x03BA;</span></sub> = <span 
class="cmmi-10x-x-109">&#x03BA;</span><sup><span 
class="cmr-8">4</span></sup><span 
class="cmmib-10x-x-109">C </span><span 
class="cmr-10x-x-109">+ </span><span 
class="cmmi-10x-x-109">&#x03BA;</span><sup><span 
class="cmr-8">2</span></sup><span 
class="cmmib-10x-x-109">G </span><span 
class="cmr-10x-x-109">+ </span><span 
class="cmmi-10x-x-109">&#x03BA;</span><sup><span 
class="cmr-8">2</span></sup><span 
class="cmmib-10x-x-109">G </span><span 
class="cmr-10x-x-109">+ </span><span 
class="cmmib-10x-x-109">GC</span><sup><span 
class="cmsy-8">-</span><span 
class="cmr-8">1</span></sup><span 
class="cmmib-10x-x-109">G</span></li></ul>
<!--l. 22--><p class="indent" >   The way it is done is to have a regression like model for <span 
class="cmr-10x-x-109">log</span> <span 
class="cmmi-10x-x-109">&#x03C4; </span>and <span 
class="cmr-10x-x-109">log</span> <span 
class="cmmi-10x-x-109">&#x03BA;</span>. In order to
implement it, the precision matrix are written in a more general way as
</p>
   <table 
class="equation"><tr><td><a 
 id="x13-59001r1"></a>
   <center class="math-display" >
<img 
src="spde-tutorial71x.png" alt="      (0)  (1)  (0) (1)    (2) (1)  (1)     (1)T  (1)  (2)     (2)   (0)
Q = D    (D    M   D    + D   D   M     + (M   ) D    D   + M    )D
" class="math-display"  /></center></td><td class="equation-label">(9.1)</td></tr></table>
<!--l. 30--><p class="nopar" >
where <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(0)</span></sup>, <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(1)</span></sup> and <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(2)</span></sup>, are provided from the finite element method - FEM based on the
mesh. For <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 1 </span>(<span 
class="cmmi-10x-x-109">&#x03BD; </span><span 
class="cmr-10x-x-109">= 0</span>), we have <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(0)</span></sup> <span 
class="cmr-10x-x-109">=</span> <span 
class="cmmib-10x-x-109">C</span>, <span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(1)</span></sup><span 
class="cmr-10x-x-109">)</span><sub><span 
class="cmmi-8">ij</span></sub> <span 
class="cmr-10x-x-109">= 0 </span>and <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(2)</span></sup> <span 
class="cmr-10x-x-109">=</span> <span 
class="cmmib-10x-x-109">G</span>. For <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 2 </span>(<span 
class="cmmi-10x-x-109">&#x03BD; </span><span 
class="cmr-10x-x-109">= 1</span>),
we have <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(0)</span></sup> <span 
class="cmr-10x-x-109">=</span> <span 
class="cmmib-10x-x-109">C</span>, <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(1)</span></sup> <span 
class="cmr-10x-x-109">=</span> <span 
class="cmmib-10x-x-109">G</span> and <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(2)</span></sup> <span 
class="cmr-10x-x-109">=</span> <span 
class="cmmib-10x-x-109">G</span><span 
class="cmmib-10x-x-109">C</span><sup><span 
class="cmsy-8">-</span><span 
class="cmr-8">1</span></sup><span 
class="cmmib-10x-x-109">G</span>.
</p><!--l. 41--><p class="indent" >   All three <span 
class="cmmib-10x-x-109">D</span><sup><span 
class="cmr-8">(0)</span></sup>, <span 
class="cmmib-10x-x-109">D</span><sup><span 
class="cmr-8">(1)</span></sup> and <span 
class="cmmib-10x-x-109">D</span><sup><span 
class="cmr-8">(2)</span></sup> are diagonal with elements used to describe non-stationarity.
The definition of these matrices are
                                                                                 
                                                                                 
</p><table 
class="align-star">
                          <tr><td 
class="align-odd"><span 
class="cmmib-10x-x-109">D</span><sup><span 
class="cmr-8">(0)</span></sup> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">diag</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmmib-10x-x-109">D</span><sub>
<span 
class="cmmi-8">i</span></sub><sup><span 
class="cmr-8">(0)</span></sup><span 
class="cmsy-10x-x-109">} </span><span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">diag</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmmi-10x-x-109">e</span><sup><span 
class="cmmi-8">&#x03D5;</span><sub><span 
class="cmmi-6">i</span></sub><sup><span 
class="cmr-6">(0)</span></sup>
       </sup><span 
class="cmsy-10x-x-109">}</span></td>                          <td 
class="align-even"></td>                          <td 
class="align-label">
                          </td></tr><tr><td 
class="align-odd"><span 
class="cmmib-10x-x-109">D</span><sup><span 
class="cmr-8">(1)</span></sup> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">diag</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmmib-10x-x-109">D</span><sub>
<span 
class="cmmi-8">i</span></sub><sup><span 
class="cmr-8">(1)</span></sup><span 
class="cmsy-10x-x-109">} </span><span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">diag</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmmi-10x-x-109">e</span><sup><span 
class="cmmi-8">&#x03D5;</span><sub><span 
class="cmmi-6">i</span></sub><sup><span 
class="cmr-6">(1)</span></sup>
       </sup><span 
class="cmsy-10x-x-109">}</span></td>                          <td 
class="align-even"></td>                          <td 
class="align-label">
                          </td></tr><tr><td 
class="align-odd"><span 
class="cmmib-10x-x-109">D</span><sup><span 
class="cmr-8">(2)</span></sup> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">diag</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmmib-10x-x-109">D</span><sub>
<span 
class="cmmi-8">i</span></sub><sup><span 
class="cmr-8">(2)</span></sup><span 
class="cmsy-10x-x-109">} </span><span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">diag</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmmi-10x-x-109">&#x03D5;</span><sub>
<span 
class="cmmi-8">i</span></sub><sup><span 
class="cmr-8">(2)</span></sup><span 
class="cmsy-10x-x-109">}</span></td>                          <td 
class="align-even"></td>                          <td 
class="align-label"></td></tr></table>
where
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="spde-tutorial72x.png" alt=" (k)     (k)   &#x2211;p   (k)
&#x03D5;i  = B i,0 +    B i,j &#x03B8;j, i = 1,...,n
             j=1
" class="math-display"  /></center></td></tr></table>
<!--l. 54--><p class="nopar" >
with the <span 
class="cmmib-10x-x-109">B</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">k</span><span 
class="cmr-8">)</span></sup> <span 
class="cmr-10x-x-109">: </span><span 
class="cmmi-10x-x-109">n</span>-by-<span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">p </span><span 
class="cmr-10x-x-109">+ 1) </span>user defined matrix.
</p><!--l. 58--><p class="indent" >   The default stationary SPDE model uses <span 
class="cmmib-10x-x-109">B</span><sup><span 
class="cmr-8">(0)</span></sup> <span 
class="cmr-10x-x-109">= [0</span><span style="margin-left:3.04074pt" class="tmspace"></span><span 
class="cmr-10x-x-109">1</span><span style="margin-left:3.04074pt" class="tmspace"></span><span 
class="cmr-10x-x-109">0] </span>(one by three) matrix for
the local precision parameter <span 
class="cmmi-10x-x-109">&#x03C4;</span>, <span 
class="cmmib-10x-x-109">B</span><sup><span 
class="cmr-8">(1)</span></sup> <span 
class="cmr-10x-x-109">= [0</span><span style="margin-left:3.04074pt" class="tmspace"></span><span 
class="cmr-10x-x-109">0</span><span style="margin-left:3.04074pt" class="tmspace"></span><span 
class="cmr-10x-x-109">1] </span>(one by three) matrix for the scaling
parameter <span 
class="cmmi-10x-x-109">&#x03BA;</span>, and <span 
class="cmmib-10x-x-109">B</span><sup><span 
class="cmr-8">(2)</span></sup> <span 
class="cmr-10x-x-109">= 1</span>. When these basis matrices are supplied as just one line
matrix, the actual basis matrix will be formed having all lines equals to this unique line
matrix.
</p><!--l. 69--><p class="indent" >   In the next section, we add one of the location coordinates as a fourth column for <span 
class="cmmib-10x-x-109">B</span><sup><span 
class="cmr-8">(1)</span></sup> in
order to build a non-stationary model.
</p><!--l. 73--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">9.2   </span> <a 
 id="x13-600009.2"></a>An example</h3>
<!--l. 75--><p class="noindent" >In this section we define a model where the local precision depends in one of the coordinates.
Note that in order to build a precision matrix defined in the equation&#x00A0;(<a 
href="#x13-59001r1">9.1<!--tex4ht:ref: eq:Qnst --></a>), one also needs
<span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(0)</span></sup>, <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(1)</span></sup> and <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(2)</span></sup> defined at the mesh nodes.
</p><!--l. 82--><p class="indent" >   First, we define a polygon to define a mesh. We define an unitary square
</p>
   <div class="fancyvrb" id="fancyvrb401"><a 
 id="x13-60002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;pl01</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;cbind(c(0,1,1,0,0),</span><span 
class="aesltt-10x-x-109">&#x00A0;c(0,0,1,1,0))</span></div>
<!--l. 89--><p class="noindent" >and build a mesh using this polygon with
</p>
   <div class="fancyvrb" id="fancyvrb402"><a 
 id="x13-60004r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;(mesh</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.2d(,</span><span 
class="aesltt-10x-x-109">&#x00A0;pl01,</span><span 
class="aesltt-10x-x-109">&#x00A0;cutoff=0.03,</span><br class="fancyvrb" /><a 
 id="x13-60006r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;max.edge=c(0.07,.12)))$n</span></div>
<!--l. 95--><p class="noindent" >
                                                                                 
                                                                                 
</p>
   <div class="fancyvrb" id="fancyvrb403"><a 
 id="x13-60008r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;924</span></div>
<!--l. 100--><p class="indent" >   Now, we define the non-stationary SPDE model. We want to define a model where the local
precision depends on the first coordinate. So, we have to consider a fourth column for <span 
class="cmmib-10x-x-109">B</span><sup><span 
class="cmr-8">(1)</span></sup>,
supplied as in the <span 
class="aett-10x-x-109">B.tau </span>argument of the <span 
class="aett-10x-x-109">inla.spde2.matern() </span>function. By doing it, we also
do need to set prior <span 
class="cmmi-10x-x-109">&#x03B8; </span>according to its new dimension, a three length vector. The default is a
Gaussian distribution and we just need to specify the mean and precision diagonal, two vectors
as follows:
</p>
   <div class="fancyvrb" id="fancyvrb404"><a 
 id="x13-60010r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;spde</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde2.matern(mesh,</span><br class="fancyvrb" /><a 
 id="x13-60012r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;B.tau=cbind(0,</span><span 
class="aesltt-10x-x-109">&#x00A0;1,</span><span 
class="aesltt-10x-x-109">&#x00A0;0,</span><span 
class="aesltt-10x-x-109">&#x00A0;sin(pi*mesh$loc[,1])),</span>
<br class="fancyvrb" /><a 
 id="x13-60014r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;B.kappa=cbind(0,</span><span 
class="aesltt-10x-x-109">&#x00A0;0,</span><span 
class="aesltt-10x-x-109">&#x00A0;1,</span><span 
class="aesltt-10x-x-109">&#x00A0;0),</span><br class="fancyvrb" /><a 
 id="x13-60016r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;theta.prior.mean=rep(0,</span><span 
class="aesltt-10x-x-109">&#x00A0;3),</span>
<br class="fancyvrb" /><a 
 id="x13-60018r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;theta.prior.prec=rep(1,</span><span 
class="aesltt-10x-x-109">&#x00A0;3))</span></div>
<!--l. 117--><p class="noindent" >where it was set <span 
class="cmmib-10x-x-109">B</span><sup><span 
class="cmr-8">(1)</span></sup> to define
</p>
   <center class="math-display" >
<img 
src="spde-tutorial73x.png" alt="&#x03C4;i = e&#x03B8;1+&#x03B8;3sin(&#x03C0;loc[i,1])   " class="math-display"  /></center>
having the local precision non-constant. In this case it also implies in a marginal variance
non-constant as well, as the marginal variance is:
   <center class="math-display" >
<img 
src="spde-tutorial74x.png" alt="&#x03C3;2 = (4&#x03C0; &#x03C4;2&#x03BA;2)-1.
" class="math-display"  /></center>
<!--l. 125--><p class="indent" >   We can have a feeling about the model just defined setting values for <span 
class="cmmi-10x-x-109">&#x03B8;</span>, build the
covariance and look at the marginal variance (our interest). We consider two different
cases:
</p>
   <div class="fancyvrb" id="fancyvrb405"><a 
 id="x13-60020r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;theta1</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;c(-1,</span><span 
class="aesltt-10x-x-109">&#x00A0;2,</span><span 
class="aesltt-10x-x-109">&#x00A0;-1)</span><br class="fancyvrb" /><a 
 id="x13-60022r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;theta2</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;c(-1,</span><span 
class="aesltt-10x-x-109">&#x00A0;2,</span><span 
class="aesltt-10x-x-109">&#x00A0;1)</span></div>
<!--l. 135--><p class="noindent" >The precision matrices are built with
</p>
   <div class="fancyvrb" id="fancyvrb406"><a 
 id="x13-60024r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;Q1</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde2.precision(spde,</span><span 
class="aesltt-10x-x-109">&#x00A0;theta=theta1)</span><br class="fancyvrb" /><a 
 id="x13-60026r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;Q2</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde2.precision(spde,</span><span 
class="aesltt-10x-x-109">&#x00A0;theta=theta2)</span></div>
<!--l. 142--><p class="noindent" >As we have the x-coordinate in the (0,1) interval, and the sin function is positive and non-decreasing
in this interval, the second precision matrix has larger values of <span 
class="cmmi-10x-x-109">&#x03C4;</span><sub><span 
class="cmmi-8">i</span></sub>, implying in a lower marginal
variance.
</p><!--l. 149--><p class="indent" >   To clarify, we compute both covariance matrix implied. The covariance matrix
of
                                                                                 
                                                                                 
</p>
   <center class="math-display" >
<img 
src="spde-tutorial75x.png" alt="      &#x2211;n
x(s) =    Ak(s)wk
      k=1  " class="math-display"  /></center> at
the mesh nodes as the inverse of the precision matrix. The <span 
class="aett-10x-x-109">inla.qinv() </span>function computes the
diagonal of the covariance matrix and the covariance elements at the non-zero elements of <span 
class="cmmib-10x-x-109">Q</span>
efficiently.
   <div class="fancyvrb" id="fancyvrb407"><a 
 id="x13-60028r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;cov1</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.qinv(Q1);</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;cov2</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.qinv(Q2)</span></div>
<!--l. 161--><p class="noindent" >A summary of the variances implied (diagonal of the covariance matrix) for both covariance
matrices is obtained with
</p>
   <div class="fancyvrb" id="fancyvrb408"><a 
 id="x13-60030r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;v1</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;diag(cov1);</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;v2</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;diag(cov2)</span><br class="fancyvrb" /><a 
 id="x13-60032r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;rbind(v1=summary(v1),</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;v2=summary(v2))</span></div>
<!--l. 169--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb409"><a 
 id="x13-60034r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Min.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1st</span><span 
class="aett-10x-x-109">&#x00A0;Qu.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Median</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Mean</span><span 
class="aett-10x-x-109">&#x00A0;3rd</span><span 
class="aett-10x-x-109">&#x00A0;Qu.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Max.</span>
<br class="fancyvrb" /><a 
 id="x13-60036r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;v1</span><span 
class="aett-10x-x-109">&#x00A0;0.004241</span><span 
class="aett-10x-x-109">&#x00A0;0.011520</span><span 
class="aett-10x-x-109">&#x00A0;0.031180</span><span 
class="aett-10x-x-109">&#x00A0;0.04007</span><span 
class="aett-10x-x-109">&#x00A0;0.06624</span><span 
class="aett-10x-x-109">&#x00A0;0.1786</span>
<br class="fancyvrb" /><a 
 id="x13-60038r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;v2</span><span 
class="aett-10x-x-109">&#x00A0;0.001495</span><span 
class="aett-10x-x-109">&#x00A0;0.002265</span><span 
class="aett-10x-x-109">&#x00A0;0.004924</span><span 
class="aett-10x-x-109">&#x00A0;0.01621</span><span 
class="aett-10x-x-109">&#x00A0;0.01432</span><span 
class="aett-10x-x-109">&#x00A0;0.1565</span></div>
<!--l. 175--><p class="noindent" >showing large values for the first case.
</p><!--l. 177--><p class="indent" >   We can see the marginal variance at the mesh nodes considering both process in the
Figure&#x00A0;<a 
href="#x13-600631">9.1<!--tex4ht:ref: fig:varns --></a>. Commands to make the figure&#x00A0;<a 
href="#x13-600631">9.1<!--tex4ht:ref: fig:varns --></a>:
</p>
   <div class="fancyvrb" id="fancyvrb410"><a 
 id="x13-60040r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;par(mfrow=c(1,2),</span><span 
class="aesltt-10x-x-109">&#x00A0;mar=c(3,3,.5,.5),</span><span 
class="aesltt-10x-x-109">&#x00A0;mgp=c(2,</span><span 
class="aesltt-10x-x-109">&#x00A0;.7,</span><span 
class="aesltt-10x-x-109">&#x00A0;0),</span><span 
class="aesltt-10x-x-109">&#x00A0;las=1)</span>
<br class="fancyvrb" /><a 
 id="x13-60042r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(mesh$loc[,1],</span><span 
class="aesltt-10x-x-109">&#x00A0;v1,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylim=range(v1,v2),</span><span 
class="aesltt-10x-x-109">&#x00A0;las=1,</span>
<br class="fancyvrb" /><a 
 id="x13-60044r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">x-coordinate</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">marginal</span><span 
class="aesltt-10x-x-109">&#x00A0;variance</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span><br class="fancyvrb" /><a 
 id="x13-60046r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;points(mesh$loc[,1],</span><span 
class="aesltt-10x-x-109">&#x00A0;v2,</span><span 
class="aesltt-10x-x-109">&#x00A0;col=2)</span>
<br class="fancyvrb" /><a 
 id="x13-60048r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;i1</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;which((mesh$loc[,1]&#x003E;0)</span><span 
class="aesltt-10x-x-109">&#x00A0;&amp;</span><span 
class="aesltt-10x-x-109">&#x00A0;(mesh$loc[,1]&#x003C;1)</span><span 
class="aesltt-10x-x-109">&#x00A0;&amp;</span><br class="fancyvrb" /><a 
 id="x13-60050r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;(mesh$loc[,2]&#x003E;0)</span><span 
class="aesltt-10x-x-109">&#x00A0;&amp;</span><span 
class="aesltt-10x-x-109">&#x00A0;(mesh$loc[,2]&#x003C;1))</span>
<br class="fancyvrb" /><a 
 id="x13-60052r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(mesh$loc[i1,1],</span><span 
class="aesltt-10x-x-109">&#x00A0;v1[i1],</span><span 
class="aesltt-10x-x-109">&#x00A0;ylim=range(v1[i1],v2[i1]),</span>
<br class="fancyvrb" /><a 
 id="x13-60054r8"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">x-coordinate</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">marginal</span><span 
class="aesltt-10x-x-109">&#x00A0;variance</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;las=1)</span><br class="fancyvrb" /><a 
 id="x13-60056r9"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;points(mesh$loc[i1,1],</span><span 
class="aesltt-10x-x-109">&#x00A0;v2[i1],</span><span 
class="aesltt-10x-x-109">&#x00A0;col=2)</span>
<br class="fancyvrb" /><a 
 id="x13-60058r10"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;legend(</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">topleft</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;as.expression(lapply(</span><br class="fancyvrb" /><a 
 id="x13-60060r11"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;c(theta1[3],</span><span 
class="aesltt-10x-x-109">&#x00A0;theta2[3]),</span>
<br class="fancyvrb" /><a 
 id="x13-60062r12"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;function(x)</span><span 
class="aesltt-10x-x-109">&#x00A0;bquote(theta[3]==.(x)))),</span><span 
class="aesltt-10x-x-109">&#x00A0;col=1:2)</span></div>
                                                                                 
                                                                                 
<hr class="figure" /><div class="figure" 
><a 
 id="x13-600631"></a><img 
src="spde-tutorial76x.png" alt="PIC" class="graphics" width="422.52936pt" height="253.51842pt"  /><!--tex4ht:graphics  
name="spde-tutorial76x.png" src="figs/nonstationar-vvarns.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;9.1: </span><span  
class="content">Marginal variances at mesh nodes implied by both non-stationary process
defined, considering all the mesh points (left) and only those inside the region domain
(right).</span></div><!--tex4ht:label?: x13-600631 -->
   </div><hr class="endfigure" />
<!--l. 206--><p class="indent" >   In the plot at left we have some marginal variances that does not follows the pattern. For
example, it is clear that some points in the right plot does not follows the expected pattern when
<span 
class="cmmi-10x-x-109">x </span><span 
class="cmsy-10x-x-109">- </span><span 
class="cmmi-10x-x-109">axis </span>is near 0.5. These points are marginal variances computed for the mesh
nodes for <span 
class="cmmi-10x-x-109">y </span><span 
class="cmsy-10x-x-109">- </span><span 
class="cmmi-10x-x-109">axis </span>near bellow 0 or above 1, outside the domain. This is expected
as the variance of the approximation happens to be bigger at the boundary of the
mesh.
</p><!--l. 215--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">9.3   </span> <a 
 id="x13-610009.3"></a>Simulation at the mesh nodes</h3>
<!--l. 217--><p class="noindent" >Both precision matrix defined in previous the section consider that the locations are the mesh
nodes. So, the simulation made with it is a realization of the random field on each
point of the mesh nodes. We use the same seed for each simulation, just to show
it.
</p>
   <div class="fancyvrb" id="fancyvrb411"><a 
 id="x13-61002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;sample1</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;as.vector(inla.qsample(1,</span><span 
class="aesltt-10x-x-109">&#x00A0;Q1,</span><span 
class="aesltt-10x-x-109">&#x00A0;seed=1))</span>
<br class="fancyvrb" /><a 
 id="x13-61004r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;sample2</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;as.vector(inla.qsample(1,</span><span 
class="aesltt-10x-x-109">&#x00A0;Q2,</span><span 
class="aesltt-10x-x-109">&#x00A0;seed=1))</span></div>
<!--l. 232--><p class="indent" >   We compute the standard deviations for both the samples considering groups defined in
accord to the first coordinate of the locations:
</p>
   <div class="fancyvrb" id="fancyvrb412"><a 
 id="x13-61006r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;tapply(sample1,</span><span 
class="aesltt-10x-x-109">&#x00A0;round(inla.group(mesh$loc[,1],</span><span 
class="aesltt-10x-x-109">&#x00A0;5),3),</span><span 
class="aesltt-10x-x-109">&#x00A0;var)</span></div>
<!--l. 239--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb413"><a 
 id="x13-61008r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-0.073</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.18</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.496</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.825</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.071</span>
<br class="fancyvrb" /><a 
 id="x13-61010r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.008349852</span><span 
class="aett-10x-x-109">&#x00A0;0.021988985</span><span 
class="aett-10x-x-109">&#x00A0;0.051450362</span><span 
class="aett-10x-x-109">&#x00A0;0.022831676</span><span 
class="aett-10x-x-109">&#x00A0;0.007851851</span></div>
                                                                                 
                                                                                 
<!--l. 243--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb414"><a 
 id="x13-61012r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;tapply(sample2,</span><span 
class="aesltt-10x-x-109">&#x00A0;round(inla.group(mesh$loc[,1],</span><span 
class="aesltt-10x-x-109">&#x00A0;5),3),</span><span 
class="aesltt-10x-x-109">&#x00A0;var)</span></div>
<!--l. 246--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb415"><a 
 id="x13-61014r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-0.073</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.18</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.496</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.825</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.071</span>
<br class="fancyvrb" /><a 
 id="x13-61016r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.026432644</span><span 
class="aett-10x-x-109">&#x00A0;0.003051414</span><span 
class="aett-10x-x-109">&#x00A0;0.001069714</span><span 
class="aett-10x-x-109">&#x00A0;0.004342003</span><span 
class="aett-10x-x-109">&#x00A0;0.024451202</span></div>
<!--l. 251--><p class="noindent" >We observe that the variance of the sample from the first random field increase near 0.5 and
decrease near 0 and near 1. For the sample of the second random field the opposite happens and
we have larger values, as it has lower local precision.
</p><!--l. 258--><p class="indent" >   One can see the simulated values projected to a grid in Figure&#x00A0;<a 
href="#x13-610312">9.2<!--tex4ht:ref: fig:s12ns --></a>. We use a projector
matrix to project the simulated values in the grid limited in the unit square with limits (0,0) and
(1,1) with
</p>
   <div class="fancyvrb" id="fancyvrb416"><a 
 id="x13-61018r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;proj</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.projector(mesh,</span><span 
class="aesltt-10x-x-109">&#x00A0;xlim=0:1,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylim=0:1)</span>
<br class="fancyvrb" /><a 
 id="x13-61020r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;grid.arrange(levelplot(inla.mesh.project(proj,</span><span 
class="aesltt-10x-x-109">&#x00A0;field=sample1),</span>
<br class="fancyvrb" /><a 
 id="x13-61022r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;scale=list(draw=FALSE),</span>
<br class="fancyvrb" /><a 
 id="x13-61024r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;col.regions=topo.colors(100)),</span>
<br class="fancyvrb" /><a 
 id="x13-61026r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;levelplot(inla.mesh.project(proj,field=sample2),</span>
<br class="fancyvrb" /><a 
 id="x13-61028r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;scale=list(draw=FALSE),</span>
<br class="fancyvrb" /><a 
 id="x13-61030r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;col.regions=topo.colors(100)),</span><span 
class="aesltt-10x-x-109">&#x00A0;nrow=1)</span></div>
<hr class="figure" /><div class="figure" 
><a 
 id="x13-610312"></a><img 
src="spde-tutorial77x.png" alt="PIC" class="graphics" width="422.52936pt" height="253.51842pt"  /><!--tex4ht:graphics  
name="spde-tutorial77x.png" src="figs/nonstationar-vplotsamples.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;9.2: </span><span  
class="content">Two simulated random fields, using two diferent <span 
class="cmmi-10x-x-109">&#x03B8; </span>in the same basis functions.</span></div><!--tex4ht:label?: x13-610312 -->
   </div><hr class="endfigure" />
<!--l. 282--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.3.1   </span> <a 
 id="x13-620009.3.1"></a>Simulation with linear constraint</h4>
                                                                                 
                                                                                 
<!--l. 284--><p class="noindent" >The linear constraint is common for models intrinsic models, such the random walks in one or
two dimensions. This is not the case for the models we have defined in this chapter.
However, in this section we would like to show the use of linear constraints for the SPDE
models.
</p><!--l. 290--><p class="indent" >   Because the SPDE models are based in the Finite Element Method (FEM) approximation,
the sum-to-zero restriction in this case is non trivial. The issue is that
</p>
   <center class="math-display" >
<img 
src="spde-tutorial78x.png" alt="&#x2211;
   xk
 k  " class="math-display"  /></center>
doesn&#8217;t mean anything for the mesh-based spde-models. Whereas
   <center class="math-display" >
<img 
src="spde-tutorial79x.png" alt="&#x222B;          &#x222B;
  x(s)ds =   &#x03A8; (s)xkds  " class="math-display"  /></center> does
mean something, and that integral is equal to
   <center class="math-display" >
<img 
src="spde-tutorial80x.png" alt="&#x2211;
   Ckkxk.
 k  " class="math-display"  /></center> So
the constraint
   <center class="math-display" >
<img 
src="spde-tutorial81x.png" alt="&#x222B;
   x(s)ds = 0  " class="math-display"  /></center> is
provided by
                                                                                 
                                                                                 
   <center class="math-display" >
<img 
src="spde-tutorial82x.png" alt="A *x = 0,whereA    = C   ,
                 1k     kk  " class="math-display"  /></center>
where <span 
class="cmmib-10x-x-109">C</span> is the matrix used in the FEM.
<!--l. 313--><p class="indent" >   Using <span 
class="cmmi-10x-x-109">A </span><span 
class="cmr-10x-x-109">= (1</span><span 
class="cmmi-10x-x-109">,...,</span><span 
class="cmr-10x-x-109">1) </span>instead of <span 
class="cmmi-10x-x-109">diag</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">C</span><span 
class="cmr-10x-x-109">) </span>leads to very bad behavior for irregular meshes. So, if
we want a linear constraint, we need to use <span 
class="cmmib-10x-x-109">C</span>.
</p><!--l. 318--><p class="indent" >   The <span 
class="cmmib-10x-x-109">C </span>matrix is obtained by the <span 
class="aett-10x-x-109">inla.mesh.fem() </span>function and is available directly in
outputs of <span 
class="aett-10x-x-109">inla.spde2.matern() </span>function. So, we do the simulation with
</p>
   <div class="fancyvrb" id="fancyvrb417"><a 
 id="x13-62002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;s1r</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;as.vector(inla.qsample(1,</span><span 
class="aesltt-10x-x-109">&#x00A0;Q1,</span><span 
class="aesltt-10x-x-109">&#x00A0;seed=1,</span><span 
class="aesltt-10x-x-109">&#x00A0;constr=spde$f$extraconstr))</span>
<br class="fancyvrb" /><a 
 id="x13-62004r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;s2r</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;as.vector(inla.qsample(1,</span><span 
class="aesltt-10x-x-109">&#x00A0;Q2,</span><span 
class="aesltt-10x-x-109">&#x00A0;seed=1,</span><span 
class="aesltt-10x-x-109">&#x00A0;constr=spde$f$extraconstr))</span></div>
<!--l. 329--><p class="noindent" >So, we have
</p>
   <div class="fancyvrb" id="fancyvrb418"><a 
 id="x13-62006r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;rbind(s1r=summary(s1r),</span><span 
class="aesltt-10x-x-109">&#x00A0;s2r=summary(s2r))</span></div>
<!--l. 334--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb419"><a 
 id="x13-62008r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Min.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1st</span><span 
class="aett-10x-x-109">&#x00A0;Qu.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Median</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Mean</span><span 
class="aett-10x-x-109">&#x00A0;3rd</span><span 
class="aett-10x-x-109">&#x00A0;Qu.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Max.</span>
<br class="fancyvrb" /><a 
 id="x13-62010r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;s1r</span><span 
class="aett-10x-x-109">&#x00A0;-0.4399</span><span 
class="aett-10x-x-109">&#x00A0;-0.03012</span><span 
class="aett-10x-x-109">&#x00A0;0.05297</span><span 
class="aett-10x-x-109">&#x00A0;0.06406</span><span 
class="aett-10x-x-109">&#x00A0;0.15710</span><span 
class="aett-10x-x-109">&#x00A0;0.7765</span>
<br class="fancyvrb" /><a 
 id="x13-62012r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;s2r</span><span 
class="aett-10x-x-109">&#x00A0;-0.5973</span><span 
class="aett-10x-x-109">&#x00A0;-0.01840</span><span 
class="aett-10x-x-109">&#x00A0;0.02174</span><span 
class="aett-10x-x-109">&#x00A0;0.02401</span><span 
class="aett-10x-x-109">&#x00A0;0.06044</span><span 
class="aett-10x-x-109">&#x00A0;0.4819</span></div>
<!--l. 339--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb420"><a 
 id="x13-62014r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;c(cor1=cor(sample1,</span><span 
class="aesltt-10x-x-109">&#x00A0;s1r),</span><span 
class="aesltt-10x-x-109">&#x00A0;cor2=cor(sample2,</span><span 
class="aesltt-10x-x-109">&#x00A0;s2r))</span></div>
<!--l. 342--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb421"><a 
 id="x13-62016r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;cor1</span><span 
class="aett-10x-x-109">&#x00A0;cor2</span><br class="fancyvrb" /><a 
 id="x13-62018r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1</span></div>
<!--l. 347--><p class="noindent" >where the mean of the process simulated at mesh nodes have mean near zero.
</p><!--l. 350--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">9.4   </span> <a 
 id="x13-630009.4"></a>Estimation with data simulated at the mesh nodes</h3>
<!--l. 353--><p class="noindent" >The model can be fitted easily with the data simulated at mesh nodes. Considering that we have
data exactly at each mesh node, we don&#8217;t need the use of any predictor matrix and the stack
functionality. Because we have just realizations of the random field, we don&#8217;t have noise and
need to fix the precision of the Gaussian likelihood in a high value, for example on the value
<span 
class="cmmi-10x-x-109">e</span><sup><span 
class="cmr-8">20</span></sup>
</p>
   <div class="fancyvrb" id="fancyvrb422"><a 
 id="x13-63002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;clik</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;list(hyper=list(theta=list(initial=20,</span><span 
class="aesltt-10x-x-109">&#x00A0;fixed=TRUE)))</span></div>
<!--l. 369--><p class="noindent" >Remember that we have a zero mean random field, so we also do not have fixed parameters to fit.
We just do
                                                                                 
                                                                                 
</p>
   <div class="fancyvrb" id="fancyvrb423"><a 
 id="x13-63004r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;formula</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;y</span><span 
class="aesltt-10x-x-109">&#x00A0;~</span><span 
class="aesltt-10x-x-109">&#x00A0;0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;f(i,</span><span 
class="aesltt-10x-x-109">&#x00A0;model=spde)</span><br class="fancyvrb" /><a 
 id="x13-63006r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;fit1</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla(formula,</span><span 
class="aesltt-10x-x-109">&#x00A0;control.family=clik,</span>
<br class="fancyvrb" /><a 
 id="x13-63008r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=data.frame(y=sample1,</span><span 
class="aesltt-10x-x-109">&#x00A0;i=1:mesh$n))</span><br class="fancyvrb" /><a 
 id="x13-63010r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;fit2</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla(formula,</span><span 
class="aesltt-10x-x-109">&#x00A0;control.family=clik,</span>
<br class="fancyvrb" /><a 
 id="x13-63012r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=data.frame(y=sample2,</span><span 
class="aesltt-10x-x-109">&#x00A0;i=1:mesh$n))</span></div>
<!--l. 382--><p class="indent" >   We look at the summary of the posterior for <span 
class="cmmi-10x-x-109">&#x03B8; </span>(joined with the true values). For the first
sample
</p>
   <div class="fancyvrb" id="fancyvrb424"><a 
 id="x13-63014r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;round(cbind(true=theta1,</span><span 
class="aesltt-10x-x-109">&#x00A0;fit1$summary.hy),</span><span 
class="aesltt-10x-x-109">&#x00A0;4)</span></div>
<!--l. 389--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb425"><a 
 id="x13-63016r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;true</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mean</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sd</span><span 
class="aett-10x-x-109">&#x00A0;0.025quant</span><span 
class="aett-10x-x-109">&#x00A0;0.5quant</span><span 
class="aett-10x-x-109">&#x00A0;0.975quant</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mode</span>
<br class="fancyvrb" /><a 
 id="x13-63018r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Theta1</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;i</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-1</span><span 
class="aett-10x-x-109">&#x00A0;-0.9554</span><span 
class="aett-10x-x-109">&#x00A0;0.0295</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-1.0193</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-0.9526</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-0.9046</span><span 
class="aett-10x-x-109">&#x00A0;-0.9442</span>
<br class="fancyvrb" /><a 
 id="x13-63020r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Theta2</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;i</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.9045</span><span 
class="aett-10x-x-109">&#x00A0;0.1233</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.6894</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.8940</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.1703</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.8628</span>
<br class="fancyvrb" /><a 
 id="x13-63022r4"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Theta3</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;i</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-1</span><span 
class="aett-10x-x-109">&#x00A0;-0.9676</span><span 
class="aett-10x-x-109">&#x00A0;0.0505</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-1.0517</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-0.9732</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-0.8563</span><span 
class="aett-10x-x-109">&#x00A0;-0.9918</span></div>
<!--l. 396--><p class="noindent" >and for the second
</p>
   <div class="fancyvrb" id="fancyvrb426"><a 
 id="x13-63024r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;round(cbind(true=theta2,</span><span 
class="aesltt-10x-x-109">&#x00A0;fit2$summary.hy),</span><span 
class="aesltt-10x-x-109">&#x00A0;4)</span></div>
<!--l. 401--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb427"><a 
 id="x13-63026r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;true</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mean</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sd</span><span 
class="aett-10x-x-109">&#x00A0;0.025quant</span><span 
class="aett-10x-x-109">&#x00A0;0.5quant</span><span 
class="aett-10x-x-109">&#x00A0;0.975quant</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mode</span>
<br class="fancyvrb" /><a 
 id="x13-63028r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Theta1</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;i</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-1</span><span 
class="aett-10x-x-109">&#x00A0;-1.0107</span><span 
class="aett-10x-x-109">&#x00A0;0.0333</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-1.0753</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-1.0111</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-0.9447</span><span 
class="aett-10x-x-109">&#x00A0;-1.0121</span>
<br class="fancyvrb" /><a 
 id="x13-63030r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Theta2</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;i</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.0656</span><span 
class="aett-10x-x-109">&#x00A0;0.1059</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.8481</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.0698</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.2631</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.0824</span>
<br class="fancyvrb" /><a 
 id="x13-63032r4"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Theta3</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;i</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.0675</span><span 
class="aett-10x-x-109">&#x00A0;0.0443</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.9814</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.0672</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.1552</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.0661</span></div>
<!--l. 408--><p class="noindent" >We see that for both we have good results. In next section we see more results.
</p><!--l. 411--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">9.5   </span> <a 
 id="x13-640009.5"></a>Estimation with locations not at the mesh nodes</h3>
<!--l. 413--><p class="noindent" >Suppose that we have the data at the locations simulated by the commands below
</p>
   <div class="fancyvrb" id="fancyvrb428"><a 
 id="x13-64002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;set.seed(2);</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;n</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;100</span><br class="fancyvrb" /><a 
 id="x13-64004r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;loc</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;cbind(runif(n),</span><span 
class="aesltt-10x-x-109">&#x00A0;runif(n))</span></div>
<!--l. 422--><p class="indent" >   Now, we project the data simulated at the mesh vertices to this locations. To do it, we need
a projection matrix
</p>
   <div class="fancyvrb" id="fancyvrb429"><a 
 id="x13-64006r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;projloc</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.projector(mesh,</span><span 
class="aesltt-10x-x-109">&#x00A0;loc)</span></div>
<!--l. 430--><p class="noindent" >with
</p>
   <div class="fancyvrb" id="fancyvrb430"><a 
 id="x13-64008r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;x1</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.project(projloc,</span><span 
class="aesltt-10x-x-109">&#x00A0;sample1)</span><br class="fancyvrb" /><a 
 id="x13-64010r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;x2</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.project(projloc,</span><span 
class="aesltt-10x-x-109">&#x00A0;sample2)</span></div>
<!--l. 437--><p class="noindent" >and we have the sample data at these locations.
</p><!--l. 439--><p class="indent" >   Now, because the this locations aren&#8217;t vertices of the mesh, we need to use the stack
functionality. First, we need the predictor matrix. But this is the same used to &#8217;sample&#8217; the
data.
</p><!--l. 444--><p class="indent" >   And we define the stack for each one of the samples
                                                                                 
                                                                                 
</p>
   <div class="fancyvrb" id="fancyvrb431"><a 
 id="x13-64012r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stk1</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(list(y=x1),</span><span 
class="aesltt-10x-x-109">&#x00A0;A=list(projloc$proj$A),</span><span 
class="aesltt-10x-x-109">&#x00A0;tag=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">d</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x13-64014r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;effects=list(data.frame(i=1:mesh$n)))</span>
<br class="fancyvrb" /><a 
 id="x13-64016r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stk2</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(list(y=x2),</span><span 
class="aesltt-10x-x-109">&#x00A0;A=list(projloc$proj$A),</span><span 
class="aesltt-10x-x-109">&#x00A0;tag=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">d</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x13-64018r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;effects=list(data.frame(i=1:mesh$n)))</span></div>
<!--l. 454--><p class="indent" >   And we fit the model with
</p>
   <div class="fancyvrb" id="fancyvrb432"><a 
 id="x13-64020r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res1</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla(formula,</span><span 
class="aesltt-10x-x-109">&#x00A0;data=inla.stack.data(stk1),</span><span 
class="aesltt-10x-x-109">&#x00A0;control.family=clik,</span>
<br class="fancyvrb" /><a 
 id="x13-64022r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;control.predictor=list(compute=TRUE,</span><span 
class="aesltt-10x-x-109">&#x00A0;A=inla.stack.A(stk1)))</span>
<br class="fancyvrb" /><a 
 id="x13-64024r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res2</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla(formula,</span><span 
class="aesltt-10x-x-109">&#x00A0;data=inla.stack.data(stk2),</span><span 
class="aesltt-10x-x-109">&#x00A0;control.family=clik,</span>
<br class="fancyvrb" /><a 
 id="x13-64026r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;control.predictor=list(compute=TRUE,</span><span 
class="aesltt-10x-x-109">&#x00A0;A=inla.stack.A(stk2)))</span></div>
<!--l. 464--><p class="indent" >   The true and summary of marginal posterior distribution for <span 
class="cmmi-10x-x-109">&#x03B8;</span>:
</p>
   <div class="fancyvrb" id="fancyvrb433"><a 
 id="x13-64028r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;round(cbind(True=theta1,</span><span 
class="aesltt-10x-x-109">&#x00A0;res1$summary.hy),</span><span 
class="aesltt-10x-x-109">&#x00A0;4)</span></div>
<!--l. 470--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb434"><a 
 id="x13-64030r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;True</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mean</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sd</span><span 
class="aett-10x-x-109">&#x00A0;0.025quant</span><span 
class="aett-10x-x-109">&#x00A0;0.5quant</span><span 
class="aett-10x-x-109">&#x00A0;0.975quant</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mode</span>
<br class="fancyvrb" /><a 
 id="x13-64032r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Theta1</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;i</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-1</span><span 
class="aett-10x-x-109">&#x00A0;-1.0496</span><span 
class="aett-10x-x-109">&#x00A0;0.1817</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-1.4073</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-1.0494</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-0.6936</span><span 
class="aett-10x-x-109">&#x00A0;-1.0489</span>
<br class="fancyvrb" /><a 
 id="x13-64034r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Theta2</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;i</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.1947</span><span 
class="aett-10x-x-109">&#x00A0;0.1862</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.8175</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.1996</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.5481</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.2141</span>
<br class="fancyvrb" /><a 
 id="x13-64036r4"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Theta3</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;i</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-1</span><span 
class="aett-10x-x-109">&#x00A0;-0.9677</span><span 
class="aett-10x-x-109">&#x00A0;0.2424</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-1.4429</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-0.9684</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-0.4900</span><span 
class="aett-10x-x-109">&#x00A0;-0.9704</span></div>
<!--l. 476--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb435"><a 
 id="x13-64038r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;round(cbind(True=theta2,</span><span 
class="aesltt-10x-x-109">&#x00A0;res2$summary.hy),</span><span 
class="aesltt-10x-x-109">&#x00A0;4)</span></div>
<!--l. 479--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb436"><a 
 id="x13-64040r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;True</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mean</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sd</span><span 
class="aett-10x-x-109">&#x00A0;0.025quant</span><span 
class="aett-10x-x-109">&#x00A0;0.5quant</span><span 
class="aett-10x-x-109">&#x00A0;0.975quant</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mode</span>
<br class="fancyvrb" /><a 
 id="x13-64042r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Theta1</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;i</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-1</span><span 
class="aett-10x-x-109">&#x00A0;-0.9624</span><span 
class="aett-10x-x-109">&#x00A0;0.1771</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-1.3091</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-0.9630</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-0.6124</span><span 
class="aett-10x-x-109">&#x00A0;-0.9650</span>
<br class="fancyvrb" /><a 
 id="x13-64044r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Theta2</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;i</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.1677</span><span 
class="aett-10x-x-109">&#x00A0;0.1899</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.7823</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.1734</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.5263</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.1901</span>
<br class="fancyvrb" /><a 
 id="x13-64046r4"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Theta3</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;i</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.9308</span><span 
class="aett-10x-x-109">&#x00A0;0.2413</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.4562</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.9311</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.4041</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.9321</span></div>
<!--l. 487--><p class="indent" >   To make the visualization more good, we take the logarithm of the variance.
</p>
   <div class="fancyvrb" id="fancyvrb437"><a 
 id="x13-64048r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;x1.mean</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.project(proj,</span><span 
class="aesltt-10x-x-109">&#x00A0;field=res1$summary.ran$i$mean)</span>
<br class="fancyvrb" /><a 
 id="x13-64050r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;x1.var</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.project(proj,</span><span 
class="aesltt-10x-x-109">&#x00A0;field=res1$summary.ran$i$sd^2)</span>
<br class="fancyvrb" /><a 
 id="x13-64052r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;x2.mean</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.project(proj,</span><span 
class="aesltt-10x-x-109">&#x00A0;field=res2$summary.ran$i$mean)</span>
<br class="fancyvrb" /><a 
 id="x13-64054r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;x2.var</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.project(proj,</span><span 
class="aesltt-10x-x-109">&#x00A0;field=res2$summary.ran$i$sd^2)</span></div>
<!--l. 498--><p class="indent" >   We visualize, for both random fields, the simulated, the predicted (posterior mean) and the
posterior variance in Figure&#x00A0;<a 
href="#x13-640653">9.3<!--tex4ht:ref: fig:visprojp --></a> with commands below
</p>
   <div class="fancyvrb" id="fancyvrb438"><a 
 id="x13-64056r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;do.call(function(...)</span><span 
class="aesltt-10x-x-109">&#x00A0;grid.arrange(...,</span><span 
class="aesltt-10x-x-109">&#x00A0;nrow=2),</span>
<br class="fancyvrb" /><a 
 id="x13-64058r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;lapply(list(inla.mesh.project(proj,</span><span 
class="aesltt-10x-x-109">&#x00A0;sample1),</span><span 
class="aesltt-10x-x-109">&#x00A0;x1.mean,</span><span 
class="aesltt-10x-x-109">&#x00A0;x1.var,</span>
<br class="fancyvrb" /><a 
 id="x13-64060r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.project(proj,</span><span 
class="aesltt-10x-x-109">&#x00A0;sample2),</span><span 
class="aesltt-10x-x-109">&#x00A0;x2.mean,</span><span 
class="aesltt-10x-x-109">&#x00A0;x2.var),</span>
<br class="fancyvrb" /><a 
 id="x13-64062r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;levelplot,</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x13-64064r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;col.regions=topo.colors(100),</span><span 
class="aesltt-10x-x-109">&#x00A0;scale=list(draw=FALSE)))</span></div>
                                                                                 
                                                                                 
<hr class="figure" /><div class="figure" 
><a 
 id="x13-640653"></a><img 
src="spde-tutorial83x.png" alt="PIC" class="graphics" width="422.52936pt" height="211.26535pt"  /><!--tex4ht:graphics  
name="spde-tutorial83x.png" src="figs/nonstationar-fvisprojp.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;9.3: </span><span  
class="content">Simulated (top and bottom left), posterior mean (top and bottom mid) and
the posterior variance (top and bottom right) for both random fields.</span></div><!--tex4ht:label?: x13-640653 -->
   </div><hr class="endfigure" />
<!--l. 520--><p class="indent" >   We see in the Figure&#x00A0;<a 
href="#x13-640653">9.3<!--tex4ht:ref: fig:visprojp --></a> that the predicted values are similar to the simulated ones. Also, we
see that the posterior variance of the first model increase near 0.5 for the first coordinate. And
we see the opposite for the second random field. Also, we see that the variance of the first is
greater than the second.
                                                                                 
                                                                                 
</p>
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialch10.html" >next</a>] [<a 
href="spde-tutorialch8.html" >prev</a>] [<a 
href="spde-tutorialch8.html#tailspde-tutorialch8.html" >prev-tail</a>] [<a 
href="spde-tutorialch9.html" >front</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch9.html" >up</a>] </p></div>
<!--l. 1--><p class="indent" >   <a 
 id="tailspde-tutorialch9.html"></a>  </p> 
</body></html> 
