<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>3 A toy example</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- xhtml,html,frames,2 --> 
<meta name="src" content="spde-tutorial.tex" /> 
<meta name="date" content="2017-01-22 14:18:00" /> 
<link rel="stylesheet" type="text/css" href="spde-tutorial.css" /> 
</head><body 
>
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialch4.html" >next</a>] [<a 
href="spde-tutorialch2.html" >prev</a>] [<a 
href="spde-tutorialch2.html#tailspde-tutorialch2.html" >prev-tail</a>] [<a 
href="#tailspde-tutorialch3.html">tail</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch3.html" >up</a>] </p></div>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;3</span><br /><a 
 id="x7-200003"></a>A toy example</h2>
<!--l. 5--><p class="noindent" >In this section we start to show the fitting process using the SPDE approach, <span class="cite">[<a 
href="spde-tutorialli2.html#XlindgrenRL:2011">Lindgren
et&#x00A0;al., 2011</a>]</span>. This starter is by fitting a toy geostatistical model: Gaussian response
without covariate. We use the Bayesian approach and found the posterior marginal
distributions using the Integrated Nested Laplace Approximation - INLA, <span class="cite">[<a 
href="spde-tutorialli2.html#XrueMC:2009">Rue et&#x00A0;al., 2009</a>]</span>
implemented on the <span 
class="aeb10-x-x-109">INLA R </span>package. The ideas for application of the SPDE approach using
the <span 
class="aeb10-x-x-109">INLA </span>package are well described on <span class="cite">[<a 
href="spde-tutorialli2.html#Xlindgren:2012">Lindgren, 2012</a>]</span> and on <span class="cite">[<a 
href="spde-tutorialli2.html#XlindgrenR:2013">Lindgren and Rue,
2013</a>]</span>.
</p><!--l. 17--><p class="indent" >   The dataset used are a tree column <span 
class="aett-10x-x-109">data.frame </span>simulated on the previous section and
provided on <span 
class="aeb10-x-x-109">INLA </span>package. It can be called by
</p>
   <div class="fancyvrb" id="fancyvrb120"><a 
 id="x7-20002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data(SPDEtoy)</span></div>
<!--l. 26--><p class="noindent" >this is a <span 
class="aett-10x-x-109">data.frame </span>where the two first columns are the coordinates and the third is the response
simulated at this locations
</p>
   <div class="fancyvrb" id="fancyvrb121"><a 
 id="x7-20004r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;str(SPDEtoy)</span></div>
<div class="fancyvrb" id="fancyvrb122"><a 
 id="x7-20006r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">data.frame</span><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">:        200</span><span 
class="aett-10x-x-109">&#x00A0;obs.</span><span 
class="aett-10x-x-109">&#x00A0;of</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;3</span><span 
class="aett-10x-x-109">&#x00A0;variables:</span><br class="fancyvrb" /><a 
 id="x7-20008r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;$</span><span 
class="aett-10x-x-109">&#x00A0;s1:</span><span 
class="aett-10x-x-109">&#x00A0;num</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.0827</span><span 
class="aett-10x-x-109">&#x00A0;0.6123</span><span 
class="aett-10x-x-109">&#x00A0;0.162</span><span 
class="aett-10x-x-109">&#x00A0;0.7526</span><span 
class="aett-10x-x-109">&#x00A0;0.851</span><span 
class="aett-10x-x-109">&#x00A0;...</span>
<br class="fancyvrb" /><a 
 id="x7-20010r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;$</span><span 
class="aett-10x-x-109">&#x00A0;s2:</span><span 
class="aett-10x-x-109">&#x00A0;num</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.0564</span><span 
class="aett-10x-x-109">&#x00A0;0.9168</span><span 
class="aett-10x-x-109">&#x00A0;0.357</span><span 
class="aett-10x-x-109">&#x00A0;0.2576</span><span 
class="aett-10x-x-109">&#x00A0;0.1541</span><span 
class="aett-10x-x-109">&#x00A0;...</span><br class="fancyvrb" /><a 
 id="x7-20012r4"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;$</span><span 
class="aett-10x-x-109">&#x00A0;y</span><span 
class="aett-10x-x-109">&#x00A0;:</span><span 
class="aett-10x-x-109">&#x00A0;num</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;11.52</span><span 
class="aett-10x-x-109">&#x00A0;5.28</span><span 
class="aett-10x-x-109">&#x00A0;6.9</span><span 
class="aett-10x-x-109">&#x00A0;13.18</span><span 
class="aett-10x-x-109">&#x00A0;14.6</span><span 
class="aett-10x-x-109">&#x00A0;...</span></div>
<!--l. 41--><p class="indent" >   We consider the <span 
class="cmmi-10x-x-109">n </span>observations <span 
class="cmmi-10x-x-109">y</span><sub><span 
class="cmmi-8">i</span></sub> on locations the <span 
class="cmmi-10x-x-109">s</span><sub><span 
class="cmmi-8">i</span></sub>, <span 
class="cmmi-10x-x-109">i </span><span 
class="cmr-10x-x-109">= 1</span><span 
class="cmmi-10x-x-109">,...,n</span>, and we define the
model
</p>
   <table 
class="equation"><tr><td><a 
 id="x7-20013r1"></a>
   <center class="math-display" >
<img 
src="spde-tutorial37x.png" alt="yi|&#x03B2;0,xi,&#x03C3;2 ~ N (&#x03B2;0 + xi,&#x03C3;2)
       x ~eGF  (0,&#x03A3; )     e
" class="math-display"  /></center></td><td class="equation-label">(3.1)</td></tr></table>
<!--l. 47--><p class="nopar" >
We consider that <span 
class="cmmi-10x-x-109">x </span>is a realization of a Gaussian Field, with Matérn correlation function
parametrized by the smoothness parameter <span 
class="cmmi-10x-x-109">&#x03BD; </span>and the scale <span 
class="cmmi-10x-x-109">&#x03BA;</span>, such the parametrization
in&#x00A0;<span class="cite">[<a 
href="spde-tutorialli2.html#XlindgrenRL:2011">Lindgren et&#x00A0;al., 2011</a>]</span>.
</p><!--l. 55--><p class="indent" >   With this toy example we show with details how we make a good triangulation, prepare the
data, fit the model, extract the results from output and make predictions on locations where we
don&#8217;t have observed the response. In this section we use the default priors for all the
parameters.
</p><!--l. 64--><p class="indent" >   To the estimation mesh we need to define the mesh. We show it on Chapter&#x00A0;<a 
href="spde-tutorialch2.html#x6-100002.2">2.2<!--tex4ht:ref: ch:mesh --></a> and here we
use the fift mesh builded for the toy example on Chapter&#x00A0;<a 
href="spde-tutorialch2.html#x6-100002.2">2.2<!--tex4ht:ref: ch:mesh --></a>
</p><!--l. 69--><p class="indent" >   With that mesh, we define the SPDE model using the function <span 
class="aett-10x-x-109">inla.spde2.matern()</span>
</p>
   <div class="fancyvrb" id="fancyvrb123"><a 
 id="x7-20015r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;args(inla.spde2.matern)</span></div>
                                                                                 
                                                                                 
<div class="fancyvrb" id="fancyvrb124"><a 
 id="x7-20017r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;function</span><span 
class="aett-10x-x-109">&#x00A0;(mesh,</span><span 
class="aett-10x-x-109">&#x00A0;alpha</span><span 
class="aett-10x-x-109">&#x00A0;=</span><span 
class="aett-10x-x-109">&#x00A0;2,</span><span 
class="aett-10x-x-109">&#x00A0;param</span><span 
class="aett-10x-x-109">&#x00A0;=</span><span 
class="aett-10x-x-109">&#x00A0;NULL,</span><span 
class="aett-10x-x-109">&#x00A0;constr</span><span 
class="aett-10x-x-109">&#x00A0;=</span><span 
class="aett-10x-x-109">&#x00A0;FALSE,</span><span 
class="aett-10x-x-109">&#x00A0;extraconstr.int</span><span 
class="aett-10x-x-109">&#x00A0;=</span><span 
class="aett-10x-x-109">&#x00A0;NULL,</span>
<br class="fancyvrb" /><a 
 id="x7-20019r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;extraconstr</span><span 
class="aett-10x-x-109">&#x00A0;=</span><span 
class="aett-10x-x-109">&#x00A0;NULL,</span><span 
class="aett-10x-x-109">&#x00A0;fractional.method</span><span 
class="aett-10x-x-109">&#x00A0;=</span><span 
class="aett-10x-x-109">&#x00A0;c("parsimonious",</span>
<br class="fancyvrb" /><a 
 id="x7-20021r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;"null"),</span><span 
class="aett-10x-x-109">&#x00A0;B.tau</span><span 
class="aett-10x-x-109">&#x00A0;=</span><span 
class="aett-10x-x-109">&#x00A0;matrix(c(0,</span><span 
class="aett-10x-x-109">&#x00A0;1,</span><span 
class="aett-10x-x-109">&#x00A0;0),</span><span 
class="aett-10x-x-109">&#x00A0;1,</span><span 
class="aett-10x-x-109">&#x00A0;3),</span><span 
class="aett-10x-x-109">&#x00A0;B.kappa</span><span 
class="aett-10x-x-109">&#x00A0;=</span><span 
class="aett-10x-x-109">&#x00A0;matrix(c(0,</span>
<br class="fancyvrb" /><a 
 id="x7-20023r4"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0,</span><span 
class="aett-10x-x-109">&#x00A0;1),</span><span 
class="aett-10x-x-109">&#x00A0;1,</span><span 
class="aett-10x-x-109">&#x00A0;3),</span><span 
class="aett-10x-x-109">&#x00A0;prior.variance.nominal</span><span 
class="aett-10x-x-109">&#x00A0;=</span><span 
class="aett-10x-x-109">&#x00A0;1,</span><span 
class="aett-10x-x-109">&#x00A0;prior.range.nominal</span><span 
class="aett-10x-x-109">&#x00A0;=</span><span 
class="aett-10x-x-109">&#x00A0;NULL,</span>
<br class="fancyvrb" /><a 
 id="x7-20025r5"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;prior.tau</span><span 
class="aett-10x-x-109">&#x00A0;=</span><span 
class="aett-10x-x-109">&#x00A0;NULL,</span><span 
class="aett-10x-x-109">&#x00A0;prior.kappa</span><span 
class="aett-10x-x-109">&#x00A0;=</span><span 
class="aett-10x-x-109">&#x00A0;NULL,</span><span 
class="aett-10x-x-109">&#x00A0;theta.prior.mean</span><span 
class="aett-10x-x-109">&#x00A0;=</span><span 
class="aett-10x-x-109">&#x00A0;NULL,</span>
<br class="fancyvrb" /><a 
 id="x7-20027r6"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;theta.prior.prec</span><span 
class="aett-10x-x-109">&#x00A0;=</span><span 
class="aett-10x-x-109">&#x00A0;0.1,</span><span 
class="aett-10x-x-109">&#x00A0;n.iid.group</span><span 
class="aett-10x-x-109">&#x00A0;=</span><span 
class="aett-10x-x-109">&#x00A0;1)</span><br class="fancyvrb" /><a 
 id="x7-20029r7"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;NULL</span></div>
<!--l. 85--><p class="noindent" >The principal arguments are the mesh object and the <span 
class="cmmi-10x-x-109">&#x03B1; </span>parameter, related to the smoothness
parameter of the process.
</p><!--l. 89--><p class="indent" >   The toy dataset was simulated with <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 2 </span>and we use this value here (with the mesh
five)
</p>
   <div class="fancyvrb" id="fancyvrb125"><a 
 id="x7-20031r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;spde5</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde2.matern(mesh5,</span><span 
class="aesltt-10x-x-109">&#x00A0;alpha=2)</span></div>
<!--l. 97--><p class="indent" >   Also, from section&#x00A0;<a 
href="spde-tutorialch2.html#x6-170002.4">2.4<!--tex4ht:ref: sec:projmat --></a> we define the projector matrix
</p>
   <div class="fancyvrb" id="fancyvrb126"><a 
 id="x7-20033r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;coords</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;as.matrix(SPDEtoy[,1:2])</span><br class="fancyvrb" /><a 
 id="x7-20035r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;A5</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde.make.A(mesh5,</span><span 
class="aesltt-10x-x-109">&#x00A0;loc=coords)</span></div>
   <h3 class="sectionHead"><span class="titlemark">3.1   </span> <a 
 id="x7-210003.1"></a>The stack functionality</h3>
<!--l. 108--><p class="noindent" >The stack functionality is a very useful functionality to work with SPDE on <span 
class="aeb10-x-x-109">INLA </span>package. This
allow to fit more general SPDE models, such as replicated or correlated ones, or more general
models that includes more than one projector matrix. Using it we avoid errors in the index
construction, <span class="cite">[<a 
href="spde-tutorialli2.html#Xlindgren:2012">Lindgren, 2012</a>]</span>. Examples on more complex models, with the details,
can be found on <span class="cite">[<a 
href="spde-tutorialli2.html#Xlindgren:2012">Lindgren, 2012</a>]</span>, <span class="cite">[<a 
href="spde-tutorialli2.html#Xcameletti:2012">Cameletti et&#x00A0;al., 2012</a>]</span> and <span class="cite">[<a 
href="spde-tutorialli2.html#XlindgrenR:2013">Lindgren and Rue,
2013</a>]</span>.
</p><!--l. 120--><p class="indent" >   In a section on the previous Chapter we define the projector matrix to project the
latent field on the response locations. If we have have covariates measured at same
locations (with same dimention of the response), we need a more general definition of the
linear predictor. On the toy example, we have to include the effect of the random field
and the intercept that is treated as a covariate. So, we define the new intercept <span 
class="cmmi-10x-x-109">&#x03B7;</span><sup><span 
class="cmsy-8">*</span></sup>
as
</p>
   <center class="math-display" >
<img 
src="spde-tutorial38x.png" alt=" *
&#x03B7; = Ax  + 1¯&#x03B2;0
" class="math-display"  /></center>
<!--l. 133--><p class="nopar" > that is a sum of two components each one can be represented as a product of a projector matrix
and an effect.
</p><!--l. 138--><p class="indent" >   We have that the SPDE approach defines a model on the mesh nodes, and usually
the number of nodes are not equal to the number of locations where we have data
observed. The <span 
class="aett-10x-x-109">inla.stack </span>function allow us to work with predictors that includes terms
with different dimentions. The three main <span 
class="aett-10x-x-109">inla.stack() </span>arguments are the <span 
class="aett-10x-x-109">data</span>
vectors list, a list of projector matrices (each one related to one block effect) and the
effects.
</p><!--l. 150--><p class="indent" >   We need two projector matrices, the projector matrix for the latend field and a matrix to
map one-to-one the &#8217;covariate&#8217; and the response. This last one can be just a constant instead a
diagonal matrix. So, we have
</p>
   <div class="fancyvrb" id="fancyvrb127"><a 
 id="x7-21002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stk5</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(data=list(resp=SPDEtoy$y),</span><span 
class="aesltt-10x-x-109">&#x00A0;A=list(A5,1),</span>
<br class="fancyvrb" /><a 
 id="x7-21004r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;effects=list(i=1:spde5$n.spde,</span>
<br class="fancyvrb" /><a 
 id="x7-21006r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;m=rep(1,nrow(SPDEtoy))),</span><span 
class="aesltt-10x-x-109">&#x00A0;tag=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">est</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span></div>
                                                                                 
                                                                                 
<!--l. 163--><p class="indent" >   The <span 
class="aett-10x-x-109">inla.stack() </span>function automatically eliminates the elements when any column of each
projector matrix has zero sum, generating a correspondent simplified projector matrix.
The <span 
class="aett-10x-x-109">inla.stack.A() </span>extracts a simplified predictor matrix to use on the <span 
class="aett-10x-x-109">inla()</span>
function and the <span 
class="aett-10x-x-109">inla.stack.data() </span>function extract the correspondent organized
data.
</p><!--l. 173--><p class="indent" >   The simplified projector matrix from the stack is the binded by column the simplified
projectors matrices from each effect block. So, in this case we have
</p>
   <div class="fancyvrb" id="fancyvrb128"><a 
 id="x7-21008r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;dim(inla.stack.A(stk5))</span></div>
<!--l. 181--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb129"><a 
 id="x7-21010r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;200</span><span 
class="aett-10x-x-109">&#x00A0;249</span></div>
<!--l. 185--><p class="noindent" >one columns more than the number of columns with non null elements of the projector
matrix.
</p><!--l. 188--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3.2   </span> <a 
 id="x7-220003.2"></a>Model fitting and some results</h3>
<!--l. 190--><p class="noindent" >To fit the model need to remove the intercept from the formulae and add it as a covariate term,
because we a have projector matrix that allows it as a covariate effect. Of course, we must
have to pass these predictor matrix on <span 
class="aett-10x-x-109">control.predictor </span>argument of the <span 
class="aett-10x-x-109">inla</span>
function
</p>
   <div class="fancyvrb" id="fancyvrb130"><a 
 id="x7-22002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res5</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla(resp</span><span 
class="aesltt-10x-x-109">&#x00A0;~</span><span 
class="aesltt-10x-x-109">&#x00A0;0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;m</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;f(i,</span><span 
class="aesltt-10x-x-109">&#x00A0;model=spde5),</span><br class="fancyvrb" /><a 
 id="x7-22004r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=inla.stack.data(stk5),</span>
<br class="fancyvrb" /><a 
 id="x7-22006r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;control.predictor=list(A=inla.stack.A(stk5)))</span></div>
<!--l. 205--><p class="indent" >   An object from <span 
class="aett-10x-x-109">inla() </span>function has a set of several results. These includes summaries,
marginal posterior densities of each parameter on the model: the regression parameters, each
element of the latent field and all the hyperparameters.
</p><!--l. 211--><p class="indent" >   The summary of <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub> is obtained by
</p>
   <div class="fancyvrb" id="fancyvrb131"><a 
 id="x7-22008r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res5$summary.fix</span></div>
<!--l. 216--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb132"><a 
 id="x7-22010r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mean</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sd</span><span 
class="aett-10x-x-109">&#x00A0;0.025quant</span><span 
class="aett-10x-x-109">&#x00A0;0.5quant</span><span 
class="aett-10x-x-109">&#x00A0;0.975quant</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mode</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;kld</span>
<br class="fancyvrb" /><a 
 id="x7-22012r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;m</span><span 
class="aett-10x-x-109">&#x00A0;9.515321</span><span 
class="aett-10x-x-109">&#x00A0;0.7321088</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;7.977745</span><span 
class="aett-10x-x-109">&#x00A0;9.530563</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;10.9655</span><span 
class="aett-10x-x-109">&#x00A0;9.555448</span><span 
class="aett-10x-x-109">&#x00A0;4.337767e-10</span></div>
<!--l. 222--><p class="indent" >   The summary of <span 
class="cmr-10x-x-109">1</span><span 
class="cmmi-10x-x-109">&#x2215;&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmr-8">2</span></sup> is obtained by
</p>
   <div class="fancyvrb" id="fancyvrb133"><a 
 id="x7-22014r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res5$summary.hy[1,]</span></div>
<!--l. 227--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb134"><a 
 id="x7-22016r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mean</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sd</span><span 
class="aett-10x-x-109">&#x00A0;0.025quant</span>
<br class="fancyvrb" /><a 
 id="x7-22018r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Precision</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;the</span><span 
class="aett-10x-x-109">&#x00A0;Gaussian</span><span 
class="aett-10x-x-109">&#x00A0;observations</span><span 
class="aett-10x-x-109">&#x00A0;2.740854</span><span 
class="aett-10x-x-109">&#x00A0;0.4294075</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.982823</span>
<br class="fancyvrb" /><a 
 id="x7-22020r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.5quant</span><span 
class="aett-10x-x-109">&#x00A0;0.975quant</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mode</span>
<br class="fancyvrb" /><a 
 id="x7-22022r4"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Precision</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;the</span><span 
class="aett-10x-x-109">&#x00A0;Gaussian</span><span 
class="aett-10x-x-109">&#x00A0;observations</span><span 
class="aett-10x-x-109">&#x00A0;2.712372</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;3.664651</span><span 
class="aett-10x-x-109">&#x00A0;2.659948</span></div>
                                                                                 
                                                                                 
<!--l. 235--><p class="indent" >   A marginal distribution on <span 
class="aett-10x-x-109">inla() </span>output is just two vector, where one represents the
parameter values and another the density. Any posterior marginal can be transformed. If we
want the posterior marginal for <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub>, the square root of the <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmr-8">2</span></sup>, we use
</p>
   <div class="fancyvrb" id="fancyvrb135"><a 
 id="x7-22024r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;post.se</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.tmarginal(function(x)</span><span 
class="aesltt-10x-x-109">&#x00A0;sqrt(1/x),</span>
<br class="fancyvrb" /><a 
 id="x7-22026r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res5$marginals.hy[[1]])</span></div>
<!--l. 248--><p class="noindent" >and now we are able to summarize this distribution
</p>
   <div class="fancyvrb" id="fancyvrb136"><a 
 id="x7-22028r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.emarginal(function(x)</span><span 
class="aesltt-10x-x-109">&#x00A0;x,</span><span 
class="aesltt-10x-x-109">&#x00A0;post.se)</span></div>
<!--l. 253--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb137"><a 
 id="x7-22030r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;0.6095443</span></div>
<!--l. 256--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb138"><a 
 id="x7-22032r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.qmarginal(c(0.025,</span><span 
class="aesltt-10x-x-109">&#x00A0;0.5,</span><span 
class="aesltt-10x-x-109">&#x00A0;0.975),</span><span 
class="aesltt-10x-x-109">&#x00A0;post.se)</span></div>
<!--l. 259--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb139"><a 
 id="x7-22034r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;0.5229423</span><span 
class="aett-10x-x-109">&#x00A0;0.6070412</span><span 
class="aett-10x-x-109">&#x00A0;0.7087971</span></div>
<!--l. 262--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb140"><a 
 id="x7-22036r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.hpdmarginal(0.95,</span><span 
class="aesltt-10x-x-109">&#x00A0;post.se)</span></div>
<!--l. 265--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb141"><a 
 id="x7-22038r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;low</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;high</span><br class="fancyvrb" /><a 
 id="x7-22040r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;level:0.95</span><span 
class="aett-10x-x-109">&#x00A0;0.5190225</span><span 
class="aett-10x-x-109">&#x00A0;0.7040746</span></div>
<!--l. 269--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb142"><a 
 id="x7-22042r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.pmarginal(c(0.5,</span><span 
class="aesltt-10x-x-109">&#x00A0;0.7),</span><span 
class="aesltt-10x-x-109">&#x00A0;post.se)</span></div>
<!--l. 272--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb143"><a 
 id="x7-22044r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;0.00465222</span><span 
class="aett-10x-x-109">&#x00A0;0.96410039</span></div>
<!--l. 276--><p class="noindent" >and, of course, we can visualize it.
</p><!--l. 278--><p class="indent" >   The parameters of the latent field is parametrized as <span 
class="cmmi-10x-x-109">log</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">&#x03BA;</span><span 
class="cmr-10x-x-109">) </span>and <span 
class="cmmi-10x-x-109">log</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">&#x03C4;</span><span 
class="cmr-10x-x-109">)</span>, where <span 
class="cmmi-10x-x-109">&#x03C4; </span>is the local
variance parameter. We have the posterior marginals for <span 
class="cmmi-10x-x-109">&#x03BA;</span>, <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">x</span></sub><sup><span 
class="cmr-8">2</span></sup> and for the nominal range (the
distance that we have correlation equals 0.1). This can be done with the <span 
class="aett-10x-x-109">inla.spde2.result</span>
function
</p>
   <div class="fancyvrb" id="fancyvrb144"><a 
 id="x7-22046r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res5.field</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde2.result(res5,</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">i</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;spde5,</span><span 
class="aesltt-10x-x-109">&#x00A0;do.transf=TRUE)</span></div>
<!--l. 291--><p class="noindent" >and we get the posterior mean of each of these parameters by
</p>
   <div class="fancyvrb" id="fancyvrb145"><a 
 id="x7-22048r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.emarginal(function(x)</span><span 
class="aesltt-10x-x-109">&#x00A0;x,</span><span 
class="aesltt-10x-x-109">&#x00A0;res5.field$marginals.kappa[[1]])</span></div>
                                                                                 
                                                                                 
<!--l. 296--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb146"><a 
 id="x7-22050r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;7.898428</span></div>
<!--l. 299--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb147"><a 
 id="x7-22052r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.emarginal(function(x)</span><span 
class="aesltt-10x-x-109">&#x00A0;x,</span><span 
class="aesltt-10x-x-109">&#x00A0;res5.field$marginals.variance.nominal[[1]])</span></div>
<!--l. 302--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb148"><a 
 id="x7-22054r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;3.872945</span></div>
<!--l. 305--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb149"><a 
 id="x7-22056r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.emarginal(function(x)</span><span 
class="aesltt-10x-x-109">&#x00A0;x,</span><span 
class="aesltt-10x-x-109">&#x00A0;res5.field$marginals.range.nominal[[1]])</span></div>
<!--l. 308--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb150"><a 
 id="x7-22058r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;0.3773454</span></div>
<!--l. 312--><p class="noindent" >also we can get other summary statistics, HPD interval and visualize it.
</p><!--l. 315--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3.3   </span> <a 
 id="x7-230003.3"></a>Prediction of the random field</h3>
<!--l. 317--><p class="noindent" >A very common objective when we have spatial data collected on some locations is the
prediction on a fine grid to get hight resolution maps. In this section we show two approaches to
make prediction of the random field, one is after the estimation process and other is jointly on
estimation process. To compare both approaches, we predict the random field on three target
locations: (0.1,0.1), (0.5,0.55), (0.7,0.9).
</p>
   <div class="fancyvrb" id="fancyvrb151"><a 
 id="x7-23002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;pts3</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;rbind(c(.1,.1),</span><span 
class="aesltt-10x-x-109">&#x00A0;c(.5,.55),</span><span 
class="aesltt-10x-x-109">&#x00A0;c(.7,.9))</span></div>
<!--l. 332--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.3.1   </span> <a 
 id="x7-240003.3.1"></a>Jointly with the estimation process</h4>
<!--l. 334--><p class="noindent" >The prediction of the random field joint the parameter estimation process in Bayesian inference
is the common approach. This approach is made by the computation of the marginal posterior
distribution of the random field at target locations. If the target points are on the mesh, so we
have automatically this distribution. If the target points are not on the mesh, we must define the
projector matrix for the target points.
</p><!--l. 346--><p class="indent" >   The predictor matrix for the target locations is
</p>
   <div class="fancyvrb" id="fancyvrb152"><a 
 id="x7-24002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;dim(A5pts3</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde.make.A(mesh5,</span><span 
class="aesltt-10x-x-109">&#x00A0;loc=pts3))</span></div>
<!--l. 351--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb153"><a 
 id="x7-24004r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;3</span><span 
class="aett-10x-x-109">&#x00A0;490</span></div>
                                                                                 
                                                                                 
<!--l. 355--><p class="noindent" >We can show the columns with non-zero elements of this matrix
</p>
   <div class="fancyvrb" id="fancyvrb154"><a 
 id="x7-24006r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;(jj3</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;which(colSums(A5pts3)&#x003E;0))</span></div>
<!--l. 361--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb155"><a 
 id="x7-24008r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;85</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;89</span><span 
class="aett-10x-x-109">&#x00A0;153</span><span 
class="aett-10x-x-109">&#x00A0;162</span><span 
class="aett-10x-x-109">&#x00A0;197</span><span 
class="aett-10x-x-109">&#x00A0;242</span><span 
class="aett-10x-x-109">&#x00A0;244</span><span 
class="aett-10x-x-109">&#x00A0;285</span><span 
class="aett-10x-x-109">&#x00A0;290</span></div>
<!--l. 364--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb156"><a 
 id="x7-24010r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;round(A5pts3[,</span><span 
class="aesltt-10x-x-109">&#x00A0;jj3],3)</span></div>
<!--l. 367--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb157"><a 
 id="x7-24012r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;3</span><span 
class="aett-10x-x-109">&#x00A0;x</span><span 
class="aett-10x-x-109">&#x00A0;9</span><span 
class="aett-10x-x-109">&#x00A0;sparse</span><span 
class="aett-10x-x-109">&#x00A0;Matrix</span><span 
class="aett-10x-x-109">&#x00A0;of</span><span 
class="aett-10x-x-109">&#x00A0;class</span><span 
class="aett-10x-x-109">&#x00A0;"dgCMatrix"</span><br class="fancyvrb" /><a 
 id="x7-24014r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><br class="fancyvrb" /><a 
 id="x7-24016r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1,]</span><span 
class="aett-10x-x-109">&#x00A0;.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.094</span><span 
class="aett-10x-x-109">&#x00A0;.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.513</span><span 
class="aett-10x-x-109">&#x00A0;0.393</span><span 
class="aett-10x-x-109">&#x00A0;.</span>
<br class="fancyvrb" /><a 
 id="x7-24018r4"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[2,]</span><span 
class="aett-10x-x-109">&#x00A0;0.219</span><span 
class="aett-10x-x-109">&#x00A0;.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.324</span><span 
class="aett-10x-x-109">&#x00A0;.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.458</span><span 
class="aett-10x-x-109">&#x00A0;.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;.</span>
<br class="fancyvrb" /><a 
 id="x7-24020r5"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[3,]</span><span 
class="aett-10x-x-109">&#x00A0;.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.119</span><span 
class="aett-10x-x-109">&#x00A0;.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.268</span><span 
class="aett-10x-x-109">&#x00A0;.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.612</span></div>
<!--l. 376--><p class="indent" >   We have to define a data stack for the prediction and join it with the data stack of the
observations. The prediction data stack contais the effect set, predictor matrices and assign NA
to response
</p>
   <div class="fancyvrb" id="fancyvrb158"><a 
 id="x7-24022r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stk5p.rf</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(data=list(resp=NA),</span><span 
class="aesltt-10x-x-109">&#x00A0;A=list(A5pts3),</span>
<br class="fancyvrb" /><a 
 id="x7-24024r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;effects=list(i=1:spde5$n.spde),</span><span 
class="aesltt-10x-x-109">&#x00A0;tag=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">prd5r</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span></div>
<!--l. 386--><p class="noindent" >Also, we join both stacks by
</p>
   <div class="fancyvrb" id="fancyvrb159"><a 
 id="x7-24026r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stk5.jp</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(stk5,</span><span 
class="aesltt-10x-x-109">&#x00A0;stk5p.rf)</span></div>
<!--l. 392--><p class="noindent" >and fit the model again with the full stack setting <span 
class="aett-10x-x-109">compute=TRUE </span>on <span 
class="aett-10x-x-109">control.predictor</span>
</p>
   <div class="fancyvrb" id="fancyvrb160"><a 
 id="x7-24028r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res5p</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla(resp</span><span 
class="aesltt-10x-x-109">&#x00A0;~</span><span 
class="aesltt-10x-x-109">&#x00A0;0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;m</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;f(i,</span><span 
class="aesltt-10x-x-109">&#x00A0;model=spde5),</span><br class="fancyvrb" /><a 
 id="x7-24030r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=inla.stack.data(stk5.jp),</span>
<br class="fancyvrb" /><a 
 id="x7-24032r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;control.predictor=list(A=inla.stack.A(stk5.jp),</span><span 
class="aesltt-10x-x-109">&#x00A0;compute=TRUE))</span></div>
<!--l. 402--><p class="indent" >   To access the posterior marginal distribution of the random field at the target locations, we
extract the index from the full stack using the adequate <span 
class="aett-10x-x-109">tag</span>.
</p>
   <div class="fancyvrb" id="fancyvrb161"><a 
 id="x7-24034r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;(indd5p</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack.index(stk5.jp,</span><span 
class="aesltt-10x-x-109">&#x00A0;tag=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">prd5r</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)$data)</span></div>
<!--l. 410--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb162"><a 
 id="x7-24036r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;201</span><span 
class="aett-10x-x-109">&#x00A0;202</span><span 
class="aett-10x-x-109">&#x00A0;203</span></div>
<!--l. 414--><p class="noindent" >The summary of the posterior distributions of the random field on the target locations
is
</p>
   <div class="fancyvrb" id="fancyvrb163"><a 
 id="x7-24038r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;round(res5p$summary.linear.pred[indd5p,],</span><span 
class="aesltt-10x-x-109">&#x00A0;4)</span></div>
<!--l. 420--><p class="noindent" >
                                                                                 
                                                                                 
</p>
   <div class="fancyvrb" id="fancyvrb164"><a 
 id="x7-24040r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mean</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sd</span><span 
class="aett-10x-x-109">&#x00A0;0.025quant</span><span 
class="aett-10x-x-109">&#x00A0;0.5quant</span><span 
class="aett-10x-x-109">&#x00A0;0.975quant</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mode</span><span 
class="aett-10x-x-109">&#x00A0;kld</span>
<br class="fancyvrb" /><a 
 id="x7-24042r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Apredictor.201</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.1683</span><span 
class="aett-10x-x-109">&#x00A0;0.8119</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-1.4021</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.1480</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.8621</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.1143</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span>
<br class="fancyvrb" /><a 
 id="x7-24044r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Apredictor.202</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;3.0480</span><span 
class="aett-10x-x-109">&#x00A0;0.9610</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.1764</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;3.0367</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;4.9886</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;3.0168</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span>
<br class="fancyvrb" /><a 
 id="x7-24046r4"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Apredictor.203</span><span 
class="aett-10x-x-109">&#x00A0;-2.7852</span><span 
class="aett-10x-x-109">&#x00A0;1.2086</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-5.1885</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-2.7782</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-0.4225</span><span 
class="aett-10x-x-109">&#x00A0;-2.7652</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span></div>
<!--l. 427--><p class="noindent" >that includes the posterior mean, standard deviation, quantiles and mode.
</p><!--l. 430--><p class="indent" >   Because it is a full bayesian analysis, we also we have the marginal distributions. We extract
the marginals posterior distributions with
</p>
   <div class="fancyvrb" id="fancyvrb165"><a 
 id="x7-24048r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;marg3</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;res5p$marginals.linear[indd5p]</span></div>
<!--l. 438--><p class="noindent" >and get the 95% HPD interval for the random field at the second target location by
</p>
   <div class="fancyvrb" id="fancyvrb166"><a 
 id="x7-24050r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.hpdmarginal(0.95,</span><span 
class="aesltt-10x-x-109">&#x00A0;marg3[[2]])</span></div>
<!--l. 444--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb167"><a 
 id="x7-24052r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;low</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;high</span><br class="fancyvrb" /><a 
 id="x7-24054r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;level:0.95</span><span 
class="aett-10x-x-109">&#x00A0;1.153082</span><span 
class="aett-10x-x-109">&#x00A0;4.962885</span></div>
<!--l. 449--><p class="noindent" >and see that around the point (0.5,0.5) the random field has positive values, see Figure&#x00A0;<a 
href="#x7-300531">3.1<!--tex4ht:ref: fig:pgrid --></a>.
</p><!--l. 452--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.3.2   </span> <a 
 id="x7-250003.3.2"></a>After the estimation process</h4>
<!--l. 454--><p class="noindent" >If we need just the prediction we can do the prediction after the estimation process with a very
small computational cost. It is just a matrix operation in way that we just project the posterior
mean of the the random field on mesh nodes to target locations, using the correspondent
projector matrix.
</p><!--l. 463--><p class="indent" >   So, we &#8217;project&#8217; the posterior mean of the latend random field to the target locations
by
</p>
   <div class="fancyvrb" id="fancyvrb168"><a 
 id="x7-25002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;drop(A5pts3%*%res5$summary.random$i$mean)</span></div>
<!--l. 469--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb169"><a 
 id="x7-25004r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.1677611</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;3.0473053</span><span 
class="aett-10x-x-109">&#x00A0;-2.7852272</span></div>
<!--l. 473--><p class="noindent" >or using the <span 
class="aett-10x-x-109">inla.mesh.projector() </span>function
</p>
   <div class="fancyvrb" id="fancyvrb170"><a 
 id="x7-25006r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.project(inla.mesh.projector(mesh5,</span><span 
class="aesltt-10x-x-109">&#x00A0;loc=pts3),</span>
<br class="fancyvrb" /><a 
 id="x7-25008r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res5$summary.random$i$mean)</span></div>
<!--l. 479--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb171"><a 
 id="x7-25010r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.1677611</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;3.0473053</span><span 
class="aett-10x-x-109">&#x00A0;-2.7852272</span></div>
<!--l. 483--><p class="noindent" >and see that for the mean we have similar values than those on previous section.
</p><!--l. 486--><p class="indent" >   Also, we can get the standard deviation
</p>
   <div class="fancyvrb" id="fancyvrb172"><a 
 id="x7-25012r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;drop(A5pts3%*%res5$summary.random$i$sd)</span></div>
                                                                                 
                                                                                 
<!--l. 491--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb173"><a 
 id="x7-25014r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;0.8947855</span><span 
class="aett-10x-x-109">&#x00A0;1.1135311</span><span 
class="aett-10x-x-109">&#x00A0;1.3737751</span></div>
<!--l. 495--><p class="noindent" >and we have a little difference.
</p>
   <div class="fancyvrb" id="fancyvrb174"><a 
 id="x7-25016r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;sqrt(drop((A5pts3^2)%*%(res5$summary.random$i$sd^2)))</span></div>
<!--l. 500--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb175"><a 
 id="x7-25018r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;0.5897516</span><span 
class="aett-10x-x-109">&#x00A0;0.6849483</span><span 
class="aett-10x-x-109">&#x00A0;0.9346851</span></div>
<!--l. 505--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.3.3   </span> <a 
 id="x7-260003.3.3"></a>Projection on a grid</h4>
<!--l. 507--><p class="noindent" >The approach by the projection of the posterior mean random field is computationaly cheap. So,
it can be used to get the map of the random field on a fine grid. The <span 
class="aett-10x-x-109">inla.mesh.projector()</span>
function get the projector matrix automatically for a grid of points over a square that contains
the mesh.
</p><!--l. 515--><p class="indent" >   To get projection on a grid at the domain <span 
class="cmr-10x-x-109">(0</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmr-10x-x-109">1) </span><span 
class="cmsy-10x-x-109">&#x00D7; </span><span 
class="cmr-10x-x-109">(0</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmr-10x-x-109">1) </span>we just inform these limits
</p>
   <div class="fancyvrb" id="fancyvrb176"><a 
 id="x7-26002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;pgrid0</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.projector(mesh5,</span><span 
class="aesltt-10x-x-109">&#x00A0;xlim=0:1,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylim=0:1,</span><span 
class="aesltt-10x-x-109">&#x00A0;dims=c(101,101))</span></div>
<!--l. 522--><p class="noindent" >and we project the posterior mean and the posterior standard deviation on the both grid
with
</p>
   <div class="fancyvrb" id="fancyvrb177"><a 
 id="x7-26004r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;prd0.m</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.project(pgrid0,</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res5$summary.ran$i$mean)</span>
<br class="fancyvrb" /><a 
 id="x7-26006r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;prd0.s</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.project(pgrid0,</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res5$summary.ran$i$s)</span></div>
<!--l. 530--><p class="noindent" >We visualize this values projected on the grid on Figure&#x00A0;<a 
href="#x7-300531">3.1<!--tex4ht:ref: fig:pgrid --></a>.
</p><!--l. 533--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3.4   </span> <a 
 id="x7-270003.4"></a>Prediction of the response</h3>
<!--l. 535--><p class="noindent" >Another commom result that we want on spatially continuous modelling is the prediction of the
response on a target locations that we don&#8217;t have data observed. In similar way that on past
section, it is possible to find the marginal distribution or to make a projection of some functional
of the response.
</p><!--l. 543--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.4.1   </span> <a 
 id="x7-280003.4.1"></a>By the posterior distribution</h4>
<!--l. 545--><p class="noindent" >In this case, we want to define a adequate predictor of the response and build the model again.
This is similar to the stack to predict the random field, but here we add the intercept on the list
of predictor matrix and on the list of effects
                                                                                 
                                                                                 
</p>
   <div class="fancyvrb" id="fancyvrb178"><a 
 id="x7-28002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stk5.presp</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(data=list(resp=NA),</span><span 
class="aesltt-10x-x-109">&#x00A0;A=list(A5pts3,1),</span>
<br class="fancyvrb" /><a 
 id="x7-28004r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;effects=list(i=1:spde5$n.spde,</span><span 
class="aesltt-10x-x-109">&#x00A0;m=rep(1,3)),</span>
<br class="fancyvrb" /><a 
 id="x7-28006r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;tag=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">prd5.resp</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span></div>
<!--l. 558--><p class="noindent" >and join with the data stack to build the model again
</p>
   <div class="fancyvrb" id="fancyvrb179"><a 
 id="x7-28008r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stk5.full</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(stk5,</span><span 
class="aesltt-10x-x-109">&#x00A0;stk5.presp)</span><br class="fancyvrb" /><a 
 id="x7-28010r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;r5presp</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla(resp</span><span 
class="aesltt-10x-x-109">&#x00A0;~</span><span 
class="aesltt-10x-x-109">&#x00A0;0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;m</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;f(i,</span><span 
class="aesltt-10x-x-109">&#x00A0;model=spde5),</span>
<br class="fancyvrb" /><a 
 id="x7-28012r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=inla.stack.data(stk5.full),</span>
<br class="fancyvrb" /><a 
 id="x7-28014r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;control.predictor=list(A=inla.stack.A(stk5.full),</span><span 
class="aesltt-10x-x-109">&#x00A0;compute=TRUE))</span></div>
<!--l. 568--><p class="indent" >   We find the index of the predictor that corresponds the predicted values of the response on
the target locations. We extract the index from the full stack by
</p>
   <div class="fancyvrb" id="fancyvrb180"><a 
 id="x7-28016r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;(indd3r</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack.index(stk5.full,</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">prd5.resp</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)$data)</span></div>
<!--l. 576--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb181"><a 
 id="x7-28018r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;201</span><span 
class="aett-10x-x-109">&#x00A0;202</span><span 
class="aett-10x-x-109">&#x00A0;203</span></div>
<!--l. 581--><p class="indent" >   To get the summary of the posterior distributions of the response on target locations we
do
</p>
   <div class="fancyvrb" id="fancyvrb182"><a 
 id="x7-28020r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;round(r5presp$summary.fitted.values[indd3r,],</span><span 
class="aesltt-10x-x-109">&#x00A0;3)</span></div>
<!--l. 587--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb183"><a 
 id="x7-28022r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mean</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sd</span><span 
class="aett-10x-x-109">&#x00A0;0.025quant</span><span 
class="aett-10x-x-109">&#x00A0;0.5quant</span><span 
class="aett-10x-x-109">&#x00A0;0.975quant</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mode</span>
<br class="fancyvrb" /><a 
 id="x7-28024r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;fitted.Apredictor.201</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;9.683</span><span 
class="aett-10x-x-109">&#x00A0;0.343</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;9.012</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;9.682</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;10.358</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;9.681</span>
<br class="fancyvrb" /><a 
 id="x7-28026r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;fitted.Apredictor.202</span><span 
class="aett-10x-x-109">&#x00A0;12.563</span><span 
class="aett-10x-x-109">&#x00A0;0.626</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;11.336</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;12.561</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;13.796</span><span 
class="aett-10x-x-109">&#x00A0;12.559</span>
<br class="fancyvrb" /><a 
 id="x7-28028r4"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;fitted.Apredictor.203</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;6.730</span><span 
class="aett-10x-x-109">&#x00A0;0.989</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;4.794</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;6.726</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;8.687</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;6.719</span></div>
<!--l. 594--><p class="noindent" >Also, we extract the marginals posterior distributions with
</p>
   <div class="fancyvrb" id="fancyvrb184"><a 
 id="x7-28030r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;marg3r</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;r5presp$marginals.fitted.values[indd3r]</span></div>
<!--l. 601--><p class="noindent" >and get the 95% HPD interval for the response at second target location by
</p>
   <div class="fancyvrb" id="fancyvrb185"><a 
 id="x7-28032r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.hpdmarginal(0.95,</span><span 
class="aesltt-10x-x-109">&#x00A0;marg3r[[2]])</span></div>
<!--l. 607--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb186"><a 
 id="x7-28034r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;low</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;high</span><br class="fancyvrb" /><a 
 id="x7-28036r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;level:0.95</span><span 
class="aett-10x-x-109">&#x00A0;11.33272</span><span 
class="aett-10x-x-109">&#x00A0;13.79105</span></div>
<!--l. 612--><p class="noindent" >and see that around the point (0.5,0.5) we have the values of the response significantly larger than
<span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub>, see Figure&#x00A0;<a 
href="#x7-300531">3.1<!--tex4ht:ref: fig:pgrid --></a>.
                                                                                 
                                                                                 
</p><!--l. 616--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.4.2   </span> <a 
 id="x7-290003.4.2"></a>By sum of linear predictor components</h4>
<!--l. 618--><p class="noindent" >A computational cheap approach is to (naively) sum the projected posterior mean
to the regression term. In this toy example we just sum the posterior mean of the
intercept to the posterior mean of the random field to get the posterior mean of the
response.
</p><!--l. 625--><p class="indent" >   If there are covariates, the prediction also can be made in similar way, see&#x00A0;. That approach
can be used here considering just the intercept
</p>
   <div class="fancyvrb" id="fancyvrb187"><a 
 id="x7-29002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res5$summary.fix[1,1]</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;drop(A5pts3%*%res5$summary.random$i$mean)</span></div>
<!--l. 633--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb188"><a 
 id="x7-29004r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;9.683082</span><span 
class="aett-10x-x-109">&#x00A0;12.562627</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;6.730094</span></div>
<!--l. 637--><p class="noindent" >For the standard error, we need to take into account the error of the covariate values and regression
coefficients.
</p>
   <div class="fancyvrb" id="fancyvrb189"><a 
 id="x7-29006r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;summary(rvar</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;res5$summary.random$i$sd^2)</span></div>
<!--l. 645--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb190"><a 
 id="x7-29008r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Min.</span><span 
class="aett-10x-x-109">&#x00A0;1st</span><span 
class="aett-10x-x-109">&#x00A0;Qu.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Median</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Mean</span><span 
class="aett-10x-x-109">&#x00A0;3rd</span><span 
class="aett-10x-x-109">&#x00A0;Qu.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Max.</span><br class="fancyvrb" /><a 
 id="x7-29010r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.5925</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.0370</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.4300</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.5170</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.6080</span><span 
class="aett-10x-x-109">&#x00A0;11.0800</span></div>
<!--l. 649--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb191"><a 
 id="x7-29012r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;sqrt(1^2+res5$summary.fix[1,2]^2</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;drop(A5pts3%*%rvar))</span></div>
<!--l. 652--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb192"><a 
 id="x7-29014r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;1.529301</span><span 
class="aett-10x-x-109">&#x00A0;1.669212</span><span 
class="aett-10x-x-109">&#x00A0;1.850958</span></div>
<!--l. 657--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.4.3   </span> <a 
 id="x7-300003.4.3"></a>Response on a grid</h4>
<!--l. 659--><p class="noindent" >The computation of all marginal posterior distributions on a grid is computationally expensive.
But, we usually not uses the marginal distributions. We usually uses just the mean and standard
deviation. So, we don&#8217;t need the storage of all the marginal distributions! Also, we don&#8217;t need
the quantiles of the marginal distributions.
</p><!--l. 667--><p class="indent" >   On the code below, we build the model again but we disable the storage of the marginal
posterior distributions to random effects and to posterior predictor values. Also, we
disable the computation of the quantiles. Only the mean and standard defiation are
stored.
</p><!--l. 674--><p class="indent" >   We use the projector matrix on the projector object that we use to project the posterior
mean on the grid
                                                                                 
                                                                                 
</p>
   <div class="fancyvrb" id="fancyvrb193"><a 
 id="x7-30002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stkgrid</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(data=list(resp=NA),</span><span 
class="aesltt-10x-x-109">&#x00A0;A=list(pgrid0$proj$A,1),</span>
<br class="fancyvrb" /><a 
 id="x7-30004r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;effects=list(i=1:spde5$n.spde,</span>
<br class="fancyvrb" /><a 
 id="x7-30006r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;m=rep(1,101*101)),</span><span 
class="aesltt-10x-x-109">&#x00A0;tag=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">prd.gr</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span><br class="fancyvrb" /><a 
 id="x7-30008r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stk.all</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(stk5,</span><span 
class="aesltt-10x-x-109">&#x00A0;stkgrid)</span>
<br class="fancyvrb" /><a 
 id="x7-30010r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res5g</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla(resp</span><span 
class="aesltt-10x-x-109">&#x00A0;~</span><span 
class="aesltt-10x-x-109">&#x00A0;0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;m</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;f(i,</span><span 
class="aesltt-10x-x-109">&#x00A0;model=spde5),</span><br class="fancyvrb" /><a 
 id="x7-30012r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=inla.stack.data(stk.all),</span>
<br class="fancyvrb" /><a 
 id="x7-30014r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;control.predictor=list(A=inla.stack.A(stk.all),</span>
<br class="fancyvrb" /><a 
 id="x7-30016r8"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;compute=TRUE),</span><span 
class="aesltt-10x-x-109">&#x00A0;quantiles=NULL,</span>
<br class="fancyvrb" /><a 
 id="x7-30018r9"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;control.results=list(return.marginals.random=FALSE,</span>
<br class="fancyvrb" /><a 
 id="x7-30020r10"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;return.marginals.predictor=FALSE))</span><br class="fancyvrb" /><a 
 id="x7-30022r11"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res5g$cpu</span></div>
<!--l. 690--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb194"><a 
 id="x7-30024r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Pre-processing</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Running</span><span 
class="aett-10x-x-109">&#x00A0;inla</span><span 
class="aett-10x-x-109">&#x00A0;Post-processing</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Total</span>
<br class="fancyvrb" /><a 
 id="x7-30026r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.21755958</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;11.04928875</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.08309412</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;11.34994245</span></div>
<!--l. 696--><p class="indent" >   We get the indexes
</p>
   <div class="fancyvrb" id="fancyvrb195"><a 
 id="x7-30028r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;igr</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack.index(stk.all,</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">prd.gr</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)$data</span></div>
<!--l. 702--><p class="noindent" >and use it to visualize, together the prediction of the random field on previous section, on
Figure&#x00A0;<a 
href="#x7-300531">3.1<!--tex4ht:ref: fig:pgrid --></a> with the commands bellow
</p>
   <div class="fancyvrb" id="fancyvrb196"><a 
 id="x7-30030r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;require(gridExtra)</span>
<br class="fancyvrb" /><a 
 id="x7-30032r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;grid.arrange(levelplot(prd0.m,</span><span 
class="aesltt-10x-x-109">&#x00A0;col.regions=topo.colors(99),</span><span 
class="aesltt-10x-x-109">&#x00A0;main=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">latent</span><span 
class="aesltt-10x-x-109">&#x00A0;field</span><span 
class="aesltt-10x-x-109">&#x00A0;mean</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x7-30034r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;scales=list(draw=FALSE)),</span>
<br class="fancyvrb" /><a 
 id="x7-30036r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;levelplot(matrix(res5g$summary.fitt[igr,1],</span><span 
class="aesltt-10x-x-109">&#x00A0;101),</span>
<br class="fancyvrb" /><a 
 id="x7-30038r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;main=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">response</span><span 
class="aesltt-10x-x-109">&#x00A0;mean</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x7-30040r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;col.regions=topo.colors(99),</span><span 
class="aesltt-10x-x-109">&#x00A0;scales=list(draw=FALSE)),</span>
<br class="fancyvrb" /><a 
 id="x7-30042r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;levelplot(prd0.s,</span><span 
class="aesltt-10x-x-109">&#x00A0;col.regions=topo.colors(99),</span><span 
class="aesltt-10x-x-109">&#x00A0;main=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">latent</span><span 
class="aesltt-10x-x-109">&#x00A0;field</span><span 
class="aesltt-10x-x-109">&#x00A0;SD</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x7-30044r8"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;scales=list(draw=FALSE)),</span>
<br class="fancyvrb" /><a 
 id="x7-30046r9"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;levelplot(matrix(res5g$summary.fitt[igr,2],</span><span 
class="aesltt-10x-x-109">&#x00A0;101),</span>
<br class="fancyvrb" /><a 
 id="x7-30048r10"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;main=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">response</span><span 
class="aesltt-10x-x-109">&#x00A0;SD</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x7-30050r11"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;col.regions=topo.colors(99),</span><span 
class="aesltt-10x-x-109">&#x00A0;scales=list(draw=FALSE)),</span>
<br class="fancyvrb" /><a 
 id="x7-30052r12"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;nrow=2)</span></div>
                                                                                 
                                                                                 
<hr class="figure" /><div class="figure" 
><a 
 id="x7-300531"></a><img 
src="spde-tutorial39x.png" alt="PIC" class="graphics" width="422.52936pt" height="394.37744pt"  /><!--tex4ht:graphics  
name="spde-tutorial39x.png" src="figs/toy-046.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;3.1: </span><span  
class="content">The mean and standard deviation of the random field (top left and bottom
left) and the mean and standard variation of the response (top right and bottom right)</span></div><!--tex4ht:label?: x7-300531 -->
   </div><hr class="endfigure" />
<!--l. 731--><p class="indent" >   We see on Figure&#x00A0;<a 
href="#x7-300531">3.1<!--tex4ht:ref: fig:pgrid --></a> that we have a variation from -4 to 4 on the spatial effect. Considering
also that we have standard deviations around 0.8 to 1.6, the spatial dependence is
significantly.
</p><!--l. 737--><p class="indent" >   Another thing is that the standard deviation of both, random field and the response, are less
near the corner (0, 0) and greater near the corner (1,1). This is just proportional to the locations
density.
</p><!--l. 743--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3.5   </span> <a 
 id="x7-310003.5"></a>Results from different meshes</h3>
<!--l. 745--><p class="noindent" >In this section we compare six results for the toy dataset based on the six different meshs
builded on section&#x00A0;<a 
href="spde-tutorialch2.html#x6-100002.2">2.2<!--tex4ht:ref: ch:mesh --></a>. To do this comparison, we just plot the posterior marginal distributions
of the model parameters. We evaluate the meshes by the addiction of the true values used on the
simulation of the toy dataset. Also, we add the maximum likelihood estimates from <span 
class="aeb10-x-x-109">geoR</span>
package, <span class="cite">[<a 
href="spde-tutorialli2.html#XgeoR">Ribeiro Jr and Diggle, 2001</a>]</span>.
</p><!--l. 757--><p class="indent" >   We fit the model, using each one of the six meshes, and put the results in a list with the code
bellow
</p>
                                                                                 
                                                                                 
   <div class="fancyvrb" id="fancyvrb197"><a 
 id="x7-31002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;lrf</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;lres</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;l.dat</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;l.spde</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;l.a</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;list()</span><br class="fancyvrb" /><a 
 id="x7-31004r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;for</span><span 
class="aesltt-10x-x-109">&#x00A0;(k</span><span 
class="aesltt-10x-x-109">&#x00A0;in</span><span 
class="aesltt-10x-x-109">&#x00A0;1:6)</span><span 
class="aesltt-10x-x-109">&#x00A0;{</span>
<br class="fancyvrb" /><a 
 id="x7-31006r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;l.a[[k]]</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde.make.A(get(paste(</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">mesh</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;k,</span><span 
class="aesltt-10x-x-109">&#x00A0;sep=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">)),</span><span 
class="aesltt-10x-x-109">&#x00A0;loc=coords)</span>
<br class="fancyvrb" /><a 
 id="x7-31008r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;l.spde[[k]]</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde2.matern(get(paste(</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">mesh</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;k,</span><span 
class="aesltt-10x-x-109">&#x00A0;sep=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">)),</span><span 
class="aesltt-10x-x-109">&#x00A0;alpha=2)</span>
<br class="fancyvrb" /><a 
 id="x7-31010r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;l.dat[[k]]</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;list(y=SPDEtoy[,3],</span><span 
class="aesltt-10x-x-109">&#x00A0;i=1:ncol(l.a[[k]]),</span>
<br class="fancyvrb" /><a 
 id="x7-31012r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;m=rep(1,</span><span 
class="aesltt-10x-x-109">&#x00A0;ncol(l.a[[k]])))</span>
<br class="fancyvrb" /><a 
 id="x7-31014r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;lres[[k]]</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla(y</span><span 
class="aesltt-10x-x-109">&#x00A0;~</span><span 
class="aesltt-10x-x-109">&#x00A0;0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;m</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;f(i,</span><span 
class="aesltt-10x-x-109">&#x00A0;model=l.spde[[k]]),</span>
<br class="fancyvrb" /><a 
 id="x7-31016r8"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=l.dat[[k]],</span><span 
class="aesltt-10x-x-109">&#x00A0;control.predictor=list(A=l.a[[k]]))</span>
<br class="fancyvrb" /><a 
 id="x7-31018r9"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;lrf[[k]]</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde2.result(lres[[k]],</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">i</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;l.spde[[k]],</span><span 
class="aesltt-10x-x-109">&#x00A0;do.transf=TRUE)</span><br class="fancyvrb" /><a 
 id="x7-31020r10"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;}</span></div>
<!--l. 774--><p class="indent" >   The mesh size influences the computational time needed to fit the model. More nodes on
the mesh need more computational time. The time running inla for these six meshes
are
</p>
   <div class="fancyvrb" id="fancyvrb198"><a 
 id="x7-31022r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;round(sapply(lres,</span><span 
class="aesltt-10x-x-109">&#x00A0;function(x)</span><span 
class="aesltt-10x-x-109">&#x00A0;x$cpu[2]),</span><span 
class="aesltt-10x-x-109">&#x00A0;2)</span></div>
<!--l. 782--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb199"><a 
 id="x7-31024r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Running</span><span 
class="aett-10x-x-109">&#x00A0;inla</span><span 
class="aett-10x-x-109">&#x00A0;Running</span><span 
class="aett-10x-x-109">&#x00A0;inla</span><span 
class="aett-10x-x-109">&#x00A0;Running</span><span 
class="aett-10x-x-109">&#x00A0;inla</span><span 
class="aett-10x-x-109">&#x00A0;Running</span><span 
class="aett-10x-x-109">&#x00A0;inla</span><span 
class="aett-10x-x-109">&#x00A0;Running</span><span 
class="aett-10x-x-109">&#x00A0;inla</span>
<br class="fancyvrb" /><a 
 id="x7-31026r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;14.45</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.76</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.97</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;11.90</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.39</span><br class="fancyvrb" /><a 
 id="x7-31028r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Running</span><span 
class="aett-10x-x-109">&#x00A0;inla</span><br class="fancyvrb" /><a 
 id="x7-31030r4"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.16</span></div>
<!--l. 790--><p class="indent" >   We compute the distribution for <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmr-8">2</span></sup> for each fitted model
</p>
   <div class="fancyvrb" id="fancyvrb200"><a 
 id="x7-31032r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;s2.marg</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;lapply(lres,</span><span 
class="aesltt-10x-x-109">&#x00A0;function(m)</span>
<br class="fancyvrb" /><a 
 id="x7-31034r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.tmarginal(function(x)</span><span 
class="aesltt-10x-x-109">&#x00A0;1/x,</span><span 
class="aesltt-10x-x-109">&#x00A0;m$marginals.hy[[1]]))</span></div>
<!--l. 799--><p class="indent" >   The true values are: <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub> <span 
class="cmr-10x-x-109">= 10</span>, <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmr-8">2</span></sup> <span 
class="cmr-10x-x-109">= 0</span><span 
class="cmmi-10x-x-109">.</span><span 
class="cmr-10x-x-109">3</span>, <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">x</span></sub><sup><span 
class="cmr-8">2</span></sup> <span 
class="cmr-10x-x-109">= 5</span>, <span 
class="cmmi-10x-x-109">&#x03BA; </span><span 
class="cmr-10x-x-109">= 7 </span>and <span 
class="cmmi-10x-x-109">&#x03BD; </span><span 
class="cmr-10x-x-109">= 1</span>. The <span 
class="cmmi-10x-x-109">&#x03BD; </span>parameter is fixed
on the true value when we define <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 2 </span>on definition of the SPDE model.
</p>
   <div class="fancyvrb" id="fancyvrb201"><a 
 id="x7-31036r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;beta0</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;10;</span><span 
class="aesltt-10x-x-109">&#x00A0;sigma2e</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;0.3;</span><span 
class="aesltt-10x-x-109">&#x00A0;sigma2x</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;5;</span><span 
class="aesltt-10x-x-109">&#x00A0;kappa</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;7;</span><span 
class="aesltt-10x-x-109">&#x00A0;nu</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;1</span></div>
<!--l. 808--><p class="noindent" >and the maximum likelihood estimates are
</p><!--l. 811--><p class="indent" >
</p>
   <div class="fancyvrb" id="fancyvrb202"><a 
 id="x7-31038r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;lk.est</span></div>
<!--l. 814--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb203"><a 
 id="x7-31040r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;beta</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;s2e</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;s2x</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;kappa</span><br class="fancyvrb" /><a 
 id="x7-31042r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;9.5400961</span><span 
class="aett-10x-x-109">&#x00A0;0.3739484</span><span 
class="aett-10x-x-109">&#x00A0;3.3227266</span><span 
class="aett-10x-x-109">&#x00A0;8.4134845</span></div>
<!--l. 820--><p class="indent" >   We want to visualize the posterior marginal distributions for <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub>, <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmr-8">2</span></sup>, <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">x</span></sub><sup><span 
class="cmr-8">2</span></sup>, <span 
class="cmmi-10x-x-109">&#x03BA;</span>, nominal range
and the local variance <span 
class="cmmi-10x-x-109">&#x03C4;</span>. This can be done with the code bellow
</p>
   <div class="fancyvrb" id="fancyvrb204"><a 
 id="x7-31044r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;rcols</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;rainbow(6)##c(rgb(4:1/4,0:3/5,0),</span><span 
class="aesltt-10x-x-109">&#x00A0;c(rgb(0,0:3/5,4:1/4)))</span>
<br class="fancyvrb" /><a 
 id="x7-31046r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;par(mfrow=c(2,3),</span><span 
class="aesltt-10x-x-109">&#x00A0;mar=c(2.5,2.5,1,.5),</span><span 
class="aesltt-10x-x-109">&#x00A0;mgp=c(1.5,.5,0),</span><span 
class="aesltt-10x-x-109">&#x00A0;las=1)</span>
<br class="fancyvrb" /><a 
 id="x7-31048r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xrange</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;range(sapply(lres,</span><span 
class="aesltt-10x-x-109">&#x00A0;function(x)</span><span 
class="aesltt-10x-x-109">&#x00A0;range(x$marginals.fix[[1]][,1])))</span>
<br class="fancyvrb" /><a 
 id="x7-31050r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;yrange</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;range(sapply(lres,</span><span 
class="aesltt-10x-x-109">&#x00A0;function(x)</span><span 
class="aesltt-10x-x-109">&#x00A0;range(x$marginals.fix[[1]][,2])))</span>
<br class="fancyvrb" /><a 
 id="x7-31052r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(lres[[1]]$marginals.fix[[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;xlim=xrange,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylim=yrange,</span>
<br class="fancyvrb" /><a 
 id="x7-31054r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=expression(beta[0]),</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Density</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span><br class="fancyvrb" /><a 
 id="x7-31056r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;for</span><span 
class="aesltt-10x-x-109">&#x00A0;(k</span><span 
class="aesltt-10x-x-109">&#x00A0;in</span><span 
class="aesltt-10x-x-109">&#x00A0;1:6)</span>
<br class="fancyvrb" /><a 
 id="x7-31058r8"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;lines(lres[[k]]$marginals.fix[[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;col=rcols[k],</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2)</span>
<br class="fancyvrb" /><a 
 id="x7-31060r9"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;abline(v=beta0,</span><span 
class="aesltt-10x-x-109">&#x00A0;lty=2,</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2,</span><span 
class="aesltt-10x-x-109">&#x00A0;col=3)</span><br class="fancyvrb" /><a 
 id="x7-31062r10"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;abline(v=lk.est[1],</span><span 
class="aesltt-10x-x-109">&#x00A0;lty=3,</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2,</span><span 
class="aesltt-10x-x-109">&#x00A0;col=3)</span>
<br class="fancyvrb" /><a 
 id="x7-31064r11"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xrange</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;range(sapply(s2.marg,</span><span 
class="aesltt-10x-x-109">&#x00A0;function(x)</span><span 
class="aesltt-10x-x-109">&#x00A0;range(x[,1])))</span>
<br class="fancyvrb" /><a 
 id="x7-31066r12"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;yrange</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;range(sapply(s2.marg,</span><span 
class="aesltt-10x-x-109">&#x00A0;function(x)</span><span 
class="aesltt-10x-x-109">&#x00A0;range(x[,2])))</span>
                                                                                 
                                                                                 
<br class="fancyvrb" /><a 
 id="x7-31068r13"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot.default(s2.marg[[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;xlim=xrange,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylim=yrange,</span>
<br class="fancyvrb" /><a 
 id="x7-31070r14"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=expression(sigma[e]^2),</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Density</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span>
<br class="fancyvrb" /><a 
 id="x7-31072r15"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;for</span><span 
class="aesltt-10x-x-109">&#x00A0;(k</span><span 
class="aesltt-10x-x-109">&#x00A0;in</span><span 
class="aesltt-10x-x-109">&#x00A0;1:6)</span><br class="fancyvrb" /><a 
 id="x7-31074r16"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;lines(s2.marg[[k]],</span><span 
class="aesltt-10x-x-109">&#x00A0;col=rcols[k],</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2)</span>
<br class="fancyvrb" /><a 
 id="x7-31076r17"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;abline(v=sigma2e,</span><span 
class="aesltt-10x-x-109">&#x00A0;lty=2,</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2,</span><span 
class="aesltt-10x-x-109">&#x00A0;col=3)</span><br class="fancyvrb" /><a 
 id="x7-31078r18"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;abline(v=lk.est[2],</span><span 
class="aesltt-10x-x-109">&#x00A0;lty=3,</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2,</span><span 
class="aesltt-10x-x-109">&#x00A0;col=3)</span>
<br class="fancyvrb" /><a 
 id="x7-31080r19"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xrange</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;range(sapply(lrf,</span><span 
class="aesltt-10x-x-109">&#x00A0;function(r)</span><span 
class="aesltt-10x-x-109">&#x00A0;range(r$marginals.variance.nominal[[1]][,1])))</span>
<br class="fancyvrb" /><a 
 id="x7-31082r20"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;yrange</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;range(sapply(lrf,</span><span 
class="aesltt-10x-x-109">&#x00A0;function(r)</span><span 
class="aesltt-10x-x-109">&#x00A0;range(r$marginals.variance.nominal[[1]][,2])))</span>
<br class="fancyvrb" /><a 
 id="x7-31084r21"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(lrf[[1]]$marginals.variance.nominal[[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x7-31086r22"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlim=xrange,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylim=yrange,</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=expression(sigma[x]^2),</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Density</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span>
<br class="fancyvrb" /><a 
 id="x7-31088r23"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;for</span><span 
class="aesltt-10x-x-109">&#x00A0;(k</span><span 
class="aesltt-10x-x-109">&#x00A0;in</span><span 
class="aesltt-10x-x-109">&#x00A0;1:6)</span><br class="fancyvrb" /><a 
 id="x7-31090r24"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;lines(lrf[[k]]$marginals.variance.nominal[[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;col=rcols[k],</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2)</span>
<br class="fancyvrb" /><a 
 id="x7-31092r25"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;abline(v=sigma2x,</span><span 
class="aesltt-10x-x-109">&#x00A0;lty=2,</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2,</span><span 
class="aesltt-10x-x-109">&#x00A0;col=3)</span><br class="fancyvrb" /><a 
 id="x7-31094r26"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;abline(v=lk.est[3],</span><span 
class="aesltt-10x-x-109">&#x00A0;lty=3,</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2,</span><span 
class="aesltt-10x-x-109">&#x00A0;col=3)</span>
<br class="fancyvrb" /><a 
 id="x7-31096r27"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xrange</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;range(sapply(lrf,</span><span 
class="aesltt-10x-x-109">&#x00A0;function(r)</span><span 
class="aesltt-10x-x-109">&#x00A0;range(r$marginals.kappa[[1]][,1])))</span>
<br class="fancyvrb" /><a 
 id="x7-31098r28"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;yrange</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;range(sapply(lrf,</span><span 
class="aesltt-10x-x-109">&#x00A0;function(r)</span><span 
class="aesltt-10x-x-109">&#x00A0;range(r$marginals.kappa[[1]][,2])))</span>
<br class="fancyvrb" /><a 
 id="x7-31100r29"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(lrf[[1]]$marginals.kappa[[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x7-31102r30"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlim=xrange,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylim=yrange,</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=expression(kappa),</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Density</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span>
<br class="fancyvrb" /><a 
 id="x7-31104r31"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;for</span><span 
class="aesltt-10x-x-109">&#x00A0;(k</span><span 
class="aesltt-10x-x-109">&#x00A0;in</span><span 
class="aesltt-10x-x-109">&#x00A0;1:6)</span><br class="fancyvrb" /><a 
 id="x7-31106r32"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;lines(lrf[[k]]$marginals.kappa[[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;col=rcols[k],</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2)</span>
<br class="fancyvrb" /><a 
 id="x7-31108r33"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;abline(v=kappa,</span><span 
class="aesltt-10x-x-109">&#x00A0;lty=2,</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2,</span><span 
class="aesltt-10x-x-109">&#x00A0;col=3)</span><br class="fancyvrb" /><a 
 id="x7-31110r34"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;abline(v=lk.est[4],</span><span 
class="aesltt-10x-x-109">&#x00A0;lty=3,</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2,</span><span 
class="aesltt-10x-x-109">&#x00A0;col=3)</span>
<br class="fancyvrb" /><a 
 id="x7-31112r35"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xrange</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;range(sapply(lrf,</span><span 
class="aesltt-10x-x-109">&#x00A0;function(r)</span><span 
class="aesltt-10x-x-109">&#x00A0;range(r$marginals.range.nominal[[1]][,1])))</span>
<br class="fancyvrb" /><a 
 id="x7-31114r36"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;yrange</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;range(sapply(lrf,</span><span 
class="aesltt-10x-x-109">&#x00A0;function(r)</span><span 
class="aesltt-10x-x-109">&#x00A0;range(r$marginals.range.nominal[[1]][,2])))</span>
<br class="fancyvrb" /><a 
 id="x7-31116r37"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(lrf[[1]]$marginals.range.nominal[[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x7-31118r38"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlim=xrange,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylim=yrange,</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">nominal</span><span 
class="aesltt-10x-x-109">&#x00A0;range</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Density</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span>
<br class="fancyvrb" /><a 
 id="x7-31120r39"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;for</span><span 
class="aesltt-10x-x-109">&#x00A0;(k</span><span 
class="aesltt-10x-x-109">&#x00A0;in</span><span 
class="aesltt-10x-x-109">&#x00A0;1:6)</span><br class="fancyvrb" /><a 
 id="x7-31122r40"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;lines(lrf[[k]]$marginals.range.nominal[[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;col=rcols[k],</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2)</span>
<br class="fancyvrb" /><a 
 id="x7-31124r41"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;abline(v=sqrt(8)/kappa,</span><span 
class="aesltt-10x-x-109">&#x00A0;lty=2,</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2,</span><span 
class="aesltt-10x-x-109">&#x00A0;col=3)</span><br class="fancyvrb" /><a 
 id="x7-31126r42"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;abline(v=sqrt(8)/lk.est[4],</span><span 
class="aesltt-10x-x-109">&#x00A0;lty=3,</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2,</span><span 
class="aesltt-10x-x-109">&#x00A0;col=3)</span>
<br class="fancyvrb" /><a 
 id="x7-31128r43"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xrange</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;range(sapply(lrf,</span><span 
class="aesltt-10x-x-109">&#x00A0;function(r)</span><span 
class="aesltt-10x-x-109">&#x00A0;range(r$marginals.tau[[1]][,1])))</span>
<br class="fancyvrb" /><a 
 id="x7-31130r44"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;yrange</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;range(sapply(lrf,</span><span 
class="aesltt-10x-x-109">&#x00A0;function(r)</span><span 
class="aesltt-10x-x-109">&#x00A0;range(r$marginals.tau[[1]][,2])))</span>
<br class="fancyvrb" /><a 
 id="x7-31132r45"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(lrf[[1]]$marginals.tau[[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x7-31134r46"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlim=xrange,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylim=yrange,</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=expression(tau),</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Density</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span>
<br class="fancyvrb" /><a 
 id="x7-31136r47"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;for</span><span 
class="aesltt-10x-x-109">&#x00A0;(k</span><span 
class="aesltt-10x-x-109">&#x00A0;in</span><span 
class="aesltt-10x-x-109">&#x00A0;1:6)</span><br class="fancyvrb" /><a 
 id="x7-31138r48"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;lines(lrf[[k]]$marginals.tau[[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;col=rcols[k],</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2)</span>
<br class="fancyvrb" /><a 
 id="x7-31140r49"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;legend(</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">topright</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;c(paste(</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">mesh</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;1:6,</span><span 
class="aesltt-10x-x-109">&#x00A0;sep=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">),</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">True</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Likelihood</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">),</span>
<br class="fancyvrb" /><a 
 id="x7-31142r50"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;lty=c(rep(1,6),</span><span 
class="aesltt-10x-x-109">&#x00A0;2,</span><span 
class="aesltt-10x-x-109">&#x00A0;3),</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=rep(2,</span><span 
class="aesltt-10x-x-109">&#x00A0;6),</span><span 
class="aesltt-10x-x-109">&#x00A0;col=c(rcols,3,3),</span><span 
class="aesltt-10x-x-109">&#x00A0;bty=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">n</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span></div>
<!--l. 880--><p class="indent" >   At the Figure&#x00A0;<a 
href="#x7-311472">3.2<!--tex4ht:ref: fig:margposttoy --></a> we can see that the posterior marginal distribution for the intercept has
mode on the likelihood estimate, considering the results from all six meshes.
</p>
   <div class="fancyvrb" id="fancyvrb205"><a 
 id="x7-31144r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;1/kappa</span></div>
<!--l. 888--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb206"><a 
 id="x7-31146r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;0.1428571</span></div>
<!--l. 893--><p class="indent" >   The main differences are on the noise variance <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmr-8">2</span></sup> (the nugget effect). The result from the
mesh based on the points and with small triangles mode less than the likelihood estimate, the
second has mode near likelihood estimate and the third large. Considering the other meshes, the
mesh four has mode around likelihood estimate and the other two litle larger, similar to the
third mesh, such is based on points but with some freedom (<span 
class="aett-10x-x-109">cutoff </span>greather than
zero).
</p><!--l. 906--><p class="indent" >   For the marginal variance of the latent field, <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">x</span></sub><sup><span 
class="cmr-8">2</span></sup>, the results with all meshes had mode near
the likelihood estimate. For the scale parameter <span 
class="cmmi-10x-x-109">&#x03BA; </span>all meshes has mode less than the likelihood
estimate. The posterior distribution from the meshes based on points are that ones with less
mode and that the mode from third mesh are the less. For the practical range the opposite
happens.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x7-311472"></a>
                                                                                 
                                                                                 
<!--l. 917--><p class="noindent" ><img 
src="spde-tutorial40x.png" alt="PIC" class="graphics" width="422.52936pt" height="281.69817pt"  /><!--tex4ht:graphics  
name="spde-tutorial40x.png" src="figs/toy-055.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;3.2: </span><span  
class="content">Marginal posterior distribution for <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub>  (top left), <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmr-8">2</span></sup>  (top mid), <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">x</span></sub><sup><span 
class="cmr-8">2</span></sup>  (top
right), <span 
class="cmmi-10x-x-109">&#x03BA; </span>(bottom left), nominal range (bottom mid) and <span 
class="cmmi-10x-x-109">&#x03C4; </span>(bottom right).</span></div><!--tex4ht:label?: x7-311472 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 925--><p class="indent" >   These results are not conclusive, but a general comment is that is good to have a mesh with
some tune on the points locations, to access noise variance, but with some flexibility to avoid
many variability on the triangles size and shape, to get good latent field parameters
estimation.
                                                                                 
                                                                                 
</p>
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialch4.html" >next</a>] [<a 
href="spde-tutorialch2.html" >prev</a>] [<a 
href="spde-tutorialch2.html#tailspde-tutorialch2.html" >prev-tail</a>] [<a 
href="spde-tutorialch3.html" >front</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch3.html" >up</a>] </p></div>
<!--l. 1--><p class="indent" >   <a 
 id="tailspde-tutorialch3.html"></a>  </p> 
</body></html> 
