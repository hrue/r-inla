<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>5 Space-time examples</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- xhtml,html,frames,2 --> 
<meta name="src" content="spde-tutorial.tex" /> 
<meta name="date" content="2017-03-01 23:12:00" /> 
<link rel="stylesheet" type="text/css" href="spde-tutorial.css" /> 
</head><body 
>
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialli2.html" >next</a>] [<a 
href="spde-tutorialch4.html" >prev</a>] [<a 
href="spde-tutorialch4.html#tailspde-tutorialch4.html" >prev-tail</a>] [<a 
href="#tailspde-tutorialch5.html">tail</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch5.html" >up</a>] </p></div>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;5</span><br /><a 
 id="x9-840005"></a>Space-time examples</h2>
<!--l. 3--><p class="noindent" >The  R  source  for  this  file  is  available  at
<a 
href="http://www.math.ntnu.no/inla/r-inla.org/tutorials/spde/R/spde-tutorial-spacetime.R" class="url" ><span 
class="aett-10x-x-109">http://www.math.ntnu.no/inla/r-_inla.org/tutorials/spde/R/spde-_tutorial-_spacetime.R</span></a>
</p><!--l. 8--><p class="indent" >   In this chapter we show an example on fitting a space-time model. This model is a separable
one described on <span class="cite">[<a 
href="spde-tutorialli2.html#Xcameletti:2012">Cameletti et&#x00A0;al., 2012</a>]</span>. Basically the model is defined as a SPDE model
for the spatial domain and an AR(<span 
class="cmr-10x-x-109">1</span>) model for the time dimention. The space-time
separable model is defined by the kronecker product between the precision of these two
models.
</p><!--l. 16--><p class="indent" >   We provide two examples, one for discrete time domain and another when the
time is discretized over a set of knots. Basically the difference appears only in the
simulation process, wich is not that important. The main difference in the fitting process is
that in the continuous time case we have to select time knots and build the projector
matrix considering it. However, both cases allows to have different locations at different
times.
</p>
   <h3 class="sectionHead"><span class="titlemark">5.1   </span> <a 
 id="x9-850005.1"></a>Discrete time domain</h3>
<!--l. 25--><p class="noindent" >In this section we show how to fit a space-time separable model, as in <span class="cite">[<a 
href="spde-tutorialli2.html#Xcameletti:2012">Cameletti et&#x00A0;al., 2012</a>]</span>.
Additionally, we show the use of a categorical covariate.
</p><!--l. 29--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.1.1   </span> <a 
 id="x9-860005.1.1"></a>Data simulation</h4>
<!--l. 31--><p class="noindent" >We use the Paraná state border, available on <span 
class="aeb10-x-x-109">INLA </span>package, as the domain.  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12183"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12180"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor12181"><span 
class="aett-10x-x-109">(PRborder)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 40--><p class="indent" >   We start by defining the spatial model. Because we need that the example run faster, we use
the low resolution mesh for Paraná state border created in Section&#x00A0;<a 
href="spde-tutorialch1.html#x5-270001.3">1.3<!--tex4ht:ref: sec:mesh --></a>.
</p><!--l. 46--><p class="indent" >   There is two options to simulate from Cameletti&#8217;s model. One is based on the marginal
distribution of the latent field and another is on the conditional distribution at each time. This
last option is easy as we can simulate one realization of a spatial random field for each
time.
</p><!--l. 55--><p class="indent" >   First we set <span 
class="cmmi-10x-x-109">k </span><span 
class="cmr-10x-x-109">= 12</span>, the time dimention  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12189"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12185"><span 
class="aett-10x-x-109">k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12186"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12187"><span 
class="aett-10x-x-109">12</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 63--><p class="indent" >   and consider the location points from the <span 
class="aett-10x-x-109">PRprec </span>data in a random order  
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12208"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12191"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor12192"><span 
class="aett-10x-x-109">(PRprec)</span></span>
<br /><span id="textcolor12193"><span 
class="aett-10x-x-109">coords</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12194"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12195"><span 
class="aett-10x-x-109">as.matrix</span></span><span id="textcolor12196"><span 
class="aett-10x-x-109">(PRprec[</span></span><span id="textcolor12197"><span 
class="aett-10x-x-109">sample</span></span><span id="textcolor12198"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12199"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12200"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor12201"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor12202"><span 
class="aett-10x-x-109">(PRprec)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12203"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12204"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor12205"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor12206"><span 
class="aett-10x-x-109">])</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 74--><p class="indent" >   In the following simulation step we will use the <span 
class="aett-10x-x-109">rspde() </span>function available in the file at
<a 
href="http://www.math.ntnu.no/inla/r-inla.org/tutorials/spde/R/spde-tutorial-functions.R" class="url" ><span 
class="aett-10x-x-109">http://www.math.ntnu.no/inla/r-_inla.org/tutorials/spde/R/spde-_tutorial-_functions.R</span></a>.
</p><!--l. 78--><p class="indent" >   The <span 
class="cmmi-10x-x-109">k </span>independent realizations can be done by  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12249"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12210"><span 
class="aett-10x-x-109">params</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12211"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12212"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor12213"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12214"><span 
class="aett-10x-x-109">variance</span></span><span id="textcolor12215"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12216"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12217"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12218"><span 
class="aett-10x-x-109">kappa</span></span><span id="textcolor12219"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12220"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12221"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor12222"><span 
class="aett-10x-x-109">set.seed</span></span><span id="textcolor12223"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12224"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12225"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor12226"><span 
class="aett-10x-x-109">x.k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12227"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12228"><span 
class="aett-10x-x-109">rspde</span></span><span id="textcolor12229"><span 
class="aett-10x-x-109">(coords,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12230"><span 
class="aett-10x-x-109">kappa</span></span><span id="textcolor12231"><span 
class="aett-10x-x-109">=params[</span></span><span id="textcolor12232"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor12233"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12234"><span 
class="aett-10x-x-109">variance</span></span><span id="textcolor12235"><span 
class="aett-10x-x-109">=params[</span></span><span id="textcolor12236"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12237"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12238"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor12239"><span 
class="aett-10x-x-109">=k,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12240"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor12241"><span 
class="aett-10x-x-109">=prmesh1,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12242"><span 
class="aett-10x-x-109">return.attributes</span></span><span id="textcolor12243"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12244"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor12245"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor12246"><span 
class="aett-10x-x-109">dim</span></span><span id="textcolor12247"><span 
class="aett-10x-x-109">(x.k)</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-118">
##&#x00A0;[1]&#x00A0;616&#x00A0;&#x00A0;12
</div>
<!--l. 90--><p class="nopar" >                                                                          </span></div>-
<!--l. 94--><p class="indent" >   Now, we define the autoregressive parameter <span 
class="cmmi-10x-x-109">&#x03C1;  </span>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12255"></p>    
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12251"><span 
class="aett-10x-x-109">rho</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12252"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12253"><span 
class="aett-10x-x-109">0.7</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 102--><p class="indent" >   and get the correlated sample over time using  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12286"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12257"><span 
class="aett-10x-x-109">x</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12258"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12259"><span 
class="aett-10x-x-109">x.k</span></span>
<br /><span id="textcolor12260"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12261"><span 
class="aett-10x-x-109">(j</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12262"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12263"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor12264"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor12265"><span 
class="aett-10x-x-109">k)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12266"><span 
class="aett-10x-x-109">x[,j]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12267"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12268"><span 
class="aett-10x-x-109">rho</span></span><span id="textcolor12269"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor12270"><span 
class="aett-10x-x-109">x[,j</span></span><span id="textcolor12271"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor12272"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12273"><span 
class="aett-10x-x-109">]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12274"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12275"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor12276"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12277"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12278"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor12279"><span 
class="aett-10x-x-109">rho</span></span><span id="textcolor12280"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor12281"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor12282"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor12283"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor12284"><span 
class="aett-10x-x-109">x.k[,j]</span></span>
</div>
</div>                                                                          </span></div>-
                                                                                 
                                                                                 
<!--l. 112--><p class="indent" >   where the <img 
src="spde-tutorial86x.png" alt="&#x2218; ("  class="sqrt"  /><span 
class="cmr-10x-x-109">1 </span><span 
class="cmsy-10x-x-109">- </span><span 
class="cmmi-10x-x-109">&#x03C1;</span><sup><span 
class="cmr-8">2</span></sup><span 
class="cmr-10x-x-109">) </span>term is added as we would like to consider that the innovation noise
follows the stationary distribution, see <span class="cite">[<a 
href="spde-tutorialli2.html#XRueHeld:2005">Rue and Held, 2005</a>]</span> and <span class="cite">[<a 
href="spde-tutorialli2.html#Xcameletti:2012">Cameletti et&#x00A0;al.,
2012</a>]</span>.
</p><!--l. 117--><p class="indent" >   We can visualize the realization at the figure&#x00A0;<a 
href="#x9-860005.1.1">5.1.1<!--tex4ht:ref: fig:timevisual --></a> with commands bellow  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12356"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12288"><span 
class="aett-10x-x-109">c100</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12289"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12290"><span 
class="aett-10x-x-109">rainbow</span></span><span id="textcolor12291"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12292"><span 
class="aett-10x-x-109">101</span></span><span id="textcolor12293"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor12294"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor12295"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12296"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor12297"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12298"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor12299"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12300"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor12301"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor12302"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor12303"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12304"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor12305"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12306"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor12307"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12308"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor12309"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor12310"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor12311"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor12312"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor12313"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor12314"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor12315"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor12316"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12317"><span 
class="aett-10x-x-109">(j</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12318"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12319"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12320"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor12321"><span 
class="aett-10x-x-109">k)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12322"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor12323"><span 
class="aett-10x-x-109">(coords,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12324"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor12325"><span 
class="aett-10x-x-109">=c100[</span></span><span id="textcolor12326"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor12327"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12328"><span 
class="aett-10x-x-109">100</span></span><span id="textcolor12329"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor12330"><span 
class="aett-10x-x-109">(x[,j]</span></span><span id="textcolor12331"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor12332"><span 
class="aett-10x-x-109">min</span></span><span id="textcolor12333"><span 
class="aett-10x-x-109">(x[,j]))</span></span><span id="textcolor12334"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor12335"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor12336"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12337"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor12338"><span 
class="aett-10x-x-109">(x[,j])))],</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12339"><span 
class="aett-10x-x-109">axes</span></span><span id="textcolor12340"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12341"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor12342"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12343"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor12344"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12345"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12346"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12347"><span 
class="aett-10x-x-109">pch</span></span><span id="textcolor12348"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12349"><span 
class="aett-10x-x-109">19</span></span><span id="textcolor12350"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12351"><span 
class="aett-10x-x-109">cex</span></span><span id="textcolor12352"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12353"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor12354"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>                                                                          </span></div>-
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x9-860011"></a>
                                                                                 
                                                                                 
<!--l. 135--><p class="noindent" ><img 
src="spde-tutorial87x.png" alt="PIC" class="graphics" width="426.79497pt" height="398.35286pt"  /><!--tex4ht:graphics  
name="spde-tutorial87x.png" src="figs/spacetimeftimevisual-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;5.1: </span><span  
class="content">Realization of the space-time random field.</span></div><!--tex4ht:label?: x9-860011 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 141--><p class="indent" >   In this example we need to show the use of a categorical covariate. First we do the simulation
of the covariate as  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12384"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12358"><span 
class="aett-10x-x-109">n</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12359"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12360"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor12361"><span 
class="aett-10x-x-109">(coords)</span></span>
<br /><span id="textcolor12362"><span 
class="aett-10x-x-109">set.seed</span></span><span id="textcolor12363"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12364"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor12365"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor12366"><span 
class="aett-10x-x-109">table</span></span><span id="textcolor12367"><span 
class="aett-10x-x-109">(ccov</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12368"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12369"><span 
class="aett-10x-x-109">factor</span></span><span id="textcolor12370"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12371"><span 
class="aett-10x-x-109">sample</span></span><span id="textcolor12372"><span 
class="aett-10x-x-109">(LETTERS[</span></span><span id="textcolor12373"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12374"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor12375"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor12376"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;n</span></span><span id="textcolor12377"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor12378"><span 
class="aett-10x-x-109">k,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12379"><span 
class="aett-10x-x-109">replace</span></span><span id="textcolor12380"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12381"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor12382"><span 
class="aett-10x-x-109">))</span><span 
class="aett-10x-x-109">&#x00A0;)</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-119">
##
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;A&#x00A0;&#x00A0;&#x00A0;&#x00A0;B&#x00A0;&#x00A0;&#x00A0;&#x00A0;C
&#x00A0;<br />##&#x00A0;2458&#x00A0;2438&#x00A0;2496
</div>
<!--l. 155--><p class="nopar" >                                                                          </span></div>-
<!--l. 158--><p class="indent" >   and the regression parameters as  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12393"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12386"><span 
class="aett-10x-x-109">beta</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12387"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12388"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor12389"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12390"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor12391"><span 
class="aett-10x-x-109">1</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 167--><p class="indent" >   The response is  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12415"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12395"><span 
class="aett-10x-x-109">sd.y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12396"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12397"><span 
class="aett-10x-x-109">0.1</span></span>
<br /><span id="textcolor12398"><span 
class="aett-10x-x-109">y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12399"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12400"><span 
class="aett-10x-x-109">beta[</span></span><span id="textcolor12401"><span 
class="aett-10x-x-109">unclass</span></span><span id="textcolor12402"><span 
class="aett-10x-x-109">(ccov)]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12403"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12404"><span 
class="aett-10x-x-109">x</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12405"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12406"><span 
class="aett-10x-x-109">rnorm</span></span><span id="textcolor12407"><span 
class="aett-10x-x-109">(n</span></span><span id="textcolor12408"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor12409"><span 
class="aett-10x-x-109">k,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12410"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor12411"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;sd.y)</span></span>
<br /><span id="textcolor12412"><span 
class="aett-10x-x-109">tapply</span></span><span id="textcolor12413"><span 
class="aett-10x-x-109">(y,</span><span 
class="aett-10x-x-109">&#x00A0;ccov,</span><span 
class="aett-10x-x-109">&#x00A0;mean)</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-120">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;A&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;B&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;C
&#x00A0;<br />##&#x00A0;-0.88285886&#x00A0;&#x00A0;0.08870521&#x00A0;&#x00A0;1.11408627
</div>
<!--l. 178--><p class="nopar" >                                                                          </span></div>-
<!--l. 182--><p class="indent" >   To show that is allowed to have different locations on different times, we drop some of the
observations. We do it by just selecting a half of the simulated data. We do it by creating a
index for the selected observations  
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12432"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12417"><span 
class="aett-10x-x-109">isel</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12418"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12419"><span 
class="aett-10x-x-109">sample</span></span><span id="textcolor12420"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12421"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12422"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor12423"><span 
class="aett-10x-x-109">(n</span></span><span id="textcolor12424"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor12425"><span 
class="aett-10x-x-109">k),</span><span 
class="aett-10x-x-109">&#x00A0;n</span></span><span id="textcolor12426"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor12427"><span 
class="aett-10x-x-109">k</span></span><span id="textcolor12428"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor12429"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor12430"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 195--><p class="indent" >   and we organize the data on a <span 
class="aett-10x-x-109">data.frame </span>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12466"></p>   
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12434"><span 
class="aett-10x-x-109">dat</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12435"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12436"><span 
class="aett-10x-x-109">data.frame</span></span><span id="textcolor12437"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12438"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor12439"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12440"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor12441"><span 
class="aett-10x-x-109">(y),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12442"><span 
class="aett-10x-x-109">w</span></span><span id="textcolor12443"><span 
class="aett-10x-x-109">=ccov,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12444"><span 
class="aett-10x-x-109">time</span></span><span id="textcolor12445"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12446"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor12447"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12448"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12449"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor12450"><span 
class="aett-10x-x-109">k,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12451"><span 
class="aett-10x-x-109">each</span></span><span id="textcolor12452"><span 
class="aett-10x-x-109">=n),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12453"><span 
class="aett-10x-x-109">xcoo</span></span><span id="textcolor12454"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12455"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor12456"><span 
class="aett-10x-x-109">(coords[,</span></span><span id="textcolor12457"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12458"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;k),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12459"><span 
class="aett-10x-x-109">ycoo</span></span><span id="textcolor12460"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12461"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor12462"><span 
class="aett-10x-x-109">(coords[,</span></span><span id="textcolor12463"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor12464"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;k))[isel,</span><span 
class="aett-10x-x-109">&#x00A0;]</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 207--><p class="indent" >   In real applications some times we have completely missaligned locations between different
times. The code provided here to fit the model still work on this situation.
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.1.2   </span> <a 
 id="x9-870005.1.2"></a>Data stack preparation</h4>
<!--l. 214--><p class="noindent" >Defining the SPDE model considering the PC-prior derived in <span class="cite">[<a 
href="spde-tutorialli2.html#Xfuglstadetal:2017">Fuglstad et&#x00A0;al., 2017</a>]</span> for the
model parameters as the practical range, <img 
src="spde-tutorial88x.png" alt="&#x221A; ---
  8&#x03BD;"  class="sqrt"  /><span 
class="cmmi-10x-x-109">&#x2215;&#x03BA;</span>, and the marginal standard deviation.
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12498"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12468"><span 
class="aett-10x-x-109">spde</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12469"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12470"><span 
class="aett-10x-x-109">inla.spde2.pcmatern</span></span><span id="textcolor12471"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12472"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor12473"><span 
class="aett-10x-x-109">=prmesh1,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12474"><span 
class="aett-10x-x-109">alpha</span></span><span id="textcolor12475"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12476"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor12477"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12478"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;mesh</span><span 
class="aeitt-10x-x-109">&#x00A0;and</span><span 
class="aeitt-10x-x-109">&#x00A0;smoothness</span><span 
class="aeitt-10x-x-109">&#x00A0;parameter</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12479"><span 
class="aett-10x-x-109">prior.range</span></span><span id="textcolor12480"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12481"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor12482"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12483"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor12484"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12485"><span 
class="aett-10x-x-109">0.01</span></span><span id="textcolor12486"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12487"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;P(practic.range&#x003C;0.05)=0.01</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12488"><span 
class="aett-10x-x-109">prior.sigma</span></span><span id="textcolor12489"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12490"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor12491"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12492"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12493"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12494"><span 
class="aett-10x-x-109">0.01</span></span><span id="textcolor12495"><span 
class="aett-10x-x-109">))</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12496"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;P(sigma&#x003E;1)=0.01</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 229--><p class="indent" >   Now, we need the data preparation to build the space-time model. The index set is made
taking into account the number of weights on the SPDE model and the number of groups
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12513"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12500"><span 
class="aett-10x-x-109">iset</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12501"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12502"><span 
class="aett-10x-x-109">inla.spde.make.index</span></span><span id="textcolor12503"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12504"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">i</span><span 
class="tctt-1095">'</span></span><span id="textcolor12505"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12506"><span 
class="aett-10x-x-109">n.spde</span></span><span id="textcolor12507"><span 
class="aett-10x-x-109">=spde</span></span><span id="textcolor12508"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12509"><span 
class="aett-10x-x-109">n.spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12510"><span 
class="aett-10x-x-109">n.group</span></span><span id="textcolor12511"><span 
class="aett-10x-x-109">=k)</span></span>
</div>
</div>                                                                          </span></div>-
                                                                                 
                                                                                 
<!--l. 241--><p class="indent" >   Notice that the index set for the latent field is not depending on the data set locations. It
only depends on the SPDE model size and on the time dimention.
</p><!--l. 246--><p class="indent" >   The projector matrix must be defined considering the coordinates of the observed data. We
have to inform the time index for the group to build the projector matrix. This also must be
defined on the <span 
class="aett-10x-x-109">inla.spde.make.A() </span>function  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12534"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12515"><span 
class="aett-10x-x-109">A</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12516"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12517"><span 
class="aett-10x-x-109">inla.spde.make.A</span></span><span id="textcolor12518"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12519"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor12520"><span 
class="aett-10x-x-109">=prmesh1,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12521"><span 
class="aett-10x-x-109">loc</span></span><span id="textcolor12522"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12523"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor12524"><span 
class="aett-10x-x-109">(dat</span></span><span id="textcolor12525"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12526"><span 
class="aett-10x-x-109">xcoo,</span><span 
class="aett-10x-x-109">&#x00A0;dat</span></span><span id="textcolor12527"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12528"><span 
class="aett-10x-x-109">ycoo),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12529"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor12530"><span 
class="aett-10x-x-109">=dat</span></span><span id="textcolor12531"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12532"><span 
class="aett-10x-x-109">time)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 262--><p class="indent" >   The effects on the stack are a list with two elements, one is the index set and another the
categorical covariate. The stack data is defined as  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12567"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12536"><span 
class="aett-10x-x-109">sdat</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12537"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12538"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor12539"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12540"><span 
class="aett-10x-x-109">tag</span></span><span id="textcolor12541"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12542"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">stdata</span><span 
class="tctt-1095">'</span></span><span id="textcolor12543"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12544"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor12545"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12546"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor12547"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12548"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor12549"><span 
class="aett-10x-x-109">=dat</span></span><span id="textcolor12550"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12551"><span 
class="aett-10x-x-109">y),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12552"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor12553"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12554"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor12555"><span 
class="aett-10x-x-109">(A,</span></span><span id="textcolor12556"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12557"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12558"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor12559"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12560"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor12561"><span 
class="aett-10x-x-109">(iset,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12562"><span 
class="aett-10x-x-109">w</span></span><span id="textcolor12563"><span 
class="aett-10x-x-109">=dat</span></span><span id="textcolor12564"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12565"><span 
class="aett-10x-x-109">w))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 274--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.1.3   </span> <a 
 id="x9-880005.1.3"></a>Fitting the model and some results</h4>
<!--l. 276--><p class="noindent" >We set the PC-prior for the temporal autoregressive parameter with <span 
class="cmmi-10x-x-109">P</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">cor &#x003E; </span><span 
class="cmr-10x-x-109">0) = 0</span><span 
class="cmmi-10x-x-109">.</span><span 
class="cmr-10x-x-109">9</span>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12590"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12569"><span 
class="aett-10x-x-109">h.spec</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12570"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12571"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor12572"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12573"><span 
class="aett-10x-x-109">theta</span></span><span id="textcolor12574"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12575"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor12576"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12577"><span 
class="aett-10x-x-109">prior</span></span><span id="textcolor12578"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12579"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">pccor1</span><span 
class="tctt-1095">'</span></span><span id="textcolor12580"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12581"><span 
class="aett-10x-x-109">param</span></span><span id="textcolor12582"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12583"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor12584"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12585"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor12586"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12587"><span 
class="aett-10x-x-109">0.9</span></span><span id="textcolor12588"><span 
class="aett-10x-x-109">)))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 286--><p class="indent" >   The likelihood hyperparameter is fixed on a hight precision, just because we haven&#8217;t noise.
To deal with the categorical covariate we need to set <span 
class="aett-10x-x-109">expand.factor.strategy=</span><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">inla</span><span 
class="tctt-1095">' </span>on the
<span 
class="aett-10x-x-109">control.fixed </span>argument list.
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12672"></p>     
<div class="alltt">
                                                                                                                     </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12674"><div class="obeylines-v">
<span id="textcolor12592"><span 
class="aett-10x-x-109">formulae</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12593"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12594"><span 
class="aett-10x-x-109">y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12595"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12596"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12597"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12598"><span 
class="aett-10x-x-109">w</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12599"><span 
class="aett-10x-x-109">+</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12600"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor12601"><span 
class="aett-10x-x-109">(i,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12602"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor12603"><span 
class="aett-10x-x-109">=spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12604"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor12605"><span 
class="aett-10x-x-109">=i.group,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12606"><span 
class="aett-10x-x-109">control.group</span></span><span id="textcolor12607"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12608"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor12609"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12610"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor12611"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12612"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">ar1</span><span 
class="tctt-1095">'</span></span><span id="textcolor12613"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12614"><span 
class="aett-10x-x-109">hyper</span></span><span id="textcolor12615"><span 
class="aett-10x-x-109">=h.spec))</span></span>
<br /><span id="textcolor12616"><span 
class="aett-10x-x-109">prec.prior</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12617"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12618"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor12619"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12620"><span 
class="aett-10x-x-109">prior</span></span><span id="textcolor12621"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12622"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">pc.prec</span><span 
class="tctt-1095">'</span></span><span id="textcolor12623"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12624"><span 
class="aett-10x-x-109">param</span></span><span id="textcolor12625"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12626"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor12627"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12628"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12629"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12630"><span 
class="aett-10x-x-109">0.01</span></span><span id="textcolor12631"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor12632"><span 
class="aett-10x-x-109">res</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12633"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12634"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor12635"><span 
class="aett-10x-x-109">(formulae,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12636"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor12637"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12638"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor12639"><span 
class="aett-10x-x-109">(sdat),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12640"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor12641"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12642"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor12643"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12644"><span 
class="aett-10x-x-109">compute</span></span><span id="textcolor12645"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12646"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor12647"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12648"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor12649"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12650"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor12651"><span 
class="aett-10x-x-109">(sdat)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12652"><span 
class="aett-10x-x-109">control.family</span></span><span id="textcolor12653"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12654"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor12655"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12656"><span 
class="aett-10x-x-109">hyper</span></span><span id="textcolor12657"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12658"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor12659"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12660"><span 
class="aett-10x-x-109">theta</span></span><span id="textcolor12661"><span 
class="aett-10x-x-109">=prec.prior)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12662"><span 
class="aett-10x-x-109">control.fixed</span></span><span id="textcolor12663"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12664"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor12665"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12666"><span 
class="aett-10x-x-109">expand.factor.strategy</span></span><span id="textcolor12667"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12668"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">inla</span><span 
class="tctt-1095">'</span></span><span id="textcolor12669"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 307--><p class="indent" >   Summary for the trhee intercepts (and the observed mean for each covariate level)
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12693"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12676"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor12677"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12678"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor12679"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12680"><span 
class="aett-10x-x-109">observed</span></span><span id="textcolor12681"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12682"><span 
class="aett-10x-x-109">tapply</span></span><span id="textcolor12683"><span 
class="aett-10x-x-109">(dat</span></span><span id="textcolor12684"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12685"><span 
class="aett-10x-x-109">y,</span><span 
class="aett-10x-x-109">&#x00A0;dat</span></span><span id="textcolor12686"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12687"><span 
class="aett-10x-x-109">w,</span><span 
class="aett-10x-x-109">&#x00A0;mean),</span><span 
class="aett-10x-x-109">&#x00A0;res</span></span><span id="textcolor12688"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12689"><span 
class="aett-10x-x-109">summary.fixed),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12690"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor12691"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-121">
##&#x00A0;&#x00A0;&#x00A0;observed&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant&#x00A0;0.5quant&#x00A0;0.975quant&#x00A0;&#x00A0;&#x00A0;&#x00A0;mode&#x00A0;kld
&#x00A0;<br />##&#x00A0;A&#x00A0;&#x00A0;-0.9242&#x00A0;-0.7795&#x00A0;0.3467&#x00A0;&#x00A0;&#x00A0;&#x00A0;-1.4635&#x00A0;&#x00A0;-0.7799&#x00A0;&#x00A0;&#x00A0;&#x00A0;-0.0945&#x00A0;-0.7806&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />##&#x00A0;B&#x00A0;&#x00A0;&#x00A0;0.0245&#x00A0;&#x00A0;0.2182&#x00A0;0.3467&#x00A0;&#x00A0;&#x00A0;&#x00A0;-0.4658&#x00A0;&#x00A0;&#x00A0;0.2178&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.9032&#x00A0;&#x00A0;0.2170&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />##&#x00A0;C&#x00A0;&#x00A0;&#x00A0;1.1124&#x00A0;&#x00A0;1.2246&#x00A0;0.3467&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.5406&#x00A0;&#x00A0;&#x00A0;1.2242&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.9096&#x00A0;&#x00A0;1.2235&#x00A0;&#x00A0;&#x00A0;0
</div>
<!--l. 319--><p class="nopar" >                                                                          </span></div>-
<!--l. 323--><p class="indent" >   Look a the posterior marginal distributions for the random field parameters and the marginal
ditribution for the temporal correlation, on the Figure&#x00A0;<a 
href="#x9-880005.1.3">5.1.3<!--tex4ht:ref: fig:rfst --></a> with the commands bellow
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12780"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12695"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor12696"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12697"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor12698"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12699"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor12700"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12701"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor12702"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor12703"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor12704"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12705"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor12706"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12707"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor12708"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12709"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor12710"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor12711"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor12712"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor12713"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12714"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor12715"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor12716"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12717"><span 
class="aett-10x-x-109">mgp</span></span><span id="textcolor12718"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12719"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor12720"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor12721"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor12722"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor12723"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12724"><span 
class="aett-10x-x-109">(j</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12725"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12726"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12727"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor12728"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor12729"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12730"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor12731"><span 
class="aett-10x-x-109">(res</span></span><span id="textcolor12732"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12733"><span 
class="aett-10x-x-109">marginals.hyper[[j]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12734"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor12735"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12736"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor12737"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12738"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor12739"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12740"><span 
class="aett-10x-x-109">names</span></span><span id="textcolor12741"><span 
class="aett-10x-x-109">(res</span></span><span id="textcolor12742"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12743"><span 
class="aett-10x-x-109">marginals.hyper)[j],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12744"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor12745"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12746"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Density</span><span 
class="tctt-1095">'</span></span><span id="textcolor12747"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12748"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor12749"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12750"><span 
class="aett-10x-x-109">v</span></span><span id="textcolor12751"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12752"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor12753"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12754"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12755"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor12756"><span 
class="aett-10x-x-109">sd.y</span></span><span id="textcolor12757"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor12758"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor12759"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12760"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor12761"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12762"><span 
class="aett-10x-x-109">8</span></span><span id="textcolor12763"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor12764"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor12765"><span 
class="aett-10x-x-109">params[</span></span><span id="textcolor12766"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12767"><span 
class="aett-10x-x-109">],</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12768"><span 
class="aett-10x-x-109">params[</span></span><span id="textcolor12769"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor12770"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor12771"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor12772"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor12773"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;rho)[j],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12774"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor12775"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12776"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor12777"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor12778"><span 
class="aett-10x-x-109">}</span></span>
</div>
</div>                                                                          </span></div>-
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x9-880012"></a>
                                                                                 
                                                                                 
<!--l. 344--><p class="noindent" ><img 
src="spde-tutorial89x.png" alt="PIC" class="graphics" width="397.48499pt" height="397.4971pt"  /><!--tex4ht:graphics  
name="spde-tutorial89x.png" src="figs/spacetimeunnamed-chunk-2-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;5.2:  </span><span  
class="content">Marginal  posterior  distribution  for  the  practical  range  (left),  standard
deviation of the field (mid) and the temporal corrlation (right). The red vertical lines are
placed at true value.</span></div><!--tex4ht:label?: x9-880012 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">5.1.4   </span> <a 
 id="x9-890005.1.4"></a>A look at the posterior random field</h4>
<!--l. 357--><p class="noindent" >The first look at the random field posterior distribution is to compare the realized random field
with the posterior mean, median or/and mode and any quantile.
</p><!--l. 362--><p class="indent" >   First, we found the index for the random field at data locations  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12792"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12782"><span 
class="aett-10x-x-109">str</span></span><span id="textcolor12783"><span 
class="aett-10x-x-109">(idat</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12784"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12785"><span 
class="aett-10x-x-109">inla.stack.index</span></span><span id="textcolor12786"><span 
class="aett-10x-x-109">(sdat,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12787"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">stdata</span><span 
class="tctt-1095">'</span></span><span id="textcolor12788"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor12789"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12790"><span 
class="aett-10x-x-109">data)</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-122">
##&#x00A0;&#x00A0;int&#x00A0;[1:3696]&#x00A0;1&#x00A0;2&#x00A0;3&#x00A0;4&#x00A0;5&#x00A0;6&#x00A0;7&#x00A0;8&#x00A0;9&#x00A0;10&#x00A0;...
</div>
<!--l. 371--><p class="nopar" >                                                                          </span></div>-
<!--l. 375--><p class="indent" >   The correlation between the simulated data response and the posterior mean of the predicted
values (there is no error term in the model):  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12803"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12794"><span 
class="aett-10x-x-109">cor</span></span><span id="textcolor12795"><span 
class="aett-10x-x-109">(dat</span></span><span id="textcolor12796"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12797"><span 
class="aett-10x-x-109">y,</span><span 
class="aett-10x-x-109">&#x00A0;res</span></span><span id="textcolor12798"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12799"><span 
class="aett-10x-x-109">summary.linear.predictor</span></span><span id="textcolor12800"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12801"><span 
class="aett-10x-x-109">mean[idat])</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-123">
##&#x00A0;[1]&#x00A0;0.9982051
</div>
<!--l. 385--><p class="nopar" >                                                                          </span></div>-
<!--l. 389--><p class="indent" >   We also can do prediction for each time and visualize it. First, we define the projection grid
in the same way that in the rainfall example in Section&#x00A0;<a 
href="spde-tutorialch2.html#x6-350002.1">2.1<!--tex4ht:ref: sec:prprec --></a>.  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12851"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12805"><span 
class="aett-10x-x-109">stepsize</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12806"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12807"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor12808"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor12809"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12810"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor12811"><span 
class="aett-10x-x-109">111</span></span>
<br /><span id="textcolor12812"><span 
class="aett-10x-x-109">nxy</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12813"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12814"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor12815"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12816"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor12817"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12818"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor12819"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12820"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor12821"><span 
class="aett-10x-x-109">(coords[,</span></span><span id="textcolor12822"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12823"><span 
class="aett-10x-x-109">])),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12824"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor12825"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12826"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor12827"><span 
class="aett-10x-x-109">(coords[,</span></span><span id="textcolor12828"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor12829"><span 
class="aett-10x-x-109">])))</span></span><span id="textcolor12830"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor12831"><span 
class="aett-10x-x-109">stepsize)</span></span>
<br /><span id="textcolor12832"><span 
class="aett-10x-x-109">projgrid</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12833"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12834"><span 
class="aett-10x-x-109">inla.mesh.projector</span></span><span id="textcolor12835"><span 
class="aett-10x-x-109">(prmesh1,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12836"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor12837"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12838"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor12839"><span 
class="aett-10x-x-109">(coords[,</span></span><span id="textcolor12840"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12841"><span 
class="aett-10x-x-109">]),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12842"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor12843"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12844"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor12845"><span 
class="aett-10x-x-109">(coords[,</span></span><span id="textcolor12846"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor12847"><span 
class="aett-10x-x-109">]),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12848"><span 
class="aett-10x-x-109">dims</span></span><span id="textcolor12849"><span 
class="aett-10x-x-109">=nxy)</span></span>
</div>
</div>                                                                          </span></div>-
                                                                                 
                                                                                 
<!--l. 403--><p class="indent" >   The prediction for each time can be done by  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12879"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12853"><span 
class="aett-10x-x-109">xmean</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12854"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12855"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor12856"><span 
class="aett-10x-x-109">()</span></span>
<br /><span id="textcolor12857"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12858"><span 
class="aett-10x-x-109">(j</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12859"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12860"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12861"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor12862"><span 
class="aett-10x-x-109">k)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12863"><span 
class="aett-10x-x-109">xmean[[j]]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12864"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12865"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor12866"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12867"><span 
class="aett-10x-x-109">projgrid,</span><span 
class="aett-10x-x-109">&#x00A0;res</span></span><span id="textcolor12868"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12869"><span 
class="aett-10x-x-109">summary.random</span></span><span id="textcolor12870"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12871"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor12872"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12873"><span 
class="aett-10x-x-109">mean[iset</span></span><span id="textcolor12874"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12875"><span 
class="aett-10x-x-109">i.group</span></span><span id="textcolor12876"><span 
class="aett-10x-x-109">==</span></span><span id="textcolor12877"><span 
class="aett-10x-x-109">j])</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 415--><p class="indent" >   We found what points of the grid are inside the Paraná state border.  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12898"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12881"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor12882"><span 
class="aett-10x-x-109">(splancs)</span></span>
<br /><span id="textcolor12883"><span 
class="aett-10x-x-109">xy.in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12884"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12885"><span 
class="aett-10x-x-109">inout</span></span><span id="textcolor12886"><span 
class="aett-10x-x-109">(projgrid</span></span><span id="textcolor12887"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12888"><span 
class="aett-10x-x-109">lattice</span></span><span id="textcolor12889"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12890"><span 
class="aett-10x-x-109">loc,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12891"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor12892"><span 
class="aett-10x-x-109">(PRborder[,</span></span><span id="textcolor12893"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12894"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;PRborder[,</span></span><span id="textcolor12895"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor12896"><span 
class="aett-10x-x-109">]))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 425--><p class="indent" >   To plot, we set NA to the points of the grid out of the Paraná border.  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12911"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12900"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12901"><span 
class="aett-10x-x-109">(j</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12902"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12903"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12904"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor12905"><span 
class="aett-10x-x-109">k)</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;xmean[[j]][</span></span><span id="textcolor12906"><span 
class="aett-10x-x-109">!</span></span><span id="textcolor12907"><span 
class="aett-10x-x-109">xy.in]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12908"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12909"><span 
class="aett-10x-x-109">NA</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 434--><p class="indent" >   The visualization at Figure&#x00A0;<a 
href="#x9-890005.1.4">5.1.4<!--tex4ht:ref: fig:strf --></a> can be made by the comands bellow  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox12952"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12913"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor12914"><span 
class="aett-10x-x-109">(gridExtra)</span></span>
<br /><span id="textcolor12915"><span 
class="aett-10x-x-109">do.call</span></span><span id="textcolor12916"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12917"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor12918"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12919"><span 
class="aett-10x-x-109">...</span></span><span id="textcolor12920"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12921"><span 
class="aett-10x-x-109">grid.arrange</span></span><span id="textcolor12922"><span 
class="aett-10x-x-109">(...,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12923"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor12924"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12925"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor12926"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12927"><span 
class="aett-10x-x-109">lapply</span></span><span id="textcolor12928"><span 
class="aett-10x-x-109">(xmean,</span><span 
class="aett-10x-x-109">&#x00A0;levelplot,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12929"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor12930"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12931"><span 
class="tctt-1095">''</span></span><span id="textcolor12932"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12933"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor12934"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12935"><span 
class="tctt-1095">''</span></span><span id="textcolor12936"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12937"><span 
class="aett-10x-x-109">col.regions</span></span><span id="textcolor12938"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12939"><span 
class="aett-10x-x-109">topo.colors</span></span><span id="textcolor12940"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12941"><span 
class="aett-10x-x-109">16</span></span><span id="textcolor12942"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12943"><span 
class="aett-10x-x-109">scale</span></span><span id="textcolor12944"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12945"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor12946"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12947"><span 
class="aett-10x-x-109">draw</span></span><span id="textcolor12948"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12949"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor12950"><span 
class="aett-10x-x-109">)))</span></span>
</div>
</div>                                                                          </span></div>-
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x9-890013"></a>
                                                                                 
                                                                                 
<!--l. 450--><p class="noindent" ><img 
src="spde-tutorial90x.png" alt="PIC" class="graphics" width="426.79497pt" height="371.07745pt"  /><!--tex4ht:graphics  
name="spde-tutorial90x.png" src="figs/spacetimevstrf-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;5.3: </span><span  
class="content">Visualization of the posterior mean of the space-time random field.</span></div><!--tex4ht:label?: x9-890013 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">5.1.5   </span> <a 
 id="x9-900005.1.5"></a>Validation</h4>
<!--l. 459--><p class="noindent" >The results on previous section are done using part of the simulated data. This part of the
simulated data is now used as a validation data. So, we prepare another data stack to compute
posterior distributions to this part of the data:  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13035"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor12954"><span 
class="aett-10x-x-109">vdat</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12955"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12956"><span 
class="aett-10x-x-109">data.frame</span></span><span id="textcolor12957"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12958"><span 
class="aett-10x-x-109">r</span></span><span id="textcolor12959"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12960"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor12961"><span 
class="aett-10x-x-109">(y),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12962"><span 
class="aett-10x-x-109">w</span></span><span id="textcolor12963"><span 
class="aett-10x-x-109">=ccov,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12964"><span 
class="aett-10x-x-109">t</span></span><span id="textcolor12965"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12966"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor12967"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor12968"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12969"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor12970"><span 
class="aett-10x-x-109">k,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12971"><span 
class="aett-10x-x-109">each</span></span><span id="textcolor12972"><span 
class="aett-10x-x-109">=n),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12973"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor12974"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12975"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor12976"><span 
class="aett-10x-x-109">(coords[,</span></span><span id="textcolor12977"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor12978"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;k),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12979"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor12980"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12981"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor12982"><span 
class="aett-10x-x-109">(coords[,</span></span><span id="textcolor12983"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor12984"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;k))[</span></span><span id="textcolor12985"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor12986"><span 
class="aett-10x-x-109">isel,</span><span 
class="aett-10x-x-109">&#x00A0;]</span></span>
<br /><span id="textcolor12987"><span 
class="aett-10x-x-109">Aval</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12988"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12989"><span 
class="aett-10x-x-109">inla.spde.make.A</span></span><span id="textcolor12990"><span 
class="aett-10x-x-109">(prmesh1,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12991"><span 
class="aett-10x-x-109">loc</span></span><span id="textcolor12992"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor12993"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor12994"><span 
class="aett-10x-x-109">(vdat</span></span><span id="textcolor12995"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12996"><span 
class="aett-10x-x-109">x,</span><span 
class="aett-10x-x-109">&#x00A0;vdat</span></span><span id="textcolor12997"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor12998"><span 
class="aett-10x-x-109">y),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12999"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor13000"><span 
class="aett-10x-x-109">=vdat</span></span><span id="textcolor13001"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13002"><span 
class="aett-10x-x-109">t)</span></span>
<br /><span id="textcolor13003"><span 
class="aett-10x-x-109">stval</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13004"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13005"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor13006"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13007"><span 
class="aett-10x-x-109">tag</span></span><span id="textcolor13008"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13009"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">stval</span><span 
class="tctt-1095">'</span></span><span id="textcolor13010"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13011"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor13012"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13013"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13014"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13015"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor13016"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13017"><span 
class="aett-10x-x-109">NA</span></span><span id="textcolor13018"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13019"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;set</span><span 
class="aeitt-10x-x-109">&#x00A0;NA</span><span 
class="aeitt-10x-x-109">&#x00A0;in</span><span 
class="aeitt-10x-x-109">&#x00A0;order</span><span 
class="aeitt-10x-x-109">&#x00A0;to</span><span 
class="aeitt-10x-x-109">&#x00A0;predict</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13020"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor13021"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13022"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13023"><span 
class="aett-10x-x-109">(Aval,</span></span><span id="textcolor13024"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13025"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13026"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor13027"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13028"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13029"><span 
class="aett-10x-x-109">(iset,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13030"><span 
class="aett-10x-x-109">w</span></span><span id="textcolor13031"><span 
class="aett-10x-x-109">=vdat</span></span><span id="textcolor13032"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13033"><span 
class="aett-10x-x-109">w))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 474--><p class="indent" >   Now, we just use a full data stack to fit the model and consider the hyperparameters values
fitted before  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13094"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13037"><span 
class="aett-10x-x-109">stfull</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13038"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13039"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor13040"><span 
class="aett-10x-x-109">(sdat,</span><span 
class="aett-10x-x-109">&#x00A0;stval)</span></span>
<br /><span id="textcolor13041"><span 
class="aett-10x-x-109">vres</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13042"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13043"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor13044"><span 
class="aett-10x-x-109">(formulae,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13045"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor13046"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13047"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor13048"><span 
class="aett-10x-x-109">(stfull),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13049"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor13050"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13051"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13052"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13053"><span 
class="aett-10x-x-109">compute</span></span><span id="textcolor13054"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13055"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor13056"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13057"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor13058"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13059"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor13060"><span 
class="aett-10x-x-109">(stfull)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13061"><span 
class="aett-10x-x-109">control.family</span></span><span id="textcolor13062"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13063"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13064"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13065"><span 
class="aett-10x-x-109">hyper</span></span><span id="textcolor13066"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13067"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13068"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13069"><span 
class="aett-10x-x-109">theta</span></span><span id="textcolor13070"><span 
class="aett-10x-x-109">=prec.prior)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13071"><span 
class="aett-10x-x-109">control.fixed</span></span><span id="textcolor13072"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13073"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13074"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13075"><span 
class="aett-10x-x-109">expand.factor.strategy</span></span><span id="textcolor13076"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13077"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">inla</span><span 
class="tctt-1095">'</span></span><span id="textcolor13078"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13079"><span 
class="aett-10x-x-109">control.mode</span></span><span id="textcolor13080"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13081"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13082"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13083"><span 
class="aett-10x-x-109">theta</span></span><span id="textcolor13084"><span 
class="aett-10x-x-109">=res</span></span><span id="textcolor13085"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13086"><span 
class="aett-10x-x-109">mode</span></span><span id="textcolor13087"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13088"><span 
class="aett-10x-x-109">theta,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13089"><span 
class="aett-10x-x-109">restart</span></span><span id="textcolor13090"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13091"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor13092"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 489--><p class="indent" >   We can plot the predicted versus observed values to look at goodness of fit. First, we found
the index for this data from full stack data.  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13105"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13096"><span 
class="aett-10x-x-109">ival</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13097"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13098"><span 
class="aett-10x-x-109">inla.stack.index</span></span><span id="textcolor13099"><span 
class="aett-10x-x-109">(stfull,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13100"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">stval</span><span 
class="tctt-1095">'</span></span><span id="textcolor13101"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor13102"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13103"><span 
class="aett-10x-x-109">data</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 498--><p class="indent" >   We plot it with following commands and visualize at Figure&#x00A0;<a 
href="#x9-900005.1.5">5.1.5<!--tex4ht:ref: fig:stval --></a>.  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13173"></p>     
<div class="alltt">
                                                                                                                     </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13175"><div class="obeylines-v">
<span id="textcolor13107"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor13108"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13109"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor13110"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13111"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor13112"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13113"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13114"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor13115"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13116"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13117"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor13118"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13119"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor13120"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13121"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor13122"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor13123"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor13124"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor13125"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor13126"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor13127"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor13128"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13129"><span 
class="aett-10x-x-109">mgp</span></span><span id="textcolor13130"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13131"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor13132"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13133"><span 
class="aett-10x-x-109">1.75</span></span><span id="textcolor13134"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor13135"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor13136"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor13137"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor13138"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor13139"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor13140"><span 
class="aett-10x-x-109">(vres</span></span><span id="textcolor13141"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13142"><span 
class="aett-10x-x-109">summary.fitted.values</span></span><span id="textcolor13143"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13144"><span 
class="aett-10x-x-109">mean[ival],</span><span 
class="aett-10x-x-109">&#x00A0;vdat</span></span><span id="textcolor13145"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13146"><span 
class="aett-10x-x-109">r,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13147"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor13148"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13149"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13150"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13151"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor13152"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13153"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Posterior</span><span 
class="aett-10x-x-109">&#x00A0;mean</span><span 
class="tctt-1095">'</span></span><span id="textcolor13154"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13155"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor13156"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13157"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Observed</span><span 
class="tctt-1095">'</span></span><span id="textcolor13158"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor13159"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor13160"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13161"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor13162"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor13163"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13164"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13165"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor13166"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13167"><span 
class="aett-10x-x-109">gray</span></span><span id="textcolor13168"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13169"><span 
class="aett-10x-x-109">.7</span></span><span id="textcolor13170"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>                                                                          </span></div>-
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x9-900014"></a>
                                                                                 
                                                                                 
<!--l. 513--><p class="noindent" ><img 
src="spde-tutorial91x.png" alt="PIC" class="graphics" width="397.48499pt" height="361.36101pt"  /><!--tex4ht:graphics  
name="spde-tutorial91x.png" src="figs/spacetimevstval-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;5.4: </span><span  
class="content">Validation: Observed versus posterior mean.</span></div><!--tex4ht:label?: x9-900014 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
   <h3 class="sectionHead"><span class="titlemark">5.2   </span> <a 
 id="x9-910005.2"></a>Continuous time domain</h3>
<!--l. 521--><p class="noindent" >We now suppose that we have that the observations are not collected over discrete time points.
This is the case for fishing data and space-time point process in general. Similar to the Finite
Method approach for the space, we can use piecewise linear basis function at a set of time knots,
as we have in some other spacetime examples.
</p><!--l. 527--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.2.1   </span> <a 
 id="x9-920005.2.1"></a>Data simulation</h4>
<!--l. 529--><p class="noindent" >We now sample some locations over space and time points as well.  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13201"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13177"><span 
class="aett-10x-x-109">n</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13178"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13179"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor13180"><span 
class="aett-10x-x-109">(loc</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13181"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13182"><span 
class="aett-10x-x-109">unique</span></span><span id="textcolor13183"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13184"><span 
class="aett-10x-x-109">as.matrix</span></span><span id="textcolor13185"><span 
class="aett-10x-x-109">(PRprec[,</span></span><span id="textcolor13186"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13187"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor13188"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor13189"><span 
class="aett-10x-x-109">])))</span></span>
<br /><span id="textcolor13190"><span 
class="aett-10x-x-109">time</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13191"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13192"><span 
class="aett-10x-x-109">sort</span></span><span id="textcolor13193"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13194"><span 
class="aett-10x-x-109">runif</span></span><span id="textcolor13195"><span 
class="aett-10x-x-109">(n,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13196"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor13197"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13198"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13199"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 539--><p class="indent" >   To sample from the model, we define a space-time separable covariance function, which is
Matérn in space and Exponential over time:  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13279"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13203"><span 
class="aett-10x-x-109">stcov</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13204"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13205"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor13206"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13207"><span 
class="aett-10x-x-109">coords</span></span><span id="textcolor13208"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13209"><span 
class="aett-10x-x-109">time</span></span><span id="textcolor13210"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13211"><span 
class="aett-10x-x-109">kappa.s</span></span><span id="textcolor13212"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13213"><span 
class="aett-10x-x-109">kappa.t</span></span><span id="textcolor13214"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13215"><span 
class="aett-10x-x-109">variance</span></span><span id="textcolor13216"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13217"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13218"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13219"><span 
class="aett-10x-x-109">nu</span></span><span id="textcolor13220"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13221"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13222"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13223"><span 
class="aett-10x-x-109">s</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13224"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13225"><span 
class="aett-10x-x-109">as.matrix</span></span><span id="textcolor13226"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13227"><span 
class="aett-10x-x-109">dist</span></span><span id="textcolor13228"><span 
class="aett-10x-x-109">(coords))</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13229"><span 
class="aett-10x-x-109">t</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13230"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13231"><span 
class="aett-10x-x-109">as.matrix</span></span><span id="textcolor13232"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13233"><span 
class="aett-10x-x-109">dist</span></span><span id="textcolor13234"><span 
class="aett-10x-x-109">(time))</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13235"><span 
class="aett-10x-x-109">scorr</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13236"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13237"><span 
class="aett-10x-x-109">exp</span></span><span id="textcolor13238"><span 
class="aett-10x-x-109">((</span></span><span id="textcolor13239"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13240"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor13241"><span 
class="aett-10x-x-109">nu)</span></span><span id="textcolor13242"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor13243"><span 
class="aett-10x-x-109">log</span></span><span id="textcolor13244"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13245"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor13246"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13247"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13248"><span 
class="aett-10x-x-109">nu</span></span><span id="textcolor13249"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor13250"><span 
class="aett-10x-x-109">log</span></span><span id="textcolor13251"><span 
class="aett-10x-x-109">(s</span></span><span id="textcolor13252"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor13253"><span 
class="aett-10x-x-109">kappa.s)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13254"><span 
class="aett-10x-x-109">-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13255"><span 
class="aett-10x-x-109">lgamma</span></span><span id="textcolor13256"><span 
class="aett-10x-x-109">(nu))</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13257"><span 
class="aett-10x-x-109">*</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13258"><span 
class="aett-10x-x-109">besselK</span></span><span id="textcolor13259"><span 
class="aett-10x-x-109">(s</span></span><span id="textcolor13260"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor13261"><span 
class="aett-10x-x-109">kappa.s,</span><span 
class="aett-10x-x-109">&#x00A0;nu)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13262"><span 
class="aett-10x-x-109">diag</span></span><span id="textcolor13263"><span 
class="aett-10x-x-109">(scorr)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13264"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13265"><span 
class="aett-10x-x-109">1</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13266"><span 
class="aett-10x-x-109">return</span></span><span id="textcolor13267"><span 
class="aett-10x-x-109">(variance</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13268"><span 
class="aett-10x-x-109">*</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13269"><span 
class="aett-10x-x-109">scorr</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13270"><span 
class="aett-10x-x-109">*</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13271"><span 
class="aett-10x-x-109">exp</span></span><span id="textcolor13272"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13273"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor13274"><span 
class="aett-10x-x-109">t</span></span><span id="textcolor13275"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor13276"><span 
class="aett-10x-x-109">kappa.t))</span></span>
<br /><span id="textcolor13277"><span 
class="aett-10x-x-109">}</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 555--><p class="indent" >   and use it to sample from the model  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13326"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13281"><span 
class="aett-10x-x-109">kappa.s</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13282"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13283"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13284"><span 
class="aett-10x-x-109">;</span><span 
class="aett-10x-x-109">&#x00A0;kappa.t</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13285"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13286"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor13287"><span 
class="aett-10x-x-109">;</span><span 
class="aett-10x-x-109">&#x00A0;s2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13288"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13289"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13290"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor13291"><span 
class="aett-10x-x-109">2</span></span>
<br /><span id="textcolor13292"><span 
class="aett-10x-x-109">xx</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13293"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13294"><span 
class="aett-10x-x-109">crossprod</span></span><span id="textcolor13295"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13296"><span 
class="aett-10x-x-109">chol</span></span><span id="textcolor13297"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13298"><span 
class="aett-10x-x-109">stcov</span></span><span id="textcolor13299"><span 
class="aett-10x-x-109">(loc,</span><span 
class="aett-10x-x-109">&#x00A0;time,</span><span 
class="aett-10x-x-109">&#x00A0;kappa.s,</span><span 
class="aett-10x-x-109">&#x00A0;kappa.t,</span><span 
class="aett-10x-x-109">&#x00A0;s2)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13300"><span 
class="aett-10x-x-109">rnorm</span></span><span id="textcolor13301"><span 
class="aett-10x-x-109">(n))</span></span>
<br /><span id="textcolor13302"><span 
class="aett-10x-x-109">beta0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13303"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13304"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor13305"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor13306"><span 
class="aett-10x-x-109">;</span><span 
class="aett-10x-x-109">&#x00A0;tau.error</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13307"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13308"><span 
class="aett-10x-x-109">3</span></span>
<br /><span id="textcolor13309"><span 
class="aett-10x-x-109">y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13310"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13311"><span 
class="aett-10x-x-109">beta0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13312"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13313"><span 
class="aett-10x-x-109">xx</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13314"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13315"><span 
class="aett-10x-x-109">rnorm</span></span><span id="textcolor13316"><span 
class="aett-10x-x-109">(n,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13317"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor13318"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13319"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor13320"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13321"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13322"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor13323"><span 
class="aett-10x-x-109">tau.error))</span></span>                          </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13328"></div></div>                                                                          </span></div>-
<!--l. 568--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.2.2   </span> <a 
 id="x9-930005.2.2"></a>Data stack preparation</h4>
<!--l. 570--><p class="noindent" >To fit the space-time continuous model we need to determine the time knots and the temporal
mesh  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13354"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13330"><span 
class="aett-10x-x-109">k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13331"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13332"><span 
class="aett-10x-x-109">10</span></span>
<br /><span id="textcolor13333"><span 
class="aett-10x-x-109">(mesh.t</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13334"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13335"><span 
class="aett-10x-x-109">inla.mesh.1d</span></span><span id="textcolor13336"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13337"><span 
class="aett-10x-x-109">seq</span></span><span id="textcolor13338"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13339"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor13340"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor13341"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor13342"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor13343"><span 
class="aett-10x-x-109">k,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13344"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13345"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor13346"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor13347"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor13348"><span 
class="aett-10x-x-109">k,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13349"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor13350"><span 
class="aett-10x-x-109">=k)))</span></span><span id="textcolor13351"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13352"><span 
class="aett-10x-x-109">loc</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-124">
##&#x00A0;&#x00A0;[1]&#x00A0;0.05&#x00A0;0.15&#x00A0;0.25&#x00A0;0.35&#x00A0;0.45&#x00A0;0.55&#x00A0;0.65&#x00A0;0.75&#x00A0;0.85&#x00A0;0.95
</div>
<!--l. 579--><p class="nopar" >                                                                          </span></div>-
<!--l. 583--><p class="indent" >   Consider the the low resolution mesh for Paraná state border created in Section&#x00A0;<a 
href="spde-tutorialch1.html#x5-270001.3">1.3<!--tex4ht:ref: sec:mesh --></a>, used in
the previous example and the SPDE model also defined in the previous example.
</p><!--l. 588--><p class="indent" >   Building the index set  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13369"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13356"><span 
class="aett-10x-x-109">iset</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13357"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13358"><span 
class="aett-10x-x-109">inla.spde.make.index</span></span><span id="textcolor13359"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13360"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">i</span><span 
class="tctt-1095">'</span></span><span id="textcolor13361"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13362"><span 
class="aett-10x-x-109">n.spde</span></span><span id="textcolor13363"><span 
class="aett-10x-x-109">=spde</span></span><span id="textcolor13364"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13365"><span 
class="aett-10x-x-109">n.spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13366"><span 
class="aett-10x-x-109">n.group</span></span><span id="textcolor13367"><span 
class="aett-10x-x-109">=k)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 597--><p class="indent" >   The projector matrix consider the spatial and time projection. So, it needs the spatial mesh
and the spatial locations, the time points and the temporal mesh  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13384"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13371"><span 
class="aett-10x-x-109">A</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13372"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13373"><span 
class="aett-10x-x-109">inla.spde.make.A</span></span><span id="textcolor13374"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13375"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor13376"><span 
class="aett-10x-x-109">=prmesh1,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13377"><span 
class="aett-10x-x-109">loc</span></span><span id="textcolor13378"><span 
class="aett-10x-x-109">=loc,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13379"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor13380"><span 
class="aett-10x-x-109">=time,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13381"><span 
class="aett-10x-x-109">group.mesh</span></span><span id="textcolor13382"><span 
class="aett-10x-x-109">=mesh.t)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 609--><p class="indent" >   The effects on the stack are a list with two elements, one is the index set and another the
categorical covariate. The stack data is defined as  
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13419"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13386"><span 
class="aett-10x-x-109">sdat</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13387"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13388"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor13389"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13390"><span 
class="aett-10x-x-109">tag</span></span><span id="textcolor13391"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13392"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">stdata</span><span 
class="tctt-1095">'</span></span><span id="textcolor13393"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13394"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor13395"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13396"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13397"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13398"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor13399"><span 
class="aett-10x-x-109">=y),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13400"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor13401"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13402"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13403"><span 
class="aett-10x-x-109">(A,</span></span><span id="textcolor13404"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13405"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13406"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor13407"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13408"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13409"><span 
class="aett-10x-x-109">(iset,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13410"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13411"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13412"><span 
class="aett-10x-x-109">b0</span></span><span id="textcolor13413"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13414"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor13415"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13416"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13417"><span 
class="aett-10x-x-109">,n))))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 621--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.2.3   </span> <a 
 id="x9-940005.2.3"></a>Fitting the model and some results</h4>
<!--l. 623--><p class="noindent" >We used an Exponential correlation function for time with parameter <span 
class="cmmi-10x-x-109">&#x03BA; </span>as the inverse range
parameter. It gives a correlation between time knots equals to  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13435"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13421"><span 
class="aett-10x-x-109">exp</span></span><span id="textcolor13422"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13423"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor13424"><span 
class="aett-10x-x-109">kappa.t</span></span><span id="textcolor13425"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor13426"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor13427"><span 
class="aett-10x-x-109">(mesh.t</span></span><span id="textcolor13428"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13429"><span 
class="aett-10x-x-109">loc[</span></span><span id="textcolor13430"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13431"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor13432"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor13433"><span 
class="aett-10x-x-109">]))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-125">
##&#x00A0;[1]&#x00A0;0.6065307
</div>
<!--l. 632--><p class="nopar" >                                                                          </span></div>-
<!--l. 636--><p class="indent" >   Fitting the model considering a AR1 temporal correlation over the time knots
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13492"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13437"><span 
class="aett-10x-x-109">formulae</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13438"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13439"><span 
class="aett-10x-x-109">y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13440"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13441"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13442"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13443"><span 
class="aett-10x-x-109">b0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13444"><span 
class="aett-10x-x-109">+</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13445"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor13446"><span 
class="aett-10x-x-109">(i,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13447"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor13448"><span 
class="aett-10x-x-109">=spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13449"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor13450"><span 
class="aett-10x-x-109">=i.group,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13451"><span 
class="aett-10x-x-109">control.group</span></span><span id="textcolor13452"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13453"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13454"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13455"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor13456"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13457"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">ar1</span><span 
class="tctt-1095">'</span></span><span id="textcolor13458"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13459"><span 
class="aett-10x-x-109">hyper</span></span><span id="textcolor13460"><span 
class="aett-10x-x-109">=h.spec))</span></span>
<br /><span id="textcolor13461"><span 
class="aett-10x-x-109">res</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13462"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13463"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor13464"><span 
class="aett-10x-x-109">(formulae,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13465"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor13466"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13467"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor13468"><span 
class="aett-10x-x-109">(sdat),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13469"><span 
class="aett-10x-x-109">control.family</span></span><span id="textcolor13470"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13471"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13472"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13473"><span 
class="aett-10x-x-109">hyper</span></span><span id="textcolor13474"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13475"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13476"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13477"><span 
class="aett-10x-x-109">theta</span></span><span id="textcolor13478"><span 
class="aett-10x-x-109">=prec.prior)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13479"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor13480"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13481"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13482"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13483"><span 
class="aett-10x-x-109">compute</span></span><span id="textcolor13484"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13485"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor13486"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13487"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor13488"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13489"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor13490"><span 
class="aett-10x-x-109">(sdat)))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 651--><p class="indent" >   Look at the summary of the posterior marginal distributions for the likelihood precision and
the random field parameters:  
                                                                                 
                                                                                 
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13501"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13494"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor13495"><span 
class="aett-10x-x-109">(res</span></span><span id="textcolor13496"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13497"><span 
class="aett-10x-x-109">summary.hyper,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13498"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor13499"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-126">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant&#x00A0;0.5quant
&#x00A0;<br />##&#x00A0;Precision&#x00A0;for&#x00A0;the&#x00A0;Gaussian&#x00A0;observations&#x00A0;2.8535&#x00A0;0.1903&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2.4918&#x00A0;&#x00A0;&#x00A0;2.8496
&#x00A0;<br />##&#x00A0;Range&#x00A0;for&#x00A0;i&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2.4527&#x00A0;0.4363&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.7246&#x00A0;&#x00A0;&#x00A0;2.4070
&#x00A0;<br />##&#x00A0;Stdev&#x00A0;for&#x00A0;i&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.6753&#x00A0;0.0725&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.5423&#x00A0;&#x00A0;&#x00A0;0.6721
&#x00A0;<br />##&#x00A0;GroupRho&#x00A0;for&#x00A0;i&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.5124&#x00A0;0.1464&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.1879&#x00A0;&#x00A0;&#x00A0;0.5270
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.975quant&#x00A0;&#x00A0;&#x00A0;mode
&#x00A0;<br />##&#x00A0;Precision&#x00A0;for&#x00A0;the&#x00A0;Gaussian&#x00A0;observations&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;3.2401&#x00A0;2.8443
&#x00A0;<br />##&#x00A0;Range&#x00A0;for&#x00A0;i&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;3.4361&#x00A0;2.3131
&#x00A0;<br />##&#x00A0;Stdev&#x00A0;for&#x00A0;i&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.8274&#x00A0;0.6664
&#x00A0;<br />##&#x00A0;GroupRho&#x00A0;for&#x00A0;i&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.7559&#x00A0;0.5584
</div>
<!--l. 669--><p class="nopar" >                                                                          </span></div>-
<!--l. 673--><p class="indent" >   These distributions are showed in Figure&#x00A0;<a 
href="#x9-940005.2.3">5.2.3<!--tex4ht:ref: fig:stcpost --></a>, as well also the marginal ditribution for the
intercept, error precision, spatial range, standard deviation and temporal correlation in the
spacetime field with the commands bellow  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13617"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13503"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor13504"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13505"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor13506"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13507"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor13508"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13509"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor13510"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor13511"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor13512"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13513"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor13514"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13515"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor13516"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13517"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor13518"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor13519"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor13520"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor13521"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13522"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor13523"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor13524"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13525"><span 
class="aett-10x-x-109">mgp</span></span><span id="textcolor13526"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13527"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor13528"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor13529"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor13530"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor13531"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor13532"><span 
class="aett-10x-x-109">(res</span></span><span id="textcolor13533"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13534"><span 
class="aett-10x-x-109">marginals.fixed[[</span></span><span id="textcolor13535"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13536"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13537"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor13538"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13539"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor13540"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13541"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor13542"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13543"><span 
class="aett-10x-x-109">expression</span></span><span id="textcolor13544"><span 
class="aett-10x-x-109">(beta[</span></span><span id="textcolor13545"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor13546"><span 
class="aett-10x-x-109">]),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13547"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor13548"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13549"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Density</span><span 
class="tctt-1095">'</span></span><span id="textcolor13550"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor13551"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor13552"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13553"><span 
class="aett-10x-x-109">v</span></span><span id="textcolor13554"><span 
class="aett-10x-x-109">=beta0,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13555"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor13556"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13557"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor13558"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor13559"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13560"><span 
class="aett-10x-x-109">(j</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13561"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13562"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13563"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor13564"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor13565"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13566"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor13567"><span 
class="aett-10x-x-109">(res</span></span><span id="textcolor13568"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13569"><span 
class="aett-10x-x-109">marginals.hyper[[j]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13570"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor13571"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13572"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor13573"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13574"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor13575"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13576"><span 
class="aett-10x-x-109">names</span></span><span id="textcolor13577"><span 
class="aett-10x-x-109">(res</span></span><span id="textcolor13578"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13579"><span 
class="aett-10x-x-109">marginals.hyper)[j],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13580"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor13581"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13582"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Density</span><span 
class="tctt-1095">'</span></span><span id="textcolor13583"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13584"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor13585"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13586"><span 
class="aett-10x-x-109">v</span></span><span id="textcolor13587"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13588"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor13589"><span 
class="aett-10x-x-109">(tau.error,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13590"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor13591"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13592"><span 
class="aett-10x-x-109">8</span></span><span id="textcolor13593"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor13594"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor13595"><span 
class="aett-10x-x-109">kappa.s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13596"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor13597"><span 
class="aett-10x-x-109">(s2),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13598"><span 
class="aett-10x-x-109">exp</span></span><span id="textcolor13599"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13600"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor13601"><span 
class="aett-10x-x-109">kappa.t</span></span><span id="textcolor13602"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor13603"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor13604"><span 
class="aett-10x-x-109">(mesh.t</span></span><span id="textcolor13605"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13606"><span 
class="aett-10x-x-109">loc[</span></span><span id="textcolor13607"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13608"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor13609"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor13610"><span 
class="aett-10x-x-109">])))[j],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13611"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor13612"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13613"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor13614"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor13615"><span 
class="aett-10x-x-109">}</span></span>
</div>
</div>                                                                          </span></div>-
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x9-940015"></a>
                                                                                 
                                                                                 
<!--l. 698--><p class="noindent" ><img 
src="spde-tutorial92x.png" alt="PIC" class="graphics" width="426.79497pt" height="284.53775pt"  /><!--tex4ht:graphics  
name="spde-tutorial92x.png" src="figs/spacetimeunnamed-chunk-3-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;5.5: </span><span  
class="content">Marginal posterior distribution for the intercept, likelihood precision and the
parameters in the space-time process.</span></div><!--tex4ht:label?: x9-940015 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
   <h3 class="sectionHead"><span class="titlemark">5.3   </span> <a 
 id="x9-950005.3"></a>Lowering resolution of a spatio-temporal model</h3>
<!--l. 3--><p class="noindent" >The  R  source  for  this  file  is  available  at
<a 
href="http://www.math.ntnu.no/inla/r-inla.org/tutorials/spde/R/spde-tutorial-lower-spatio-temporal.R" class="url" ><span 
class="aett-10x-x-109">http://www.math.ntnu.no/inla/r-_inla.org/tutorials/spde/R/spde-_tutorial-_lower-_spatio-_temporal.R</span></a>
</p><!--l. 9--><p class="indent" >   It can be challenging when dealing with large data sets. In this chapter we want to show how
to fit a model using some dimention reduction.
</p><!--l. 13--><p class="indent" >   Before starting, the spatial mesh and the SPDE model is built with the following code.
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13670"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13619"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor13620"><span 
class="aett-10x-x-109">(PRprec)</span></span>
<br /><span id="textcolor13621"><span 
class="aett-10x-x-109">bound</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13622"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13623"><span 
class="aett-10x-x-109">inla.nonconvex.hull</span></span><span id="textcolor13624"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13625"><span 
class="aett-10x-x-109">as.matrix</span></span><span id="textcolor13626"><span 
class="aett-10x-x-109">(PRprec[,</span></span><span id="textcolor13627"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13628"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor13629"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor13630"><span 
class="aett-10x-x-109">]),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13631"><span 
class="aett-10x-x-109">.2</span></span><span id="textcolor13632"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13633"><span 
class="aett-10x-x-109">.2</span></span><span id="textcolor13634"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13635"><span 
class="aett-10x-x-109">resol</span></span><span id="textcolor13636"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13637"><span 
class="aett-10x-x-109">50</span></span><span id="textcolor13638"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor13639"><span 
class="aett-10x-x-109">mesh.s</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13640"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13641"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor13642"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13643"><span 
class="aett-10x-x-109">bound</span></span><span id="textcolor13644"><span 
class="aett-10x-x-109">=bound,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13645"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor13646"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13647"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor13648"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13649"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13650"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor13651"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor13652"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13653"><span 
class="aett-10x-x-109">offset</span></span><span id="textcolor13654"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13655"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor13656"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13657"><span 
class="aett-10x-x-109">1e-5</span></span><span id="textcolor13658"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor13659"><span 
class="aett-10x-x-109">0.7</span></span><span id="textcolor13660"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13661"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor13662"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13663"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor13664"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor13665"><span 
class="aett-10x-x-109">spde.s</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13666"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13667"><span 
class="aett-10x-x-109">inla.spde2.matern</span></span><span id="textcolor13668"><span 
class="aett-10x-x-109">(mesh.s)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 26--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.3.1   </span> <a 
 id="x9-960005.3.1"></a>Data temporal aggregation</h4>
<!--l. 28--><p class="noindent" >The data we are going to analyse is the daily rainfall in Paraná. We have rainfall at 616 location
points observed over 365 days.  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13685"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13672"><span 
class="aett-10x-x-109">dim</span></span><span id="textcolor13673"><span 
class="aett-10x-x-109">(PRprec)</span></span>
</div>
</div>                                                                          </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13687">   <div class="verbatim" id="verbatim-127">
##&#x00A0;[1]&#x00A0;616&#x00A0;368
</div>
<!--l. 37--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor13674"><span 
class="aett-10x-x-109">PRprec[</span></span><span id="textcolor13675"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13676"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor13677"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor13678"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13679"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13680"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor13681"><span 
class="aett-10x-x-109">7</span></span><span id="textcolor13682"><span 
class="aett-10x-x-109">]</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-128">
##&#x00A0;&#x00A0;&#x00A0;Longitude&#x00A0;Latitude&#x00A0;Altitude&#x00A0;d0101&#x00A0;d0102&#x00A0;d0103&#x00A0;d0104
&#x00A0;<br />##&#x00A0;1&#x00A0;&#x00A0;-50.8744&#x00A0;-22.8511&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;365&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />##&#x00A0;3&#x00A0;&#x00A0;-50.7711&#x00A0;-22.9597&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;344&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
</div>
<!--l. 45--><p class="nopar" >                                                                          </span></div>-
<!--l. 49--><p class="indent" >   To this example we are going to analyse the probability of rain. So we only consider if the
value where bigger than <span 
class="cmr-10x-x-109">0</span><span 
class="cmmi-10x-x-109">.</span><span 
class="cmr-10x-x-109">1 </span>or not.
</p><!--l. 52--><p class="indent" >   To reduce the time dimension of the data, we aggregate it summing every five days. At end
we have two data matrix, one with the number of days without NA in each station and another
with the number of raining days on such stations.  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13750"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13689"><span 
class="aett-10x-x-109">table</span></span><span id="textcolor13690"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13691"><span 
class="aett-10x-x-109">table</span></span><span id="textcolor13692"><span 
class="aett-10x-x-109">(id5</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13693"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13694"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor13695"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor13696"><span 
class="aett-10x-x-109">364</span></span><span id="textcolor13697"><span 
class="aett-10x-x-109">%/%</span></span><span id="textcolor13698"><span 
class="aett-10x-x-109">5</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13699"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13700"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13701"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>                                                                          </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13752">   <div class="verbatim" id="verbatim-129">
##
&#x00A0;<br />##&#x00A0;&#x00A0;5
&#x00A0;<br />##&#x00A0;73
</div>
<!--l. 65--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor13702"><span 
class="aett-10x-x-109">n5</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13703"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13704"><span 
class="aett-10x-x-109">t</span></span><span id="textcolor13705"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13706"><span 
class="aett-10x-x-109">apply</span></span><span id="textcolor13707"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13708"><span 
class="aett-10x-x-109">!</span></span><span id="textcolor13709"><span 
class="aett-10x-x-109">is.na</span></span><span id="textcolor13710"><span 
class="aett-10x-x-109">(PRprec[,</span></span><span id="textcolor13711"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor13712"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor13713"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13714"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor13715"><span 
class="aett-10x-x-109">365</span></span><span id="textcolor13716"><span 
class="aett-10x-x-109">]),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13717"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13718"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;tapply,</span><span 
class="aett-10x-x-109">&#x00A0;id5,</span><span 
class="aett-10x-x-109">&#x00A0;sum))</span></span>
<br /><span id="textcolor13719"><span 
class="aett-10x-x-109">y5</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13720"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13721"><span 
class="aett-10x-x-109">t</span></span><span id="textcolor13722"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13723"><span 
class="aett-10x-x-109">apply</span></span><span id="textcolor13724"><span 
class="aett-10x-x-109">(PRprec[,</span></span><span id="textcolor13725"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor13726"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor13727"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13728"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor13729"><span 
class="aett-10x-x-109">365</span></span><span id="textcolor13730"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor13731"><span 
class="aett-10x-x-109">&#x003E;</span></span><span id="textcolor13732"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor13733"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13734"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13735"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;tapply,</span><span 
class="aett-10x-x-109">&#x00A0;id5,</span><span 
class="aett-10x-x-109">&#x00A0;sum,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13736"><span 
class="aett-10x-x-109">na.rm</span></span><span id="textcolor13737"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13738"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor13739"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor13740"><span 
class="aett-10x-x-109">k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13741"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13742"><span 
class="aett-10x-x-109">ncol</span></span><span id="textcolor13743"><span 
class="aett-10x-x-109">(n5);</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13744"><span 
class="aett-10x-x-109">table</span></span><span id="textcolor13745"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13746"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor13747"><span 
class="aett-10x-x-109">(n5))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-130">
##
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;3&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;5
&#x00A0;<br />##&#x00A0;&#x00A0;3563&#x00A0;&#x00A0;&#x00A0;&#x00A0;77&#x00A0;&#x00A0;&#x00A0;&#x00A0;72&#x00A0;&#x00A0;&#x00A0;&#x00A0;95&#x00A0;&#x00A0;&#x00A0;172&#x00A0;40989
</div>
<!--l. 75--><p class="nopar" >                                                                          </span></div>-
<!--l. 78--><p class="indent" >   From now, our data has 73 time points.
</p><!--l. 80--><p class="indent" >   From the above table, we can see that there were 3563 periods of five days with no data
recorded. The first approach can be removing such pairs data, both <span 
class="cmmi-10x-x-109">y </span>and <span 
class="cmmi-10x-x-109">n</span>. If we do not remove
it, we have to assign NA to <span 
class="cmmi-10x-x-109">y </span>when <span 
class="cmmi-10x-x-109">n </span><span 
class="cmr-10x-x-109">= 0</span>. However, we have to assign a positive
value, five for example, for such <span 
class="cmmi-10x-x-109">n </span>and it will be treated as a prediction scenario.
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13767"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13754"><span 
class="aett-10x-x-109">y5[n5</span></span><span id="textcolor13755"><span 
class="aett-10x-x-109">==</span></span><span id="textcolor13756"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor13757"><span 
class="aett-10x-x-109">]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13758"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13759"><span 
class="aett-10x-x-109">NA</span></span><span id="textcolor13760"><span 
class="aett-10x-x-109">;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;n5[n5</span></span><span id="textcolor13761"><span 
class="aett-10x-x-109">==</span></span><span id="textcolor13762"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor13763"><span 
class="aett-10x-x-109">]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13764"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13765"><span 
class="aett-10x-x-109">5</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 94--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.3.2   </span> <a 
 id="x9-970005.3.2"></a>Lowering temporal model resolution</h4>
<!--l. 96--><p class="noindent" >This approach is better expained in<span class="cite">[<a 
href="spde-tutorialli2.html#XblangiardoC:2015">Blangiardo and Cameletti, 2015</a>]</span>. The main idea is to place
some knots over the time window and define a model on such knots. Them project the model
into the data time points as we do using the Finite Element Method in the SPDE
approach.
</p><!--l. 102--><p class="indent" >   We choose to place knots at each 6 time points of the temporally aggregated data, which has
73 time points. So, we en up with only 12 knots over time.  
                                                                                 
                                                                                 
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13816"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13769"><span 
class="aett-10x-x-109">bt</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13770"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13771"><span 
class="aett-10x-x-109">6</span></span><span id="textcolor13772"><span 
class="aett-10x-x-109">;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;gtime</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13773"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13774"><span 
class="aett-10x-x-109">seq</span></span><span id="textcolor13775"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13776"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13777"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor13778"><span 
class="aett-10x-x-109">bt,</span><span 
class="aett-10x-x-109">&#x00A0;k,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13779"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor13780"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13781"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor13782"><span 
class="aett-10x-x-109">(k</span></span><span id="textcolor13783"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor13784"><span 
class="aett-10x-x-109">bt))</span></span><span id="textcolor13785"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor13786"><span 
class="aett-10x-x-109">bt</span></span><span id="textcolor13787"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor13788"><span 
class="aett-10x-x-109">2</span></span>
<br /><span id="textcolor13789"><span 
class="aett-10x-x-109">mesh.t</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13790"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13791"><span 
class="aett-10x-x-109">inla.mesh.1d</span></span><span id="textcolor13792"><span 
class="aett-10x-x-109">(gtime,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13793"><span 
class="aett-10x-x-109">degree</span></span><span id="textcolor13794"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13795"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13796"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor13797"><span 
class="aett-10x-x-109">table</span></span><span id="textcolor13798"><span 
class="aett-10x-x-109">(igr</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13799"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13800"><span 
class="aett-10x-x-109">apply</span></span><span id="textcolor13801"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13802"><span 
class="aett-10x-x-109">abs</span></span><span id="textcolor13803"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13804"><span 
class="aett-10x-x-109">outer</span></span><span id="textcolor13805"><span 
class="aett-10x-x-109">(mesh.t</span></span><span id="textcolor13806"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13807"><span 
class="aett-10x-x-109">loc,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13808"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13809"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor13810"><span 
class="aett-10x-x-109">k,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13811"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">-</span><span 
class="tctt-1095">'</span></span><span id="textcolor13812"><span 
class="aett-10x-x-109">)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13813"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor13814"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;which.min))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-131">
##
&#x00A0;<br />##&#x00A0;&#x00A0;1&#x00A0;&#x00A0;2&#x00A0;&#x00A0;3&#x00A0;&#x00A0;4&#x00A0;&#x00A0;5&#x00A0;&#x00A0;6&#x00A0;&#x00A0;7&#x00A0;&#x00A0;8&#x00A0;&#x00A0;9&#x00A0;10&#x00A0;11&#x00A0;12
&#x00A0;<br />##&#x00A0;&#x00A0;7&#x00A0;&#x00A0;6&#x00A0;&#x00A0;6&#x00A0;&#x00A0;6&#x00A0;&#x00A0;6&#x00A0;&#x00A0;6&#x00A0;&#x00A0;6&#x00A0;&#x00A0;6&#x00A0;&#x00A0;6&#x00A0;&#x00A0;6&#x00A0;&#x00A0;6&#x00A0;&#x00A0;6
</div>
<!--l. 117--><p class="nopar" >                                                                          </span></div>-
<!--l. 120--><p class="indent" >   The fist knot is closer to 7 time blocks and the others to 6.
</p><!--l. 122--><p class="indent" >   The model dimention is then  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13826"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13818"><span 
class="aett-10x-x-109">spde.s</span></span><span id="textcolor13819"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13820"><span 
class="aett-10x-x-109">n.spde</span></span><span id="textcolor13821"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor13822"><span 
class="aett-10x-x-109">mesh.t</span></span><span id="textcolor13823"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13824"><span 
class="aett-10x-x-109">n</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-132">
##&#x00A0;[1]&#x00A0;1152
</div>
<!--l. 130--><p class="nopar" >                                                                          </span></div>-
<!--l. 134--><p class="indent" >   To built the spatial projector matrix, we need to replicate the spatial coordinates as
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13845"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13828"><span 
class="aett-10x-x-109">n</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13829"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13830"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor13831"><span 
class="aett-10x-x-109">(PRprec)</span></span>
<br /><span id="textcolor13832"><span 
class="aett-10x-x-109">st.sloc</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13833"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13834"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor13835"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13836"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor13837"><span 
class="aett-10x-x-109">(PRprec[,</span></span><span id="textcolor13838"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13839"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;k),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13840"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor13841"><span 
class="aett-10x-x-109">(PRprec[,</span></span><span id="textcolor13842"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor13843"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;k))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 144--><p class="indent" >   and then to consider the temporal mesh considering the group index in the scale of the data
to be analised.  
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13867"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13847"><span 
class="aett-10x-x-109">Ast</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13848"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13849"><span 
class="aett-10x-x-109">inla.spde.make.A</span></span><span id="textcolor13850"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13851"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor13852"><span 
class="aett-10x-x-109">=mesh.s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13853"><span 
class="aett-10x-x-109">loc</span></span><span id="textcolor13854"><span 
class="aett-10x-x-109">=st.sloc,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13855"><span 
class="aett-10x-x-109">group.mesh</span></span><span id="textcolor13856"><span 
class="aett-10x-x-109">=mesh.t,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13857"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor13858"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13859"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor13860"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13861"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13862"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor13863"><span 
class="aett-10x-x-109">k,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13864"><span 
class="aett-10x-x-109">each</span></span><span id="textcolor13865"><span 
class="aett-10x-x-109">=n))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 155--><p class="indent" >   The index set and the stack is built as usual  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13925"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13869"><span 
class="aett-10x-x-109">idx.st</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13870"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13871"><span 
class="aett-10x-x-109">inla.spde.make.index</span></span><span id="textcolor13872"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13873"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">i</span><span 
class="tctt-1095">'</span></span><span id="textcolor13874"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13875"><span 
class="aett-10x-x-109">n.spde</span></span><span id="textcolor13876"><span 
class="aett-10x-x-109">=spde.s</span></span><span id="textcolor13877"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13878"><span 
class="aett-10x-x-109">n.spde,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13879"><span 
class="aett-10x-x-109">n.group</span></span><span id="textcolor13880"><span 
class="aett-10x-x-109">=mesh.t</span></span><span id="textcolor13881"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13882"><span 
class="aett-10x-x-109">n)</span></span>
<br /><span id="textcolor13883"><span 
class="aett-10x-x-109">dat</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13884"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13885"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor13886"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13887"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor13888"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13889"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13890"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13891"><span 
class="aett-10x-x-109">yy</span></span><span id="textcolor13892"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13893"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor13894"><span 
class="aett-10x-x-109">(y5),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13895"><span 
class="aett-10x-x-109">nn</span></span><span id="textcolor13896"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13897"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor13898"><span 
class="aett-10x-x-109">(n5)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13899"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor13900"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13901"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13902"><span 
class="aett-10x-x-109">(Ast,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13903"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13904"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13905"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor13906"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13907"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13908"><span 
class="aett-10x-x-109">(idx.st,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13909"><span 
class="aett-10x-x-109">data.frame</span></span><span id="textcolor13910"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13911"><span 
class="aett-10x-x-109">mu0</span></span><span id="textcolor13912"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13913"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor13914"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13915"><span 
class="aett-10x-x-109">altitude</span></span><span id="textcolor13916"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13917"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor13918"><span 
class="aett-10x-x-109">(PRprec</span></span><span id="textcolor13919"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13920"><span 
class="aett-10x-x-109">Alt</span></span><span id="textcolor13921"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor13922"><span 
class="aett-10x-x-109">1e3</span></span><span id="textcolor13923"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;k))))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 170--><p class="indent" >   The formula is also as the usual for the separable spatio temporal model  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox13952"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13927"><span 
class="aett-10x-x-109">form</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13928"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13929"><span 
class="aett-10x-x-109">yy</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13930"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13931"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13932"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13933"><span 
class="aett-10x-x-109">mu0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13934"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13935"><span 
class="aett-10x-x-109">altitude</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13936"><span 
class="aett-10x-x-109">+</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13937"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor13938"><span 
class="aett-10x-x-109">(i,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13939"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor13940"><span 
class="aett-10x-x-109">=spde.s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13941"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor13942"><span 
class="aett-10x-x-109">=i.group,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13943"><span 
class="aett-10x-x-109">control.group</span></span><span id="textcolor13944"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13945"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13946"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13947"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor13948"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13949"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">ar1</span><span 
class="tctt-1095">'</span></span><span id="textcolor13950"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 181--><p class="indent" >   To "fit" the model as fast as possible, we use the &#8217;gaussian&#8217; approximation and the Empirical
Bayes (&#8217;eb&#8217;) integration strategy over the hyperparameters. We also fixed the mode at the values
we have find in previous analisys.  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14008"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor13954"><span 
class="aett-10x-x-109">result</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13955"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13956"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor13957"><span 
class="aett-10x-x-109">(form,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13958"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">binomial</span><span 
class="tctt-1095">'</span></span><span id="textcolor13959"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13960"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor13961"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13962"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor13963"><span 
class="aett-10x-x-109">(dat),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13964"><span 
class="aett-10x-x-109">Ntrials</span></span><span id="textcolor13965"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13966"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor13967"><span 
class="aett-10x-x-109">(dat)</span></span><span id="textcolor13968"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor13969"><span 
class="aett-10x-x-109">nn,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13970"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor13971"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13972"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13973"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13974"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor13975"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13976"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor13977"><span 
class="aett-10x-x-109">(dat)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13978"><span 
class="aett-10x-x-109">control.mode</span></span><span id="textcolor13979"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13980"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13981"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13982"><span 
class="aett-10x-x-109">theta</span></span><span id="textcolor13983"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13984"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor13985"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13986"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor13987"><span 
class="aett-10x-x-109">0.48</span></span><span id="textcolor13988"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13989"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor13990"><span 
class="aett-10x-x-109">0.9</span></span><span id="textcolor13991"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13992"><span 
class="aett-10x-x-109">2.52</span></span><span id="textcolor13993"><span 
class="aett-10x-x-109">)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13994"><span 
class="aeitt-10x-x-109">###restart=TRUE),</span><span 
class="aeitt-10x-x-109">&#x00A0;</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor13995"><span 
class="aett-10x-x-109">control.inla</span></span><span id="textcolor13996"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor13997"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor13998"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor13999"><span 
class="aett-10x-x-109">strategy</span></span><span id="textcolor14000"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14001"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">gaussian</span><span 
class="tctt-1095">'</span></span><span id="textcolor14002"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14003"><span 
class="aett-10x-x-109">int.strategy</span></span><span id="textcolor14004"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14005"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">eb</span><span 
class="tctt-1095">'</span></span><span id="textcolor14006"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>                                                                          </span></div>-
                                                                                 
                                                                                 
<!--l. 197--><p class="indent" >   We can plot the fitted spatial effect for each temporal knot and overlay the proportion
raining days considering the data closest to the time knots.
</p><!--l. 201--><p class="indent" >   Defining a grid to project  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14061"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14010"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor14011"><span 
class="aett-10x-x-109">(PRborder)</span></span>
<br /><span id="textcolor14012"><span 
class="aett-10x-x-109">r0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14013"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14014"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor14015"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14016"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor14017"><span 
class="aett-10x-x-109">(PRborder[,</span></span><span id="textcolor14018"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14019"><span 
class="aett-10x-x-109">]))</span></span><span id="textcolor14020"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor14021"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor14022"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14023"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor14024"><span 
class="aett-10x-x-109">(PRborder[,</span></span><span id="textcolor14025"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14026"><span 
class="aett-10x-x-109">]))</span></span>
<br /><span id="textcolor14027"><span 
class="aett-10x-x-109">prj</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14028"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14029"><span 
class="aett-10x-x-109">inla.mesh.projector</span></span><span id="textcolor14030"><span 
class="aett-10x-x-109">(mesh.s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14031"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor14032"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14033"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor14034"><span 
class="aett-10x-x-109">(PRborder[,</span></span><span id="textcolor14035"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14036"><span 
class="aett-10x-x-109">]),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14037"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor14038"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14039"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor14040"><span 
class="aett-10x-x-109">(PRborder[,</span></span><span id="textcolor14041"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14042"><span 
class="aett-10x-x-109">]),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14043"><span 
class="aett-10x-x-109">dims</span></span><span id="textcolor14044"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14045"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14046"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14047"><span 
class="aett-10x-x-109">100</span></span><span id="textcolor14048"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor14049"><span 
class="aett-10x-x-109">r0,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14050"><span 
class="aett-10x-x-109">100</span></span><span id="textcolor14051"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor14052"><span 
class="aett-10x-x-109">in.pr</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14053"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14054"><span 
class="aett-10x-x-109">inout</span></span><span id="textcolor14055"><span 
class="aett-10x-x-109">(prj</span></span><span id="textcolor14056"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14057"><span 
class="aett-10x-x-109">lattice</span></span><span id="textcolor14058"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14059"><span 
class="aett-10x-x-109">loc,</span><span 
class="aett-10x-x-109">&#x00A0;PRborder)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 214--><p class="indent" >   Project the posterior mean fitted at each time knot  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14111"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14063"><span 
class="aett-10x-x-109">mu.spat</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14064"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14065"><span 
class="aett-10x-x-109">lapply</span></span><span id="textcolor14066"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14067"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14068"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor14069"><span 
class="aett-10x-x-109">mesh.t</span></span><span id="textcolor14070"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14071"><span 
class="aett-10x-x-109">n,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14072"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor14073"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14074"><span 
class="aett-10x-x-109">j</span></span><span id="textcolor14075"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14076"><span 
class="aett-10x-x-109">r</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14077"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14078"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor14079"><span 
class="aett-10x-x-109">(prj,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14080"><span 
class="aett-10x-x-109">field</span></span><span id="textcolor14081"><span 
class="aett-10x-x-109">=result</span></span><span id="textcolor14082"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14083"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor14084"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14085"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor14086"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14087"><span 
class="aett-10x-x-109">mean[</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14088"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14089"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor14090"><span 
class="aett-10x-x-109">spde.s</span></span><span id="textcolor14091"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14092"><span 
class="aett-10x-x-109">n.spde</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14093"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14094"><span 
class="aett-10x-x-109">(j</span></span><span id="textcolor14095"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor14096"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14097"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor14098"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor14099"><span 
class="aett-10x-x-109">spde.s</span></span><span id="textcolor14100"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14101"><span 
class="aett-10x-x-109">n.spde])</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14102"><span 
class="aett-10x-x-109">r[</span></span><span id="textcolor14103"><span 
class="aett-10x-x-109">!</span></span><span id="textcolor14104"><span 
class="aett-10x-x-109">in.pr]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14105"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14106"><span 
class="aett-10x-x-109">NA</span></span><span id="textcolor14107"><span 
class="aett-10x-x-109">;</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14108"><span 
class="aett-10x-x-109">return</span></span><span id="textcolor14109"><span 
class="aett-10x-x-109">(r)})</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 226--><p class="indent" >   The images in Figure&#x00A0;<a 
href="#x9-970005.3.2">5.3.2<!--tex4ht:ref: fig:lowstres --></a> were made using the following commands  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14200"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14113"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor14114"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14115"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor14116"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14117"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14118"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14119"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor14120"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14121"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor14122"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14123"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor14124"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14125"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14126"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14127"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor14128"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14129"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor14130"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14131"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor14132"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14133"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor14134"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor14135"><span 
class="aett-10x-x-109">zlm</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14136"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14137"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor14138"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14139"><span 
class="aett-10x-x-109">unlist</span></span><span id="textcolor14140"><span 
class="aett-10x-x-109">(mu.spat),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14141"><span 
class="aett-10x-x-109">na.rm</span></span><span id="textcolor14142"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14143"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor14144"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor14145"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14146"><span 
class="aett-10x-x-109">(j</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14147"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14148"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14149"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor14150"><span 
class="aett-10x-x-109">mesh.t</span></span><span id="textcolor14151"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14152"><span 
class="aett-10x-x-109">n)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14153"><span 
class="aett-10x-x-109">image.plot</span></span><span id="textcolor14154"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14155"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor14156"><span 
class="aett-10x-x-109">=prj</span></span><span id="textcolor14157"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14158"><span 
class="aett-10x-x-109">x,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14159"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor14160"><span 
class="aett-10x-x-109">=prj</span></span><span id="textcolor14161"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14162"><span 
class="aett-10x-x-109">y,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14163"><span 
class="aett-10x-x-109">z</span></span><span id="textcolor14164"><span 
class="aett-10x-x-109">=mu.spat[[j]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14165"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor14166"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14167"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14168"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14169"><span 
class="aett-10x-x-109">axes</span></span><span id="textcolor14170"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14171"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor14172"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14173"><span 
class="aett-10x-x-109">zlim</span></span><span id="textcolor14174"><span 
class="aett-10x-x-109">=zlm)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14175"><span 
class="aett-10x-x-109">lines</span></span><span id="textcolor14176"><span 
class="aett-10x-x-109">(PRborder)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14177"><span 
class="aett-10x-x-109">points</span></span><span id="textcolor14178"><span 
class="aett-10x-x-109">(PRprec[,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14179"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14180"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor14181"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14182"><span 
class="aett-10x-x-109">],</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14183"><span 
class="aett-10x-x-109">cex</span></span><span id="textcolor14184"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14185"><span 
class="aett-10x-x-109">rowSums</span></span><span id="textcolor14186"><span 
class="aett-10x-x-109">(y5[,</span><span 
class="aett-10x-x-109">&#x00A0;j</span></span><span id="textcolor14187"><span 
class="aett-10x-x-109">==</span></span><span id="textcolor14188"><span 
class="aett-10x-x-109">igr],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14189"><span 
class="aett-10x-x-109">na.rm</span></span><span id="textcolor14190"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14191"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor14192"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor14193"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor14194"><span 
class="aett-10x-x-109">rowSums</span></span><span id="textcolor14195"><span 
class="aett-10x-x-109">(n5[,j</span></span><span id="textcolor14196"><span 
class="aett-10x-x-109">==</span></span><span id="textcolor14197"><span 
class="aett-10x-x-109">igr]))</span></span>
<br /><span id="textcolor14198"><span 
class="aett-10x-x-109">}</span></span>
</div>
</div>                                                                          </span></div>-
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x9-970016"></a>
                                                                                 
                                                                                 
<!--l. 245--><p class="noindent" ><img 
src="spde-tutorial93x.png" alt="PIC" class="graphics" width="426.79497pt" height="371.07745pt"  /><!--tex4ht:graphics  
name="spde-tutorial93x.png" src="figs/lowstlowstres-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;5.6: </span><span  
class="content">Spatial effect at each time knots.</span></div><!--tex4ht:label?: x9-970016 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
   <h3 class="sectionHead"><span class="titlemark">5.4   </span> <a 
 id="x9-980005.4"></a>Dynamic regression example</h3>
<!--l. 3--><p class="noindent" >The  R  source  for  this  file  is  available  at
<a 
href="http://www.math.ntnu.no/inla/r-inla.org/tutorials/spde/R/spde-tutorial-dynamic.R" class="url" ><span 
class="aett-10x-x-109">http://www.math.ntnu.no/inla/r-_inla.org/tutorials/spde/R/spde-_tutorial-_dynamic.R</span></a>
</p><!--l. 9--><p class="indent" >   There is a large literature about dynamic models with also some books about it, from <span class="cite">[<a 
href="spde-tutorialli2.html#XwestH:1997">West
and Harrison, 1997</a>]</span> to <span class="cite">[<a 
href="spde-tutorialli2.html#XPetrisPC:2009">Petris et&#x00A0;al., 2009</a>]</span>. These models basically defines an hierarchical
framework for a class of time series models. A particular case is the dynamic regression model,
were the regression coefficients are modeled as time series. That is the case when the regression
coefficients vary smoothly over time.
</p><!--l. 19--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.4.1   </span> <a 
 id="x9-990005.4.1"></a>Dynamic space-time regression</h4>
<!--l. 21--><p class="noindent" >The specific class of models for spatially structured time series was proposed by <span class="cite">[<a 
href="spde-tutorialli2.html#XgelfandKSB:2003">Gelfand et&#x00A0;al.,
2003</a>]</span>, where the regression coefficients varies smoothly over time and space. For the
areal data case, the use of proper Gaussian Markov random fields (PGMRF) over
space as proposed by <span class="cite">[<a 
href="spde-tutorialli2.html#XvivarF:2009">Vivar and Ferreira, 2009</a>]</span>. There exists a particular class of such
models called &#8220;spatially varying coefficient models&#8221; were the regression coefficients
veries over space, <span class="cite">[<a 
href="spde-tutorialli2.html#XassuncaoGA:1999">Assunção et&#x00A0;al., 1999</a>]</span>, <span class="cite">[<a 
href="spde-tutorialli2.html#XassuncaoPC:2002">Assunção et&#x00A0;al., 2002</a>]</span>, <span class="cite">[<a 
href="spde-tutorialli2.html#XgamermanMR:2003">Gamerman et&#x00A0;al.,
2003</a>]</span>.
</p><!--l. 31--><p class="indent" >   In <span class="cite">[<a 
href="spde-tutorialli2.html#XgelfandKSB:2003">Gelfand et&#x00A0;al., 2003</a>]</span> the Gibbs sampler were used for inference and it was claimed that
better algorithms is needed due to strong autocorrelations. In <span class="cite">[<a 
href="spde-tutorialli2.html#XvivarF:2009">Vivar and Ferreira, 2009</a>]</span> the use
of forward information filtering and backward sampling (FIFBS) recursions were proposed. Both
MCMC algorithms are computationally expensive.
</p><!--l. 37--><p class="indent" >   One can avoid the FFBS algorithm as a relation between the Kalman-filter and the Cholesky
factorization is provided in <span class="cite">[<a 
href="spde-tutorialli2.html#XknorrheldR:2002">Knorr-Held and Rue, 2002</a>]</span>. The Cholesky fator is more general and
has superior performance when using sparse matrix methods, <span class="cite">[<a 
href="spde-tutorialli2.html#XRueHeld:2005">Rue and Held, 2005</a>, p. 149]</span>.
Additionally, the restriction that the prior for the latent field has to be proper can be
avoided.
</p><!--l. 43--><p class="indent" >   When the likelihood is Gaussian, there is no approximation needed in the inference process
since the distribution of the latent field given the data and the hyperparameters is Gaussian.
So, the main task is to perform inference for the hyperparameters in the model. For
this, the mode and curvature around can be found without any sampling method.
For the class of models in&#x00A0;<span class="cite">[<a 
href="spde-tutorialli2.html#XvivarF:2009">Vivar and Ferreira, 2009</a>]</span> it is natural to use INLA, as
shown in <span class="cite">[<a 
href="spde-tutorialli2.html#XcardenasKR:2012">Ruiz-Cárdenas et&#x00A0;al., 2012</a>]</span>, and for the models in&#x00A0;<span class="cite">[<a 
href="spde-tutorialli2.html#XgelfandKSB:2003">Gelfand et&#x00A0;al., 2003</a>]</span> we
can use the SPDE approach when considering the Matérn covariance for the spatial
part.
</p><!--l. 51--><p class="indent" >   In this example we will show how to fit the space-time dynamic regression model as in
<span class="cite">[<a 
href="spde-tutorialli2.html#XgelfandKSB:2003">Gelfand et&#x00A0;al., 2003</a>]</span>, considering the Matérn spatial covariance and the AR(1) model for time
which corresponds to the exponential correlation function. This particular covariance choise
correspond to the model in <span class="cite">[<a 
href="spde-tutorialli2.html#Xcameletti:2012">Cameletti et&#x00A0;al., 2012</a>]</span>, where only the intercept is dynamic. Here,
we show the case when we have a dynamic intercept and a dynamic regression coefficient for an
harmonic over time.
</p><!--l. 59--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.4.2   </span> <a 
 id="x9-1000005.4.2"></a>Simulation from the model</h4>
<!--l. 61--><p class="noindent" >We can start on defining the spatial locations:  
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14219"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14202"><span 
class="aett-10x-x-109">n</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14203"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14204"><span 
class="aett-10x-x-109">150</span></span><span id="textcolor14205"><span 
class="aett-10x-x-109">;</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14206"><span 
class="aett-10x-x-109">set.seed</span></span><span id="textcolor14207"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14208"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14209"><span 
class="aett-10x-x-109">);</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;coo</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14210"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14211"><span 
class="aett-10x-x-109">matrix</span></span><span id="textcolor14212"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14213"><span 
class="aett-10x-x-109">runif</span></span><span id="textcolor14214"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14215"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14216"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor14217"><span 
class="aett-10x-x-109">n),</span><span 
class="aett-10x-x-109">&#x00A0;n)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 70--><p class="indent" >   To sample from a random field on a set of location, we can use the
<span 
class="aett-10x-x-109">rMatern() </span>function defined in the Section&#x00A0;<a 
href="spde-tutorialch1.html#x5-90001.1.4">1.1.4<!--tex4ht:ref: sec:simulatoy --></a> to simulate independent
random field realizations for each time. This function is available in the file at
<a 
href="http://www.math.ntnu.no/inla/r-inla.org/tutorials/spde/R/spde-tutorial-functions.R" class="url" ><span 
class="aett-10x-x-109">http://www.math.ntnu.no/inla/r-_inla.org/tutorials/spde/R/spde-_tutorial-_functions.R</span></a>
</p><!--l. 77--><p class="indent" >   We draw <span 
class="cmmi-10x-x-109">k </span>(number of time points) samples from the random field. Then, we make it
temporally correlated considering the time autoregression  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14359"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14221"><span 
class="aett-10x-x-109">kappa</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14222"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14223"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14224"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14225"><span 
class="aett-10x-x-109">10</span></span><span id="textcolor14226"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14227"><span 
class="aett-10x-x-109">12</span></span><span id="textcolor14228"><span 
class="aett-10x-x-109">);</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sigma2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14229"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14230"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14231"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14232"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14233"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor14234"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14235"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14236"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14237"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor14238"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor14239"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor14240"><span 
class="aett-10x-x-109">k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14241"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14242"><span 
class="aett-10x-x-109">15</span></span><span id="textcolor14243"><span 
class="aett-10x-x-109">;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;rho</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14244"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14245"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14246"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14247"><span 
class="aett-10x-x-109">0.7</span></span><span id="textcolor14248"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14249"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor14250"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor14251"><span 
class="aett-10x-x-109">set.seed</span></span><span id="textcolor14252"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14253"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14254"><span 
class="aett-10x-x-109">);</span><span 
class="aett-10x-x-109">&#x00A0;beta0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14255"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14256"><span 
class="aett-10x-x-109">rMatern</span></span><span id="textcolor14257"><span 
class="aett-10x-x-109">(k,</span><span 
class="aett-10x-x-109">&#x00A0;coo,</span><span 
class="aett-10x-x-109">&#x00A0;kappa[</span></span><span id="textcolor14258"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14259"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;sigma2[</span></span><span id="textcolor14260"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14261"><span 
class="aett-10x-x-109">])</span></span>
<br /><span id="textcolor14262"><span 
class="aett-10x-x-109">set.seed</span></span><span id="textcolor14263"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14264"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor14265"><span 
class="aett-10x-x-109">);</span><span 
class="aett-10x-x-109">&#x00A0;beta1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14266"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14267"><span 
class="aett-10x-x-109">rMatern</span></span><span id="textcolor14268"><span 
class="aett-10x-x-109">(k,</span><span 
class="aett-10x-x-109">&#x00A0;coo,</span><span 
class="aett-10x-x-109">&#x00A0;kappa[</span></span><span id="textcolor14269"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14270"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;sigma2[</span></span><span id="textcolor14271"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14272"><span 
class="aett-10x-x-109">])</span></span>
<br /><span id="textcolor14273"><span 
class="aett-10x-x-109">beta0[,</span></span><span id="textcolor14274"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14275"><span 
class="aett-10x-x-109">]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14276"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14277"><span 
class="aett-10x-x-109">beta0[,</span></span><span id="textcolor14278"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14279"><span 
class="aett-10x-x-109">]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14280"><span 
class="aett-10x-x-109">/</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14281"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14282"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14283"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor14284"><span 
class="aett-10x-x-109">rho[</span></span><span id="textcolor14285"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14286"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor14287"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor14288"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14289"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor14290"><span 
class="aett-10x-x-109">beta1[,</span></span><span id="textcolor14291"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14292"><span 
class="aett-10x-x-109">]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14293"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14294"><span 
class="aett-10x-x-109">beta1[,</span></span><span id="textcolor14295"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14296"><span 
class="aett-10x-x-109">]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14297"><span 
class="aett-10x-x-109">/</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14298"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14299"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14300"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor14301"><span 
class="aett-10x-x-109">rho[</span></span><span id="textcolor14302"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14303"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor14304"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor14305"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14306"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor14307"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14308"><span 
class="aett-10x-x-109">(j</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14309"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14310"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14311"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor14312"><span 
class="aett-10x-x-109">k)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14313"><span 
class="aett-10x-x-109">beta0[,</span><span 
class="aett-10x-x-109">&#x00A0;j]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14314"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14315"><span 
class="aett-10x-x-109">beta0[,j</span></span><span id="textcolor14316"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor14317"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14318"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor14319"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor14320"><span 
class="aett-10x-x-109">rho[</span></span><span id="textcolor14321"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14322"><span 
class="aett-10x-x-109">]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14323"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14324"><span 
class="aett-10x-x-109">beta0[,j]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14325"><span 
class="aett-10x-x-109">*</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14326"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14327"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14328"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor14329"><span 
class="aett-10x-x-109">rho[</span></span><span id="textcolor14330"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14331"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor14332"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor14333"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14334"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14335"><span 
class="aett-10x-x-109">beta1[,</span><span 
class="aett-10x-x-109">&#x00A0;j]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14336"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14337"><span 
class="aett-10x-x-109">beta1[,j</span></span><span id="textcolor14338"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor14339"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14340"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor14341"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor14342"><span 
class="aett-10x-x-109">rho[</span></span><span id="textcolor14343"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14344"><span 
class="aett-10x-x-109">]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14345"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14346"><span 
class="aett-10x-x-109">beta1[,j]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14347"><span 
class="aett-10x-x-109">*</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14348"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14349"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14350"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor14351"><span 
class="aett-10x-x-109">rho[</span></span><span id="textcolor14352"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14353"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor14354"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor14355"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14356"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor14357"><span 
class="aett-10x-x-109">}</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 95--><p class="indent" >   where the <span 
class="cmr-10x-x-109">(1 </span><span 
class="cmsy-10x-x-109">- </span><span 
class="cmmi-10x-x-109">&#x03C1;</span><sub><span 
class="cmmi-8">j</span></sub><sup><span 
class="cmr-8">2</span></sup><span 
class="cmr-10x-x-109">) </span>term is in accord to the parametrization of the AR(<span 
class="cmr-10x-x-109">1</span>) model in
INLA.
</p><!--l. 98--><p class="indent" >   To get the response, we define the harmonic as a function over time, compute the mean and
add an error term  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14420"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14361"><span 
class="aett-10x-x-109">set.seed</span></span><span id="textcolor14362"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14363"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor14364"><span 
class="aett-10x-x-109">);</span><span 
class="aett-10x-x-109">&#x00A0;hh</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14365"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14366"><span 
class="aett-10x-x-109">runif</span></span><span id="textcolor14367"><span 
class="aett-10x-x-109">(n</span></span><span id="textcolor14368"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor14369"><span 
class="aett-10x-x-109">k)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14370"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;simlate</span><span 
class="aeitt-10x-x-109">&#x00A0;the</span><span 
class="aeitt-10x-x-109">&#x00A0;covariate</span><span 
class="aeitt-10x-x-109">&#x00A0;values</span></span>
<br /><span id="textcolor14371"><span 
class="aett-10x-x-109">mu.beta</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14372"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14373"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14374"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14375"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor14376"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor14377"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14378"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14379"><span 
class="aett-10x-x-109">);</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;taue</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14380"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14381"><span 
class="aett-10x-x-109">20</span></span>
<br /><span id="textcolor14382"><span 
class="aett-10x-x-109">set.seed</span></span><span id="textcolor14383"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14384"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor14385"><span 
class="aett-10x-x-109">);</span><span 
class="aett-10x-x-109">&#x00A0;error</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14386"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14387"><span 
class="aett-10x-x-109">rnorm</span></span><span id="textcolor14388"><span 
class="aett-10x-x-109">(n</span></span><span id="textcolor14389"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor14390"><span 
class="aett-10x-x-109">k,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14391"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor14392"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14393"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor14394"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14395"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14396"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor14397"><span 
class="aett-10x-x-109">taue))</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14398"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;error</span><span 
class="aeitt-10x-x-109">&#x00A0;in</span><span 
class="aeitt-10x-x-109">&#x00A0;the</span><span 
class="aeitt-10x-x-109">&#x00A0;observation</span></span>
<br /><span id="textcolor14399"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor14400"><span 
class="aett-10x-x-109">(y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14401"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14402"><span 
class="aett-10x-x-109">(mu.beta[</span></span><span id="textcolor14403"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14404"><span 
class="aett-10x-x-109">]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14405"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14406"><span 
class="aett-10x-x-109">beta0)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14407"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14408"><span 
class="aett-10x-x-109">(mu.beta[</span></span><span id="textcolor14409"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14410"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor14411"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor14412"><span 
class="aett-10x-x-109">beta1)</span></span><span id="textcolor14413"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor14414"><span 
class="aett-10x-x-109">hh</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14415"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14416"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;dynamic</span><span 
class="aeitt-10x-x-109">&#x00A0;regression</span><span 
class="aeitt-10x-x-109">&#x00A0;part</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14417"><span 
class="aett-10x-x-109">error)</span></span>
</div>
</div>                                                                          </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14422">   <div class="verbatim" id="verbatim-133">
##&#x00A0;[1]&#x00A0;2250
</div>
<!--l. 111--><p class="nopar" >                                                                          </span></div>-
<!--l. 115--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.4.3   </span> <a 
 id="x9-1010005.4.3"></a>Fitting the model</h4>
<!--l. 117--><p class="noindent" >We have two space-time terms on the model, each one with three hyperparameters: precision,
spatial scale, temporal scale (or temporal correlation). So, considering the likelihood, <span 
class="cmr-10x-x-109">7</span>
hyperparameters in total. To perform fast inference, we choose to have a crude mesh with with
small number of vertices.  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14448"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14424"><span 
class="aett-10x-x-109">(mesh</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14425"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14426"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor14427"><span 
class="aett-10x-x-109">(coo,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14428"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor14429"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14430"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14431"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14432"><span 
class="aett-10x-x-109">0.25</span></span><span id="textcolor14433"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14434"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;coarse</span><span 
class="aeitt-10x-x-109">&#x00A0;mesh</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14435"><span 
class="aett-10x-x-109">offset</span></span><span id="textcolor14436"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14437"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14438"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14439"><span 
class="aett-10x-x-109">0.15</span></span><span id="textcolor14440"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14441"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor14442"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14443"><span 
class="aett-10x-x-109">0.05</span></span><span id="textcolor14444"><span 
class="aett-10x-x-109">))</span></span><span id="textcolor14445"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14446"><span 
class="aett-10x-x-109">n</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-134">
##&#x00A0;[1]&#x00A0;142
</div>
<!--l. 131--><p class="nopar" >                                                                          </span></div>-
<!--l. 136--><p class="indent" >   Defining the SPDE model considering the PC-prior derived in <span class="cite">[<a 
href="spde-tutorialli2.html#Xfuglstadetal:2017">Fuglstad et&#x00A0;al., 2017</a>]</span> for the
model parameters as the practical range, <img 
src="spde-tutorial94x.png" alt="&#x221A; ---
  8&#x03BD;"  class="sqrt"  /><span 
class="cmmi-10x-x-109">&#x2215;&#x03BA;</span>, and the marginal standard deviation.
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14480"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14450"><span 
class="aett-10x-x-109">spde</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14451"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14452"><span 
class="aett-10x-x-109">inla.spde2.pcmatern</span></span><span id="textcolor14453"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14454"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor14455"><span 
class="aett-10x-x-109">=mesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14456"><span 
class="aett-10x-x-109">alpha</span></span><span id="textcolor14457"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14458"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14459"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14460"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;mesh</span><span 
class="aeitt-10x-x-109">&#x00A0;and</span><span 
class="aeitt-10x-x-109">&#x00A0;smoothness</span><span 
class="aeitt-10x-x-109">&#x00A0;parameter</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14461"><span 
class="aett-10x-x-109">prior.range</span></span><span id="textcolor14462"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14463"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14464"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14465"><span 
class="aett-10x-x-109">0.05</span></span><span id="textcolor14466"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14467"><span 
class="aett-10x-x-109">0.01</span></span><span id="textcolor14468"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14469"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;P(practic.range&#x003C;0.05)=0.01</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14470"><span 
class="aett-10x-x-109">prior.sigma</span></span><span id="textcolor14471"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14472"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14473"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14474"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14475"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14476"><span 
class="aett-10x-x-109">0.01</span></span><span id="textcolor14477"><span 
class="aett-10x-x-109">))</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14478"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;P(sigma&#x003E;1)=0.01</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 151--><p class="indent" >   We do need one set of index for each call of the <span 
class="aett-10x-x-109">f() </span>function, no matter if they are the same,
so:  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14504"></p>     
<div class="alltt">
                                                                                                                     </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14506"><div class="obeylines-v">
<span id="textcolor14482"><span 
class="aett-10x-x-109">i0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14483"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14484"><span 
class="aett-10x-x-109">inla.spde.make.index</span></span><span id="textcolor14485"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14486"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">i0</span><span 
class="tctt-1095">'</span></span><span id="textcolor14487"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;spde</span></span><span id="textcolor14488"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14489"><span 
class="aett-10x-x-109">n.spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14490"><span 
class="aett-10x-x-109">n.group</span></span><span id="textcolor14491"><span 
class="aett-10x-x-109">=k)</span></span>
<br /><span id="textcolor14492"><span 
class="aett-10x-x-109">i1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14493"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14494"><span 
class="aett-10x-x-109">inla.spde.make.index</span></span><span id="textcolor14495"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14496"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">i1</span><span 
class="tctt-1095">'</span></span><span id="textcolor14497"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;spde</span></span><span id="textcolor14498"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14499"><span 
class="aett-10x-x-109">n.spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14500"><span 
class="aett-10x-x-109">n.group</span></span><span id="textcolor14501"><span 
class="aett-10x-x-109">=k)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 162--><p class="indent" >   In the SPDE approach, the space-time model is defined in a set of mesh nodes. As we have
considered continuous time, it is also defined on a set of time knots. So, we have to deal with the
projection from the model domain (nodes, knots) to the space-time data locations. For the
intercept it is the same way as in the other examples. For the regression coefficients, we need to
account for the covariate value in the projection matrix. It can be seen as follows
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="spde-tutorial95x.png" alt="&#x03B7;  =   &#x03BC;&#x03B2;0 + &#x03BC; &#x03B2;2h + A &#x03B2;0 + (A &#x03B2;1)h
   =   &#x03BC;  + &#x03BC;  h + A &#x03B2;  + (A &#x2295; (h1 &#x2032;))&#x03B2;                  (5.1)
        &#x03B2;0    &#x03B2;1       0               1
" class="math-display"  /><a 
 id="x9-101001r5.1"></a></center>
</div>where <span 
class="cmmib-10x-x-109">A</span><span 
class="cmsy-10x-x-109">&#x2295; </span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">h</span><span 
class="cmbx-10x-x-109">1</span><sup><span 
class="cmsy-8">&#x2032;</span></sup><span 
class="cmr-10x-x-109">) </span>is the row-wise Kronecker product between <span 
class="cmmib-10x-x-109">A </span>and a the vector <span 
class="cmmib-10x-x-109">h </span>(with
length equal the number of rows in <span 
class="cmmib-10x-x-109">A</span>) expressed as the Kronecker sum of <span 
class="cmmib-10x-x-109">A </span>and <span 
class="cmmib-10x-x-109">h</span><span 
class="cmbx-10x-x-109">1</span><sup><span 
class="cmr-8">1</span></sup>.
This operation can be performed usind the <span 
class="aett-10x-x-109">inla.row.kron() </span>function and is done
internally in the function <span 
class="aett-10x-x-109">inla.spde.make.A() </span>when supplying a vector in the <span 
class="aett-10x-x-109">weights</span>
argument.
<!--l. 183--><p class="indent" >   The space-time projector matrix <span 
class="cmmib-10x-x-109">A </span>is defined as follows:  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14557"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14508"><span 
class="aett-10x-x-109">A0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14509"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14510"><span 
class="aett-10x-x-109">inla.spde.make.A</span></span><span id="textcolor14511"><span 
class="aett-10x-x-109">(mesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14512"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor14513"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14514"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor14515"><span 
class="aett-10x-x-109">(coo[,</span></span><span id="textcolor14516"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14517"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;k),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14518"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor14519"><span 
class="aett-10x-x-109">(coo[,</span></span><span id="textcolor14520"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14521"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;k)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14522"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor14523"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14524"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor14525"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14526"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14527"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor14528"><span 
class="aett-10x-x-109">k,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14529"><span 
class="aett-10x-x-109">each</span></span><span id="textcolor14530"><span 
class="aett-10x-x-109">=n))</span></span>
<br /><span id="textcolor14531"><span 
class="aett-10x-x-109">A1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14532"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14533"><span 
class="aett-10x-x-109">inla.spde.make.A</span></span><span id="textcolor14534"><span 
class="aett-10x-x-109">(mesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14535"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor14536"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14537"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor14538"><span 
class="aett-10x-x-109">(coo[,</span></span><span id="textcolor14539"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14540"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;k),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14541"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor14542"><span 
class="aett-10x-x-109">(coo[,</span></span><span id="textcolor14543"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14544"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;k)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14545"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor14546"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14547"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor14548"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14549"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14550"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor14551"><span 
class="aett-10x-x-109">k,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14552"><span 
class="aett-10x-x-109">each</span></span><span id="textcolor14553"><span 
class="aett-10x-x-109">=n),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14554"><span 
class="aett-10x-x-109">weights</span></span><span id="textcolor14555"><span 
class="aett-10x-x-109">=hh)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 195--><p class="indent" >   The data stack is as follows  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14594"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14559"><span 
class="aett-10x-x-109">stk.y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14560"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14561"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor14562"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14563"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor14564"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14565"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor14566"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14567"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor14568"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14569"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor14570"><span 
class="aett-10x-x-109">(y)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14571"><span 
class="aett-10x-x-109">tag</span></span><span id="textcolor14572"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14573"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">y</span><span 
class="tctt-1095">'</span></span><span id="textcolor14574"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14575"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor14576"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14577"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor14578"><span 
class="aett-10x-x-109">(A0,</span><span 
class="aett-10x-x-109">&#x00A0;A1,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14579"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14580"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14581"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor14582"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14583"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor14584"><span 
class="aett-10x-x-109">(i0,</span><span 
class="aett-10x-x-109">&#x00A0;i1,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14585"><span 
class="aett-10x-x-109">data.frame</span></span><span id="textcolor14586"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14587"><span 
class="aett-10x-x-109">mu1</span></span><span id="textcolor14588"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14589"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14590"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14591"><span 
class="aett-10x-x-109">h</span></span><span id="textcolor14592"><span 
class="aett-10x-x-109">=hh)))</span></span>
</div>
</div>                                                                          </span></div>-
                                                                                 
                                                                                 
<!--l. 206--><p class="indent" >   where <span 
class="aett-10x-x-109">i0 </span>is similar to <span 
class="aett-10x-x-109">i1 </span>and the elements <span 
class="aett-10x-x-109">mu1 </span>and <span 
class="aett-10x-x-109">h </span>in the second element of the effects
<span 
class="aett-10x-x-109">data.frame </span>is for <span 
class="cmmib-10x-x-109">&#x03BC;</span><sub><span 
class="cmmi-8">&#x03BE;</span></sub>.
</p><!--l. 209--><p class="indent" >   The formula take these things into account  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14637"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14596"><span 
class="aett-10x-x-109">form</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14597"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14598"><span 
class="aett-10x-x-109">y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14599"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14600"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14601"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14602"><span 
class="aett-10x-x-109">mu1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14603"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14604"><span 
class="aett-10x-x-109">h</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14605"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14606"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;to</span><span 
class="aeitt-10x-x-109">&#x00A0;fit</span><span 
class="aeitt-10x-x-109">&#x00A0;mu_beta</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14607"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor14608"><span 
class="aett-10x-x-109">(i0,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14609"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor14610"><span 
class="aett-10x-x-109">=spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14611"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor14612"><span 
class="aett-10x-x-109">=i0.group,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14613"><span 
class="aett-10x-x-109">control.group</span></span><span id="textcolor14614"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14615"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor14616"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14617"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor14618"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14619"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">ar1</span><span 
class="tctt-1095">'</span></span><span id="textcolor14620"><span 
class="aett-10x-x-109">))</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14621"><span 
class="aett-10x-x-109">+</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14622"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor14623"><span 
class="aett-10x-x-109">(i1,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14624"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor14625"><span 
class="aett-10x-x-109">=spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14626"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor14627"><span 
class="aett-10x-x-109">=i1.group,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14628"><span 
class="aett-10x-x-109">control.group</span></span><span id="textcolor14629"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14630"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor14631"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14632"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor14633"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14634"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">ar1</span><span 
class="tctt-1095">'</span></span><span id="textcolor14635"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 220--><p class="indent" >   As we have Gaussian likelihood there is no approximation in the fitting process.
The first step of the INLA algorithm is the optimization to find the mode of the <span 
class="cmr-10x-x-109">7</span>
hyperparameters in the model. By choosing good starting values it will be needed
less iteractions in this optimization process. Below, we define starting values for the
hyperparameters in the internal scale considering the values used to simute the data
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14713"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14639"><span 
class="aett-10x-x-109">(theta.ini</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14640"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14641"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14642"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14643"><span 
class="aett-10x-x-109">log</span></span><span id="textcolor14644"><span 
class="aett-10x-x-109">(taue),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14645"><span 
class="aeitt-10x-x-109">##</span><span 
class="aeitt-10x-x-109">&#x00A0;likelihood</span><span 
class="aeitt-10x-x-109">&#x00A0;log</span><span 
class="aeitt-10x-x-109">&#x00A0;precision</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14646"><span 
class="aett-10x-x-109">log</span></span><span id="textcolor14647"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14648"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor14649"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14650"><span 
class="aett-10x-x-109">8</span></span><span id="textcolor14651"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor14652"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor14653"><span 
class="aett-10x-x-109">kappa[</span></span><span id="textcolor14654"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14655"><span 
class="aett-10x-x-109">]),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14656"><span 
class="aeitt-10x-x-109">##</span><span 
class="aeitt-10x-x-109">&#x00A0;log</span><span 
class="aeitt-10x-x-109">&#x00A0;range</span><span 
class="aeitt-10x-x-109">&#x00A0;1</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14657"><span 
class="aett-10x-x-109">log</span></span><span id="textcolor14658"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14659"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor14660"><span 
class="aett-10x-x-109">(sigma2[</span></span><span id="textcolor14661"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14662"><span 
class="aett-10x-x-109">])),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14663"><span 
class="aeitt-10x-x-109">##</span><span 
class="aeitt-10x-x-109">&#x00A0;log</span><span 
class="aeitt-10x-x-109">&#x00A0;stdev</span><span 
class="aeitt-10x-x-109">&#x00A0;1</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14664"><span 
class="aett-10x-x-109">log</span></span><span id="textcolor14665"><span 
class="aett-10x-x-109">((</span></span><span id="textcolor14666"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14667"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor14668"><span 
class="aett-10x-x-109">rho[</span></span><span id="textcolor14669"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14670"><span 
class="aett-10x-x-109">])</span></span><span id="textcolor14671"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor14672"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14673"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14674"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor14675"><span 
class="aett-10x-x-109">rho[</span></span><span id="textcolor14676"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14677"><span 
class="aett-10x-x-109">])),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14678"><span 
class="aeitt-10x-x-109">##</span><span 
class="aeitt-10x-x-109">&#x00A0;inv.logit</span><span 
class="aeitt-10x-x-109">&#x00A0;rho</span><span 
class="aeitt-10x-x-109">&#x00A0;1</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14679"><span 
class="aett-10x-x-109">log</span></span><span id="textcolor14680"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14681"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor14682"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14683"><span 
class="aett-10x-x-109">8</span></span><span id="textcolor14684"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor14685"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor14686"><span 
class="aett-10x-x-109">kappa[</span></span><span id="textcolor14687"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14688"><span 
class="aett-10x-x-109">]),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14689"><span 
class="aeitt-10x-x-109">##</span><span 
class="aeitt-10x-x-109">&#x00A0;log</span><span 
class="aeitt-10x-x-109">&#x00A0;range</span><span 
class="aeitt-10x-x-109">&#x00A0;1</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14690"><span 
class="aett-10x-x-109">log</span></span><span id="textcolor14691"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14692"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor14693"><span 
class="aett-10x-x-109">(sigma2[</span></span><span id="textcolor14694"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14695"><span 
class="aett-10x-x-109">])),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14696"><span 
class="aeitt-10x-x-109">##</span><span 
class="aeitt-10x-x-109">&#x00A0;log</span><span 
class="aeitt-10x-x-109">&#x00A0;stdev</span><span 
class="aeitt-10x-x-109">&#x00A0;1</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14697"><span 
class="aett-10x-x-109">log</span></span><span id="textcolor14698"><span 
class="aett-10x-x-109">((</span></span><span id="textcolor14699"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14700"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor14701"><span 
class="aett-10x-x-109">rho[</span></span><span id="textcolor14702"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14703"><span 
class="aett-10x-x-109">])</span></span><span id="textcolor14704"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor14705"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14706"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14707"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor14708"><span 
class="aett-10x-x-109">rho[</span></span><span id="textcolor14709"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14710"><span 
class="aett-10x-x-109">]))))</span></span><span id="textcolor14711"><span 
class="aeitt-10x-x-109">##</span><span 
class="aeitt-10x-x-109">&#x00A0;inv.logit</span><span 
class="aeitt-10x-x-109">&#x00A0;rho</span><span 
class="aeitt-10x-x-109">&#x00A0;2</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-135">
##&#x00A0;[1]&#x00A0;&#x00A0;2.9957323&#x00A0;-1.2628643&#x00A0;-0.3465736&#x00A0;&#x00A0;1.7346011&#x00A0;-1.4451859&#x00A0;-0.6931472
&#x00A0;<br />##&#x00A0;[7]&#x00A0;&#x00A0;1.0986123
</div>
<!--l. 238--><p class="nopar" >                                                                          </span></div>-
<!--l. 241--><p class="indent" >   This step takes around few minutes to fit, and with bigger <span 
class="aett-10x-x-109">tolerance </span>value in
<span 
class="aett-10x-x-109">inla.control</span>, it will makes fewer posterior evaluations.
</p><!--l. 245--><p class="indent" >   The integration step when using the CCD strategy, will integrates over 79 hyperparameter
configurations, as we have <span 
class="cmr-10x-x-109">7 </span>hyperparameters. However, in the following <span 
class="aett-10x-x-109">inla() </span>call we avoid
it.
</p><!--l. 249--><p class="indent" >   Fitting the model considering the initial values defined above  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14759"></p>     
<div class="alltt">
                                                                                                                     </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14761"><div class="obeylines-v">
<span id="textcolor14715"><span 
class="aett-10x-x-109">(res</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14716"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14717"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor14718"><span 
class="aett-10x-x-109">(form,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14719"><span 
class="aett-10x-x-109">family</span></span><span id="textcolor14720"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14721"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">gaussian</span><span 
class="tctt-1095">'</span></span><span id="textcolor14722"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14723"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor14724"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14725"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor14726"><span 
class="aett-10x-x-109">(stk.y),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14727"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor14728"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14729"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor14730"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14731"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor14732"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14733"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor14734"><span 
class="aett-10x-x-109">(stk.y)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14735"><span 
class="aett-10x-x-109">control.inla</span></span><span id="textcolor14736"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14737"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor14738"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14739"><span 
class="aett-10x-x-109">int.strategy</span></span><span id="textcolor14740"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14741"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">eb</span><span 
class="tctt-1095">'</span></span><span id="textcolor14742"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14743"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;no</span><span 
class="aeitt-10x-x-109">&#x00A0;integration</span><span 
class="aeitt-10x-x-109">&#x00A0;wr</span><span 
class="aeitt-10x-x-109">&#x00A0;theta</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14744"><span 
class="aett-10x-x-109">control.mode</span></span><span id="textcolor14745"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14746"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor14747"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14748"><span 
class="aett-10x-x-109">theta</span></span><span id="textcolor14749"><span 
class="aett-10x-x-109">=theta.ini,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14750"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;initial</span><span 
class="aeitt-10x-x-109">&#x00A0;theta</span><span 
class="aeitt-10x-x-109">&#x00A0;value</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14751"><span 
class="aett-10x-x-109">restart</span></span><span id="textcolor14752"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14753"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor14754"><span 
class="aett-10x-x-109">)))</span></span><span id="textcolor14755"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14756"><span 
class="aett-10x-x-109">cpu</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-136">
##&#x00A0;&#x00A0;Pre-processing&#x00A0;&#x00A0;&#x00A0;&#x00A0;Running&#x00A0;inla&#x00A0;Post-processing&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Total
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.9579186&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;116.2767818&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.4555109&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;117.6902113
</div>
<!--l. 262--><p class="nopar" >                                                                          </span></div>-
<!--l. 266--><p class="indent" >   Summary of the <span 
class="cmmi-10x-x-109">&#x03BC;</span><sub><span 
class="cmmi-8">&#x03B2;</span></sub>:  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14774"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14763"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor14764"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14765"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor14766"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14767"><span 
class="aett-10x-x-109">true</span></span><span id="textcolor14768"><span 
class="aett-10x-x-109">=mu.beta,</span><span 
class="aett-10x-x-109">&#x00A0;res</span></span><span id="textcolor14769"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14770"><span 
class="aett-10x-x-109">summary.fix),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14771"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor14772"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-137">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;true&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant&#x00A0;0.5quant&#x00A0;0.975quant&#x00A0;&#x00A0;&#x00A0;&#x00A0;mode&#x00A0;kld
&#x00A0;<br />##&#x00A0;mu1&#x00A0;&#x00A0;&#x00A0;-5&#x00A0;-4.7481&#x00A0;0.1818&#x00A0;&#x00A0;&#x00A0;&#x00A0;-5.1050&#x00A0;&#x00A0;-4.7481&#x00A0;&#x00A0;&#x00A0;&#x00A0;-4.3915&#x00A0;-4.7481&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />##&#x00A0;h&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;0.9428&#x00A0;0.0531&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.8386&#x00A0;&#x00A0;&#x00A0;0.9428&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.0469&#x00A0;&#x00A0;0.9428&#x00A0;&#x00A0;&#x00A0;0
</div>
<!--l. 276--><p class="nopar" >                                                                          </span></div>-
<!--l. 280--><p class="indent" >   Summary for the likelihood precision  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14791"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14776"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor14777"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14778"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14779"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14780"><span 
class="aett-10x-x-109">true</span></span><span id="textcolor14781"><span 
class="aett-10x-x-109">=taue,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14782"><span 
class="aett-10x-x-109">unlist</span></span><span id="textcolor14783"><span 
class="aett-10x-x-109">(res</span></span><span id="textcolor14784"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14785"><span 
class="aett-10x-x-109">summary.hy[</span></span><span id="textcolor14786"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14787"><span 
class="aett-10x-x-109">,])),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14788"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor14789"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-138">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;true&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant&#x00A0;&#x00A0;&#x00A0;0.5quant&#x00A0;0.975quant
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;20.000&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;11.485&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.536&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;10.458&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;11.475&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;12.570
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mode
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;11.459
</div>
<!--l. 291--><p class="nopar" >                                                                          </span></div>-
                                                                                 
                                                                                 
<!--l. 295--><p class="indent" >   We can see the posterior marginal distributions for the range and standard deviation for each
spatio-temporal process in Figure&#x00A0;<a 
href="#x9-1010005.4.3">5.4.3<!--tex4ht:ref: fig:hd3pmds --></a>.  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14891"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14793"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor14794"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14795"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor14796"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14797"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14798"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14799"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14800"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14801"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor14802"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14803"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor14804"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14805"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14806"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14807"><span 
class="aett-10x-x-109">2.5</span></span><span id="textcolor14808"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14809"><span 
class="aett-10x-x-109">2.5</span></span><span id="textcolor14810"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14811"><span 
class="aett-10x-x-109">0.3</span></span><span id="textcolor14812"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14813"><span 
class="aett-10x-x-109">0.3</span></span><span id="textcolor14814"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14815"><span 
class="aett-10x-x-109">mgp</span></span><span id="textcolor14816"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14817"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14818"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14819"><span 
class="aett-10x-x-109">1.5</span></span><span id="textcolor14820"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14821"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor14822"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14823"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor14824"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor14825"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14826"><span 
class="aett-10x-x-109">(j</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14827"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14828"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14829"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor14830"><span 
class="aett-10x-x-109">7</span></span><span id="textcolor14831"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14832"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor14833"><span 
class="aett-10x-x-109">(res</span></span><span id="textcolor14834"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14835"><span 
class="aett-10x-x-109">marginals.hy[[j]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14836"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor14837"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14838"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor14839"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14840"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor14841"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14842"><span 
class="aett-10x-x-109">names</span></span><span id="textcolor14843"><span 
class="aett-10x-x-109">(res</span></span><span id="textcolor14844"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14845"><span 
class="aett-10x-x-109">marginals.hyperpar)[j],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14846"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor14847"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14848"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Density</span><span 
class="tctt-1095">'</span></span><span id="textcolor14849"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14850"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor14851"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14852"><span 
class="aett-10x-x-109">v</span></span><span id="textcolor14853"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14854"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14855"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14856"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor14857"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14858"><span 
class="aett-10x-x-109">8</span></span><span id="textcolor14859"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor14860"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor14861"><span 
class="aett-10x-x-109">kappa[</span></span><span id="textcolor14862"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14863"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;sigma2[</span></span><span id="textcolor14864"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14865"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor14866"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor14867"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor14868"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;rho[</span></span><span id="textcolor14869"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14870"><span 
class="aett-10x-x-109">],</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14871"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor14872"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14873"><span 
class="aett-10x-x-109">8</span></span><span id="textcolor14874"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor14875"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor14876"><span 
class="aett-10x-x-109">kappa[</span></span><span id="textcolor14877"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14878"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;sigma2[</span></span><span id="textcolor14879"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14880"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor14881"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor14882"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor14883"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;rho[</span></span><span id="textcolor14884"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14885"><span 
class="aett-10x-x-109">])[j</span></span><span id="textcolor14886"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor14887"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14888"><span 
class="aett-10x-x-109">])</span></span>
<br /><span id="textcolor14889"><span 
class="aett-10x-x-109">}</span></span>
</div>
</div>                                                                          </span></div>-
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x9-1010027"></a>
                                                                                 
                                                                                 
<!--l. 314--><p class="noindent" ><img 
src="spde-tutorial96x.png" alt="PIC" class="graphics" width="413.99164pt" height="220.80194pt"  /><!--tex4ht:graphics  
name="spde-tutorial96x.png" src="figs/dynamichd3pmdsf-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;5.7: </span><span  
class="content">Posterior marginal distributions for the hyperparameters of the spacetime
fields.</span></div><!--tex4ht:label?: x9-1010027 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 321--><p class="indent" >   We can have a look over the posterior mean of the dynamic coefficients. We compute the
correlation between the simulated and the posterior mean ones by  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14929"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14893"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14894"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14895"><span 
class="aett-10x-x-109">beta0</span></span><span id="textcolor14896"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14897"><span 
class="aett-10x-x-109">cor</span></span><span id="textcolor14898"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14899"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor14900"><span 
class="aett-10x-x-109">(beta0),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14901"><span 
class="aett-10x-x-109">drop</span></span><span id="textcolor14902"><span 
class="aett-10x-x-109">(A0</span></span><span id="textcolor14903"><span 
class="aett-10x-x-109">%*%</span></span><span id="textcolor14904"><span 
class="aett-10x-x-109">res</span></span><span id="textcolor14905"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14906"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor14907"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14908"><span 
class="aett-10x-x-109">i0</span></span><span id="textcolor14909"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14910"><span 
class="aett-10x-x-109">mean)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14911"><span 
class="aett-10x-x-109">beta1</span></span><span id="textcolor14912"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14913"><span 
class="aett-10x-x-109">cor</span></span><span id="textcolor14914"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14915"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor14916"><span 
class="aett-10x-x-109">(beta1),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14917"><span 
class="aett-10x-x-109">drop</span></span><span id="textcolor14918"><span 
class="aett-10x-x-109">(A0</span></span><span id="textcolor14919"><span 
class="aett-10x-x-109">%*%</span></span><span id="textcolor14920"><span 
class="aett-10x-x-109">res</span></span><span id="textcolor14921"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14922"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor14923"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14924"><span 
class="aett-10x-x-109">i1</span></span><span id="textcolor14925"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14926"><span 
class="aett-10x-x-109">mean)))</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14927"><span 
class="aeitt-10x-x-109">##</span><span 
class="aeitt-10x-x-109">&#x00A0;using</span><span 
class="aeitt-10x-x-109">&#x00A0;A0</span><span 
class="aeitt-10x-x-109">&#x00A0;to</span><span 
class="aeitt-10x-x-109">&#x00A0;account</span><span 
class="aeitt-10x-x-109">&#x00A0;only</span><span 
class="aeitt-10x-x-109">&#x00A0;for</span><span 
class="aeitt-10x-x-109">&#x00A0;the</span><span 
class="aeitt-10x-x-109">&#x00A0;coeff.</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-139">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;beta0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;beta1
&#x00A0;<br />##&#x00A0;0.9453004&#x00A0;0.6163373
</div>
<!--l. 333--><p class="nopar" >                                                                          </span></div>-
   <h3 class="sectionHead"><span class="titlemark">5.5   </span> <a 
 id="x9-1020005.5"></a>Space-time point process: Burkitt example</h3>
<!--l. 3--><p class="noindent" >In this example we show hot to fit a space-time point process using the <span 
class="aett-10x-x-109">burkitt</span>
dataset from the <span 
class="aeb10-x-x-109">splancs R </span>package. The R source for this file is available at
<a 
href="http://www.math.ntnu.no/inla/r-inla.org/tutorials/spde/R/spde-tutorial-burkitt.R" class="url" ><span 
class="aett-10x-x-109">http://www.math.ntnu.no/inla/r-_inla.org/tutorials/spde/R/spde-_tutorial-_burkitt.R</span></a>
</p><!--l. 10--><p class="indent" >   We use the <span 
class="aett-10x-x-109">burkitt </span>data set from the <span 
class="aeb10-x-x-109">splancs </span>package.
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14948"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14931"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor14932"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14933"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">burkitt</span><span 
class="tctt-1095">'</span></span><span id="textcolor14934"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14935"><span 
class="aett-10x-x-109">package</span></span><span id="textcolor14936"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14937"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">splancs</span><span 
class="tctt-1095">'</span></span><span id="textcolor14938"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor14939"><span 
class="aett-10x-x-109">t</span></span><span id="textcolor14940"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14941"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor14942"><span 
class="aett-10x-x-109">(burkitt[,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14943"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14944"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor14945"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor14946"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;summary))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-140">
##&#x00A0;&#x00A0;&#x00A0;Min.&#x00A0;1st&#x00A0;Qu.&#x00A0;Median&#x00A0;&#x00A0;&#x00A0;Mean&#x00A0;3rd&#x00A0;Qu.&#x00A0;Max.
&#x00A0;<br />##&#x00A0;x&#x00A0;&#x00A0;255&#x00A0;&#x00A0;&#x00A0;269.0&#x00A0;&#x00A0;282.5&#x00A0;&#x00A0;286.3&#x00A0;&#x00A0;&#x00A0;300.2&#x00A0;&#x00A0;335
&#x00A0;<br />##&#x00A0;y&#x00A0;&#x00A0;247&#x00A0;&#x00A0;&#x00A0;326.8&#x00A0;&#x00A0;344.5&#x00A0;&#x00A0;338.8&#x00A0;&#x00A0;&#x00A0;362.0&#x00A0;&#x00A0;399
&#x00A0;<br />##&#x00A0;t&#x00A0;&#x00A0;413&#x00A0;&#x00A0;2412.0&#x00A0;3704.0&#x00A0;3530.0&#x00A0;&#x00A0;4700.0&#x00A0;5775
</div>
<!--l. 23--><p class="nopar" >                                                                          </span></div>-
<!--l. 27--><p class="indent" >   The folowing commands shows the time when each event occurred, Figure&#x00A0;<a 
href="#x9-1020005.5">5.5<!--tex4ht:ref: fig:timeshow --></a>.
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15023"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14950"><span 
class="aett-10x-x-109">n</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14951"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14952"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor14953"><span 
class="aett-10x-x-109">(burkitt)</span></span>
<br /><span id="textcolor14954"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor14955"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14956"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor14957"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14958"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14959"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14960"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14961"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14962"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14963"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14964"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor14965"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14966"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14967"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14968"><span 
class="aett-10x-x-109">1.5</span></span><span id="textcolor14969"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14970"><span 
class="aett-10x-x-109">.1</span></span><span id="textcolor14971"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14972"><span 
class="aett-10x-x-109">.1</span></span><span id="textcolor14973"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14974"><span 
class="aett-10x-x-109">.1</span></span><span id="textcolor14975"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14976"><span 
class="aett-10x-x-109">mgp</span></span><span id="textcolor14977"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14978"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14979"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14980"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14981"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14982"><span 
class="aett-10x-x-109">0.7</span></span><span id="textcolor14983"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14984"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor14985"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor14986"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor14987"><span 
class="aett-10x-x-109">(burkitt</span></span><span id="textcolor14988"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14989"><span 
class="aett-10x-x-109">t,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14990"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor14991"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14992"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14993"><span 
class="aett-10x-x-109">,n),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14994"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor14995"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14996"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">h</span><span 
class="tctt-1095">'</span></span><span id="textcolor14997"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14998"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor14999"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15000"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15001"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor15002"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15003"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15004"><span 
class="aett-10x-x-109">axes</span></span><span id="textcolor15005"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15006"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor15007"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15008"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor15009"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15010"><span 
class="tctt-1095">''</span></span><span id="textcolor15011"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15012"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor15013"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15014"><span 
class="tctt-1095">''</span></span><span id="textcolor15015"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15016"><span 
class="aett-10x-x-109">box</span></span><span id="textcolor15017"><span 
class="aett-10x-x-109">();</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15018"><span 
class="aett-10x-x-109">axis</span></span><span id="textcolor15019"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15020"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15021"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 39--><p class="indent" >   We have to define a set of knots over time in order to fit SPDE spatio temporal model. It is
then used to built a temporal mesh  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15060"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15025"><span 
class="aett-10x-x-109">k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15026"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15027"><span 
class="aett-10x-x-109">6</span></span>
<br /><span id="textcolor15028"><span 
class="aett-10x-x-109">tknots</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15029"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15030"><span 
class="aett-10x-x-109">seq</span></span><span id="textcolor15031"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15032"><span 
class="aett-10x-x-109">min</span></span><span id="textcolor15033"><span 
class="aett-10x-x-109">(burkitt</span></span><span id="textcolor15034"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15035"><span 
class="aett-10x-x-109">t),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15036"><span 
class="aett-10x-x-109">max</span></span><span id="textcolor15037"><span 
class="aett-10x-x-109">(burkitt</span></span><span id="textcolor15038"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15039"><span 
class="aett-10x-x-109">t),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15040"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor15041"><span 
class="aett-10x-x-109">=k)</span></span>
<br /><span id="textcolor15042"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor15043"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15044"><span 
class="aett-10x-x-109">v</span></span><span id="textcolor15045"><span 
class="aett-10x-x-109">=tknots,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15046"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor15047"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15048"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor15049"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15050"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor15051"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15052"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor15053"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15054"><span 
class="aeitt-10x-x-109">##</span><span 
class="aeitt-10x-x-109">&#x00A0;add</span><span 
class="aeitt-10x-x-109">&#x00A0;to</span><span 
class="aeitt-10x-x-109">&#x00A0;plot</span></span>
<br /><span id="textcolor15055"><span 
class="aett-10x-x-109">mesh.t</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15056"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15057"><span 
class="aett-10x-x-109">inla.mesh.1d</span></span><span id="textcolor15058"><span 
class="aett-10x-x-109">(tknots)</span></span>
</div>
</div>                                                                          </span></div>-
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x9-1020018"></a>
                                                                                 
                                                                                 
<!--l. 57--><p class="noindent" ><img 
src="spde-tutorial97x.png" alt="PIC" class="graphics" width="426.79497pt" height="85.35966pt"  /><!--tex4ht:graphics  
name="spde-tutorial97x.png" src="figs/stpptimeplot-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;5.8: </span><span  
class="content">Time when each event occurred (black) and knots used for inference (blue).</span></div><!--tex4ht:label?: x9-1020018 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 63--><p class="indent" >   The spatial mesh can be done using the polygon of the region as a boundary. We can convert
the domain polygon into a <span 
class="aett-10x-x-109">SpatialPolygons </span>class with  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15077"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15062"><span 
class="aett-10x-x-109">domainSP</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15063"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15064"><span 
class="aett-10x-x-109">SpatialPolygons</span></span><span id="textcolor15065"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15066"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15067"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15068"><span 
class="aett-10x-x-109">Polygons</span></span><span id="textcolor15069"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15070"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15071"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15072"><span 
class="aett-10x-x-109">Polygon</span></span><span id="textcolor15073"><span 
class="aett-10x-x-109">(burbdy)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15074"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">0</span><span 
class="tctt-1095">'</span></span><span id="textcolor15075"><span 
class="aett-10x-x-109">)))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 74--><p class="indent" >   and the use it as a boundary  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15101"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15079"><span 
class="aett-10x-x-109">mesh.s</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15080"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15081"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor15082"><span 
class="aett-10x-x-109">(burpts,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15083"><span 
class="aett-10x-x-109">boundary</span></span><span id="textcolor15084"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15085"><span 
class="aett-10x-x-109">inla.sp2segment</span></span><span id="textcolor15086"><span 
class="aett-10x-x-109">(domainSP),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15087"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor15088"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15089"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15090"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15091"><span 
class="aett-10x-x-109">10</span></span><span id="textcolor15092"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15093"><span 
class="aett-10x-x-109">25</span></span><span id="textcolor15094"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15095"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor15096"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15097"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor15098"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15099"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;just</span><span 
class="aeitt-10x-x-109">&#x00A0;a</span><span 
class="aeitt-10x-x-109">&#x00A0;crude</span><span 
class="aeitt-10x-x-109">&#x00A0;mesh</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 84--><p class="indent" >   Defining the SPDE model considering the PC-prior derived in <span class="cite">[<a 
href="spde-tutorialli2.html#Xfuglstadetal:2017">Fuglstad et&#x00A0;al., 2017</a>]</span> for the
model parameters as the practical range, <img 
src="spde-tutorial98x.png" alt="&#x221A; ---
  8&#x03BD;"  class="sqrt"  /><span 
class="cmmi-10x-x-109">&#x2215;&#x03BA;</span>, and the marginal standard deviation.
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15138"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15103"><span 
class="aett-10x-x-109">spde</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15104"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15105"><span 
class="aett-10x-x-109">inla.spde2.pcmatern</span></span><span id="textcolor15106"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15107"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor15108"><span 
class="aett-10x-x-109">=mesh.s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15109"><span 
class="aett-10x-x-109">alpha</span></span><span id="textcolor15110"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15111"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15112"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15113"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;mesh</span><span 
class="aeitt-10x-x-109">&#x00A0;and</span><span 
class="aeitt-10x-x-109">&#x00A0;smoothness</span><span 
class="aeitt-10x-x-109">&#x00A0;parameter</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15114"><span 
class="aett-10x-x-109">prior.range</span></span><span id="textcolor15115"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15116"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15117"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15118"><span 
class="aett-10x-x-109">0.05</span></span><span id="textcolor15119"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15120"><span 
class="aett-10x-x-109">0.01</span></span><span id="textcolor15121"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15122"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;P(practic.range&#x003C;0.05)=0.01</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15123"><span 
class="aett-10x-x-109">prior.sigma</span></span><span id="textcolor15124"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15125"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15126"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15127"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15128"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15129"><span 
class="aett-10x-x-109">0.01</span></span><span id="textcolor15130"><span 
class="aett-10x-x-109">))</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15131"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;P(sigma&#x003E;1)=0.01</span></span>
<br /><span id="textcolor15132"><span 
class="aett-10x-x-109">m</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15133"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15134"><span 
class="aett-10x-x-109">spde</span></span><span id="textcolor15135"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15136"><span 
class="aett-10x-x-109">n.spde</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 100--><p class="indent" >   The spatio temporal projector matrix is made considering both spatial and temporal
locations and both spatial and temporal meshes.  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15163"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15140"><span 
class="aett-10x-x-109">dim</span></span><span id="textcolor15141"><span 
class="aett-10x-x-109">(Ast</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15142"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15143"><span 
class="aett-10x-x-109">inla.spde.make.A</span></span><span id="textcolor15144"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15145"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor15146"><span 
class="aett-10x-x-109">=mesh.s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15147"><span 
class="aett-10x-x-109">loc</span></span><span id="textcolor15148"><span 
class="aett-10x-x-109">=burpts,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15149"><span 
class="aett-10x-x-109">n.group</span></span><span id="textcolor15150"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15151"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor15152"><span 
class="aett-10x-x-109">(mesh.t</span></span><span id="textcolor15153"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15154"><span 
class="aett-10x-x-109">n),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15155"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor15156"><span 
class="aett-10x-x-109">=burkitt</span></span><span id="textcolor15157"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15158"><span 
class="aett-10x-x-109">t,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15159"><span 
class="aett-10x-x-109">group.mesh</span></span><span id="textcolor15160"><span 
class="aett-10x-x-109">=mesh.t))</span></span>
</div>
</div>                                                                          </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15165">   <div class="verbatim" id="verbatim-141">
##&#x00A0;[1]&#x00A0;&#x00A0;188&#x00A0;3234
</div>
<!--l. 110--><p class="nopar" >                                                                          </span></div>-
<!--l. 113--><p class="indent" >   Internally <span 
class="aett-10x-x-109">inla.spde.make.A </span>function makes a row Kronecker product (see <span 
class="aett-10x-x-109">inla.row.kron</span>)
between the spatial projector and the group (temporal in our case) projector. This matrix has
number of columns equals to the number of nodes in the mesh times the number of
groups.
</p><!--l. 117--><p class="indent" >   The index set is made considering the group feature:  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15180"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15167"><span 
class="aett-10x-x-109">idx</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15168"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15169"><span 
class="aett-10x-x-109">inla.spde.make.index</span></span><span id="textcolor15170"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15171"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">s</span><span 
class="tctt-1095">'</span></span><span id="textcolor15172"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;spde</span></span><span id="textcolor15173"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15174"><span 
class="aett-10x-x-109">n.spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15175"><span 
class="aett-10x-x-109">n.group</span></span><span id="textcolor15176"><span 
class="aett-10x-x-109">=mesh.t</span></span><span id="textcolor15177"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15178"><span 
class="aett-10x-x-109">n)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 126--><p class="indent" >   The data stack can be made considering the ideas for the purerly spatial model. So, we do
need to consider the expected number of cases at the 1) integration points and 2) data locations.
For the integration points it is the spacetime volume computed for each mesh node and time
knot, considering the spatial area of the dual mesh polygons, as in Chapter&#x00A0;<a 
href="spde-tutorialch4.html#x8-710004">4<!--tex4ht:ref: ch:lcox --></a>, times the the
length of the time window at each time point. For the data locations it is zero as for a point the
expectation is zero, in accord to the likelihood approximation proposed by <span class="cite">[<a 
href="spde-tutorialli2.html#Xsimpsonetal:2016">Simpson et&#x00A0;al.,
2016</a>]</span>.
</p><!--l. 137--><p class="indent" >   The dual mesh is extracted considering the function <span 
class="aett-10x-x-109">inla.mesh.dual()</span>, available in
<a 
href="http://www.math.ntnu.no/inla/r-inla.org/tutorials/spde/R/spde-tutorial-functions.R" class="url" ><span 
class="aett-10x-x-109">http://www.math.ntnu.no/inla/r-_inla.org/tutorials/spde/R/spde-_tutorial-_functions.R</span></a>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15191"></p>   
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15182"><span 
class="aett-10x-x-109">source</span></span><span id="textcolor15183"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15184"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">R/spde-tutorial-functions.R</span><span 
class="tctt-1095">'</span></span><span id="textcolor15185"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15186"><span 
class="aett-10x-x-109">dmesh</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15187"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15188"><span 
class="aett-10x-x-109">inla.mesh.dual</span></span><span id="textcolor15189"><span 
class="aett-10x-x-109">(mesh.s)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 150--><p class="indent" >   Them, we compute the intersection with each polygon from the mesh dual using the
functions <span 
class="aett-10x-x-109">gIntersection() </span>from the <span 
class="aessbx-10x-x-109">rgeos </span>package (show the sum of the intersection polygons
areas):  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15226"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15193"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor15194"><span 
class="aett-10x-x-109">(rgeos)</span></span>
<br /><span id="textcolor15195"><span 
class="aett-10x-x-109">sum</span></span><span id="textcolor15196"><span 
class="aett-10x-x-109">(w</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15197"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15198"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor15199"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15200"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15201"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor15202"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor15203"><span 
class="aett-10x-x-109">(dmesh),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15204"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor15205"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15206"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor15207"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15208"><span 
class="aett-10x-x-109">if</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15209"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15210"><span 
class="aett-10x-x-109">gIntersects</span></span><span id="textcolor15211"><span 
class="aett-10x-x-109">(dmesh[i,],</span><span 
class="aett-10x-x-109">&#x00A0;domainSP))</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15212"><span 
class="aett-10x-x-109">return</span></span><span id="textcolor15213"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15214"><span 
class="aett-10x-x-109">gArea</span></span><span id="textcolor15215"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15216"><span 
class="aett-10x-x-109">gIntersection</span></span><span id="textcolor15217"><span 
class="aett-10x-x-109">(dmesh[i,],</span><span 
class="aett-10x-x-109">&#x00A0;domainSP)))</span></span>                 </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15228"><br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15218"><span 
class="aett-10x-x-109">else</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15219"><span 
class="aett-10x-x-109">return</span></span><span id="textcolor15220"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15221"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15222"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15223"><span 
class="aett-10x-x-109">}))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-142">
##&#x00A0;[1]&#x00A0;11035.01
</div>
<!--l. 167--><p class="nopar" >                                                                          </span></div>-
<!--l. 170--><p class="indent" >   We can see that it sum up the same as the domain area:  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15233"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15230"><span 
class="aett-10x-x-109">gArea</span></span><span id="textcolor15231"><span 
class="aett-10x-x-109">(domainSP)</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-143">
##&#x00A0;[1]&#x00A0;11035.01
</div>
<!--l. 178--><p class="nopar" >                                                                          </span></div>-
<!--l. 182--><p class="indent" >   The spatio temporal volume is the product of these values and the time window length of
each time knot.  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15249"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15235"><span 
class="aett-10x-x-109">st.vol</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15236"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15237"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor15238"><span 
class="aett-10x-x-109">(w,</span><span 
class="aett-10x-x-109">&#x00A0;k)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15239"><span 
class="aett-10x-x-109">*</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15240"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor15241"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15242"><span 
class="aett-10x-x-109">diag</span></span><span id="textcolor15243"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15244"><span 
class="aett-10x-x-109">inla.mesh.fem</span></span><span id="textcolor15245"><span 
class="aett-10x-x-109">(mesh.t)</span></span><span id="textcolor15246"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15247"><span 
class="aett-10x-x-109">c0),</span><span 
class="aett-10x-x-109">&#x00A0;m)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 191--><p class="indent" >   The data stack is built using  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15314"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15251"><span 
class="aett-10x-x-109">y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15252"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15253"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor15254"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15255"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15256"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor15257"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15258"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15259"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15260"><span 
class="aett-10x-x-109">(k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15261"><span 
class="aett-10x-x-109">*</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15262"><span 
class="aett-10x-x-109">m,</span><span 
class="aett-10x-x-109">&#x00A0;n))</span></span>
<br /><span id="textcolor15263"><span 
class="aett-10x-x-109">expected</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15264"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15265"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15266"><span 
class="aett-10x-x-109">(st.vol,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15267"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor15268"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15269"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15270"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;n))</span></span>
<br /><span id="textcolor15271"><span 
class="aett-10x-x-109">stk</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15272"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15273"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor15274"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15275"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor15276"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15277"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15278"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15279"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor15280"><span 
class="aett-10x-x-109">=y,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15281"><span 
class="aett-10x-x-109">expect</span></span><span id="textcolor15282"><span 
class="aett-10x-x-109">=expected),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15283"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor15284"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15285"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15286"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15287"><span 
class="aett-10x-x-109">rBind</span></span><span id="textcolor15288"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15289"><span 
class="aett-10x-x-109">Diagonal</span></span><span id="textcolor15290"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15291"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor15292"><span 
class="aett-10x-x-109">=k</span></span><span id="textcolor15293"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor15294"><span 
class="aett-10x-x-109">m),</span><span 
class="aett-10x-x-109">&#x00A0;Ast),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15295"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15296"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15297"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor15298"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15299"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15300"><span 
class="aett-10x-x-109">(idx,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15301"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15302"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15303"><span 
class="aett-10x-x-109">a0</span></span><span id="textcolor15304"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15305"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor15306"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15307"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15308"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;k</span></span><span id="textcolor15309"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor15310"><span 
class="aett-10x-x-109">m</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15311"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15312"><span 
class="aett-10x-x-109">n))))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 204--><p class="indent" >   Model fitting (using the cruder approximation: &#8217;gaussian&#8217;)  
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15391"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15316"><span 
class="aett-10x-x-109">pcrho</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15317"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15318"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15319"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15320"><span 
class="aett-10x-x-109">prior</span></span><span id="textcolor15321"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15322"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">pccor1</span><span 
class="tctt-1095">'</span></span><span id="textcolor15323"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15324"><span 
class="aett-10x-x-109">param</span></span><span id="textcolor15325"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15326"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15327"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15328"><span 
class="aett-10x-x-109">0.7</span></span><span id="textcolor15329"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15330"><span 
class="aett-10x-x-109">0.7</span></span><span id="textcolor15331"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor15332"><span 
class="aett-10x-x-109">form</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15333"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15334"><span 
class="aett-10x-x-109">y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15335"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15336"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15337"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15338"><span 
class="aett-10x-x-109">a0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15339"><span 
class="aett-10x-x-109">+</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15340"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor15341"><span 
class="aett-10x-x-109">(s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15342"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor15343"><span 
class="aett-10x-x-109">=spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15344"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor15345"><span 
class="aett-10x-x-109">=s.group,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15346"><span 
class="aett-10x-x-109">control.group</span></span><span id="textcolor15347"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15348"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15349"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15350"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor15351"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15352"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">ar1</span><span 
class="tctt-1095">'</span></span><span id="textcolor15353"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15354"><span 
class="aett-10x-x-109">hyper</span></span><span id="textcolor15355"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15356"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15357"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15358"><span 
class="aett-10x-x-109">theta</span></span><span id="textcolor15359"><span 
class="aett-10x-x-109">=pcrho)))</span></span>
<br /><span id="textcolor15360"><span 
class="aett-10x-x-109">burk.res</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15361"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15362"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor15363"><span 
class="aett-10x-x-109">(form,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15364"><span 
class="aett-10x-x-109">family</span></span><span id="textcolor15365"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15366"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">poisson</span><span 
class="tctt-1095">'</span></span><span id="textcolor15367"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15368"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor15369"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15370"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor15371"><span 
class="aett-10x-x-109">(stk),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15372"><span 
class="aett-10x-x-109">E</span></span><span id="textcolor15373"><span 
class="aett-10x-x-109">=expect,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15374"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor15375"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15376"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15377"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15378"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor15379"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15380"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor15381"><span 
class="aett-10x-x-109">(stk)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15382"><span 
class="aett-10x-x-109">control.inla</span></span><span id="textcolor15383"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15384"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15385"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15386"><span 
class="aett-10x-x-109">strategy</span></span><span id="textcolor15387"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15388"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">gaussian</span><span 
class="tctt-1095">'</span></span><span id="textcolor15389"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 220--><p class="indent" >   The exponential of the intercept plus the random effect at each spacetime integration point is
the relative risk at each these points. This relative risk times the spacetime volume will give the
expected number of points at each these spacetime locations. Summing it will approaches the
number of observations:  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15422"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15393"><span 
class="aett-10x-x-109">eta.at.integration.points</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15394"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15395"><span 
class="aett-10x-x-109">burk.res</span></span><span id="textcolor15396"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15397"><span 
class="aett-10x-x-109">summary.fix[</span></span><span id="textcolor15398"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15399"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15400"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15401"><span 
class="aett-10x-x-109">]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15402"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15403"><span 
class="aett-10x-x-109">burk.res</span></span><span id="textcolor15404"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15405"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor15406"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15407"><span 
class="aett-10x-x-109">s</span></span><span id="textcolor15408"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15409"><span 
class="aett-10x-x-109">mean</span></span>
<br /><span id="textcolor15410"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15411"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15412"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor15413"><span 
class="aett-10x-x-109">=n,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15414"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">E(n)</span><span 
class="tctt-1095">'</span></span><span id="textcolor15415"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15416"><span 
class="aett-10x-x-109">sum</span></span><span id="textcolor15417"><span 
class="aett-10x-x-109">(st.vol</span></span><span id="textcolor15418"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor15419"><span 
class="aett-10x-x-109">exp</span></span><span id="textcolor15420"><span 
class="aett-10x-x-109">(eta.at.integration.points)))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-144">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;n&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;E(n)
&#x00A0;<br />##&#x00A0;188.0000&#x00A0;187.9949
</div>
<!--l. 232--><p class="nopar" >                                                                          </span></div>-
<!--l. 236--><p class="indent" >   We can plot the posterior marginal distributions for the intercept and parameters, in
Figure&#x00A0;<a 
href="#x9-1020005.5">5.5<!--tex4ht:ref: fig:irf --></a>, with  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15537"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15424"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor15425"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15426"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor15427"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15428"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15429"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15430"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15431"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15432"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15433"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15434"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor15435"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15436"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15437"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15438"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor15439"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15440"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor15441"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15442"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15443"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15444"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15445"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15446"><span 
class="aett-10x-x-109">mgp</span></span><span id="textcolor15447"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15448"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15449"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15450"><span 
class="aett-10x-x-109">1.7</span></span><span id="textcolor15451"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15452"><span 
class="aett-10x-x-109">0.7</span></span><span id="textcolor15453"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15454"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15455"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor15456"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor15457"><span 
class="aett-10x-x-109">(burk.res</span></span><span id="textcolor15458"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15459"><span 
class="aett-10x-x-109">marginals.fix[[</span></span><span id="textcolor15460"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15461"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15462"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor15463"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15464"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor15465"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15466"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor15467"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15468"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Intercept</span><span 
class="tctt-1095">'</span></span><span id="textcolor15469"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15470"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor15471"><span 
class="aett-10x-x-109">(burk.res</span></span><span id="textcolor15472"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15473"><span 
class="aett-10x-x-109">marginals.hy[[</span></span><span id="textcolor15474"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15475"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15476"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor15477"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15478"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor15479"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15480"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor15481"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15482"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15483"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15484"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15485"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15486"><span 
class="aett-10x-x-109">10</span></span><span id="textcolor15487"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15488"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor15489"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15490"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Practical</span><span 
class="aett-10x-x-109">&#x00A0;range</span><span 
class="tctt-1095">'</span></span><span id="textcolor15491"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15492"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor15493"><span 
class="aett-10x-x-109">(burk.res</span></span><span id="textcolor15494"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15495"><span 
class="aett-10x-x-109">marginals.hy[[</span></span><span id="textcolor15496"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15497"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15498"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor15499"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15500"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor15501"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15502"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor15503"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15504"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15505"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15506"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15507"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15508"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor15509"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15510"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor15511"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15512"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Standard</span><span 
class="aett-10x-x-109">&#x00A0;deviation</span><span 
class="tctt-1095">'</span></span><span id="textcolor15513"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15514"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor15515"><span 
class="aett-10x-x-109">(burk.res</span></span><span id="textcolor15516"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15517"><span 
class="aett-10x-x-109">marginals.hy[[</span></span><span id="textcolor15518"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor15519"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15520"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor15521"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15522"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor15523"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15524"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor15525"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15526"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15527"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15528"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15529"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15530"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15531"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15532"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor15533"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15534"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">time</span><span 
class="aett-10x-x-109">&#x00A0;correlation</span><span 
class="tctt-1095">'</span></span><span id="textcolor15535"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>                                                                          </span></div>-
                                                                                 
                                                                                 
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x9-1020029"></a>
                                                                                 
                                                                                 
<!--l. 254--><p class="noindent" ><img 
src="spde-tutorial99x.png" alt="PIC" class="graphics" width="413.99164pt" height="295.71414pt"  /><!--tex4ht:graphics  
name="spde-tutorial99x.png" src="figs/stppparsfig-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;5.9: </span><span  
class="content">Intercept and Random Field parameters posterior marginal distributions.</span></div><!--tex4ht:label?: x9-1020029 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 260--><p class="indent" >   The projection over a grid for each time knot can be done with  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15630"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15539"><span 
class="aett-10x-x-109">r0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15540"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15541"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor15542"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15543"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor15544"><span 
class="aett-10x-x-109">(burbdy[,</span></span><span id="textcolor15545"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15546"><span 
class="aett-10x-x-109">]))</span></span><span id="textcolor15547"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor15548"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor15549"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15550"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor15551"><span 
class="aett-10x-x-109">(burbdy[,</span></span><span id="textcolor15552"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15553"><span 
class="aett-10x-x-109">]))</span></span>
<br /><span id="textcolor15554"><span 
class="aett-10x-x-109">prj</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15555"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15556"><span 
class="aett-10x-x-109">inla.mesh.projector</span></span><span id="textcolor15557"><span 
class="aett-10x-x-109">(mesh.s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15558"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor15559"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15560"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor15561"><span 
class="aett-10x-x-109">(burbdy[,</span></span><span id="textcolor15562"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15563"><span 
class="aett-10x-x-109">]),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15564"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor15565"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15566"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor15567"><span 
class="aett-10x-x-109">(burbdy[,</span></span><span id="textcolor15568"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15569"><span 
class="aett-10x-x-109">]),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15570"><span 
class="aett-10x-x-109">dims</span></span><span id="textcolor15571"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15572"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15573"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15574"><span 
class="aett-10x-x-109">100</span></span><span id="textcolor15575"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15576"><span 
class="aett-10x-x-109">100</span></span><span id="textcolor15577"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor15578"><span 
class="aett-10x-x-109">r0))</span></span>
<br /><span id="textcolor15579"><span 
class="aett-10x-x-109">ov</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15580"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15581"><span 
class="aett-10x-x-109">over</span></span><span id="textcolor15582"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15583"><span 
class="aett-10x-x-109">SpatialPoints</span></span><span id="textcolor15584"><span 
class="aett-10x-x-109">(prj</span></span><span id="textcolor15585"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15586"><span 
class="aett-10x-x-109">lattice</span></span><span id="textcolor15587"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15588"><span 
class="aett-10x-x-109">loc),</span><span 
class="aett-10x-x-109">&#x00A0;domainSP)</span></span>
<br /><span id="textcolor15589"><span 
class="aett-10x-x-109">m.prj</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15590"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15591"><span 
class="aett-10x-x-109">lapply</span></span><span id="textcolor15592"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15593"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15594"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor15595"><span 
class="aett-10x-x-109">k,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15596"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor15597"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15598"><span 
class="aett-10x-x-109">j</span></span><span id="textcolor15599"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15600"><span 
class="aett-10x-x-109">r</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15601"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15602"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor15603"><span 
class="aett-10x-x-109">(prj,</span><span 
class="aett-10x-x-109">&#x00A0;burk.res</span></span><span id="textcolor15604"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15605"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor15606"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15607"><span 
class="aett-10x-x-109">s</span></span><span id="textcolor15608"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15609"><span 
class="aett-10x-x-109">mean[</span></span><span id="textcolor15610"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15611"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor15612"><span 
class="aett-10x-x-109">m</span></span><span id="textcolor15613"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor15614"><span 
class="aett-10x-x-109">(j</span></span><span id="textcolor15615"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor15616"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15617"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor15618"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor15619"><span 
class="aett-10x-x-109">m])</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15620"><span 
class="aett-10x-x-109">r[</span></span><span id="textcolor15621"><span 
class="aett-10x-x-109">is.na</span></span><span id="textcolor15622"><span 
class="aett-10x-x-109">(ov)]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15623"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15624"><span 
class="aett-10x-x-109">NA</span></span><span id="textcolor15625"><span 
class="aett-10x-x-109">;</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15626"><span 
class="aett-10x-x-109">return</span></span><span id="textcolor15627"><span 
class="aett-10x-x-109">(r)</span></span>
<br /><span id="textcolor15628"><span 
class="aett-10x-x-109">})</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 276--><p class="indent" >   The fitted latent field at each time knot is in Figure&#x00A0;<a 
href="#x9-1020005.5">5.5<!--tex4ht:ref: fig:stppres --></a>, produced with the code below. It
can also be done for the standard deviation.  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15744"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15632"><span 
class="aett-10x-x-109">igr</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15633"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15634"><span 
class="aett-10x-x-109">apply</span></span><span id="textcolor15635"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15636"><span 
class="aett-10x-x-109">abs</span></span><span id="textcolor15637"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15638"><span 
class="aett-10x-x-109">outer</span></span><span id="textcolor15639"><span 
class="aett-10x-x-109">(burkitt</span></span><span id="textcolor15640"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15641"><span 
class="aett-10x-x-109">t,</span><span 
class="aett-10x-x-109">&#x00A0;mesh.t</span></span><span id="textcolor15642"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15643"><span 
class="aett-10x-x-109">loc,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15644"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">-</span><span 
class="tctt-1095">'</span></span><span id="textcolor15645"><span 
class="aett-10x-x-109">)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15646"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15647"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;which.min)</span></span>
<br /><span id="textcolor15648"><span 
class="aett-10x-x-109">zlm</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15649"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15650"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor15651"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15652"><span 
class="aett-10x-x-109">unlist</span></span><span id="textcolor15653"><span 
class="aett-10x-x-109">(m.prj),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15654"><span 
class="aett-10x-x-109">na.rm</span></span><span id="textcolor15655"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15656"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor15657"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15658"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor15659"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15660"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor15661"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15662"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15663"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15664"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15665"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15666"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor15667"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15668"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor15669"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15670"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15671"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15672"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15673"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15674"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15675"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15676"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15677"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15678"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15679"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor15680"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15681"><span 
class="aett-10x-x-109">(j</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15682"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15683"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15684"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor15685"><span 
class="aett-10x-x-109">k)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15686"><span 
class="aett-10x-x-109">image</span></span><span id="textcolor15687"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15688"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor15689"><span 
class="aett-10x-x-109">=prj</span></span><span id="textcolor15690"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15691"><span 
class="aett-10x-x-109">x,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15692"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor15693"><span 
class="aett-10x-x-109">=prj</span></span><span id="textcolor15694"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15695"><span 
class="aett-10x-x-109">y,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15696"><span 
class="aett-10x-x-109">z</span></span><span id="textcolor15697"><span 
class="aett-10x-x-109">=m.prj[[j]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15698"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor15699"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15700"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15701"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15702"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor15703"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15704"><span 
class="tctt-1095">''</span></span><span id="textcolor15705"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15706"><span 
class="aett-10x-x-109">zlim</span></span><span id="textcolor15707"><span 
class="aett-10x-x-109">=zlm,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15708"><span 
class="aett-10x-x-109">axes</span></span><span id="textcolor15709"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15710"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor15711"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15712"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor15713"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15714"><span 
class="aett-10x-x-109">tim.colors</span></span><span id="textcolor15715"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15716"><span 
class="aett-10x-x-109">64</span></span><span id="textcolor15717"><span 
class="aett-10x-x-109">))</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15718"><span 
class="aett-10x-x-109">points</span></span><span id="textcolor15719"><span 
class="aett-10x-x-109">(burkitt[igr</span></span><span id="textcolor15720"><span 
class="aett-10x-x-109">==</span></span><span id="textcolor15721"><span 
class="aett-10x-x-109">j,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15722"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15723"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor15724"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15725"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15726"><span 
class="aett-10x-x-109">pch</span></span><span id="textcolor15727"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15728"><span 
class="aett-10x-x-109">19</span></span><span id="textcolor15729"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15730"><span 
class="aett-10x-x-109">};</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15731"><span 
class="aett-10x-x-109">image.plot</span></span><span id="textcolor15732"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15733"><span 
class="aett-10x-x-109">legend.only</span></span><span id="textcolor15734"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15735"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor15736"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15737"><span 
class="aett-10x-x-109">zlim</span></span><span id="textcolor15738"><span 
class="aett-10x-x-109">=zlm,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15739"><span 
class="aett-10x-x-109">legend.mar</span></span><span id="textcolor15740"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15741"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor15742"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>                                                                          </span></div>-
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x9-10200310"></a>
                                                                                 
                                                                                 
<!--l. 296--><p class="noindent" ><img 
src="spde-tutorial100x.png" alt="PIC" class="graphics" width="413.99164pt" height="579.59357pt"  /><!--tex4ht:graphics  
name="spde-tutorial100x.png" src="figs/stppstppres-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;5.10: </span><span  
class="content">Fitted latent field at each time knot overlayed by the points closer in time.</span></div><!--tex4ht:label?: x9-10200310 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
   <h3 class="sectionHead"><span class="titlemark">5.6   </span> <a 
 id="x9-1030005.6"></a>Large point process data set</h3>
<!--l. 7--><p class="noindent" >In this chapter we show how an approach to fit a spatio temporal log-Cox point
process model for a large data sets. We are going to drawn samples from a
separable space time intensity function. The R source for this file is available at
<a 
href="http://www.math.ntnu.no/inla/r-inla.org/tutorials/spde/R/spde-tutorial-stpp.R" class="url" ><span 
class="aett-10x-x-109">http://www.math.ntnu.no/inla/r-_inla.org/tutorials/spde/R/spde-_tutorial-_stpp.R</span></a>
</p><!--l. 13--><p class="indent" >   First we define the spatial domain as follows  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15803"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15746"><span 
class="aett-10x-x-109">x0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15747"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15748"><span 
class="aett-10x-x-109">seq</span></span><span id="textcolor15749"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15750"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15751"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15752"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor15753"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor15754"><span 
class="aett-10x-x-109">pi,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15755"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor15756"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15757"><span 
class="aett-10x-x-109">15</span></span><span id="textcolor15758"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15759"><span 
class="aett-10x-x-109">domain</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15760"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15761"><span 
class="aett-10x-x-109">data.frame</span></span><span id="textcolor15762"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15763"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor15764"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15765"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15766"><span 
class="aett-10x-x-109">(x0,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15767"><span 
class="aett-10x-x-109">rev</span></span><span id="textcolor15768"><span 
class="aett-10x-x-109">(x0),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15769"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15770"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor15771"><span 
class="aett-10x-x-109">domain</span></span><span id="textcolor15772"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15773"><span 
class="aett-10x-x-109">y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15774"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15775"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15776"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15777"><span 
class="aett-10x-x-109">sin</span></span><span id="textcolor15778"><span 
class="aett-10x-x-109">(x0</span></span><span id="textcolor15779"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor15780"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15781"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor15782"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor15783"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15784"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15785"><span 
class="aett-10x-x-109">sin</span></span><span id="textcolor15786"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15787"><span 
class="aett-10x-x-109">rev</span></span><span id="textcolor15788"><span 
class="aett-10x-x-109">(x0</span></span><span id="textcolor15789"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor15790"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15791"><span 
class="aett-10x-x-109">))</span></span><span id="textcolor15792"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor15793"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15794"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15795"><span 
class="aett-10x-x-109">sin</span></span><span id="textcolor15796"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15797"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15798"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor15799"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor15800"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15801"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 23--><p class="indent" >   and convert it into the <span 
class="aett-10x-x-109">SpatialPolygons </span>class  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15822"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15805"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor15806"><span 
class="aett-10x-x-109">(sp)</span></span>
<br /><span id="textcolor15807"><span 
class="aett-10x-x-109">domainSP</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15808"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15809"><span 
class="aett-10x-x-109">SpatialPolygons</span></span><span id="textcolor15810"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15811"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15812"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15813"><span 
class="aett-10x-x-109">Polygons</span></span><span id="textcolor15814"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15815"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15816"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15817"><span 
class="aett-10x-x-109">Polygon</span></span><span id="textcolor15818"><span 
class="aett-10x-x-109">(domain)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15819"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">0</span><span 
class="tctt-1095">'</span></span><span id="textcolor15820"><span 
class="aett-10x-x-109">)))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 33--><p class="indent" >   We choose to sample a dataset using the <span 
class="aessbx-10x-x-109">lgcp</span>, <span class="cite">[<a 
href="spde-tutorialli2.html#XtaylorDRD:2013">Taylor et&#x00A0;al., 2013</a>]</span>, package as follows
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15881"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15824"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor15825"><span 
class="aett-10x-x-109">(lgcp)</span></span>
<br /><span id="textcolor15826"><span 
class="aett-10x-x-109">ndays</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15827"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15828"><span 
class="aett-10x-x-109">15</span></span>
<br /><span id="textcolor15829"><span 
class="aett-10x-x-109">n</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15830"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15831"><span 
class="aett-10x-x-109">(xyt</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15832"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15833"><span 
class="aett-10x-x-109">lgcpSim</span></span><span id="textcolor15834"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15835"><span 
class="aett-10x-x-109">owin</span></span><span id="textcolor15836"><span 
class="aett-10x-x-109">=spatstat</span></span><span id="textcolor15837"><span 
class="aett-10x-x-109">:::</span></span><span id="textcolor15838"><span 
class="aett-10x-x-109">owin</span></span><span id="textcolor15839"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15840"><span 
class="aett-10x-x-109">poly</span></span><span id="textcolor15841"><span 
class="aett-10x-x-109">=domain),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15842"><span 
class="aett-10x-x-109">tlim</span></span><span id="textcolor15843"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15844"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15845"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15846"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15847"><span 
class="aett-10x-x-109">,ndays),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15848"><span 
class="aett-10x-x-109">model.parameters</span></span><span id="textcolor15849"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15850"><span 
class="aett-10x-x-109">lgcppars</span></span><span id="textcolor15851"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15852"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15853"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15854"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor15855"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15856"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor15857"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15858"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15859"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15860"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor15861"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15862"><span 
class="aett-10x-x-109">cellwidth</span></span><span id="textcolor15863"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15864"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor15865"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15866"><span 
class="aett-10x-x-109">spatial.covmodel</span></span><span id="textcolor15867"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15868"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">matern</span><span 
class="tctt-1095">'</span></span><span id="textcolor15869"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15870"><span 
class="aett-10x-x-109">covpars</span></span><span id="textcolor15871"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15872"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15873"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15874"><span 
class="aett-10x-x-109">nu</span></span><span id="textcolor15875"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15876"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15877"><span 
class="aett-10x-x-109">)))</span></span><span id="textcolor15878"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15879"><span 
class="aett-10x-x-109">n</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 48--><p class="indent" >   In order to fit the model, we do need to define a discretization over space and over time.
For the time domain, we define a temporal mesh based on a number of time knots:
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15897"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15883"><span 
class="aett-10x-x-109">k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15884"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15885"><span 
class="aett-10x-x-109">7</span></span><span id="textcolor15886"><span 
class="aett-10x-x-109">;</span><span 
class="aett-10x-x-109">&#x00A0;tmesh</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15887"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15888"><span 
class="aett-10x-x-109">inla.mesh.1d</span></span><span id="textcolor15889"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15890"><span 
class="aett-10x-x-109">seq</span></span><span id="textcolor15891"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15892"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15893"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;ndays,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15894"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor15895"><span 
class="aett-10x-x-109">=k))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 57--><p class="indent" >   The spatial mesh is defined using the domain polygon:  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15916"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15899"><span 
class="aett-10x-x-109">smesh</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15900"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15901"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor15902"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15903"><span 
class="aett-10x-x-109">boundary</span></span><span id="textcolor15904"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15905"><span 
class="aett-10x-x-109">inla.sp2segment</span></span><span id="textcolor15906"><span 
class="aett-10x-x-109">(domainSP),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15907"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor15908"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15909"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15910"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15911"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor15912"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15913"><span 
class="aett-10x-x-109">0.3</span></span><span id="textcolor15914"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 67--><p class="indent" >   We can have a look in Figure&#x00A0;<a 
href="#x9-1030005.6">5.6<!--tex4ht:ref: fig:stlppshow --></a> to see a plot of a sample of the data over time, the
time knots and over space and the spatial mesh as well with the commands below
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16045"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15918"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor15919"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15920"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor15921"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15922"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15923"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15924"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15925"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15926"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15927"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15928"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor15929"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15930"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15931"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15932"><span 
class="aett-10x-x-109">1.5</span></span><span id="textcolor15933"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15934"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15935"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15936"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15937"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15938"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15939"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15940"><span 
class="aett-10x-x-109">mgp</span></span><span id="textcolor15941"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15942"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15943"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15944"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15945"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15946"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor15947"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15948"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15949"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor15950"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor15951"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15952"><span 
class="aett-10x-x-109">sample</span></span><span id="textcolor15953"><span 
class="aett-10x-x-109">(xyt</span></span><span id="textcolor15954"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15955"><span 
class="aett-10x-x-109">t,</span></span><span id="textcolor15956"><span 
class="aett-10x-x-109">500</span></span><span id="textcolor15957"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15958"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor15959"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15960"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15961"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15962"><span 
class="aett-10x-x-109">500</span></span><span id="textcolor15963"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15964"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor15965"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15966"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">h</span><span 
class="tctt-1095">'</span></span><span id="textcolor15967"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15968"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor15969"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15970"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15971"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor15972"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15973"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15974"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor15975"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15976"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Day</span><span 
class="tctt-1095">'</span></span><span id="textcolor15977"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15978"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor15979"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15980"><span 
class="tctt-1095">''</span></span><span id="textcolor15981"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15982"><span 
class="aett-10x-x-109">axes</span></span><span id="textcolor15983"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15984"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor15985"><span 
class="aett-10x-x-109">);</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15986"><span 
class="aett-10x-x-109">box</span></span><span id="textcolor15987"><span 
class="aett-10x-x-109">();</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15988"><span 
class="aett-10x-x-109">axis</span></span><span id="textcolor15989"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15990"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15991"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15992"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor15993"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15994"><span 
class="aett-10x-x-109">v</span></span><span id="textcolor15995"><span 
class="aett-10x-x-109">=tmesh</span></span><span id="textcolor15996"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15997"><span 
class="aett-10x-x-109">loc,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15998"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor15999"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16000"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor16001"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16002"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor16003"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16004"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor16005"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor16006"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor16007"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16008"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor16009"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16010"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor16011"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16012"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor16013"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor16014"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor16015"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor16016"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor16017"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor16018"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor16019"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor16020"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor16021"><span 
class="aett-10x-x-109">(smesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16022"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor16023"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16024"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16025"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16026"><span 
class="aett-10x-x-109">main</span></span><span id="textcolor16027"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16028"><span 
class="tctt-1095">''</span></span><span id="textcolor16029"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor16030"><span 
class="aett-10x-x-109">points</span></span><span id="textcolor16031"><span 
class="aett-10x-x-109">(xyt</span></span><span id="textcolor16032"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16033"><span 
class="aett-10x-x-109">x,</span><span 
class="aett-10x-x-109">&#x00A0;xyt</span></span><span id="textcolor16034"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16035"><span 
class="aett-10x-x-109">y,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16036"><span 
class="aett-10x-x-109">cex</span></span><span id="textcolor16037"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16038"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor16039"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16040"><span 
class="aett-10x-x-109">pch</span></span><span id="textcolor16041"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16042"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor16043"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>                                                                          </span></div>-
                                                                                 
                                                                                 
<!--l. 81--><p class="indent" >   <img 
src="spde-tutorial101x.png" alt="PIC" class="graphics" width="426.79497pt" height="426.80608pt"  /><!--tex4ht:graphics  
name="spde-tutorial101x.png" src="figs/stppstplot-1.eps"  
-->
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x9-10300111"></a>
                                                                                 
                                                                                 
<!--l. 88--><p class="noindent" ><img 
src="spde-tutorial102x.png" alt="PIC" class="graphics" width="426.79497pt" height="170.71933pt"  /><!--tex4ht:graphics  
name="spde-tutorial102x.png" src="figs/stppstfit-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;5.11: </span><span  
class="content">Time for a sample of the events (black), time knots (blue) in the upper plot.
Spatial locations of a sample on the spatial domain (botton plot).</span></div><!--tex4ht:label?: x9-10300111 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">5.6.1   </span> <a 
 id="x9-1040005.6.1"></a>Space-time aggregation</h4>
<!--l. 97--><p class="noindent" >For large datasets it can be computationally demanding to fit the model. The problem is
because the dimention of the model would be <span 
class="cmmi-10x-x-109">n </span><span 
class="cmr-10x-x-109">+ </span><span 
class="cmmi-10x-x-109">m</span><span 
class="cmsy-10x-x-109">*</span><span 
class="cmmi-10x-x-109">k</span>, where <span 
class="cmmi-10x-x-109">n </span>is the number of data points, <span 
class="cmmi-10x-x-109">m</span>
is the number of nodes in the mesh, <span 
class="cmmi-10x-x-109">k </span>is the number of time knots. In this section we choose to
aggregate the data in a way that we have a problem with dimention <span 
class="cmr-10x-x-109">2 </span><span 
class="cmsy-10x-x-109">*</span><span 
class="cmmi-10x-x-109">m</span><span 
class="cmsy-10x-x-109">*</span><span 
class="cmmi-10x-x-109">k</span>. So, this approach
really makes sence when <span 
class="cmmi-10x-x-109">n &#x003E;&#x003E; m </span><span 
class="cmsy-10x-x-109">* </span><span 
class="cmmi-10x-x-109">k</span>.
</p><!--l. 105--><p class="indent" >   We choose to aggregate the data in accord to the integration points to make the fitting
process easier. We also consider the dual mesh polygons, as shown in Chapter&#x00A0;<a 
href="spde-tutorialch4.html#x8-710004">4<!--tex4ht:ref: ch:lcox --></a>.
</p><!--l. 109--><p class="indent" >   So, firt we find the Voronoi polygons for the mesh nodes  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16066"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16047"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor16048"><span 
class="aett-10x-x-109">(deldir)</span></span>
<br /><span id="textcolor16049"><span 
class="aett-10x-x-109">dd</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16050"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16051"><span 
class="aett-10x-x-109">deldir</span></span><span id="textcolor16052"><span 
class="aett-10x-x-109">(smesh</span></span><span id="textcolor16053"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16054"><span 
class="aett-10x-x-109">loc[,</span></span><span id="textcolor16055"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16056"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;smesh</span></span><span id="textcolor16057"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16058"><span 
class="aett-10x-x-109">loc[,</span></span><span id="textcolor16059"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor16060"><span 
class="aett-10x-x-109">])</span></span>
<br /><span id="textcolor16061"><span 
class="aett-10x-x-109">tiles</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16062"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16063"><span 
class="aett-10x-x-109">tile.list</span></span><span id="textcolor16064"><span 
class="aett-10x-x-109">(dd)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 119--><p class="indent" >   Convert it into <span 
class="aett-10x-x-109">SpatialPolygons</span>:  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16109"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16068"><span 
class="aett-10x-x-109">polys</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16069"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16070"><span 
class="aett-10x-x-109">SpatialPolygons</span></span><span id="textcolor16071"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16072"><span 
class="aett-10x-x-109">lapply</span></span><span id="textcolor16073"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16074"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16075"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16076"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor16077"><span 
class="aett-10x-x-109">(tiles),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16078"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor16079"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16080"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor16081"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16082"><span 
class="aett-10x-x-109">{</span><span 
class="aett-10x-x-109">&#x00A0;p</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16083"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16084"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor16085"><span 
class="aett-10x-x-109">(tiles[[i]]</span></span><span id="textcolor16086"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16087"><span 
class="aett-10x-x-109">x,</span><span 
class="aett-10x-x-109">&#x00A0;tiles[[i]]</span></span><span id="textcolor16088"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16089"><span 
class="aett-10x-x-109">y)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16090"><span 
class="aett-10x-x-109">n</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16091"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16092"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor16093"><span 
class="aett-10x-x-109">(p)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16094"><span 
class="aett-10x-x-109">Polygons</span></span><span id="textcolor16095"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16096"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16097"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16098"><span 
class="aett-10x-x-109">Polygon</span></span><span id="textcolor16099"><span 
class="aett-10x-x-109">(p[</span></span><span id="textcolor16100"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor16101"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16102"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16103"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16104"><span 
class="aett-10x-x-109">n,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16105"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16106"><span 
class="aett-10x-x-109">),])),</span><span 
class="aett-10x-x-109">&#x00A0;i)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16107"><span 
class="aett-10x-x-109">}))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 132--><p class="indent" >   Find to which polygon belongs each data point:  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16133"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16111"><span 
class="aett-10x-x-109">area</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16112"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16113"><span 
class="aett-10x-x-109">factor</span></span><span id="textcolor16114"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16115"><span 
class="aett-10x-x-109">over</span></span><span id="textcolor16116"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16117"><span 
class="aett-10x-x-109">SpatialPoints</span></span><span id="textcolor16118"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16119"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor16120"><span 
class="aett-10x-x-109">(xyt</span></span><span id="textcolor16121"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16122"><span 
class="aett-10x-x-109">x,</span><span 
class="aett-10x-x-109">&#x00A0;xyt</span></span><span id="textcolor16123"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16124"><span 
class="aett-10x-x-109">y)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16125"><span 
class="aett-10x-x-109">polys),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16126"><span 
class="aett-10x-x-109">levels</span></span><span id="textcolor16127"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16128"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16129"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16130"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor16131"><span 
class="aett-10x-x-109">(polys))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 141--><p class="indent" >   Fint to which part of the time mesh belongs each data point:  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16189"></p>     
<div class="alltt">                                                                                                                </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16191"><div class="obeylines-v">
<span id="textcolor16135"><span 
class="aett-10x-x-109">t.breaks</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16136"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16137"><span 
class="aett-10x-x-109">sort</span></span><span id="textcolor16138"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16139"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor16140"><span 
class="aett-10x-x-109">(tmesh</span></span><span id="textcolor16141"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16142"><span 
class="aett-10x-x-109">loc[</span></span><span id="textcolor16143"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor16144"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16145"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16146"><span 
class="aett-10x-x-109">,k)],</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16147"><span 
class="aett-10x-x-109">tmesh</span></span><span id="textcolor16148"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16149"><span 
class="aett-10x-x-109">loc[</span></span><span id="textcolor16150"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor16151"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16152"><span 
class="aett-10x-x-109">k</span></span><span id="textcolor16153"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor16154"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16155"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor16156"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor16157"><span 
class="aett-10x-x-109">2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16158"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16159"><span 
class="aett-10x-x-109">tmesh</span></span><span id="textcolor16160"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16161"><span 
class="aett-10x-x-109">loc[</span></span><span id="textcolor16162"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor16163"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16164"><span 
class="aett-10x-x-109">k]</span></span><span id="textcolor16165"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor16166"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor16167"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor16168"><span 
class="aett-10x-x-109">table</span></span><span id="textcolor16169"><span 
class="aett-10x-x-109">(time</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16170"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16171"><span 
class="aett-10x-x-109">factor</span></span><span id="textcolor16172"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16173"><span 
class="aett-10x-x-109">findInterval</span></span><span id="textcolor16174"><span 
class="aett-10x-x-109">(xyt</span></span><span id="textcolor16175"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16176"><span 
class="aett-10x-x-109">t,</span><span 
class="aett-10x-x-109">&#x00A0;t.breaks),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16177"><span 
class="aett-10x-x-109">levels</span></span><span id="textcolor16178"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16179"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16180"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16181"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16182"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor16183"><span 
class="aett-10x-x-109">(t.breaks)</span></span><span id="textcolor16184"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor16185"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16186"><span 
class="aett-10x-x-109">)))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-145">
##
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;3&#x00A0;&#x00A0;&#x00A0;4&#x00A0;&#x00A0;&#x00A0;5&#x00A0;&#x00A0;&#x00A0;6&#x00A0;&#x00A0;&#x00A0;7
&#x00A0;<br />##&#x00A0;183&#x00A0;327&#x00A0;260&#x00A0;282&#x00A0;321&#x00A0;288&#x00A0;146
</div>
<!--l. 154--><p class="nopar" >                                                                          </span></div>-
<!--l. 157--><p class="indent" >   Use these both identification index sets to aggregate the data  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16216"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16193"><span 
class="aett-10x-x-109">agg.dat</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16194"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16195"><span 
class="aett-10x-x-109">as.data.frame</span></span><span id="textcolor16196"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16197"><span 
class="aett-10x-x-109">table</span></span><span id="textcolor16198"><span 
class="aett-10x-x-109">(area,</span><span 
class="aett-10x-x-109">&#x00A0;time))</span></span>
<br /><span id="textcolor16199"><span 
class="aett-10x-x-109">for</span></span><span id="textcolor16200"><span 
class="aett-10x-x-109">(j</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16201"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16202"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16203"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16204"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor16205"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16206"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;set</span><span 
class="aeitt-10x-x-109">&#x00A0;time</span><span 
class="aeitt-10x-x-109">&#x00A0;and</span><span 
class="aeitt-10x-x-109">&#x00A0;area</span><span 
class="aeitt-10x-x-109">&#x00A0;as</span><span 
class="aeitt-10x-x-109">&#x00A0;integer</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16207"><span 
class="aett-10x-x-109">agg.dat[[j]]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16208"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16209"><span 
class="aett-10x-x-109">as.integer</span></span><span id="textcolor16210"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16211"><span 
class="aett-10x-x-109">as.character</span></span><span id="textcolor16212"><span 
class="aett-10x-x-109">(agg.dat[[j]]))</span></span>
<br /><span id="textcolor16213"><span 
class="aett-10x-x-109">str</span></span><span id="textcolor16214"><span 
class="aett-10x-x-109">(agg.dat)</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-146">
##&#x00A0;'data.frame': 1064&#x00A0;obs.&#x00A0;of&#x00A0;&#x00A0;3&#x00A0;variables:
&#x00A0;<br />##&#x00A0;&#x00A0;$&#x00A0;area:&#x00A0;int&#x00A0;&#x00A0;1&#x00A0;2&#x00A0;3&#x00A0;4&#x00A0;5&#x00A0;6&#x00A0;7&#x00A0;8&#x00A0;9&#x00A0;10&#x00A0;...
&#x00A0;<br />##&#x00A0;&#x00A0;$&#x00A0;time:&#x00A0;int&#x00A0;&#x00A0;1&#x00A0;1&#x00A0;1&#x00A0;1&#x00A0;1&#x00A0;1&#x00A0;1&#x00A0;1&#x00A0;1&#x00A0;1&#x00A0;...
&#x00A0;<br />##&#x00A0;&#x00A0;$&#x00A0;Freq:&#x00A0;int&#x00A0;&#x00A0;1&#x00A0;2&#x00A0;0&#x00A0;0&#x00A0;0&#x00A0;0&#x00A0;0&#x00A0;0&#x00A0;0&#x00A0;3&#x00A0;...
</div>
<!--l. 171--><p class="nopar" >                                                                          </span></div>-
<!--l. 175--><p class="indent" >   We need to define the expected number of cases (at least) proportional to the area of the
Polygons times the width length of the time knots. Compute the intersection area of each
polygon with the domain (show the sum).  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16282"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16218"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor16219"><span 
class="aett-10x-x-109">(rgeos)</span></span>
<br /><span id="textcolor16220"><span 
class="aett-10x-x-109">sum</span></span><span id="textcolor16221"><span 
class="aett-10x-x-109">(w.areas</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16222"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16223"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor16224"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16225"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16226"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16227"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor16228"><span 
class="aett-10x-x-109">(tiles),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16229"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor16230"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16231"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor16232"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16233"><span 
class="aett-10x-x-109">{</span><span 
class="aett-10x-x-109">&#x00A0;p</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16234"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16235"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor16236"><span 
class="aett-10x-x-109">(tiles[[i]]</span></span><span id="textcolor16237"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16238"><span 
class="aett-10x-x-109">x,</span><span 
class="aett-10x-x-109">&#x00A0;tiles[[i]]</span></span><span id="textcolor16239"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16240"><span 
class="aett-10x-x-109">y)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16241"><span 
class="aett-10x-x-109">n</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16242"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16243"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor16244"><span 
class="aett-10x-x-109">(p)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16245"><span 
class="aett-10x-x-109">pl</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16246"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16247"><span 
class="aett-10x-x-109">SpatialPolygons</span></span><span id="textcolor16248"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16249"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16250"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16251"><span 
class="aett-10x-x-109">Polygons</span></span><span id="textcolor16252"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16253"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16254"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16255"><span 
class="aett-10x-x-109">Polygon</span></span><span id="textcolor16256"><span 
class="aett-10x-x-109">(p[</span></span><span id="textcolor16257"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor16258"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16259"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16260"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16261"><span 
class="aett-10x-x-109">n,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16262"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16263"><span 
class="aett-10x-x-109">),])),</span><span 
class="aett-10x-x-109">&#x00A0;i)))</span></span> </span> </div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16284"><br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16264"><span 
class="aett-10x-x-109">if</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16265"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16266"><span 
class="aett-10x-x-109">gIntersects</span></span><span id="textcolor16267"><span 
class="aett-10x-x-109">(pl,</span><span 
class="aett-10x-x-109">&#x00A0;domainSP))</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16268"><span 
class="aett-10x-x-109">return</span></span><span id="textcolor16269"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16270"><span 
class="aett-10x-x-109">gArea</span></span><span id="textcolor16271"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16272"><span 
class="aett-10x-x-109">gIntersection</span></span><span id="textcolor16273"><span 
class="aett-10x-x-109">(pl,</span><span 
class="aett-10x-x-109">&#x00A0;domainSP)))</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16274"><span 
class="aett-10x-x-109">else</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16275"><span 
class="aett-10x-x-109">return</span></span><span id="textcolor16276"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16277"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor16278"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16279"><span 
class="aett-10x-x-109">}))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-147">
##&#x00A0;[1]&#x00A0;50.26548
</div>
<!--l. 192--><p class="nopar" >                                                                          </span></div>-
<!--l. 196--><p class="indent" >   A summary of the polygons area is  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16289"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16286"><span 
class="aett-10x-x-109">summary</span></span><span id="textcolor16287"><span 
class="aett-10x-x-109">(w.areas)</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-148">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;Min.&#x00A0;1st&#x00A0;Qu.&#x00A0;&#x00A0;Median&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mean&#x00A0;3rd&#x00A0;Qu.&#x00A0;&#x00A0;&#x00A0;&#x00A0;Max.
&#x00A0;<br />##&#x00A0;0.06293&#x00A0;0.21780&#x00A0;0.35040&#x00A0;0.33070&#x00A0;0.41160&#x00A0;0.69310
</div>
<!--l. 205--><p class="nopar" >                                                                          </span></div>-
<!--l. 208--><p class="indent" >   and the area of the spatial domain is  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16294"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16291"><span 
class="aett-10x-x-109">gArea</span></span><span id="textcolor16292"><span 
class="aett-10x-x-109">(domainSP)</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-149">
##&#x00A0;[1]&#x00A0;50.26548
</div>
<!--l. 216--><p class="nopar" >                                                                          </span></div>-
<!--l. 219--><p class="indent" >   The time length (domain) is 365 and the width of each knot is  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16306"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16296"><span 
class="aett-10x-x-109">(w.t</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16297"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16298"><span 
class="aett-10x-x-109">diag</span></span><span id="textcolor16299"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16300"><span 
class="aett-10x-x-109">inla.mesh.fem</span></span><span id="textcolor16301"><span 
class="aett-10x-x-109">(tmesh)</span></span><span id="textcolor16302"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16303"><span 
class="aett-10x-x-109">c0))</span></span>                                    </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16308"></div></div>   
<div class="verbatim" id="verbatim-150">
##&#x00A0;[1]&#x00A0;1.25&#x00A0;2.50&#x00A0;2.50&#x00A0;2.50&#x00A0;2.50&#x00A0;2.50&#x00A0;1.25
</div>
<!--l. 227--><p class="nopar" >                                                                          </span></div>-
<!--l. 230--><p class="indent" >   where the knots at boundary are with less width than the internal ones.
</p><!--l. 232--><p class="indent" >   Since the intensity function is the number of cases per volumn unit, with <span 
class="cmmi-10x-x-109">n </span>cases
the intensity varies around the average number of cases (intensity) by unit volumn
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16325"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16310"><span 
class="aett-10x-x-109">(i0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16311"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16312"><span 
class="aett-10x-x-109">n</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16313"><span 
class="aett-10x-x-109">/</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16314"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16315"><span 
class="aett-10x-x-109">gArea</span></span><span id="textcolor16316"><span 
class="aett-10x-x-109">(domainSP)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16317"><span 
class="aett-10x-x-109">*</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16318"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor16319"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16320"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor16321"><span 
class="aett-10x-x-109">(tmesh</span></span><span id="textcolor16322"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16323"><span 
class="aett-10x-x-109">loc))))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-151">
##&#x00A0;[1]&#x00A0;2.396608
</div>
<!--l. 241--><p class="nopar" >                                                                          </span></div>-
<!--l. 244--><p class="indent" >   and this value is related to an intercept in the model we fit below. The space-time volumn
(area unit per time unit) at each polygon and time knot is  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16338"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16327"><span 
class="aett-10x-x-109">summary</span></span><span id="textcolor16328"><span 
class="aett-10x-x-109">(e0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16329"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16330"><span 
class="aett-10x-x-109">w.areas[agg.dat</span></span><span id="textcolor16331"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16332"><span 
class="aett-10x-x-109">area]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16333"><span 
class="aett-10x-x-109">*</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16334"><span 
class="aett-10x-x-109">(w.t[agg.dat</span></span><span id="textcolor16335"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16336"><span 
class="aett-10x-x-109">time]))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-152">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;Min.&#x00A0;1st&#x00A0;Qu.&#x00A0;&#x00A0;Median&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mean&#x00A0;3rd&#x00A0;Qu.&#x00A0;&#x00A0;&#x00A0;&#x00A0;Max.
&#x00A0;<br />##&#x00A0;0.07866&#x00A0;0.45690&#x00A0;0.64780&#x00A0;0.70860&#x00A0;0.97130&#x00A0;1.73300
</div>
<!--l. 254--><p class="nopar" >                                                                          </span></div>-
<!--l. 258--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.6.2   </span> <a 
 id="x9-1050005.6.2"></a>Model fit</h4>
<!--l. 260--><p class="noindent" >The projector matrix, SPDE model object and the space-time index set definition:
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16369"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16340"><span 
class="aett-10x-x-109">A.st</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16341"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16342"><span 
class="aett-10x-x-109">inla.spde.make.A</span></span><span id="textcolor16343"><span 
class="aett-10x-x-109">(smesh,</span><span 
class="aett-10x-x-109">&#x00A0;smesh</span></span><span id="textcolor16344"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16345"><span 
class="aett-10x-x-109">loc[agg.dat</span></span><span id="textcolor16346"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16347"><span 
class="aett-10x-x-109">area,],</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16348"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor16349"><span 
class="aett-10x-x-109">=agg.dat</span></span><span id="textcolor16350"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16351"><span 
class="aett-10x-x-109">time,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16352"><span 
class="aett-10x-x-109">mesh.group</span></span><span id="textcolor16353"><span 
class="aett-10x-x-109">=tmesh)</span></span>
<br /><span id="textcolor16354"><span 
class="aett-10x-x-109">spde</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16355"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16356"><span 
class="aett-10x-x-109">inla.spde2.matern</span></span><span id="textcolor16357"><span 
class="aett-10x-x-109">(smesh)</span></span>
<br /><span id="textcolor16358"><span 
class="aett-10x-x-109">idx</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16359"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16360"><span 
class="aett-10x-x-109">inla.spde.make.index</span></span><span id="textcolor16361"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16362"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">s</span><span 
class="tctt-1095">'</span></span><span id="textcolor16363"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;spde</span></span><span id="textcolor16364"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16365"><span 
class="aett-10x-x-109">n.spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16366"><span 
class="aett-10x-x-109">n.group</span></span><span id="textcolor16367"><span 
class="aett-10x-x-109">=k)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 272--><p class="indent" >   Defining the data stack  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16406"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16371"><span 
class="aett-10x-x-109">stk</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16372"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16373"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor16374"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16375"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor16376"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16377"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16378"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16379"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor16380"><span 
class="aett-10x-x-109">=agg.dat</span></span><span id="textcolor16381"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16382"><span 
class="aett-10x-x-109">Freq,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16383"><span 
class="aett-10x-x-109">exposure</span></span><span id="textcolor16384"><span 
class="aett-10x-x-109">=e0),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16385"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor16386"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16387"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16388"><span 
class="aett-10x-x-109">(A.st,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16389"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16390"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16391"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor16392"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16393"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16394"><span 
class="aett-10x-x-109">(idx,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16395"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16396"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16397"><span 
class="aett-10x-x-109">b0</span></span><span id="textcolor16398"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16399"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor16400"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16401"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16402"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16403"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor16404"><span 
class="aett-10x-x-109">(agg.dat)))))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 283--><p class="indent" >   the formula  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16431"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16408"><span 
class="aett-10x-x-109">formula</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16409"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16410"><span 
class="aett-10x-x-109">y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16411"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16412"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16413"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16414"><span 
class="aett-10x-x-109">b0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16415"><span 
class="aett-10x-x-109">+</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16416"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor16417"><span 
class="aett-10x-x-109">(s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16418"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor16419"><span 
class="aett-10x-x-109">=spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16420"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor16421"><span 
class="aett-10x-x-109">=s.group,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16422"><span 
class="aett-10x-x-109">control.group</span></span><span id="textcolor16423"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16424"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16425"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16426"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor16427"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16428"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">ar1</span><span 
class="tctt-1095">'</span></span><span id="textcolor16429"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 292--><p class="indent" >   and fitting the model  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16464"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16433"><span 
class="aett-10x-x-109">res</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16434"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16435"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor16436"><span 
class="aett-10x-x-109">(formula,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16437"><span 
class="aett-10x-x-109">family</span></span><span id="textcolor16438"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16439"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">poisson</span><span 
class="tctt-1095">'</span></span><span id="textcolor16440"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16441"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor16442"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16443"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor16444"><span 
class="aett-10x-x-109">(stk),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16445"><span 
class="aett-10x-x-109">E</span></span><span id="textcolor16446"><span 
class="aett-10x-x-109">=exposure,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16447"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor16448"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16449"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16450"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16451"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor16452"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16453"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor16454"><span 
class="aett-10x-x-109">(stk)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16455"><span 
class="aett-10x-x-109">control.inla</span></span><span id="textcolor16456"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16457"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16458"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16459"><span 
class="aett-10x-x-109">strategy</span></span><span id="textcolor16460"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16461"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">gaussian</span><span 
class="tctt-1095">'</span></span><span id="textcolor16462"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 304--><p class="indent" >   The log of the average intensity and the intercept summary:  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16480"></p>     
<div class="alltt">                                                                                                                </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16482"><div class="obeylines-v">
<span id="textcolor16466"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor16467"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16468"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor16469"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16470"><span 
class="aett-10x-x-109">true</span></span><span id="textcolor16471"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16472"><span 
class="aett-10x-x-109">log</span></span><span id="textcolor16473"><span 
class="aett-10x-x-109">(i0),</span><span 
class="aett-10x-x-109">&#x00A0;res</span></span><span id="textcolor16474"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16475"><span 
class="aett-10x-x-109">summary.fixed),</span></span><span id="textcolor16476"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor16477"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-153">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;true&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant&#x00A0;0.5quant&#x00A0;0.975quant&#x00A0;&#x00A0;mode&#x00A0;kld
&#x00A0;<br />##&#x00A0;b0&#x00A0;0.8741&#x00A0;0.702&#x00A0;0.1553&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.3933&#x00A0;&#x00A0;&#x00A0;0.7019&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.0107&#x00A0;0.702&#x00A0;&#x00A0;&#x00A0;0
</div>
<!--l. 313--><p class="nopar" >                                                                          </span></div>-
<!--l. 316--><p class="indent" >   The expected number of cases at each integration point can be used to compute the total
expected number of cases  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16524"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16484"><span 
class="aett-10x-x-109">eta.i</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16485"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16486"><span 
class="aett-10x-x-109">res</span></span><span id="textcolor16487"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16488"><span 
class="aett-10x-x-109">summary.fix[</span></span><span id="textcolor16489"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16490"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor16491"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16492"><span 
class="aett-10x-x-109">]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16493"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16494"><span 
class="aett-10x-x-109">res</span></span><span id="textcolor16495"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16496"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor16497"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16498"><span 
class="aett-10x-x-109">s</span></span><span id="textcolor16499"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16500"><span 
class="aett-10x-x-109">mean</span></span>
<br /><span id="textcolor16501"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor16502"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16503"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor16504"><span 
class="aett-10x-x-109">=xyt</span></span><span id="textcolor16505"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16506"><span 
class="aett-10x-x-109">n,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16507"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">E(n)</span><span 
class="tctt-1095">'</span></span><span id="textcolor16508"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16509"><span 
class="aett-10x-x-109">sum</span></span><span id="textcolor16510"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16511"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor16512"><span 
class="aett-10x-x-109">(w.areas,</span><span 
class="aett-10x-x-109">&#x00A0;k)</span></span><span id="textcolor16513"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor16514"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor16515"><span 
class="aett-10x-x-109">(w.t,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16516"><span 
class="aett-10x-x-109">each</span></span><span id="textcolor16517"><span 
class="aett-10x-x-109">=smesh</span></span><span id="textcolor16518"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16519"><span 
class="aett-10x-x-109">n)</span></span><span id="textcolor16520"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor16521"><span 
class="aett-10x-x-109">exp</span></span><span id="textcolor16522"><span 
class="aett-10x-x-109">(eta.i)))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-154">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;n&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;E(n)
&#x00A0;<br />##&#x00A0;1807.000&#x00A0;1805.903
</div>
<!--l. 326--><p class="nopar" >                                                                          </span></div>-
<!--l. 330--><p class="indent" >   The spatial surface at each time knot can be computed by  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16610"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16526"><span 
class="aett-10x-x-109">r0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16527"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16528"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor16529"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16530"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor16531"><span 
class="aett-10x-x-109">(domain[,</span></span><span id="textcolor16532"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16533"><span 
class="aett-10x-x-109">]))</span></span><span id="textcolor16534"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor16535"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor16536"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16537"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor16538"><span 
class="aett-10x-x-109">(domain[,</span></span><span id="textcolor16539"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor16540"><span 
class="aett-10x-x-109">]))</span></span>
<br /><span id="textcolor16541"><span 
class="aett-10x-x-109">prj</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16542"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16543"><span 
class="aett-10x-x-109">inla.mesh.projector</span></span><span id="textcolor16544"><span 
class="aett-10x-x-109">(smesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16545"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor16546"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16547"><span 
class="aett-10x-x-109">bbox</span></span><span id="textcolor16548"><span 
class="aett-10x-x-109">(domainSP)[</span></span><span id="textcolor16549"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16550"><span 
class="aett-10x-x-109">,],</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16551"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor16552"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16553"><span 
class="aett-10x-x-109">bbox</span></span><span id="textcolor16554"><span 
class="aett-10x-x-109">(domainSP)[</span></span><span id="textcolor16555"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor16556"><span 
class="aett-10x-x-109">,],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16557"><span 
class="aett-10x-x-109">dims</span></span><span id="textcolor16558"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16559"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor16560"><span 
class="aett-10x-x-109">(r0</span></span><span id="textcolor16561"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor16562"><span 
class="aett-10x-x-109">200</span></span><span id="textcolor16563"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16564"><span 
class="aett-10x-x-109">200</span></span><span id="textcolor16565"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor16566"><span 
class="aett-10x-x-109">g.no.in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16567"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16568"><span 
class="aett-10x-x-109">is.na</span></span><span id="textcolor16569"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16570"><span 
class="aett-10x-x-109">over</span></span><span id="textcolor16571"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16572"><span 
class="aett-10x-x-109">SpatialPoints</span></span><span id="textcolor16573"><span 
class="aett-10x-x-109">(prj</span></span><span id="textcolor16574"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16575"><span 
class="aett-10x-x-109">lattice</span></span><span id="textcolor16576"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16577"><span 
class="aett-10x-x-109">loc),</span><span 
class="aett-10x-x-109">&#x00A0;domainSP))</span></span>
<br /><span id="textcolor16578"><span 
class="aett-10x-x-109">t.mean</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16579"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16580"><span 
class="aett-10x-x-109">lapply</span></span><span id="textcolor16581"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16582"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16583"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16584"><span 
class="aett-10x-x-109">k,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16585"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor16586"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16587"><span 
class="aett-10x-x-109">j</span></span><span id="textcolor16588"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16589"><span 
class="aett-10x-x-109">z</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16590"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16591"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor16592"><span 
class="aett-10x-x-109">(prj,</span><span 
class="aett-10x-x-109">&#x00A0;res</span></span><span id="textcolor16593"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16594"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor16595"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16596"><span 
class="aett-10x-x-109">s</span></span><span id="textcolor16597"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16598"><span 
class="aett-10x-x-109">mean[idx</span></span><span id="textcolor16599"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16600"><span 
class="aett-10x-x-109">s.group</span></span><span id="textcolor16601"><span 
class="aett-10x-x-109">==</span></span><span id="textcolor16602"><span 
class="aett-10x-x-109">j])</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16603"><span 
class="aett-10x-x-109">z[g.no.in]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16604"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16605"><span 
class="aett-10x-x-109">NA</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16606"><span 
class="aett-10x-x-109">return</span></span><span id="textcolor16607"><span 
class="aett-10x-x-109">(z)</span></span>
<br /><span id="textcolor16608"><span 
class="aett-10x-x-109">})</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 346--><p class="indent" >   and is visualized in Figure&#x00A0;<a 
href="#x9-1050005.6.2">5.6.2<!--tex4ht:ref: fig:lstppsres --></a> is visualized by  
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16721"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16612"><span 
class="aett-10x-x-109">zlims</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16613"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16614"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor16615"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16616"><span 
class="aett-10x-x-109">unlist</span></span><span id="textcolor16617"><span 
class="aett-10x-x-109">(t.mean),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16618"><span 
class="aett-10x-x-109">na.rm</span></span><span id="textcolor16619"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16620"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor16621"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor16622"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor16623"><span 
class="aett-10x-x-109">(fields)</span></span>
<br /><span id="textcolor16624"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor16625"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16626"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor16627"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16628"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor16629"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16630"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor16631"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor16632"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor16633"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16634"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor16635"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16636"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor16637"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16638"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor16639"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor16640"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor16641"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor16642"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor16643"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor16644"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor16645"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor16646"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16647"><span 
class="aett-10x-x-109">(j</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16648"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16649"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16650"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16651"><span 
class="aett-10x-x-109">k)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16652"><span 
class="aett-10x-x-109">image</span></span><span id="textcolor16653"><span 
class="aett-10x-x-109">(prj</span></span><span id="textcolor16654"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16655"><span 
class="aett-10x-x-109">x,</span><span 
class="aett-10x-x-109">&#x00A0;prj</span></span><span id="textcolor16656"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16657"><span 
class="aett-10x-x-109">y,</span><span 
class="aett-10x-x-109">&#x00A0;t.mean[[j]],</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16658"><span 
class="aett-10x-x-109">axes</span></span><span id="textcolor16659"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16660"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor16661"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16662"><span 
class="aett-10x-x-109">zlim</span></span><span id="textcolor16663"><span 
class="aett-10x-x-109">=zlims,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16664"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor16665"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16666"><span 
class="aett-10x-x-109">tim.colors</span></span><span id="textcolor16667"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16668"><span 
class="aett-10x-x-109">30</span></span><span id="textcolor16669"><span 
class="aett-10x-x-109">))</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16670"><span 
class="aett-10x-x-109">points</span></span><span id="textcolor16671"><span 
class="aett-10x-x-109">(xyt</span></span><span id="textcolor16672"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16673"><span 
class="aett-10x-x-109">x[time</span></span><span id="textcolor16674"><span 
class="aett-10x-x-109">==</span></span><span id="textcolor16675"><span 
class="aett-10x-x-109">j],</span><span 
class="aett-10x-x-109">&#x00A0;xyt</span></span><span id="textcolor16676"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16677"><span 
class="aett-10x-x-109">y[time</span></span><span id="textcolor16678"><span 
class="aett-10x-x-109">==</span></span><span id="textcolor16679"><span 
class="aett-10x-x-109">j],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16680"><span 
class="aett-10x-x-109">cex</span></span><span id="textcolor16681"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16682"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor16683"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor16684"><span 
class="aett-10x-x-109">}</span></span>
<br /><span id="textcolor16685"><span 
class="aett-10x-x-109">image.plot</span></span><span id="textcolor16686"><span 
class="aett-10x-x-109">(prj</span></span><span id="textcolor16687"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16688"><span 
class="aett-10x-x-109">x,</span><span 
class="aett-10x-x-109">&#x00A0;prj</span></span><span id="textcolor16689"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16690"><span 
class="aett-10x-x-109">y,</span><span 
class="aett-10x-x-109">&#x00A0;t.mean[[j]]</span></span><span id="textcolor16691"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor16692"><span 
class="aett-10x-x-109">1e9</span></span><span id="textcolor16693"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16694"><span 
class="aett-10x-x-109">axes</span></span><span id="textcolor16695"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16696"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor16697"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16698"><span 
class="aett-10x-x-109">zlim</span></span><span id="textcolor16699"><span 
class="aett-10x-x-109">=zlims,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16700"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor16701"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16702"><span 
class="tctt-1095">''</span></span><span id="textcolor16703"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16704"><span 
class="aett-10x-x-109">legend.mar</span></span><span id="textcolor16705"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16706"><span 
class="aett-10x-x-109">10</span></span><span id="textcolor16707"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16708"><span 
class="aett-10x-x-109">legend.width</span></span><span id="textcolor16709"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16710"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor16711"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16712"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor16713"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16714"><span 
class="aett-10x-x-109">tim.colors</span></span><span id="textcolor16715"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16716"><span 
class="aett-10x-x-109">30</span></span><span id="textcolor16717"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16718"><span 
class="aett-10x-x-109">horizontal</span></span><span id="textcolor16719"><span 
class="aett-10x-x-109">=T)</span></span>
</div>
</div>                                                                          </span></div>-
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x9-10500112"></a>
                                                                                 
                                                                                 
<!--l. 366--><p class="noindent" ><img 
src="spde-tutorial103x.png" alt="PIC" class="graphics" width="413.99164pt" height="413.99539pt"  /><!--tex4ht:graphics  
name="spde-tutorial103x.png" src="figs/stpplstsresf-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;5.12: </span><span  
class="content">Spatial surface fitted at each time knot overlayed by the point pattern formed
by the points nearest to each time knot.</span></div><!--tex4ht:label?: x9-10500112 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
                                                                                 
                                                                                 
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialli2.html" >next</a>] [<a 
href="spde-tutorialch4.html" >prev</a>] [<a 
href="spde-tutorialch4.html#tailspde-tutorialch4.html" >prev-tail</a>] [<a 
href="spde-tutorialch5.html" >front</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch5.html" >up</a>] </p></div>
<!--l. 1--><p class="indent" >   <a 
 id="tailspde-tutorialch5.html"></a>   </p> 
</body></html> 
