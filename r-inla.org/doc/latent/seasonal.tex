\documentclass[a4paper,11pt]{article}
\usepackage[compat2]{geometry}
\usepackage{amstext}
\usepackage{listings}
\begin{document}

\section*{Model for seasonal variation}

\subsection*{Parametrization}

A model for seasonal variation with periodicity $m$ for the random vector $\mathcal{x}=(x_1,\dots,x_n)$, $n>m$ is obtained assuming that the sums $x_i+x_{i+1}+\dots+x_{i+m-1}$ are independent Gaussian with preciosion $\tau$.

The density for $\mathbf{x}$ is derived from the $n-m+1$ increments as
\begin{eqnarray}
\pi(\mathbf{x}|\tau) &\propto& \tau^{\frac{(n-m+1)}{2}} \exp\left\{-\frac{\tau}{2}\sum (x_i+x_{i+1}+\dots+x_{i+m-1})^2\right\}\\
& = &\tau^{\frac{(n-m+1)}{2}}\exp\left\{-\frac{1}{2}\mathbf{x}^T\mathbf{Q}\mathbf{x} \right\}
\end{eqnarray}
where $\mathbf{Q}=\tau\mathbf{R}$ and $\mathbf{R}$ is the structure matrix reflecting the neighbourhood structure of the model.


\subsection*{Hyperparameters}

The precision parameter $\tau$ is represented as
\begin{displaymath}
    \theta =\log \tau
\end{displaymath}
and the prior is defined on $\mathbf{\theta}$. 

\subsection*{Specification}

The seasonal model is specified inside the {\tt f()} function as
\begin{verbatim}
 f(<whatever>,model="seasonal",season.length=<season.length>,
              prior=c(<prior.model.theta>),
              param=c(<param.prior.theta1>))
\end{verbatim}
 
\subsection*{Example}

\begin{verbatim}

n=204
n.seas=12

trend=seq(1:n)
seasonal=rep(1:n.seas,n/n.seas)

a=1
b=0.5
y = rnorm(n,a+b*trend,1)+rnorm(n,0.2*seasonal,1)

data=data.frame(y=y,trend=trend,seasonal=trend)

formula = y~f(trend,model="rw2")+f(seasonal,model="seasonal",season.length=n.seas,param=c(1,0.1))
result=inla(formula,family="gaussian",data=data)

\end{verbatim}


\subsection*{Notes}

The seasonal is a intrinsic random field with rank deficiency of $m-1$.

\end{document}


% LocalWords: 

%%% Local Variables: 
%%% TeX-master: t
%%% End: 
