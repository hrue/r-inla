<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>11 Space-time log-Cox process</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- xhtml,html,frames,2 --> 
<meta name="src" content="spde-tutorial.tex" /> 
<meta name="date" content="2017-02-24 10:55:00" /> 
<link rel="stylesheet" type="text/css" href="spde-tutorial.css" /> 
</head><body 
>
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialli2.html" >next</a>] [<a 
href="spde-tutorialch10.html" >prev</a>] [<a 
href="spde-tutorialch10.html#tailspde-tutorialch10.html" >prev-tail</a>] [<a 
href="#tailspde-tutorialch11.html">tail</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch11.html" >up</a>] </p></div>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;11</span><br /><a 
 id="x15-9900011"></a>Space-time log-Cox process</h2>
<!--l. 3--><p class="noindent" >The  R  source  for  this  file  is  available  at
<a 
href="http://www.math.ntnu.no/inla/r-inla.org/tutorials/spde/R/spde-tutorial-stpp.R" class="url" ><span 
class="aett-10x-x-109">http://www.math.ntnu.no/inla/r-_inla.org/tutorials/spde/R/spde-_tutorial-_stpp.R</span></a>
</p><!--l. 8--><p class="indent" >   In this chapter we show how to fit a spatio temporal log-Cox point process model. In
Section&#x00A0;<a 
href="#x15-10000011.1">11.1<!--tex4ht:ref: sec:burkitt --></a> we have an example. In Section&#x00A0;<a 
href="#x15-10100011.2">11.2<!--tex4ht:ref: sec:lstpp --></a> we show an approach to deal with large data
sets.
</p>
   <h3 class="sectionHead"><span class="titlemark">11.1   </span> <a 
 id="x15-10000011.1"></a>Burkitt example</h3>
<!--l. 3--><p class="noindent" >The  R  source  for  this  file  is  available  at
<a 
href="http://www.math.ntnu.no/inla/r-inla.org/tutorials/spde/R/spde-tutorial-burkitt.R" class="url" ><span 
class="aett-10x-x-109">http://www.math.ntnu.no/inla/r-_inla.org/tutorials/spde/R/spde-_tutorial-_burkitt.R</span></a>
</p><!--l. 8--><p class="indent" >   We use the <span 
class="aett-10x-x-109">burkitt </span>data set from the <span 
class="aeb10-x-x-109">splancs </span>package.
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14850"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14833"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor14834"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14835"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">burkitt</span><span 
class="tctt-1095">'</span></span><span id="textcolor14836"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14837"><span 
class="aett-10x-x-109">package</span></span><span id="textcolor14838"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14839"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">splancs</span><span 
class="tctt-1095">'</span></span><span id="textcolor14840"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor14841"><span 
class="aett-10x-x-109">t</span></span><span id="textcolor14842"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14843"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor14844"><span 
class="aett-10x-x-109">(burkitt[,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14845"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14846"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor14847"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor14848"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;summary))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-134">
##&#x00A0;&#x00A0;&#x00A0;Min.&#x00A0;1st&#x00A0;Qu.&#x00A0;Median&#x00A0;&#x00A0;&#x00A0;Mean&#x00A0;3rd&#x00A0;Qu.&#x00A0;Max.
&#x00A0;<br />##&#x00A0;x&#x00A0;&#x00A0;255&#x00A0;&#x00A0;&#x00A0;269.0&#x00A0;&#x00A0;282.5&#x00A0;&#x00A0;286.3&#x00A0;&#x00A0;&#x00A0;300.2&#x00A0;&#x00A0;335
&#x00A0;<br />##&#x00A0;y&#x00A0;&#x00A0;247&#x00A0;&#x00A0;&#x00A0;326.8&#x00A0;&#x00A0;344.5&#x00A0;&#x00A0;338.8&#x00A0;&#x00A0;&#x00A0;362.0&#x00A0;&#x00A0;399
&#x00A0;<br />##&#x00A0;t&#x00A0;&#x00A0;413&#x00A0;&#x00A0;2412.0&#x00A0;3704.0&#x00A0;3530.0&#x00A0;&#x00A0;4700.0&#x00A0;5775
</div>
<!--l. 21--><p class="nopar" >                                                                          </span></div>-
<!--l. 25--><p class="indent" >   The folowing commands shows the time when each event occurred, Figure&#x00A0;<a 
href="#x15-10000011.1">11.1<!--tex4ht:ref: fig:timeshow --></a>.
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14925"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14852"><span 
class="aett-10x-x-109">n</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14853"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14854"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor14855"><span 
class="aett-10x-x-109">(burkitt)</span></span>
<br /><span id="textcolor14856"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor14857"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14858"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor14859"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14860"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14861"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14862"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14863"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14864"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14865"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14866"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor14867"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14868"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14869"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14870"><span 
class="aett-10x-x-109">1.5</span></span><span id="textcolor14871"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14872"><span 
class="aett-10x-x-109">.1</span></span><span id="textcolor14873"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14874"><span 
class="aett-10x-x-109">.1</span></span><span id="textcolor14875"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14876"><span 
class="aett-10x-x-109">.1</span></span><span id="textcolor14877"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14878"><span 
class="aett-10x-x-109">mgp</span></span><span id="textcolor14879"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14880"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14881"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14882"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor14883"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14884"><span 
class="aett-10x-x-109">0.7</span></span><span id="textcolor14885"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor14886"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor14887"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor14888"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor14889"><span 
class="aett-10x-x-109">(burkitt</span></span><span id="textcolor14890"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14891"><span 
class="aett-10x-x-109">t,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14892"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor14893"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14894"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14895"><span 
class="aett-10x-x-109">,n),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14896"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor14897"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14898"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">h</span><span 
class="tctt-1095">'</span></span><span id="textcolor14899"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14900"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor14901"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14902"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor14903"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor14904"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14905"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14906"><span 
class="aett-10x-x-109">axes</span></span><span id="textcolor14907"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14908"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor14909"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14910"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor14911"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14912"><span 
class="tctt-1095">''</span></span><span id="textcolor14913"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14914"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor14915"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14916"><span 
class="tctt-1095">''</span></span><span id="textcolor14917"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor14918"><span 
class="aett-10x-x-109">box</span></span><span id="textcolor14919"><span 
class="aett-10x-x-109">();</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14920"><span 
class="aett-10x-x-109">axis</span></span><span id="textcolor14921"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14922"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor14923"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 37--><p class="indent" >   We have to define a set of knots over time in order to fit SPDE spatio temporal model. It is
then used to built a temporal mesh  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14963"></p>     
<div class="alltt">                                                                                                                </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14965"><div class="obeylines-v">
<span id="textcolor14927"><span 
class="aett-10x-x-109">k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14928"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14929"><span 
class="aett-10x-x-109">6</span></span>
<br /><span id="textcolor14930"><span 
class="aett-10x-x-109">tknots</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14931"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14932"><span 
class="aett-10x-x-109">seq</span></span><span id="textcolor14933"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14934"><span 
class="aett-10x-x-109">min</span></span><span id="textcolor14935"><span 
class="aett-10x-x-109">(burkitt</span></span><span id="textcolor14936"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14937"><span 
class="aett-10x-x-109">t),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14938"><span 
class="aett-10x-x-109">max</span></span><span id="textcolor14939"><span 
class="aett-10x-x-109">(burkitt</span></span><span id="textcolor14940"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor14941"><span 
class="aett-10x-x-109">t),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14942"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor14943"><span 
class="aett-10x-x-109">=k)</span></span>
<br /><span id="textcolor14944"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor14945"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14946"><span 
class="aett-10x-x-109">v</span></span><span id="textcolor14947"><span 
class="aett-10x-x-109">=tknots,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14948"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor14949"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14950"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor14951"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14952"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor14953"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14954"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor14955"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14956"><span 
class="aeitt-10x-x-109">##</span><span 
class="aeitt-10x-x-109">&#x00A0;add</span><span 
class="aeitt-10x-x-109">&#x00A0;to</span><span 
class="aeitt-10x-x-109">&#x00A0;plot</span></span>
<br /><span id="textcolor14957"><span 
class="aett-10x-x-109">mesh.t</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14958"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14959"><span 
class="aett-10x-x-109">inla.mesh.1d</span></span><span id="textcolor14960"><span 
class="aett-10x-x-109">(tknots)</span></span>
</div>
</div>                                                                          </span></div>-
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x15-1000011"></a>
                                                                                 
                                                                                 
<!--l. 55--><p class="noindent" ><img 
src="spde-tutorial96x.png" alt="PIC" class="graphics" width="426.79497pt" height="85.35966pt"  /><!--tex4ht:graphics  
name="spde-tutorial96x.png" src="figs/stpptimeplot-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;11.1: </span><span  
class="content">Time when each event occurred (black) and knots used for inference (blue).</span></div><!--tex4ht:label?: x15-1000011 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 61--><p class="indent" >   The spatial mesh can be done using the polygon of the region as a boundary. We can convert
the domain polygon into a <span 
class="aett-10x-x-109">SpatialPolygons </span>class with  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox14982"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14967"><span 
class="aett-10x-x-109">domainSP</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14968"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14969"><span 
class="aett-10x-x-109">SpatialPolygons</span></span><span id="textcolor14970"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14971"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor14972"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14973"><span 
class="aett-10x-x-109">Polygons</span></span><span id="textcolor14974"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14975"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor14976"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14977"><span 
class="aett-10x-x-109">Polygon</span></span><span id="textcolor14978"><span 
class="aett-10x-x-109">(burbdy)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14979"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">0</span><span 
class="tctt-1095">'</span></span><span id="textcolor14980"><span 
class="aett-10x-x-109">)))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 72--><p class="indent" >   and the use it as a boundary  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15006"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor14984"><span 
class="aett-10x-x-109">mesh.s</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14985"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14986"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor14987"><span 
class="aett-10x-x-109">(burpts,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14988"><span 
class="aett-10x-x-109">boundary</span></span><span id="textcolor14989"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14990"><span 
class="aett-10x-x-109">inla.sp2segment</span></span><span id="textcolor14991"><span 
class="aett-10x-x-109">(domainSP),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14992"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor14993"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor14994"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor14995"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor14996"><span 
class="aett-10x-x-109">10</span></span><span id="textcolor14997"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14998"><span 
class="aett-10x-x-109">25</span></span><span id="textcolor14999"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15000"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor15001"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15002"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor15003"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15004"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;just</span><span 
class="aeitt-10x-x-109">&#x00A0;a</span><span 
class="aeitt-10x-x-109">&#x00A0;crude</span><span 
class="aeitt-10x-x-109">&#x00A0;mesh</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 82--><p class="indent" >   Defining the SPDE model considering the PC-prior derived in <span class="cite">[<a 
href="spde-tutorialli2.html#Xfuglstadetal:2017">Fuglstad et&#x00A0;al., 2017</a>]</span> for the
model parameters as the practical range, <img 
src="spde-tutorial97x.png" alt="&#x221A; ---
  8&#x03BD;"  class="sqrt"  /><span 
class="cmmi-10x-x-109">&#x2215;&#x03BA;</span>, and the marginal standard deviation.
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15043"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15008"><span 
class="aett-10x-x-109">spde</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15009"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15010"><span 
class="aett-10x-x-109">inla.spde2.pcmatern</span></span><span id="textcolor15011"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15012"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor15013"><span 
class="aett-10x-x-109">=mesh.s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15014"><span 
class="aett-10x-x-109">alpha</span></span><span id="textcolor15015"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15016"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15017"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15018"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;mesh</span><span 
class="aeitt-10x-x-109">&#x00A0;and</span><span 
class="aeitt-10x-x-109">&#x00A0;smoothness</span><span 
class="aeitt-10x-x-109">&#x00A0;parameter</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15019"><span 
class="aett-10x-x-109">prior.range</span></span><span id="textcolor15020"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15021"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15022"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15023"><span 
class="aett-10x-x-109">0.05</span></span><span id="textcolor15024"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15025"><span 
class="aett-10x-x-109">0.01</span></span><span id="textcolor15026"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15027"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;P(practic.range&#x003C;0.05)=0.01</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15028"><span 
class="aett-10x-x-109">prior.sigma</span></span><span id="textcolor15029"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15030"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15031"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15032"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15033"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15034"><span 
class="aett-10x-x-109">0.01</span></span><span id="textcolor15035"><span 
class="aett-10x-x-109">))</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15036"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;P(sigma&#x003E;1)=0.01</span></span>
<br /><span id="textcolor15037"><span 
class="aett-10x-x-109">m</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15038"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15039"><span 
class="aett-10x-x-109">spde</span></span><span id="textcolor15040"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15041"><span 
class="aett-10x-x-109">n.spde</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 98--><p class="indent" >   The spatio temporal projector matrix is made considering both spatial and temporal
locations and both spatial and temporal meshes.  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15068"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15045"><span 
class="aett-10x-x-109">dim</span></span><span id="textcolor15046"><span 
class="aett-10x-x-109">(Ast</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15047"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15048"><span 
class="aett-10x-x-109">inla.spde.make.A</span></span><span id="textcolor15049"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15050"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor15051"><span 
class="aett-10x-x-109">=mesh.s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15052"><span 
class="aett-10x-x-109">loc</span></span><span id="textcolor15053"><span 
class="aett-10x-x-109">=burpts,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15054"><span 
class="aett-10x-x-109">n.group</span></span><span id="textcolor15055"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15056"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor15057"><span 
class="aett-10x-x-109">(mesh.t</span></span><span id="textcolor15058"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15059"><span 
class="aett-10x-x-109">n),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15060"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor15061"><span 
class="aett-10x-x-109">=burkitt</span></span><span id="textcolor15062"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15063"><span 
class="aett-10x-x-109">t,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15064"><span 
class="aett-10x-x-109">group.mesh</span></span><span id="textcolor15065"><span 
class="aett-10x-x-109">=mesh.t))</span></span>
</div>
</div>                                                                          </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15070">   <div class="verbatim" id="verbatim-135">
##&#x00A0;[1]&#x00A0;&#x00A0;188&#x00A0;3234
</div>
<!--l. 108--><p class="nopar" >                                                                          </span></div>-
<!--l. 111--><p class="indent" >   Internally <span 
class="aett-10x-x-109">inla.spde.make.A </span>function makes a row Kronecker product (see <span 
class="aett-10x-x-109">inla.row.kron</span>)
between the spatial projector and the group (temporal in our case) projector. This matrix has
number of columns equals to the number of nodes in the mesh times the number of
groups.
</p><!--l. 115--><p class="indent" >   The index set is made considering the group feature:  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15085"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15072"><span 
class="aett-10x-x-109">idx</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15073"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15074"><span 
class="aett-10x-x-109">inla.spde.make.index</span></span><span id="textcolor15075"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15076"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">s</span><span 
class="tctt-1095">'</span></span><span id="textcolor15077"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;spde</span></span><span id="textcolor15078"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15079"><span 
class="aett-10x-x-109">n.spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15080"><span 
class="aett-10x-x-109">n.group</span></span><span id="textcolor15081"><span 
class="aett-10x-x-109">=mesh.t</span></span><span id="textcolor15082"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15083"><span 
class="aett-10x-x-109">n)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 124--><p class="indent" >   The data stack can be made considering the ideas for the purerly spatial model. So, we do
need to consider the expected number of cases at the 1) integration points and 2) data locations.
For the integration points it is the spacetime volume computed for each mesh node and time
knot, considering the spatial area of the dual mesh polygons, as in Chapter&#x00A0;<a 
href="spde-tutorialch10.html#x14-8700010">10<!--tex4ht:ref: ch:lcox --></a>, times the the
length of the time window at each time point. For the data locations it is zero as for a point the
expectation is zero, in accord to the likelihood approximation proposed by <span class="cite">[<a 
href="spde-tutorialli2.html#Xsimpsonetal:2016">Simpson et&#x00A0;al.,
2016</a>]</span>.
</p><!--l. 135--><p class="indent" >   The dual mesh is extracted considering the function <span 
class="aett-10x-x-109">inla.mesh.dual()</span>, available in
<a 
href="http://www.math.ntnu.no/inla/r-inla.org/tutorials/spde/R/spde-tutorial-functions.R" class="url" ><span 
class="aett-10x-x-109">http://www.math.ntnu.no/inla/r-_inla.org/tutorials/spde/R/spde-_tutorial-_functions.R</span></a>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15096"></p>   
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15087"><span 
class="aett-10x-x-109">source</span></span><span id="textcolor15088"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15089"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">R/spde-tutorial-functions.R</span><span 
class="tctt-1095">'</span></span><span id="textcolor15090"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15091"><span 
class="aett-10x-x-109">dmesh</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15092"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15093"><span 
class="aett-10x-x-109">inla.mesh.dual</span></span><span id="textcolor15094"><span 
class="aett-10x-x-109">(mesh.s)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 148--><p class="indent" >   Them, we compute the intersection with each polygon from the mesh dual using the
functions <span 
class="aett-10x-x-109">gIntersection() </span>from the <span 
class="aessbx-10x-x-109">rgeos </span>package (show the sum of the intersection polygons
areas):  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15131"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15098"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor15099"><span 
class="aett-10x-x-109">(rgeos)</span></span>
<br /><span id="textcolor15100"><span 
class="aett-10x-x-109">sum</span></span><span id="textcolor15101"><span 
class="aett-10x-x-109">(w</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15102"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15103"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor15104"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15105"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15106"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor15107"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor15108"><span 
class="aett-10x-x-109">(dmesh),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15109"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor15110"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15111"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor15112"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15113"><span 
class="aett-10x-x-109">if</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15114"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15115"><span 
class="aett-10x-x-109">gIntersects</span></span><span id="textcolor15116"><span 
class="aett-10x-x-109">(dmesh[i,],</span><span 
class="aett-10x-x-109">&#x00A0;domainSP))</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15117"><span 
class="aett-10x-x-109">return</span></span><span id="textcolor15118"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15119"><span 
class="aett-10x-x-109">gArea</span></span><span id="textcolor15120"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15121"><span 
class="aett-10x-x-109">gIntersection</span></span><span id="textcolor15122"><span 
class="aett-10x-x-109">(dmesh[i,],</span><span 
class="aett-10x-x-109">&#x00A0;domainSP)))</span></span>                 </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15133"><br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15123"><span 
class="aett-10x-x-109">else</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15124"><span 
class="aett-10x-x-109">return</span></span><span id="textcolor15125"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15126"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15127"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15128"><span 
class="aett-10x-x-109">}))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-136">
##&#x00A0;[1]&#x00A0;11035.01
</div>
<!--l. 165--><p class="nopar" >                                                                          </span></div>-
<!--l. 168--><p class="indent" >   We can see that it sum up the same as the domain area:  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15138"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15135"><span 
class="aett-10x-x-109">gArea</span></span><span id="textcolor15136"><span 
class="aett-10x-x-109">(domainSP)</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-137">
##&#x00A0;[1]&#x00A0;11035.01
</div>
<!--l. 176--><p class="nopar" >                                                                          </span></div>-
<!--l. 180--><p class="indent" >   The spatio temporal volume is the product of these values and the time window length of
each time knot.  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15154"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15140"><span 
class="aett-10x-x-109">st.vol</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15141"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15142"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor15143"><span 
class="aett-10x-x-109">(w,</span><span 
class="aett-10x-x-109">&#x00A0;k)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15144"><span 
class="aett-10x-x-109">*</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15145"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor15146"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15147"><span 
class="aett-10x-x-109">diag</span></span><span id="textcolor15148"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15149"><span 
class="aett-10x-x-109">inla.mesh.fem</span></span><span id="textcolor15150"><span 
class="aett-10x-x-109">(mesh.t)</span></span><span id="textcolor15151"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15152"><span 
class="aett-10x-x-109">c0),</span><span 
class="aett-10x-x-109">&#x00A0;m)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 189--><p class="indent" >   The data stack is built using  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15219"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15156"><span 
class="aett-10x-x-109">y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15157"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15158"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor15159"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15160"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15161"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor15162"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15163"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15164"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15165"><span 
class="aett-10x-x-109">(k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15166"><span 
class="aett-10x-x-109">*</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15167"><span 
class="aett-10x-x-109">m,</span><span 
class="aett-10x-x-109">&#x00A0;n))</span></span>
<br /><span id="textcolor15168"><span 
class="aett-10x-x-109">expected</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15169"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15170"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15171"><span 
class="aett-10x-x-109">(st.vol,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15172"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor15173"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15174"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15175"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;n))</span></span>
<br /><span id="textcolor15176"><span 
class="aett-10x-x-109">stk</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15177"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15178"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor15179"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15180"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor15181"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15182"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15183"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15184"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor15185"><span 
class="aett-10x-x-109">=y,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15186"><span 
class="aett-10x-x-109">expect</span></span><span id="textcolor15187"><span 
class="aett-10x-x-109">=expected),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15188"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor15189"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15190"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15191"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15192"><span 
class="aett-10x-x-109">rBind</span></span><span id="textcolor15193"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15194"><span 
class="aett-10x-x-109">Diagonal</span></span><span id="textcolor15195"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15196"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor15197"><span 
class="aett-10x-x-109">=k</span></span><span id="textcolor15198"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor15199"><span 
class="aett-10x-x-109">m),</span><span 
class="aett-10x-x-109">&#x00A0;Ast),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15200"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15201"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15202"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor15203"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15204"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15205"><span 
class="aett-10x-x-109">(idx,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15206"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15207"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15208"><span 
class="aett-10x-x-109">a0</span></span><span id="textcolor15209"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15210"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor15211"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15212"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15213"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;k</span></span><span id="textcolor15214"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor15215"><span 
class="aett-10x-x-109">m</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15216"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15217"><span 
class="aett-10x-x-109">n))))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 202--><p class="indent" >   Model fitting (using the cruder approximation: &#8217;gaussian&#8217;)  
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15296"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15221"><span 
class="aett-10x-x-109">pcrho</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15222"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15223"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15224"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15225"><span 
class="aett-10x-x-109">prior</span></span><span id="textcolor15226"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15227"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">pccor1</span><span 
class="tctt-1095">'</span></span><span id="textcolor15228"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15229"><span 
class="aett-10x-x-109">param</span></span><span id="textcolor15230"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15231"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15232"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15233"><span 
class="aett-10x-x-109">0.7</span></span><span id="textcolor15234"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15235"><span 
class="aett-10x-x-109">0.7</span></span><span id="textcolor15236"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor15237"><span 
class="aett-10x-x-109">form</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15238"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15239"><span 
class="aett-10x-x-109">y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15240"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15241"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15242"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15243"><span 
class="aett-10x-x-109">a0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15244"><span 
class="aett-10x-x-109">+</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15245"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor15246"><span 
class="aett-10x-x-109">(s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15247"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor15248"><span 
class="aett-10x-x-109">=spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15249"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor15250"><span 
class="aett-10x-x-109">=s.group,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15251"><span 
class="aett-10x-x-109">control.group</span></span><span id="textcolor15252"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15253"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15254"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15255"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor15256"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15257"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">ar1</span><span 
class="tctt-1095">'</span></span><span id="textcolor15258"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15259"><span 
class="aett-10x-x-109">hyper</span></span><span id="textcolor15260"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15261"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15262"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15263"><span 
class="aett-10x-x-109">theta</span></span><span id="textcolor15264"><span 
class="aett-10x-x-109">=pcrho)))</span></span>
<br /><span id="textcolor15265"><span 
class="aett-10x-x-109">burk.res</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15266"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15267"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor15268"><span 
class="aett-10x-x-109">(form,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15269"><span 
class="aett-10x-x-109">family</span></span><span id="textcolor15270"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15271"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">poisson</span><span 
class="tctt-1095">'</span></span><span id="textcolor15272"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15273"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor15274"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15275"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor15276"><span 
class="aett-10x-x-109">(stk),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15277"><span 
class="aett-10x-x-109">E</span></span><span id="textcolor15278"><span 
class="aett-10x-x-109">=expect,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15279"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor15280"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15281"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15282"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15283"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor15284"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15285"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor15286"><span 
class="aett-10x-x-109">(stk)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15287"><span 
class="aett-10x-x-109">control.inla</span></span><span id="textcolor15288"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15289"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15290"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15291"><span 
class="aett-10x-x-109">strategy</span></span><span id="textcolor15292"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15293"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">gaussian</span><span 
class="tctt-1095">'</span></span><span id="textcolor15294"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 218--><p class="indent" >   The exponential of the intercept plus the random effect at each spacetime integration point is
the relative risk at each these points. This relative risk times the spacetime volume will give the
expected number of points at each these spacetime locations. Summing it will approaches the
number of observations:  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15327"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15298"><span 
class="aett-10x-x-109">eta.at.integration.points</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15299"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15300"><span 
class="aett-10x-x-109">burk.res</span></span><span id="textcolor15301"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15302"><span 
class="aett-10x-x-109">summary.fix[</span></span><span id="textcolor15303"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15304"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15305"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15306"><span 
class="aett-10x-x-109">]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15307"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15308"><span 
class="aett-10x-x-109">burk.res</span></span><span id="textcolor15309"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15310"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor15311"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15312"><span 
class="aett-10x-x-109">s</span></span><span id="textcolor15313"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15314"><span 
class="aett-10x-x-109">mean</span></span>
<br /><span id="textcolor15315"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15316"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15317"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor15318"><span 
class="aett-10x-x-109">=n,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15319"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">E(n)</span><span 
class="tctt-1095">'</span></span><span id="textcolor15320"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15321"><span 
class="aett-10x-x-109">sum</span></span><span id="textcolor15322"><span 
class="aett-10x-x-109">(st.vol</span></span><span id="textcolor15323"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor15324"><span 
class="aett-10x-x-109">exp</span></span><span id="textcolor15325"><span 
class="aett-10x-x-109">(eta.at.integration.points)))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-138">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;n&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;E(n)
&#x00A0;<br />##&#x00A0;188.0000&#x00A0;187.9949
</div>
<!--l. 230--><p class="nopar" >                                                                          </span></div>-
<!--l. 234--><p class="indent" >   We can plot the posterior marginal distributions for the intercept and parameters, in
Figure&#x00A0;<a 
href="#x15-10000011.1">11.1<!--tex4ht:ref: fig:irf --></a>, with  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15442"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15329"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor15330"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15331"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor15332"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15333"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15334"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15335"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15336"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15337"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15338"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15339"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor15340"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15341"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15342"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15343"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor15344"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15345"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor15346"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15347"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15348"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15349"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15350"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15351"><span 
class="aett-10x-x-109">mgp</span></span><span id="textcolor15352"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15353"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15354"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15355"><span 
class="aett-10x-x-109">1.7</span></span><span id="textcolor15356"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15357"><span 
class="aett-10x-x-109">0.7</span></span><span id="textcolor15358"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15359"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15360"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor15361"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor15362"><span 
class="aett-10x-x-109">(burk.res</span></span><span id="textcolor15363"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15364"><span 
class="aett-10x-x-109">marginals.fix[[</span></span><span id="textcolor15365"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15366"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15367"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor15368"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15369"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor15370"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15371"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor15372"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15373"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Intercept</span><span 
class="tctt-1095">'</span></span><span id="textcolor15374"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15375"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor15376"><span 
class="aett-10x-x-109">(burk.res</span></span><span id="textcolor15377"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15378"><span 
class="aett-10x-x-109">marginals.hy[[</span></span><span id="textcolor15379"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15380"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15381"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor15382"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15383"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor15384"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15385"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor15386"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15387"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15388"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15389"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15390"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15391"><span 
class="aett-10x-x-109">10</span></span><span id="textcolor15392"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15393"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor15394"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15395"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Practical</span><span 
class="aett-10x-x-109">&#x00A0;range</span><span 
class="tctt-1095">'</span></span><span id="textcolor15396"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15397"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor15398"><span 
class="aett-10x-x-109">(burk.res</span></span><span id="textcolor15399"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15400"><span 
class="aett-10x-x-109">marginals.hy[[</span></span><span id="textcolor15401"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15402"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15403"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor15404"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15405"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor15406"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15407"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor15408"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15409"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15410"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15411"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15412"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15413"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor15414"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15415"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor15416"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15417"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Standard</span><span 
class="aett-10x-x-109">&#x00A0;deviation</span><span 
class="tctt-1095">'</span></span><span id="textcolor15418"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15419"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor15420"><span 
class="aett-10x-x-109">(burk.res</span></span><span id="textcolor15421"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15422"><span 
class="aett-10x-x-109">marginals.hy[[</span></span><span id="textcolor15423"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor15424"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15425"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor15426"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15427"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor15428"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15429"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor15430"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15431"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15432"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15433"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15434"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15435"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15436"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15437"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor15438"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15439"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">time</span><span 
class="aett-10x-x-109">&#x00A0;correlation</span><span 
class="tctt-1095">'</span></span><span id="textcolor15440"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>                                                                          </span></div>-
                                                                                 
                                                                                 
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x15-1000022"></a>
                                                                                 
                                                                                 
<!--l. 252--><p class="noindent" ><img 
src="spde-tutorial98x.png" alt="PIC" class="graphics" width="413.99164pt" height="295.71414pt"  /><!--tex4ht:graphics  
name="spde-tutorial98x.png" src="figs/stppparsfig-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;11.2: </span><span  
class="content">Intercept and Random Field parameters posterior marginal distributions.</span></div><!--tex4ht:label?: x15-1000022 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 258--><p class="indent" >   The projection over a grid for each time knot can be done with  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15535"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15444"><span 
class="aett-10x-x-109">r0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15445"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15446"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor15447"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15448"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor15449"><span 
class="aett-10x-x-109">(burbdy[,</span></span><span id="textcolor15450"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15451"><span 
class="aett-10x-x-109">]))</span></span><span id="textcolor15452"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor15453"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor15454"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15455"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor15456"><span 
class="aett-10x-x-109">(burbdy[,</span></span><span id="textcolor15457"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15458"><span 
class="aett-10x-x-109">]))</span></span>
<br /><span id="textcolor15459"><span 
class="aett-10x-x-109">prj</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15460"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15461"><span 
class="aett-10x-x-109">inla.mesh.projector</span></span><span id="textcolor15462"><span 
class="aett-10x-x-109">(mesh.s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15463"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor15464"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15465"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor15466"><span 
class="aett-10x-x-109">(burbdy[,</span></span><span id="textcolor15467"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15468"><span 
class="aett-10x-x-109">]),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15469"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor15470"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15471"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor15472"><span 
class="aett-10x-x-109">(burbdy[,</span></span><span id="textcolor15473"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15474"><span 
class="aett-10x-x-109">]),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15475"><span 
class="aett-10x-x-109">dims</span></span><span id="textcolor15476"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15477"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15478"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15479"><span 
class="aett-10x-x-109">100</span></span><span id="textcolor15480"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15481"><span 
class="aett-10x-x-109">100</span></span><span id="textcolor15482"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor15483"><span 
class="aett-10x-x-109">r0))</span></span>
<br /><span id="textcolor15484"><span 
class="aett-10x-x-109">ov</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15485"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15486"><span 
class="aett-10x-x-109">over</span></span><span id="textcolor15487"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15488"><span 
class="aett-10x-x-109">SpatialPoints</span></span><span id="textcolor15489"><span 
class="aett-10x-x-109">(prj</span></span><span id="textcolor15490"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15491"><span 
class="aett-10x-x-109">lattice</span></span><span id="textcolor15492"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15493"><span 
class="aett-10x-x-109">loc),</span><span 
class="aett-10x-x-109">&#x00A0;domainSP)</span></span>
<br /><span id="textcolor15494"><span 
class="aett-10x-x-109">m.prj</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15495"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15496"><span 
class="aett-10x-x-109">lapply</span></span><span id="textcolor15497"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15498"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15499"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor15500"><span 
class="aett-10x-x-109">k,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15501"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor15502"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15503"><span 
class="aett-10x-x-109">j</span></span><span id="textcolor15504"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15505"><span 
class="aett-10x-x-109">r</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15506"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15507"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor15508"><span 
class="aett-10x-x-109">(prj,</span><span 
class="aett-10x-x-109">&#x00A0;burk.res</span></span><span id="textcolor15509"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15510"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor15511"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15512"><span 
class="aett-10x-x-109">s</span></span><span id="textcolor15513"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15514"><span 
class="aett-10x-x-109">mean[</span></span><span id="textcolor15515"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15516"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor15517"><span 
class="aett-10x-x-109">m</span></span><span id="textcolor15518"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor15519"><span 
class="aett-10x-x-109">(j</span></span><span id="textcolor15520"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor15521"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15522"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor15523"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor15524"><span 
class="aett-10x-x-109">m])</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15525"><span 
class="aett-10x-x-109">r[</span></span><span id="textcolor15526"><span 
class="aett-10x-x-109">is.na</span></span><span id="textcolor15527"><span 
class="aett-10x-x-109">(ov)]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15528"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15529"><span 
class="aett-10x-x-109">NA</span></span><span id="textcolor15530"><span 
class="aett-10x-x-109">;</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15531"><span 
class="aett-10x-x-109">return</span></span><span id="textcolor15532"><span 
class="aett-10x-x-109">(r)</span></span>
<br /><span id="textcolor15533"><span 
class="aett-10x-x-109">})</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 274--><p class="indent" >   The fitted latent field at each time knot is in Figure&#x00A0;<a 
href="#x15-10000011.1">11.1<!--tex4ht:ref: fig:stppres --></a>, produced with the code below. It
can also be done for the standard deviation.  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15649"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15537"><span 
class="aett-10x-x-109">igr</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15538"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15539"><span 
class="aett-10x-x-109">apply</span></span><span id="textcolor15540"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15541"><span 
class="aett-10x-x-109">abs</span></span><span id="textcolor15542"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15543"><span 
class="aett-10x-x-109">outer</span></span><span id="textcolor15544"><span 
class="aett-10x-x-109">(burkitt</span></span><span id="textcolor15545"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15546"><span 
class="aett-10x-x-109">t,</span><span 
class="aett-10x-x-109">&#x00A0;mesh.t</span></span><span id="textcolor15547"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15548"><span 
class="aett-10x-x-109">loc,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15549"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">-</span><span 
class="tctt-1095">'</span></span><span id="textcolor15550"><span 
class="aett-10x-x-109">)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15551"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15552"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;which.min)</span></span>
<br /><span id="textcolor15553"><span 
class="aett-10x-x-109">zlm</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15554"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15555"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor15556"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15557"><span 
class="aett-10x-x-109">unlist</span></span><span id="textcolor15558"><span 
class="aett-10x-x-109">(m.prj),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15559"><span 
class="aett-10x-x-109">na.rm</span></span><span id="textcolor15560"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15561"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor15562"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15563"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor15564"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15565"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor15566"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15567"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15568"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15569"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15570"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15571"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor15572"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15573"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor15574"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15575"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15576"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15577"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15578"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15579"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15580"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15581"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15582"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15583"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15584"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor15585"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15586"><span 
class="aett-10x-x-109">(j</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15587"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15588"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15589"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor15590"><span 
class="aett-10x-x-109">k)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15591"><span 
class="aett-10x-x-109">image</span></span><span id="textcolor15592"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15593"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor15594"><span 
class="aett-10x-x-109">=prj</span></span><span id="textcolor15595"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15596"><span 
class="aett-10x-x-109">x,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15597"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor15598"><span 
class="aett-10x-x-109">=prj</span></span><span id="textcolor15599"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15600"><span 
class="aett-10x-x-109">y,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15601"><span 
class="aett-10x-x-109">z</span></span><span id="textcolor15602"><span 
class="aett-10x-x-109">=m.prj[[j]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15603"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor15604"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15605"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15606"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15607"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor15608"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15609"><span 
class="tctt-1095">''</span></span><span id="textcolor15610"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15611"><span 
class="aett-10x-x-109">zlim</span></span><span id="textcolor15612"><span 
class="aett-10x-x-109">=zlm,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15613"><span 
class="aett-10x-x-109">axes</span></span><span id="textcolor15614"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15615"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor15616"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15617"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor15618"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15619"><span 
class="aett-10x-x-109">tim.colors</span></span><span id="textcolor15620"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15621"><span 
class="aett-10x-x-109">64</span></span><span id="textcolor15622"><span 
class="aett-10x-x-109">))</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15623"><span 
class="aett-10x-x-109">points</span></span><span id="textcolor15624"><span 
class="aett-10x-x-109">(burkitt[igr</span></span><span id="textcolor15625"><span 
class="aett-10x-x-109">==</span></span><span id="textcolor15626"><span 
class="aett-10x-x-109">j,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15627"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15628"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor15629"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15630"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15631"><span 
class="aett-10x-x-109">pch</span></span><span id="textcolor15632"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15633"><span 
class="aett-10x-x-109">19</span></span><span id="textcolor15634"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15635"><span 
class="aett-10x-x-109">};</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15636"><span 
class="aett-10x-x-109">image.plot</span></span><span id="textcolor15637"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15638"><span 
class="aett-10x-x-109">legend.only</span></span><span id="textcolor15639"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15640"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor15641"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15642"><span 
class="aett-10x-x-109">zlim</span></span><span id="textcolor15643"><span 
class="aett-10x-x-109">=zlm,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15644"><span 
class="aett-10x-x-109">legend.mar</span></span><span id="textcolor15645"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15646"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor15647"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>                                                                          </span></div>-
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x15-1000033"></a>
                                                                                 
                                                                                 
<!--l. 294--><p class="noindent" ><img 
src="spde-tutorial99x.png" alt="PIC" class="graphics" width="413.99164pt" height="579.59357pt"  /><!--tex4ht:graphics  
name="spde-tutorial99x.png" src="figs/stppstppres-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;11.3: </span><span  
class="content">Fitted latent field at each time knot overlayed by the points closer in time.</span></div><!--tex4ht:label?: x15-1000033 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
   <h3 class="sectionHead"><span class="titlemark">11.2   </span> <a 
 id="x15-10100011.2"></a>Large data set</h3>
<!--l. 17--><p class="noindent" >We are going to drawn samples from a separable space time intensity function.
</p><!--l. 19--><p class="indent" >   First we define the spatial domain as follows  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15708"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15651"><span 
class="aett-10x-x-109">x0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15652"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15653"><span 
class="aett-10x-x-109">seq</span></span><span id="textcolor15654"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15655"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15656"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15657"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor15658"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor15659"><span 
class="aett-10x-x-109">pi,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15660"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor15661"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15662"><span 
class="aett-10x-x-109">15</span></span><span id="textcolor15663"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15664"><span 
class="aett-10x-x-109">domain</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15665"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15666"><span 
class="aett-10x-x-109">data.frame</span></span><span id="textcolor15667"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15668"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor15669"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15670"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15671"><span 
class="aett-10x-x-109">(x0,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15672"><span 
class="aett-10x-x-109">rev</span></span><span id="textcolor15673"><span 
class="aett-10x-x-109">(x0),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15674"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15675"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor15676"><span 
class="aett-10x-x-109">domain</span></span><span id="textcolor15677"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15678"><span 
class="aett-10x-x-109">y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15679"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15680"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15681"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15682"><span 
class="aett-10x-x-109">sin</span></span><span id="textcolor15683"><span 
class="aett-10x-x-109">(x0</span></span><span id="textcolor15684"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor15685"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15686"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor15687"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor15688"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15689"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15690"><span 
class="aett-10x-x-109">sin</span></span><span id="textcolor15691"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15692"><span 
class="aett-10x-x-109">rev</span></span><span id="textcolor15693"><span 
class="aett-10x-x-109">(x0</span></span><span id="textcolor15694"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor15695"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15696"><span 
class="aett-10x-x-109">))</span></span><span id="textcolor15697"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor15698"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15699"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15700"><span 
class="aett-10x-x-109">sin</span></span><span id="textcolor15701"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15702"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15703"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor15704"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor15705"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15706"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 29--><p class="indent" >   and convert it into the <span 
class="aett-10x-x-109">SpatialPolygons </span>class  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15727"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15710"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor15711"><span 
class="aett-10x-x-109">(sp)</span></span>
<br /><span id="textcolor15712"><span 
class="aett-10x-x-109">domainSP</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15713"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15714"><span 
class="aett-10x-x-109">SpatialPolygons</span></span><span id="textcolor15715"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15716"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15717"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15718"><span 
class="aett-10x-x-109">Polygons</span></span><span id="textcolor15719"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15720"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor15721"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15722"><span 
class="aett-10x-x-109">Polygon</span></span><span id="textcolor15723"><span 
class="aett-10x-x-109">(domain)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15724"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">0</span><span 
class="tctt-1095">'</span></span><span id="textcolor15725"><span 
class="aett-10x-x-109">)))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 39--><p class="indent" >   We choose to sample a dataset using the <span 
class="aessbx-10x-x-109">lgcp</span>, <span class="cite">[<a 
href="spde-tutorialli2.html#XtaylorDRD:2013">Taylor et&#x00A0;al., 2013</a>]</span>, package as follows
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15786"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15729"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor15730"><span 
class="aett-10x-x-109">(lgcp)</span></span>
<br /><span id="textcolor15731"><span 
class="aett-10x-x-109">ndays</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15732"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15733"><span 
class="aett-10x-x-109">15</span></span>
<br /><span id="textcolor15734"><span 
class="aett-10x-x-109">n</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15735"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15736"><span 
class="aett-10x-x-109">(xyt</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15737"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15738"><span 
class="aett-10x-x-109">lgcpSim</span></span><span id="textcolor15739"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15740"><span 
class="aett-10x-x-109">owin</span></span><span id="textcolor15741"><span 
class="aett-10x-x-109">=spatstat</span></span><span id="textcolor15742"><span 
class="aett-10x-x-109">:::</span></span><span id="textcolor15743"><span 
class="aett-10x-x-109">owin</span></span><span id="textcolor15744"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15745"><span 
class="aett-10x-x-109">poly</span></span><span id="textcolor15746"><span 
class="aett-10x-x-109">=domain),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15747"><span 
class="aett-10x-x-109">tlim</span></span><span id="textcolor15748"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15749"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15750"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15751"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15752"><span 
class="aett-10x-x-109">,ndays),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15753"><span 
class="aett-10x-x-109">model.parameters</span></span><span id="textcolor15754"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15755"><span 
class="aett-10x-x-109">lgcppars</span></span><span id="textcolor15756"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15757"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15758"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15759"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor15760"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15761"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor15762"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15763"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15764"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15765"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor15766"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15767"><span 
class="aett-10x-x-109">cellwidth</span></span><span id="textcolor15768"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15769"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor15770"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15771"><span 
class="aett-10x-x-109">spatial.covmodel</span></span><span id="textcolor15772"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15773"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">matern</span><span 
class="tctt-1095">'</span></span><span id="textcolor15774"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15775"><span 
class="aett-10x-x-109">covpars</span></span><span id="textcolor15776"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15777"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15778"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15779"><span 
class="aett-10x-x-109">nu</span></span><span id="textcolor15780"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15781"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15782"><span 
class="aett-10x-x-109">)))</span></span><span id="textcolor15783"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15784"><span 
class="aett-10x-x-109">n</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 54--><p class="indent" >   In order to fit the model, we do need to define a discretization over space and over time.
For the time domain, we define a temporal mesh based on a number of time knots:
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15803"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15788"><span 
class="aett-10x-x-109">k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15789"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15790"><span 
class="aett-10x-x-109">7</span></span><span id="textcolor15791"><span 
class="aett-10x-x-109">;</span><span 
class="aett-10x-x-109">&#x00A0;tmesh</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15792"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15793"><span 
class="aett-10x-x-109">inla.mesh.1d</span></span><span id="textcolor15794"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15795"><span 
class="aett-10x-x-109">seq</span></span><span id="textcolor15796"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15797"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15798"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;ndays,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15799"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor15800"><span 
class="aett-10x-x-109">=k))</span></span>                    </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15805"></div></div>                                                                          </span></div>-
<!--l. 63--><p class="indent" >   The spatial mesh is defined using the domain polygon:  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15824"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15807"><span 
class="aett-10x-x-109">smesh</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15808"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15809"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor15810"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15811"><span 
class="aett-10x-x-109">boundary</span></span><span id="textcolor15812"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15813"><span 
class="aett-10x-x-109">inla.sp2segment</span></span><span id="textcolor15814"><span 
class="aett-10x-x-109">(domainSP),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15815"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor15816"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15817"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15818"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15819"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor15820"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15821"><span 
class="aett-10x-x-109">0.3</span></span><span id="textcolor15822"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 73--><p class="indent" >   We can have a look in Figure&#x00A0;<a 
href="#x15-10100011.2">11.2<!--tex4ht:ref: fig:stlppshow --></a> to see a plot of a sample of the data over time, the
time knots and over space and the spatial mesh as well with the commands below
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15953"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15826"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor15827"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15828"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor15829"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15830"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15831"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15832"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15833"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15834"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15835"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15836"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor15837"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15838"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15839"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15840"><span 
class="aett-10x-x-109">1.5</span></span><span id="textcolor15841"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15842"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15843"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15844"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15845"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15846"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15847"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15848"><span 
class="aett-10x-x-109">mgp</span></span><span id="textcolor15849"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15850"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15851"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15852"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15853"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15854"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor15855"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15856"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15857"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor15858"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor15859"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15860"><span 
class="aett-10x-x-109">sample</span></span><span id="textcolor15861"><span 
class="aett-10x-x-109">(xyt</span></span><span id="textcolor15862"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15863"><span 
class="aett-10x-x-109">t,</span></span><span id="textcolor15864"><span 
class="aett-10x-x-109">500</span></span><span id="textcolor15865"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15866"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor15867"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15868"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15869"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15870"><span 
class="aett-10x-x-109">500</span></span><span id="textcolor15871"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15872"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor15873"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15874"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">h</span><span 
class="tctt-1095">'</span></span><span id="textcolor15875"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15876"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor15877"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15878"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15879"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor15880"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15881"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15882"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor15883"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15884"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Day</span><span 
class="tctt-1095">'</span></span><span id="textcolor15885"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15886"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor15887"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15888"><span 
class="tctt-1095">''</span></span><span id="textcolor15889"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15890"><span 
class="aett-10x-x-109">axes</span></span><span id="textcolor15891"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15892"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor15893"><span 
class="aett-10x-x-109">);</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15894"><span 
class="aett-10x-x-109">box</span></span><span id="textcolor15895"><span 
class="aett-10x-x-109">();</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15896"><span 
class="aett-10x-x-109">axis</span></span><span id="textcolor15897"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15898"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15899"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15900"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor15901"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15902"><span 
class="aett-10x-x-109">v</span></span><span id="textcolor15903"><span 
class="aett-10x-x-109">=tmesh</span></span><span id="textcolor15904"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15905"><span 
class="aett-10x-x-109">loc,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15906"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor15907"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15908"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor15909"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15910"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor15911"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15912"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor15913"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15914"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor15915"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15916"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor15917"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15918"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor15919"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15920"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15921"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15922"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15923"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15924"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15925"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor15926"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor15927"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor15928"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor15929"><span 
class="aett-10x-x-109">(smesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15930"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor15931"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15932"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15933"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15934"><span 
class="aett-10x-x-109">main</span></span><span id="textcolor15935"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15936"><span 
class="tctt-1095">''</span></span><span id="textcolor15937"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor15938"><span 
class="aett-10x-x-109">points</span></span><span id="textcolor15939"><span 
class="aett-10x-x-109">(xyt</span></span><span id="textcolor15940"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15941"><span 
class="aett-10x-x-109">x,</span><span 
class="aett-10x-x-109">&#x00A0;xyt</span></span><span id="textcolor15942"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15943"><span 
class="aett-10x-x-109">y,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15944"><span 
class="aett-10x-x-109">cex</span></span><span id="textcolor15945"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15946"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor15947"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15948"><span 
class="aett-10x-x-109">pch</span></span><span id="textcolor15949"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor15950"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor15951"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>                                                                          </span></div>-
                                                                                 
                                                                                 
<!--l. 87--><p class="indent" >   <img 
src="spde-tutorial100x.png" alt="PIC" class="graphics" width="426.79497pt" height="426.80608pt"  /><!--tex4ht:graphics  
name="spde-tutorial100x.png" src="figs/stppstplot-1.eps"  
-->
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x15-1010014"></a>
                                                                                 
                                                                                 
<!--l. 94--><p class="noindent" ><img 
src="spde-tutorial101x.png" alt="PIC" class="graphics" width="426.79497pt" height="170.71933pt"  /><!--tex4ht:graphics  
name="spde-tutorial101x.png" src="figs/stppstfit-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;11.4: </span><span  
class="content">Time for a sample of the events (black), time knots (blue) in the upper plot.
Spatial locations of a sample on the spatial domain (botton plot).</span></div><!--tex4ht:label?: x15-1010014 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">11.2.1   </span> <a 
 id="x15-10200011.2.1"></a>Space-time aggregation</h4>
<!--l. 103--><p class="noindent" >For large datasets it can be computationally demanding to fit the model. The problem is
because the dimention of the model would be <span 
class="cmmi-10x-x-109">n </span><span 
class="cmr-10x-x-109">+ </span><span 
class="cmmi-10x-x-109">m</span><span 
class="cmsy-10x-x-109">*</span><span 
class="cmmi-10x-x-109">k</span>, where <span 
class="cmmi-10x-x-109">n </span>is the number of data points, <span 
class="cmmi-10x-x-109">m</span>
is the number of nodes in the mesh, <span 
class="cmmi-10x-x-109">k </span>is the number of time knots. In this section we choose to
aggregate the data in a way that we have a problem with dimention <span 
class="cmr-10x-x-109">2 </span><span 
class="cmsy-10x-x-109">*</span><span 
class="cmmi-10x-x-109">m</span><span 
class="cmsy-10x-x-109">*</span><span 
class="cmmi-10x-x-109">k</span>. So, this approach
really makes sence when <span 
class="cmmi-10x-x-109">n &#x003E;&#x003E; m </span><span 
class="cmsy-10x-x-109">* </span><span 
class="cmmi-10x-x-109">k</span>.
</p><!--l. 111--><p class="indent" >   We choose to aggregate the data in accord to the integration points to make the fitting
process easier. We also consider the dual mesh polygons, as shown in Chapter&#x00A0;<a 
href="spde-tutorialch10.html#x14-8700010">10<!--tex4ht:ref: ch:lcox --></a>.
</p><!--l. 115--><p class="indent" >   So, firt we find the Voronoi polygons for the mesh nodes  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox15974"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15955"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor15956"><span 
class="aett-10x-x-109">(deldir)</span></span>
<br /><span id="textcolor15957"><span 
class="aett-10x-x-109">dd</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15958"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15959"><span 
class="aett-10x-x-109">deldir</span></span><span id="textcolor15960"><span 
class="aett-10x-x-109">(smesh</span></span><span id="textcolor15961"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15962"><span 
class="aett-10x-x-109">loc[,</span></span><span id="textcolor15963"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15964"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;smesh</span></span><span id="textcolor15965"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15966"><span 
class="aett-10x-x-109">loc[,</span></span><span id="textcolor15967"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor15968"><span 
class="aett-10x-x-109">])</span></span>
<br /><span id="textcolor15969"><span 
class="aett-10x-x-109">tiles</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15970"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15971"><span 
class="aett-10x-x-109">tile.list</span></span><span id="textcolor15972"><span 
class="aett-10x-x-109">(dd)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 125--><p class="indent" >   Convert it into <span 
class="aett-10x-x-109">SpatialPolygons</span>:  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16017"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor15976"><span 
class="aett-10x-x-109">polys</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15977"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15978"><span 
class="aett-10x-x-109">SpatialPolygons</span></span><span id="textcolor15979"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15980"><span 
class="aett-10x-x-109">lapply</span></span><span id="textcolor15981"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15982"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor15983"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor15984"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor15985"><span 
class="aett-10x-x-109">(tiles),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15986"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor15987"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor15988"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor15989"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15990"><span 
class="aett-10x-x-109">{</span><span 
class="aett-10x-x-109">&#x00A0;p</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15991"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15992"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor15993"><span 
class="aett-10x-x-109">(tiles[[i]]</span></span><span id="textcolor15994"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15995"><span 
class="aett-10x-x-109">x,</span><span 
class="aett-10x-x-109">&#x00A0;tiles[[i]]</span></span><span id="textcolor15996"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor15997"><span 
class="aett-10x-x-109">y)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15998"><span 
class="aett-10x-x-109">n</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15999"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16000"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor16001"><span 
class="aett-10x-x-109">(p)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16002"><span 
class="aett-10x-x-109">Polygons</span></span><span id="textcolor16003"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16004"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16005"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16006"><span 
class="aett-10x-x-109">Polygon</span></span><span id="textcolor16007"><span 
class="aett-10x-x-109">(p[</span></span><span id="textcolor16008"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor16009"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16010"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16011"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16012"><span 
class="aett-10x-x-109">n,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16013"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16014"><span 
class="aett-10x-x-109">),])),</span><span 
class="aett-10x-x-109">&#x00A0;i)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16015"><span 
class="aett-10x-x-109">}))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 138--><p class="indent" >   Find to which polygon belongs each data point:  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16041"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16019"><span 
class="aett-10x-x-109">area</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16020"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16021"><span 
class="aett-10x-x-109">factor</span></span><span id="textcolor16022"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16023"><span 
class="aett-10x-x-109">over</span></span><span id="textcolor16024"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16025"><span 
class="aett-10x-x-109">SpatialPoints</span></span><span id="textcolor16026"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16027"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor16028"><span 
class="aett-10x-x-109">(xyt</span></span><span id="textcolor16029"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16030"><span 
class="aett-10x-x-109">x,</span><span 
class="aett-10x-x-109">&#x00A0;xyt</span></span><span id="textcolor16031"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16032"><span 
class="aett-10x-x-109">y)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16033"><span 
class="aett-10x-x-109">polys),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16034"><span 
class="aett-10x-x-109">levels</span></span><span id="textcolor16035"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16036"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16037"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16038"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor16039"><span 
class="aett-10x-x-109">(polys))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 147--><p class="indent" >   Fint to which part of the time mesh belongs each data point:  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16097"></p>     
<div class="alltt">                                                                                                                </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16099"><div class="obeylines-v">
<span id="textcolor16043"><span 
class="aett-10x-x-109">t.breaks</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16044"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16045"><span 
class="aett-10x-x-109">sort</span></span><span id="textcolor16046"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16047"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor16048"><span 
class="aett-10x-x-109">(tmesh</span></span><span id="textcolor16049"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16050"><span 
class="aett-10x-x-109">loc[</span></span><span id="textcolor16051"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor16052"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16053"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16054"><span 
class="aett-10x-x-109">,k)],</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16055"><span 
class="aett-10x-x-109">tmesh</span></span><span id="textcolor16056"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16057"><span 
class="aett-10x-x-109">loc[</span></span><span id="textcolor16058"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor16059"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16060"><span 
class="aett-10x-x-109">k</span></span><span id="textcolor16061"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor16062"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16063"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor16064"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor16065"><span 
class="aett-10x-x-109">2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16066"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16067"><span 
class="aett-10x-x-109">tmesh</span></span><span id="textcolor16068"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16069"><span 
class="aett-10x-x-109">loc[</span></span><span id="textcolor16070"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor16071"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16072"><span 
class="aett-10x-x-109">k]</span></span><span id="textcolor16073"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor16074"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor16075"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor16076"><span 
class="aett-10x-x-109">table</span></span><span id="textcolor16077"><span 
class="aett-10x-x-109">(time</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16078"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16079"><span 
class="aett-10x-x-109">factor</span></span><span id="textcolor16080"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16081"><span 
class="aett-10x-x-109">findInterval</span></span><span id="textcolor16082"><span 
class="aett-10x-x-109">(xyt</span></span><span id="textcolor16083"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16084"><span 
class="aett-10x-x-109">t,</span><span 
class="aett-10x-x-109">&#x00A0;t.breaks),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16085"><span 
class="aett-10x-x-109">levels</span></span><span id="textcolor16086"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16087"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16088"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16089"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16090"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor16091"><span 
class="aett-10x-x-109">(t.breaks)</span></span><span id="textcolor16092"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor16093"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16094"><span 
class="aett-10x-x-109">)))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-139">
##
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;3&#x00A0;&#x00A0;&#x00A0;4&#x00A0;&#x00A0;&#x00A0;5&#x00A0;&#x00A0;&#x00A0;6&#x00A0;&#x00A0;&#x00A0;7
&#x00A0;<br />##&#x00A0;177&#x00A0;302&#x00A0;324&#x00A0;362&#x00A0;402&#x00A0;413&#x00A0;196
</div>
<!--l. 160--><p class="nopar" >                                                                          </span></div>-
<!--l. 163--><p class="indent" >   Use these both identification index sets to aggregate the data  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16124"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16101"><span 
class="aett-10x-x-109">agg.dat</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16102"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16103"><span 
class="aett-10x-x-109">as.data.frame</span></span><span id="textcolor16104"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16105"><span 
class="aett-10x-x-109">table</span></span><span id="textcolor16106"><span 
class="aett-10x-x-109">(area,</span><span 
class="aett-10x-x-109">&#x00A0;time))</span></span>
<br /><span id="textcolor16107"><span 
class="aett-10x-x-109">for</span></span><span id="textcolor16108"><span 
class="aett-10x-x-109">(j</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16109"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16110"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16111"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16112"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor16113"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16114"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;set</span><span 
class="aeitt-10x-x-109">&#x00A0;time</span><span 
class="aeitt-10x-x-109">&#x00A0;and</span><span 
class="aeitt-10x-x-109">&#x00A0;area</span><span 
class="aeitt-10x-x-109">&#x00A0;as</span><span 
class="aeitt-10x-x-109">&#x00A0;integer</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16115"><span 
class="aett-10x-x-109">agg.dat[[j]]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16116"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16117"><span 
class="aett-10x-x-109">as.integer</span></span><span id="textcolor16118"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16119"><span 
class="aett-10x-x-109">as.character</span></span><span id="textcolor16120"><span 
class="aett-10x-x-109">(agg.dat[[j]]))</span></span>
<br /><span id="textcolor16121"><span 
class="aett-10x-x-109">str</span></span><span id="textcolor16122"><span 
class="aett-10x-x-109">(agg.dat)</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-140">
##&#x00A0;'data.frame': 1064&#x00A0;obs.&#x00A0;of&#x00A0;&#x00A0;3&#x00A0;variables:
&#x00A0;<br />##&#x00A0;&#x00A0;$&#x00A0;area:&#x00A0;int&#x00A0;&#x00A0;1&#x00A0;2&#x00A0;3&#x00A0;4&#x00A0;5&#x00A0;6&#x00A0;7&#x00A0;8&#x00A0;9&#x00A0;10&#x00A0;...
&#x00A0;<br />##&#x00A0;&#x00A0;$&#x00A0;time:&#x00A0;int&#x00A0;&#x00A0;1&#x00A0;1&#x00A0;1&#x00A0;1&#x00A0;1&#x00A0;1&#x00A0;1&#x00A0;1&#x00A0;1&#x00A0;1&#x00A0;...
&#x00A0;<br />##&#x00A0;&#x00A0;$&#x00A0;Freq:&#x00A0;int&#x00A0;&#x00A0;0&#x00A0;0&#x00A0;1&#x00A0;0&#x00A0;0&#x00A0;1&#x00A0;0&#x00A0;1&#x00A0;2&#x00A0;3&#x00A0;...
</div>
<!--l. 177--><p class="nopar" >                                                                          </span></div>-
<!--l. 181--><p class="indent" >   We need to define the expected number of cases (at least) proportional to the area of the
Polygons times the width length of the time knots. Compute the intersection area of each
polygon with the domain (show the sum).  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16190"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16126"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor16127"><span 
class="aett-10x-x-109">(rgeos)</span></span>
<br /><span id="textcolor16128"><span 
class="aett-10x-x-109">sum</span></span><span id="textcolor16129"><span 
class="aett-10x-x-109">(w.areas</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16130"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16131"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor16132"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16133"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16134"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16135"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor16136"><span 
class="aett-10x-x-109">(tiles),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16137"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor16138"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16139"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor16140"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16141"><span 
class="aett-10x-x-109">{</span><span 
class="aett-10x-x-109">&#x00A0;p</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16142"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16143"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor16144"><span 
class="aett-10x-x-109">(tiles[[i]]</span></span><span id="textcolor16145"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16146"><span 
class="aett-10x-x-109">x,</span><span 
class="aett-10x-x-109">&#x00A0;tiles[[i]]</span></span><span id="textcolor16147"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16148"><span 
class="aett-10x-x-109">y)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16149"><span 
class="aett-10x-x-109">n</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16150"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16151"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor16152"><span 
class="aett-10x-x-109">(p)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16153"><span 
class="aett-10x-x-109">pl</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16154"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16155"><span 
class="aett-10x-x-109">SpatialPolygons</span></span><span id="textcolor16156"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16157"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16158"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16159"><span 
class="aett-10x-x-109">Polygons</span></span><span id="textcolor16160"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16161"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16162"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16163"><span 
class="aett-10x-x-109">Polygon</span></span><span id="textcolor16164"><span 
class="aett-10x-x-109">(p[</span></span><span id="textcolor16165"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor16166"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16167"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16168"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16169"><span 
class="aett-10x-x-109">n,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16170"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16171"><span 
class="aett-10x-x-109">),])),</span><span 
class="aett-10x-x-109">&#x00A0;i)))</span></span> </span> </div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16192"><br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16172"><span 
class="aett-10x-x-109">if</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16173"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16174"><span 
class="aett-10x-x-109">gIntersects</span></span><span id="textcolor16175"><span 
class="aett-10x-x-109">(pl,</span><span 
class="aett-10x-x-109">&#x00A0;domainSP))</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16176"><span 
class="aett-10x-x-109">return</span></span><span id="textcolor16177"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16178"><span 
class="aett-10x-x-109">gArea</span></span><span id="textcolor16179"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16180"><span 
class="aett-10x-x-109">gIntersection</span></span><span id="textcolor16181"><span 
class="aett-10x-x-109">(pl,</span><span 
class="aett-10x-x-109">&#x00A0;domainSP)))</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16182"><span 
class="aett-10x-x-109">else</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16183"><span 
class="aett-10x-x-109">return</span></span><span id="textcolor16184"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16185"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor16186"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16187"><span 
class="aett-10x-x-109">}))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-141">
##&#x00A0;[1]&#x00A0;50.26548
</div>
<!--l. 198--><p class="nopar" >                                                                          </span></div>-
<!--l. 202--><p class="indent" >   A summary of the polygons area is  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16197"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16194"><span 
class="aett-10x-x-109">summary</span></span><span id="textcolor16195"><span 
class="aett-10x-x-109">(w.areas)</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-142">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;Min.&#x00A0;1st&#x00A0;Qu.&#x00A0;&#x00A0;Median&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mean&#x00A0;3rd&#x00A0;Qu.&#x00A0;&#x00A0;&#x00A0;&#x00A0;Max.
&#x00A0;<br />##&#x00A0;0.06293&#x00A0;0.21780&#x00A0;0.35040&#x00A0;0.33070&#x00A0;0.41160&#x00A0;0.69310
</div>
<!--l. 211--><p class="nopar" >                                                                          </span></div>-
<!--l. 214--><p class="indent" >   and the area of the spatial domain is  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16202"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16199"><span 
class="aett-10x-x-109">gArea</span></span><span id="textcolor16200"><span 
class="aett-10x-x-109">(domainSP)</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-143">
##&#x00A0;[1]&#x00A0;50.26548
</div>
<!--l. 222--><p class="nopar" >                                                                          </span></div>-
<!--l. 225--><p class="indent" >   The time length (domain) is 365 and the width of each knot is  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16214"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16204"><span 
class="aett-10x-x-109">(w.t</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16205"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16206"><span 
class="aett-10x-x-109">diag</span></span><span id="textcolor16207"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16208"><span 
class="aett-10x-x-109">inla.mesh.fem</span></span><span id="textcolor16209"><span 
class="aett-10x-x-109">(tmesh)</span></span><span id="textcolor16210"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16211"><span 
class="aett-10x-x-109">c0))</span></span>                                    </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16216"></div></div>   
<div class="verbatim" id="verbatim-144">
##&#x00A0;[1]&#x00A0;1.25&#x00A0;2.50&#x00A0;2.50&#x00A0;2.50&#x00A0;2.50&#x00A0;2.50&#x00A0;1.25
</div>
<!--l. 233--><p class="nopar" >                                                                          </span></div>-
<!--l. 236--><p class="indent" >   where the knots at boundary are with less width than the internal ones.
</p><!--l. 238--><p class="indent" >   Since the intensity function is the number of cases per volumn unit, with <span 
class="cmmi-10x-x-109">n </span>cases
the intensity varies around the average number of cases (intensity) by unit volumn
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16233"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16218"><span 
class="aett-10x-x-109">(i0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16219"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16220"><span 
class="aett-10x-x-109">n</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16221"><span 
class="aett-10x-x-109">/</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16222"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16223"><span 
class="aett-10x-x-109">gArea</span></span><span id="textcolor16224"><span 
class="aett-10x-x-109">(domainSP)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16225"><span 
class="aett-10x-x-109">*</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16226"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor16227"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16228"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor16229"><span 
class="aett-10x-x-109">(tmesh</span></span><span id="textcolor16230"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16231"><span 
class="aett-10x-x-109">loc))))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-145">
##&#x00A0;[1]&#x00A0;2.88601
</div>
<!--l. 247--><p class="nopar" >                                                                          </span></div>-
<!--l. 250--><p class="indent" >   and this value is related to an intercept in the model we fit below. The space-time volumn
(area unit per time unit) at each polygon and time knot is  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16246"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16235"><span 
class="aett-10x-x-109">summary</span></span><span id="textcolor16236"><span 
class="aett-10x-x-109">(e0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16237"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16238"><span 
class="aett-10x-x-109">w.areas[agg.dat</span></span><span id="textcolor16239"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16240"><span 
class="aett-10x-x-109">area]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16241"><span 
class="aett-10x-x-109">*</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16242"><span 
class="aett-10x-x-109">(w.t[agg.dat</span></span><span id="textcolor16243"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16244"><span 
class="aett-10x-x-109">time]))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-146">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;Min.&#x00A0;1st&#x00A0;Qu.&#x00A0;&#x00A0;Median&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mean&#x00A0;3rd&#x00A0;Qu.&#x00A0;&#x00A0;&#x00A0;&#x00A0;Max.
&#x00A0;<br />##&#x00A0;0.07866&#x00A0;0.45690&#x00A0;0.64780&#x00A0;0.70860&#x00A0;0.97130&#x00A0;1.73300
</div>
<!--l. 260--><p class="nopar" >                                                                          </span></div>-
<!--l. 264--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">11.2.2   </span> <a 
 id="x15-10300011.2.2"></a>Model fit</h4>
<!--l. 266--><p class="noindent" >The projector matrix, SPDE model object and the space-time index set definition:
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16277"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16248"><span 
class="aett-10x-x-109">A.st</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16249"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16250"><span 
class="aett-10x-x-109">inla.spde.make.A</span></span><span id="textcolor16251"><span 
class="aett-10x-x-109">(smesh,</span><span 
class="aett-10x-x-109">&#x00A0;smesh</span></span><span id="textcolor16252"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16253"><span 
class="aett-10x-x-109">loc[agg.dat</span></span><span id="textcolor16254"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16255"><span 
class="aett-10x-x-109">area,],</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16256"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor16257"><span 
class="aett-10x-x-109">=agg.dat</span></span><span id="textcolor16258"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16259"><span 
class="aett-10x-x-109">time,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16260"><span 
class="aett-10x-x-109">mesh.group</span></span><span id="textcolor16261"><span 
class="aett-10x-x-109">=tmesh)</span></span>
<br /><span id="textcolor16262"><span 
class="aett-10x-x-109">spde</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16263"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16264"><span 
class="aett-10x-x-109">inla.spde2.matern</span></span><span id="textcolor16265"><span 
class="aett-10x-x-109">(smesh)</span></span>
<br /><span id="textcolor16266"><span 
class="aett-10x-x-109">idx</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16267"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16268"><span 
class="aett-10x-x-109">inla.spde.make.index</span></span><span id="textcolor16269"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16270"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">s</span><span 
class="tctt-1095">'</span></span><span id="textcolor16271"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;spde</span></span><span id="textcolor16272"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16273"><span 
class="aett-10x-x-109">n.spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16274"><span 
class="aett-10x-x-109">n.group</span></span><span id="textcolor16275"><span 
class="aett-10x-x-109">=k)</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 278--><p class="indent" >   Defining the data stack  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16314"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16279"><span 
class="aett-10x-x-109">stk</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16280"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16281"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor16282"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16283"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor16284"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16285"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16286"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16287"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor16288"><span 
class="aett-10x-x-109">=agg.dat</span></span><span id="textcolor16289"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16290"><span 
class="aett-10x-x-109">Freq,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16291"><span 
class="aett-10x-x-109">exposure</span></span><span id="textcolor16292"><span 
class="aett-10x-x-109">=e0),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16293"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor16294"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16295"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16296"><span 
class="aett-10x-x-109">(A.st,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16297"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16298"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16299"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor16300"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16301"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16302"><span 
class="aett-10x-x-109">(idx,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16303"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16304"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16305"><span 
class="aett-10x-x-109">b0</span></span><span id="textcolor16306"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16307"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor16308"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16309"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16310"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16311"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor16312"><span 
class="aett-10x-x-109">(agg.dat)))))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 289--><p class="indent" >   the formula  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16339"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16316"><span 
class="aett-10x-x-109">formula</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16317"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16318"><span 
class="aett-10x-x-109">y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16319"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16320"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16321"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16322"><span 
class="aett-10x-x-109">b0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16323"><span 
class="aett-10x-x-109">+</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16324"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor16325"><span 
class="aett-10x-x-109">(s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16326"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor16327"><span 
class="aett-10x-x-109">=spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16328"><span 
class="aett-10x-x-109">group</span></span><span id="textcolor16329"><span 
class="aett-10x-x-109">=s.group,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16330"><span 
class="aett-10x-x-109">control.group</span></span><span id="textcolor16331"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16332"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16333"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16334"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor16335"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16336"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">ar1</span><span 
class="tctt-1095">'</span></span><span id="textcolor16337"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 298--><p class="indent" >   and fitting the model  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16372"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16341"><span 
class="aett-10x-x-109">res</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16342"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16343"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor16344"><span 
class="aett-10x-x-109">(formula,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16345"><span 
class="aett-10x-x-109">family</span></span><span id="textcolor16346"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16347"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">poisson</span><span 
class="tctt-1095">'</span></span><span id="textcolor16348"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16349"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor16350"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16351"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor16352"><span 
class="aett-10x-x-109">(stk),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16353"><span 
class="aett-10x-x-109">E</span></span><span id="textcolor16354"><span 
class="aett-10x-x-109">=exposure,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16355"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor16356"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16357"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16358"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16359"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor16360"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16361"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor16362"><span 
class="aett-10x-x-109">(stk)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16363"><span 
class="aett-10x-x-109">control.inla</span></span><span id="textcolor16364"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16365"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor16366"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16367"><span 
class="aett-10x-x-109">strategy</span></span><span id="textcolor16368"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16369"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">gaussian</span><span 
class="tctt-1095">'</span></span><span id="textcolor16370"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 310--><p class="indent" >   The log of the average intensity and the intercept summary:  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16388"></p>     
<div class="alltt">                                                                                                                </span></div>
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16390"><div class="obeylines-v">
<span id="textcolor16374"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor16375"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16376"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor16377"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16378"><span 
class="aett-10x-x-109">true</span></span><span id="textcolor16379"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16380"><span 
class="aett-10x-x-109">log</span></span><span id="textcolor16381"><span 
class="aett-10x-x-109">(i0),</span><span 
class="aett-10x-x-109">&#x00A0;res</span></span><span id="textcolor16382"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16383"><span 
class="aett-10x-x-109">summary.fixed),</span></span><span id="textcolor16384"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor16385"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-147">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;true&#x00A0;&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant&#x00A0;0.5quant&#x00A0;0.975quant&#x00A0;&#x00A0;&#x00A0;mode&#x00A0;kld
&#x00A0;<br />##&#x00A0;b0&#x00A0;1.0599&#x00A0;0.8721&#x00A0;0.1235&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.6253&#x00A0;&#x00A0;&#x00A0;0.8726&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.1157&#x00A0;0.8737&#x00A0;&#x00A0;&#x00A0;0
</div>
<!--l. 319--><p class="nopar" >                                                                          </span></div>-
<!--l. 322--><p class="indent" >   The expected number of cases at each integration point can be used to compute the total
expected number of cases  
</p>
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16432"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16392"><span 
class="aett-10x-x-109">eta.i</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16393"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16394"><span 
class="aett-10x-x-109">res</span></span><span id="textcolor16395"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16396"><span 
class="aett-10x-x-109">summary.fix[</span></span><span id="textcolor16397"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16398"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor16399"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16400"><span 
class="aett-10x-x-109">]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16401"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16402"><span 
class="aett-10x-x-109">res</span></span><span id="textcolor16403"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16404"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor16405"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16406"><span 
class="aett-10x-x-109">s</span></span><span id="textcolor16407"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16408"><span 
class="aett-10x-x-109">mean</span></span>
<br /><span id="textcolor16409"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor16410"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16411"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor16412"><span 
class="aett-10x-x-109">=xyt</span></span><span id="textcolor16413"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16414"><span 
class="aett-10x-x-109">n,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16415"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">E(n)</span><span 
class="tctt-1095">'</span></span><span id="textcolor16416"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16417"><span 
class="aett-10x-x-109">sum</span></span><span id="textcolor16418"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16419"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor16420"><span 
class="aett-10x-x-109">(w.areas,</span><span 
class="aett-10x-x-109">&#x00A0;k)</span></span><span id="textcolor16421"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor16422"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor16423"><span 
class="aett-10x-x-109">(w.t,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16424"><span 
class="aett-10x-x-109">each</span></span><span id="textcolor16425"><span 
class="aett-10x-x-109">=smesh</span></span><span id="textcolor16426"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16427"><span 
class="aett-10x-x-109">n)</span></span><span id="textcolor16428"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor16429"><span 
class="aett-10x-x-109">exp</span></span><span id="textcolor16430"><span 
class="aett-10x-x-109">(eta.i)))</span></span>
</div>
</div>   
<div class="verbatim" id="verbatim-148">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;n&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;E(n)
&#x00A0;<br />##&#x00A0;2176.000&#x00A0;2174.872
</div>
<!--l. 332--><p class="nopar" >                                                                          </span></div>-
<!--l. 336--><p class="indent" >   The spatial surface at each time knot can be computed by  
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16518"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16434"><span 
class="aett-10x-x-109">r0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16435"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16436"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor16437"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16438"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor16439"><span 
class="aett-10x-x-109">(domain[,</span></span><span id="textcolor16440"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16441"><span 
class="aett-10x-x-109">]))</span></span><span id="textcolor16442"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor16443"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor16444"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16445"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor16446"><span 
class="aett-10x-x-109">(domain[,</span></span><span id="textcolor16447"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor16448"><span 
class="aett-10x-x-109">]))</span></span>
<br /><span id="textcolor16449"><span 
class="aett-10x-x-109">prj</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16450"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16451"><span 
class="aett-10x-x-109">inla.mesh.projector</span></span><span id="textcolor16452"><span 
class="aett-10x-x-109">(smesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16453"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor16454"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16455"><span 
class="aett-10x-x-109">bbox</span></span><span id="textcolor16456"><span 
class="aett-10x-x-109">(domainSP)[</span></span><span id="textcolor16457"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16458"><span 
class="aett-10x-x-109">,],</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16459"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor16460"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16461"><span 
class="aett-10x-x-109">bbox</span></span><span id="textcolor16462"><span 
class="aett-10x-x-109">(domainSP)[</span></span><span id="textcolor16463"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor16464"><span 
class="aett-10x-x-109">,],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16465"><span 
class="aett-10x-x-109">dims</span></span><span id="textcolor16466"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16467"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor16468"><span 
class="aett-10x-x-109">(r0</span></span><span id="textcolor16469"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor16470"><span 
class="aett-10x-x-109">200</span></span><span id="textcolor16471"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16472"><span 
class="aett-10x-x-109">200</span></span><span id="textcolor16473"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor16474"><span 
class="aett-10x-x-109">g.no.in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16475"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16476"><span 
class="aett-10x-x-109">is.na</span></span><span id="textcolor16477"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16478"><span 
class="aett-10x-x-109">over</span></span><span id="textcolor16479"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16480"><span 
class="aett-10x-x-109">SpatialPoints</span></span><span id="textcolor16481"><span 
class="aett-10x-x-109">(prj</span></span><span id="textcolor16482"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16483"><span 
class="aett-10x-x-109">lattice</span></span><span id="textcolor16484"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16485"><span 
class="aett-10x-x-109">loc),</span><span 
class="aett-10x-x-109">&#x00A0;domainSP))</span></span>
<br /><span id="textcolor16486"><span 
class="aett-10x-x-109">t.mean</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16487"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16488"><span 
class="aett-10x-x-109">lapply</span></span><span id="textcolor16489"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16490"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16491"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16492"><span 
class="aett-10x-x-109">k,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16493"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor16494"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16495"><span 
class="aett-10x-x-109">j</span></span><span id="textcolor16496"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16497"><span 
class="aett-10x-x-109">z</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16498"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16499"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor16500"><span 
class="aett-10x-x-109">(prj,</span><span 
class="aett-10x-x-109">&#x00A0;res</span></span><span id="textcolor16501"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16502"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor16503"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16504"><span 
class="aett-10x-x-109">s</span></span><span id="textcolor16505"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16506"><span 
class="aett-10x-x-109">mean[idx</span></span><span id="textcolor16507"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16508"><span 
class="aett-10x-x-109">s.group</span></span><span id="textcolor16509"><span 
class="aett-10x-x-109">==</span></span><span id="textcolor16510"><span 
class="aett-10x-x-109">j])</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16511"><span 
class="aett-10x-x-109">z[g.no.in]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16512"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16513"><span 
class="aett-10x-x-109">NA</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16514"><span 
class="aett-10x-x-109">return</span></span><span id="textcolor16515"><span 
class="aett-10x-x-109">(z)</span></span>
<br /><span id="textcolor16516"><span 
class="aett-10x-x-109">})</span></span>
</div>
</div>                                                                          </span></div>-
<!--l. 352--><p class="indent" >   and is visualized in Figure&#x00A0;<a 
href="#x15-10300011.2.2">11.2.2<!--tex4ht:ref: fig:lstppsres --></a> is visualized by  
                                                                                 
                                                                                 
   <div  
class="centerline"><span 
class="colorbox" id="colorbox16629"></p>     
<div class="alltt">
<div class="obeylines-v">
<span id="textcolor16520"><span 
class="aett-10x-x-109">zlims</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16521"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16522"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor16523"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16524"><span 
class="aett-10x-x-109">unlist</span></span><span id="textcolor16525"><span 
class="aett-10x-x-109">(t.mean),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16526"><span 
class="aett-10x-x-109">na.rm</span></span><span id="textcolor16527"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16528"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor16529"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor16530"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor16531"><span 
class="aett-10x-x-109">(fields)</span></span>
<br /><span id="textcolor16532"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor16533"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16534"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor16535"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16536"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor16537"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16538"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor16539"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor16540"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor16541"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16542"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor16543"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16544"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor16545"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16546"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor16547"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor16548"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor16549"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor16550"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor16551"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor16552"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor16553"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor16554"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16555"><span 
class="aett-10x-x-109">(j</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16556"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16557"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor16558"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor16559"><span 
class="aett-10x-x-109">k)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16560"><span 
class="aett-10x-x-109">image</span></span><span id="textcolor16561"><span 
class="aett-10x-x-109">(prj</span></span><span id="textcolor16562"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16563"><span 
class="aett-10x-x-109">x,</span><span 
class="aett-10x-x-109">&#x00A0;prj</span></span><span id="textcolor16564"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16565"><span 
class="aett-10x-x-109">y,</span><span 
class="aett-10x-x-109">&#x00A0;t.mean[[j]],</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16566"><span 
class="aett-10x-x-109">axes</span></span><span id="textcolor16567"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16568"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor16569"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16570"><span 
class="aett-10x-x-109">zlim</span></span><span id="textcolor16571"><span 
class="aett-10x-x-109">=zlims,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16572"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor16573"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16574"><span 
class="aett-10x-x-109">tim.colors</span></span><span id="textcolor16575"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16576"><span 
class="aett-10x-x-109">30</span></span><span id="textcolor16577"><span 
class="aett-10x-x-109">))</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16578"><span 
class="aett-10x-x-109">points</span></span><span id="textcolor16579"><span 
class="aett-10x-x-109">(xyt</span></span><span id="textcolor16580"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16581"><span 
class="aett-10x-x-109">x[time</span></span><span id="textcolor16582"><span 
class="aett-10x-x-109">==</span></span><span id="textcolor16583"><span 
class="aett-10x-x-109">j],</span><span 
class="aett-10x-x-109">&#x00A0;xyt</span></span><span id="textcolor16584"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16585"><span 
class="aett-10x-x-109">y[time</span></span><span id="textcolor16586"><span 
class="aett-10x-x-109">==</span></span><span id="textcolor16587"><span 
class="aett-10x-x-109">j],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16588"><span 
class="aett-10x-x-109">cex</span></span><span id="textcolor16589"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16590"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor16591"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor16592"><span 
class="aett-10x-x-109">}</span></span>
<br /><span id="textcolor16593"><span 
class="aett-10x-x-109">image.plot</span></span><span id="textcolor16594"><span 
class="aett-10x-x-109">(prj</span></span><span id="textcolor16595"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16596"><span 
class="aett-10x-x-109">x,</span><span 
class="aett-10x-x-109">&#x00A0;prj</span></span><span id="textcolor16597"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor16598"><span 
class="aett-10x-x-109">y,</span><span 
class="aett-10x-x-109">&#x00A0;t.mean[[j]]</span></span><span id="textcolor16599"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor16600"><span 
class="aett-10x-x-109">1e9</span></span><span id="textcolor16601"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16602"><span 
class="aett-10x-x-109">axes</span></span><span id="textcolor16603"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16604"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor16605"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16606"><span 
class="aett-10x-x-109">zlim</span></span><span id="textcolor16607"><span 
class="aett-10x-x-109">=zlims,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16608"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor16609"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16610"><span 
class="tctt-1095">''</span></span><span id="textcolor16611"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16612"><span 
class="aett-10x-x-109">legend.mar</span></span><span id="textcolor16613"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16614"><span 
class="aett-10x-x-109">10</span></span><span id="textcolor16615"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16616"><span 
class="aett-10x-x-109">legend.width</span></span><span id="textcolor16617"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16618"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor16619"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16620"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor16621"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor16622"><span 
class="aett-10x-x-109">tim.colors</span></span><span id="textcolor16623"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor16624"><span 
class="aett-10x-x-109">30</span></span><span id="textcolor16625"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16626"><span 
class="aett-10x-x-109">horizontal</span></span><span id="textcolor16627"><span 
class="aett-10x-x-109">=T)</span></span>
</div>
</div>                                                                          </span></div>-
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x15-1030015"></a>
                                                                                 
                                                                                 
<!--l. 372--><p class="noindent" ><img 
src="spde-tutorial102x.png" alt="PIC" class="graphics" width="413.99164pt" height="413.99539pt"  /><!--tex4ht:graphics  
name="spde-tutorial102x.png" src="figs/stpplstsresf-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;11.5: </span><span  
class="content">Spatial surface fitted at each time knot overlayed by the point pattern formed
by the points nearest to each time knot.</span></div><!--tex4ht:label?: x15-1030015 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
                                                                                 
                                                                                 
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialli2.html" >next</a>] [<a 
href="spde-tutorialch10.html" >prev</a>] [<a 
href="spde-tutorialch10.html#tailspde-tutorialch10.html" >prev-tail</a>] [<a 
href="spde-tutorialch11.html" >front</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch11.html" >up</a>] </p></div>
<!--l. 1--><p class="indent" >   <a 
 id="tailspde-tutorialch11.html"></a>   </p> 
</body></html> 
