<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>16 Copying part or the entire linear predictor</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- xhtml,html,frames,2 --> 
<meta name="src" content="spde-tutorial.tex" /> 
<meta name="date" content="2017-01-22 14:18:00" /> 
<link rel="stylesheet" type="text/css" href="spde-tutorial.css" /> 
</head><body 
>
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialch17.html" >next</a>] [<a 
href="spde-tutorialch15.html" >prev</a>] [<a 
href="spde-tutorialch15.html#tailspde-tutorialch15.html" >prev-tail</a>] [<a 
href="#tailspde-tutorialch16.html">tail</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch16.html" >up</a>] </p></div>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;16</span><br /><a 
 id="x20-9400016"></a>Copying part or the entire linear predictor</h2>
<!--l. 5--><p class="noindent" >In this Chapter we show how to copy part of a linear predictor. That is two or more outcomes
(or same outcome from different sources) are modeled jointly. In this case there are effects which
are common in the linear predictor for more than one outcome.
</p><!--l. 11--><p class="indent" >   Suppose we have data collected at the locations <span 
class="cmmib-10x-x-109">s</span>, <span 
class="cmmib-10x-x-109">y</span><span 
class="cmr-10x-x-109">1(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">)</span>, <span 
class="cmmib-10x-x-109">y</span><span 
class="cmr-10x-x-109">2(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>and <span 
class="cmmib-10x-x-109">y</span><span 
class="cmr-10x-x-109">3(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">)</span>. Consider a case
were we have the following three observation models </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="spde-tutorial105x.png" alt="y1(s)  =  &#x03B2;0 + &#x03B2;1x(s) + A(s,s0)b(s0) + &#x03F5;1(s)               (16.1)
y2(s)  =  &#x03B2;2(&#x03B2;0 + &#x03B2;1x(s))+ &#x03F5;2(s)                           (16.2)

y3(s)  =  &#x03B2;3(&#x03B2;0 + &#x03B2;1x(s)+  A(s,s0)b(s0))+ &#x03F5;3(s)            (16.3)
" class="math-display"  /><a 
 id="x20-94001r16.1"></a><a 
 id="x20-94001r16.2"></a><a 
 id="x20-94001r16.3"></a></center>
</div>where we have a SPDE model at the mesh nodes <span 
class="cmmib-10x-x-109">b</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">0) </span>with <span 
class="cmmib-10x-x-109">A</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">0) </span>being the projector matrix,
<span 
class="cmmib-10x-x-109">&#x03F5;</span><span 
class="cmmi-10x-x-109">j</span>, j=1,2,3, are observation errors considered as zero mean Gaussian with variance <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">j</span></sub><sup><span 
class="cmr-8">2</span></sup>. By
this setting we have a linear model for each outcome. We can see that a common
effect is scaled from one linear preditor into another, where <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">2</span></sub> and <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">3</span></sub> are the scaling
parameters.
<!--l. 27--><p class="indent" >   We can define the following model terms </p>
     <ul class="itemize1">
     <li class="itemize"><span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">0(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) = </span><span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub> <span 
class="cmr-10x-x-109">+ </span><span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">1</span></sub><span 
class="cmmib-10x-x-109">x</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">)</span>
     </li>
     <li class="itemize"><span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">1(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) = </span><span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">0(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) + </span><span 
class="cmmib-10x-x-109">A</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">0)</span><span 
class="cmmib-10x-x-109">b</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">0)</span>
     </li>
     <li class="itemize"><span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">2(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) = </span><span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">2</span></sub><span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">0(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">)</span>
     </li>
     <li class="itemize"><span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">3(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) = </span><span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">3</span></sub><span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">1(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">)</span></li></ul>
<!--l. 34--><p class="noindent" >By this, this example is about showing how to copy <span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">0 </span>into <span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">2 </span>and <span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">1 </span>into <span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">3 </span>in order to estimate
<span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">2</span></sub> and <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">3</span></sub>.
</p><!--l. 39--><p class="indent" >   We have assumed all the three observation vectors, <span 
class="cmmib-10x-x-109">y</span><span 
class="cmr-10x-x-109">1</span>, <span 
class="cmmib-10x-x-109">y</span><span 
class="cmr-10x-x-109">2 </span>and <span 
class="cmmib-10x-x-109">y</span><span 
class="cmr-10x-x-109">3 </span>to be observed at the same
locations.
</p>
   <h3 class="sectionHead"><span class="titlemark">16.1   </span> <a 
 id="x20-9500016.1"></a>Generating data</h3>
<!--l. 47--><p class="noindent" >First of all we define the set of parameters in the model. for <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmmi-8">j</span></sub>, j=0,2,...,3 as follows
</p>
   <div class="fancyvrb" id="fancyvrb634"><a 
 id="x20-95002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;beta0</span><span 
class="aesltt-10x-x-109">&#x00A0;=</span><span 
class="aesltt-10x-x-109">&#x00A0;5</span><br class="fancyvrb" /><a 
 id="x20-95004r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;beta1</span><span 
class="aesltt-10x-x-109">&#x00A0;=</span><span 
class="aesltt-10x-x-109">&#x00A0;1</span><br class="fancyvrb" /><a 
 id="x20-95006r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;beta2</span><span 
class="aesltt-10x-x-109">&#x00A0;=</span><span 
class="aesltt-10x-x-109">&#x00A0;0.5</span><br class="fancyvrb" /><a 
 id="x20-95008r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;beta3</span><span 
class="aesltt-10x-x-109">&#x00A0;=</span><span 
class="aesltt-10x-x-109">&#x00A0;2</span></div>
<!--l. 58--><p class="indent" >   Then, we define the variance errors as
</p>
   <div class="fancyvrb" id="fancyvrb635"><a 
 id="x20-95010r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;s123</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;c(0.1,</span><span 
class="aesltt-10x-x-109">&#x00A0;0.05,</span><span 
class="aesltt-10x-x-109">&#x00A0;0.15)</span></div>
                                                                                 
                                                                                 
<!--l. 65--><p class="indent" >   For the <span 
class="cmmi-10x-x-109">b</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>process, we consider a Matérn covariance function with <span 
class="cmmi-10x-x-109">&#x03BA;</span><sub><span 
class="cmmi-8">b</span></sub>, <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">b</span></sub><sup><span 
class="cmr-8">2</span></sup> and <span 
class="cmmi-10x-x-109">&#x03BD; </span><span 
class="cmr-10x-x-109">= 1</span>
(fixed).
</p>
   <div class="fancyvrb" id="fancyvrb636"><a 
 id="x20-95012r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;kappab</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;10</span><br class="fancyvrb" /><a 
 id="x20-95014r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;sigma2b</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;1</span></div>
<!--l. 74--><p class="indent" >   To realize the process we consider a set of locations as follows
</p>
   <div class="fancyvrb" id="fancyvrb637"><a 
 id="x20-95016r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;n</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;50</span><br class="fancyvrb" /><a 
 id="x20-95018r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;loc</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;cbind(runif(n),</span><span 
class="aesltt-10x-x-109">&#x00A0;runif(n))</span></div>
<!--l. 81--><p class="noindent" >and draw one realization of the Matérn process considering the <span 
class="aett-10x-x-109">rMatern() </span>function available in the file at
<a 
href="http://www.math.ntnu.no/inla/r-inla.org/tutorials/spde/spde-tutorial-functions.R" class="url" ><span 
class="aett-10x-x-109">http://www.math.ntnu.no/inla/r-_inla.org/tutorials/spde/spde-_tutorial-_functions.R</span></a>
</p>
   <div class="fancyvrb" id="fancyvrb638"><a 
 id="x20-95020r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;b</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;rMatern(n=1,</span><span 
class="aesltt-10x-x-109">&#x00A0;coords=loc,</span><span 
class="aesltt-10x-x-109">&#x00A0;kappa=10,</span><span 
class="aesltt-10x-x-109">&#x00A0;variance=1)</span></div>
<!--l. 90--><p class="indent" >   This sample can be visualized using
</p>
   <div class="fancyvrb" id="fancyvrb639"><a 
 id="x20-95022r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;par(mar=c(0,0,0,0))</span><br class="fancyvrb" /><a 
 id="x20-95024r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(loc,</span><span 
class="aesltt-10x-x-109">&#x00A0;asp=1,</span><span 
class="aesltt-10x-x-109">&#x00A0;cex=0.3+2*(b-min(b))/diff(range(b)),</span>
<br class="fancyvrb" /><a 
 id="x20-95026r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;pch=19,</span><span 
class="aesltt-10x-x-109">&#x00A0;axes=FALSE);</span><span 
class="aesltt-10x-x-109">&#x00A0;box()</span></div>
<hr class="figure" /><div class="figure" 
><a 
 id="x20-950271"></a><img 
src="spde-tutorial106x.png" alt="PIC" class="graphics" width="166.44977pt" height="166.44562pt"  /><!--tex4ht:graphics  
name="spde-tutorial106x.png" src="figs/copy-vvizloc.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;16.1: </span><span  
class="content">Locations</span></div><!--tex4ht:label?: x20-950271 -->
   </div><hr class="endfigure" />
<!--l. 105--><p class="indent" >   Additionally we have to define a covariate. We just sample it as follows
</p>
   <div class="fancyvrb" id="fancyvrb640"><a 
 id="x20-95029r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;x</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;runif(n,</span><span 
class="aesltt-10x-x-109">&#x00A0;-1,</span><span 
class="aesltt-10x-x-109">&#x00A0;1)*sqrt(3)</span></div>
<!--l. 113--><p class="indent" >   Them we build the linear predictors as follows
</p>
   <div class="fancyvrb" id="fancyvrb641"><a 
 id="x20-95031r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;eta1</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;beta0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;beta1*x</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;b</span><br class="fancyvrb" /><a 
 id="x20-95033r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;eta2</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;beta2*(beta0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;beta1*x)</span><br class="fancyvrb" /><a 
 id="x20-95035r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;eta3</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;beta3*eta1</span></div>
<!--l. 121--><p class="noindent" >and have the observations as follows
</p>
   <div class="fancyvrb" id="fancyvrb642"><a 
 id="x20-95037r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;y1</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;rnorm(n,</span><span 
class="aesltt-10x-x-109">&#x00A0;eta1,</span><span 
class="aesltt-10x-x-109">&#x00A0;s123[1])</span><br class="fancyvrb" /><a 
 id="x20-95039r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;y2</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;rnorm(n,</span><span 
class="aesltt-10x-x-109">&#x00A0;eta2,</span><span 
class="aesltt-10x-x-109">&#x00A0;s123[2])</span><br class="fancyvrb" /><a 
 id="x20-95041r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;y3</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;rnorm(n,</span><span 
class="aesltt-10x-x-109">&#x00A0;eta3,</span><span 
class="aesltt-10x-x-109">&#x00A0;s123[3])</span></div>
                                                                                 
                                                                                 
<!--l. 135--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">16.2   </span> <a 
 id="x20-9600016.2"></a>Setting the way to fit the model</h3>
<!--l. 137--><p class="noindent" >There are more than one way to fit this model using the <span 
class="aett-10x-x-109">R-INLA </span>package. The main point is the
need to compute <span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">0(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) = </span><span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub> <span 
class="cmr-10x-x-109">+ </span><span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">1</span></sub><span 
class="cmmib-10x-x-109">x</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>and <span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">1(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) = </span><span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub> <span 
class="cmr-10x-x-109">+ </span><span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">1</span></sub><span 
class="cmmib-10x-x-109">x</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) + </span><span 
class="cmmib-10x-x-109">A</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">0)</span><span 
class="cmmib-10x-x-109">b</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>from the first
observation equation in order to copy it to the second and third observation equation. So, one
has to define a model that computes <span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">0(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>and <span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">1(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>explicitelly.
</p><!--l. 148--><p class="indent" >   The way we choose is to minimize the size of the graph generated by the model, <span class="cite">[<a 
href="spde-tutorialli2.html#XRueetal:2016">Rue et&#x00A0;al.,
2016</a>]</span>. First, we have that </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="spde-tutorial107x.png" alt="0(s)  =   A(s,s0)b(s0)+  &#x03B7;0(s)+ &#x03F5;1(s)-  y1(s)             (16.4)
0(s)  =   &#x03B7;1(s)+ &#x03F5;1(s)-  y1(s)                            (16.5)
" class="math-display"  /><a 
 id="x20-96001r16.4"></a><a 
 id="x20-96001r16.5"></a></center>
</div>where only <span 
class="cmmib-10x-x-109">A</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">0)</span>, <span 
class="cmmib-10x-x-109">x</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>and <span 
class="cmmib-10x-x-109">y</span><span 
class="cmr-10x-x-109">1(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>are known. For the <span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">0(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>and <span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">2(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>terms we consider an
independent and identically distributed (&#8217;iid&#8217;) model with low fixed precision. With this high
fixed hight variance, each element in <span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">0(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>and <span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">1(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>can assume any value. However, it will be
forced these values to be <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub> <span 
class="cmr-10x-x-109">+ </span><span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">1</span></sub><span 
class="cmmib-10x-x-109">x</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>and <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub> <span 
class="cmr-10x-x-109">+ </span><span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">1</span></sub><span 
class="cmmib-10x-x-109">x</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) + </span><span 
class="cmmib-10x-x-109">A</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">0)</span><span 
class="cmmib-10x-x-109">b</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">0) </span>by considering a
Gaussian likelihood for the &#8217;faked zero&#8217; observations with a hight fixed precision value (lower
fixed likelihood variance). For details and examples of this approach see <span class="cite">[<a 
href="spde-tutorialli2.html#XcardenasKR:2012">Ruiz-Cárdenas
et&#x00A0;al., 2012</a>]</span>, <span class="cite">[<a 
href="spde-tutorialli2.html#XmartinsSLR:2013">Martins et&#x00A0;al., 2013</a>]</span> and Chapter&#x00A0;8 of <span class="cite">[<a 
href="spde-tutorialli2.html#XblangiardoC:2015">Blangiardo and Cameletti,
2015</a>]</span>.
<!--l. 172--><p class="indent" >   Second, since we have only Gaussian likelihood for the observed data, one can can
include <span 
class="cmmib-10x-x-109">&#x03F5;</span><span 
class="cmmi-10x-x-109">j </span>(j=1,2,3) in the linear predictor and fix a high likehihood precision. By
this setting, we have only Gaussian likelihood with high fixed precision: only one
likelihood.
</p><!--l. 179--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">16.3   </span> <a 
 id="x20-9700016.3"></a>Fitting the model</h3>
<!--l. 181--><p class="noindent" >In order to fit the <span 
class="cmmi-10x-x-109">b</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>term we have to set a SPDE Matérn model. For that, we set a
mesh
</p>
   <div class="fancyvrb" id="fancyvrb643"><a 
 id="x20-97002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;mesh</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.2d(loc.domain=cbind(c(0,1,1,0),</span><span 
class="aesltt-10x-x-109">&#x00A0;c(0,0,1,1)),</span>
<br class="fancyvrb" /><a 
 id="x20-97004r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;max.edge=c(0.1,</span><span 
class="aesltt-10x-x-109">&#x00A0;0.3),</span>
<br class="fancyvrb" /><a 
 id="x20-97006r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;offset=c(0.05,</span><span 
class="aesltt-10x-x-109">&#x00A0;0.35),</span><span 
class="aesltt-10x-x-109">&#x00A0;cutoff=0.05)</span></div>
<!--l. 191--><p class="noindent" >define the projector matrix
</p>
   <div class="fancyvrb" id="fancyvrb644"><a 
 id="x20-97008r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;As</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde.make.A(mesh,</span><span 
class="aesltt-10x-x-109">&#x00A0;loc)</span></div>
<!--l. 197--><p class="noindent" >and the SPDE model
</p>
   <div class="fancyvrb" id="fancyvrb645"><a 
 id="x20-97010r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;spde</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde2.matern(mesh,</span><span 
class="aesltt-10x-x-109">&#x00A0;alpha=2)</span></div>
                                                                                 
                                                                                 
<!--l. 203--><p class="noindent" >to be used.
</p><!--l. 205--><p class="indent" >   The data has to be organized using the <span 
class="aett-10x-x-109">inla.stack() </span>function. The data stack for the first
observation vector is just
</p>
   <div class="fancyvrb" id="fancyvrb646"><a 
 id="x20-97012r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stack1</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(tag=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">y1</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><br class="fancyvrb" /><a 
 id="x20-97014r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=list(y=y1),</span>
<br class="fancyvrb" /><a 
 id="x20-97016r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;effects=list(</span><br class="fancyvrb" /><a 
 id="x20-97018r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data.frame(beta0=1,</span><span 
class="aesltt-10x-x-109">&#x00A0;beta1=x),</span>
<br class="fancyvrb" /><a 
 id="x20-97020r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;s=1:spde$n.spde,</span><br class="fancyvrb" /><a 
 id="x20-97022r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;e1=1:n),</span>
<br class="fancyvrb" /><a 
 id="x20-97024r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;A=list(1,</span><span 
class="aesltt-10x-x-109">&#x00A0;As,</span><span 
class="aesltt-10x-x-109">&#x00A0;1))</span></div>
<!--l. 218--><p class="noindent" >where the <span 
class="aett-10x-x-109">e1 </span>term will be used to fit <span 
class="cmmib-10x-x-109">&#x03F5;</span><span 
class="cmr-10x-x-109">1</span>.
</p><!--l. 220--><p class="indent" >   Them the stack data for the first &#8217;facked zero&#8217; observations
</p>
   <div class="fancyvrb" id="fancyvrb647"><a 
 id="x20-97026r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stack01</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(tag=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">eta1</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><br class="fancyvrb" /><a 
 id="x20-97028r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=list(y=rep(0,n),</span><span 
class="aesltt-10x-x-109">&#x00A0;offset=-y1),</span>
<br class="fancyvrb" /><a 
 id="x20-97030r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;effects=list(</span><br class="fancyvrb" /><a 
 id="x20-97032r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;s=1:spde$n.spde,</span>
<br class="fancyvrb" /><a 
 id="x20-97034r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;list(e1=1:n,</span><br class="fancyvrb" /><a 
 id="x20-97036r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;eta1=1:n)),</span>
<br class="fancyvrb" /><a 
 id="x20-97038r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;A=list(As,</span><span 
class="aesltt-10x-x-109">&#x00A0;1))</span></div>
<!--l. 232--><p class="noindent" >which has the negated fist observation vector as offset.
</p><!--l. 234--><p class="indent" >   The stack for the second &#8217;facked zero&#8217; observation is
</p>
   <div class="fancyvrb" id="fancyvrb648"><a 
 id="x20-97040r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stack02</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(tag=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">eta2</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><br class="fancyvrb" /><a 
 id="x20-97042r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=list(y=rep(0,n),</span><span 
class="aesltt-10x-x-109">&#x00A0;offset=-y1),</span>
<br class="fancyvrb" /><a 
 id="x20-97044r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;effects=list(list(e1=1:n,</span><span 
class="aesltt-10x-x-109">&#x00A0;eta2=1:n)),</span><br class="fancyvrb" /><a 
 id="x20-97046r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;A=list(1))</span></div>
<!--l. 244--><p class="indent" >   The stack for the second observation vector now considers an index set to compute the <span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">1</span>
copied from the first &#8217;facked zero&#8217; observations.
</p>
   <div class="fancyvrb" id="fancyvrb649"><a 
 id="x20-97048r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stack2</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(tag=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">y2</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><br class="fancyvrb" /><a 
 id="x20-97050r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=list(y=y2),</span>
<br class="fancyvrb" /><a 
 id="x20-97052r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;effects=list(list(eta1c=1:n,</span><span 
class="aesltt-10x-x-109">&#x00A0;e2=1:n)),</span><br class="fancyvrb" /><a 
 id="x20-97054r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;A=list(1))</span></div>
<!--l. 256--><p class="indent" >   In similar way, we have the third observation stack including an index set to compute the <span 
class="cmmib-10x-x-109">&#x03B7;</span><span 
class="cmr-10x-x-109">2</span>
copied from the second &#8217;facked zero&#8217; observations.
</p>
   <div class="fancyvrb" id="fancyvrb650"><a 
 id="x20-97056r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stack3</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(tag=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">y3</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><br class="fancyvrb" /><a 
 id="x20-97058r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=list(y=y3),</span>
<br class="fancyvrb" /><a 
 id="x20-97060r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;effects=list(list(eta2c=1:n,</span><span 
class="aesltt-10x-x-109">&#x00A0;e3=1:n)),</span><br class="fancyvrb" /><a 
 id="x20-97062r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;A=list(1))</span></div>
<!--l. 268--><p class="indent" >   To fit the model we join all the data
</p>
   <div class="fancyvrb" id="fancyvrb651"><a 
 id="x20-97064r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stack</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(stack1,</span><span 
class="aesltt-10x-x-109">&#x00A0;stack01,</span><span 
class="aesltt-10x-x-109">&#x00A0;stack02,</span><span 
class="aesltt-10x-x-109">&#x00A0;stack2,</span><span 
class="aesltt-10x-x-109">&#x00A0;stack3)</span></div>
<!--l. 275--><p class="indent" >   The prior distributions will be the default for most of the parameters. For the three variance
errors in the observations we have set the PC-prior as follows
</p>
   <div class="fancyvrb" id="fancyvrb652"><a 
 id="x20-97066r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;pcprec</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;list(theta=list(prior=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">pcprec</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;param=c(0.5,</span><span 
class="aesltt-10x-x-109">&#x00A0;0.1)))</span></div>
<!--l. 283--><p class="noindent" >And consider it when defining the model formula
</p>
   <div class="fancyvrb" id="fancyvrb653"><a 
 id="x20-97068r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;formula123</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;y</span><span 
class="aesltt-10x-x-109">&#x00A0;~</span><span 
class="aesltt-10x-x-109">&#x00A0;0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;beta0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;beta1</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><br class="fancyvrb" /><a 
 id="x20-97070r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;f(s,</span><span 
class="aesltt-10x-x-109">&#x00A0;model=spde)</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;f(e1,</span><span 
class="aesltt-10x-x-109">&#x00A0;model=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">iid</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;hyper=pcprec)</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span>
<br class="fancyvrb" /><a 
 id="x20-97072r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;f(eta1,</span><span 
class="aesltt-10x-x-109">&#x00A0;model=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">iid</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><br class="fancyvrb" /><a 
 id="x20-97074r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;hyper=list(theta=list(initial=-10,</span><span 
class="aesltt-10x-x-109">&#x00A0;fixed=TRUE)))</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span>
<br class="fancyvrb" /><a 
 id="x20-97076r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;f(eta2,</span><span 
class="aesltt-10x-x-109">&#x00A0;model=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">iid</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><br class="fancyvrb" /><a 
 id="x20-97078r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;hyper=list(theta=list(initial=-10,</span><span 
class="aesltt-10x-x-109">&#x00A0;fixed=TRUE)))</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span>
<br class="fancyvrb" /><a 
 id="x20-97080r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;f(eta1c,</span><span 
class="aesltt-10x-x-109">&#x00A0;copy=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">eta1</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;fixed=FALSE)</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><br class="fancyvrb" /><a 
 id="x20-97082r8"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;f(e2,</span><span 
class="aesltt-10x-x-109">&#x00A0;model=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">iid</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;hyper=pcprec)</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span>
<br class="fancyvrb" /><a 
 id="x20-97084r9"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;f(eta2c,</span><span 
class="aesltt-10x-x-109">&#x00A0;copy=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">eta2</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;fixed=FALSE)</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><br class="fancyvrb" /><a 
 id="x20-97086r10"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;f(e3,</span><span 
class="aesltt-10x-x-109">&#x00A0;model=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">iid</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;hyper=pcprec)</span></div>
                                                                                 
                                                                                 
<!--l. 299--><p class="indent" >   The model is them fitted with
</p>
   <div class="fancyvrb" id="fancyvrb654"><a 
 id="x20-97088r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res123</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla(formula123,</span><br class="fancyvrb" /><a 
 id="x20-97090r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=inla.stack.data(stack),</span>
<br class="fancyvrb" /><a 
 id="x20-97092r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;offset=offset,</span><br class="fancyvrb" /><a 
 id="x20-97094r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;control.family=list(list(</span>
<br class="fancyvrb" /><a 
 id="x20-97096r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;hyper=list(theta=list(initial=10,</span><span 
class="aesltt-10x-x-109">&#x00A0;fixed=TRUE)))),</span>
<br class="fancyvrb" /><a 
 id="x20-97098r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;control.predictor=list(A=inla.stack.A(stack)))</span></div>
<!--l. 311--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">16.4   </span> <a 
 id="x20-9800016.4"></a>Model results</h3>
<!--l. 313--><p class="noindent" >We can see the fixed effects <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub> and <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">1</span></sub> with
</p>
   <div class="fancyvrb" id="fancyvrb655"><a 
 id="x20-98002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;round(cbind(true=c(beta0,beta1),res123$summary.fixed),</span><span 
class="aesltt-10x-x-109">&#x00A0;4)</span></div>
<!--l. 318--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb656"><a 
 id="x20-98004r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;true</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mean</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sd</span><span 
class="aett-10x-x-109">&#x00A0;0.025quant</span><span 
class="aett-10x-x-109">&#x00A0;0.5quant</span><span 
class="aett-10x-x-109">&#x00A0;0.975quant</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mode</span><span 
class="aett-10x-x-109">&#x00A0;kld</span>
<br class="fancyvrb" /><a 
 id="x20-98006r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;beta0</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;5</span><span 
class="aett-10x-x-109">&#x00A0;5.0835</span><span 
class="aett-10x-x-109">&#x00A0;0.1739</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;4.8398</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;5.0281</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;5.4432</span><span 
class="aett-10x-x-109">&#x00A0;4.9612</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span>
<br class="fancyvrb" /><a 
 id="x20-98008r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;beta1</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1</span><span 
class="aett-10x-x-109">&#x00A0;0.9696</span><span 
class="aett-10x-x-109">&#x00A0;0.0318</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.9174</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.9640</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.0360</span><span 
class="aett-10x-x-109">&#x00A0;0.9530</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span></div>
<!--l. 325--><p class="indent" >   The <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">2</span></sub> and <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">3</span></sub> parameters are
</p>
   <div class="fancyvrb" id="fancyvrb657"><a 
 id="x20-98010r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;i.b</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;match(paste0(</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Beta</span><span 
class="aesltt-10x-x-109">&#x00A0;for</span><span 
class="aesltt-10x-x-109">&#x00A0;eta</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;1:2,</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">c</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">),</span><br class="fancyvrb" /><a 
 id="x20-98012r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;rownames(res123$summary.hyper))</span>
<br class="fancyvrb" /><a 
 id="x20-98014r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;round(cbind(true=c(beta2,</span><span 
class="aesltt-10x-x-109">&#x00A0;beta3),</span><span 
class="aesltt-10x-x-109">&#x00A0;res123$summary.hy[i.b,]),</span><span 
class="aesltt-10x-x-109">&#x00A0;4)</span></div>
<!--l. 332--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb658"><a 
 id="x20-98016r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;true</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mean</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sd</span><span 
class="aett-10x-x-109">&#x00A0;0.025quant</span><span 
class="aett-10x-x-109">&#x00A0;0.5quant</span><span 
class="aett-10x-x-109">&#x00A0;0.975quant</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mode</span>
<br class="fancyvrb" /><a 
 id="x20-98018r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Beta</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;eta1c</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.5</span><span 
class="aett-10x-x-109">&#x00A0;0.4941</span><span 
class="aett-10x-x-109">&#x00A0;0.0116</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.4694</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.4949</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.5150</span><span 
class="aett-10x-x-109">&#x00A0;0.4969</span>
<br class="fancyvrb" /><a 
 id="x20-98020r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Beta</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;eta2c</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.0</span><span 
class="aett-10x-x-109">&#x00A0;2.0083</span><span 
class="aett-10x-x-109">&#x00A0;0.0050</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.9988</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.0082</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.0186</span><span 
class="aett-10x-x-109">&#x00A0;2.0078</span></div>
<!--l. 339--><p class="indent" >   The posterior marginal distribution of the standard deviation for <span 
class="cmmib-10x-x-109">&#x03F5;</span><span 
class="cmr-10x-x-109">1</span>, <span 
class="cmmib-10x-x-109">&#x03F5;</span><span 
class="cmr-10x-x-109">2 </span>and <span 
class="cmmib-10x-x-109">&#x03F5;</span><span 
class="cmr-10x-x-109">1 </span>can be
visualized with
</p>
   <div class="fancyvrb" id="fancyvrb659"><a 
 id="x20-98022r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;i.e123</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;match(paste0(</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Precision</span><span 
class="aesltt-10x-x-109">&#x00A0;for</span><span 
class="aesltt-10x-x-109">&#x00A0;e</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;1:3),</span><br class="fancyvrb" /><a 
 id="x20-98024r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;names(res123$marginals.hyper))</span>
<br class="fancyvrb" /><a 
 id="x20-98026r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;par(mfrow=c(1,3),</span><span 
class="aesltt-10x-x-109">&#x00A0;mar=c(3,3,1,1),</span><span 
class="aesltt-10x-x-109">&#x00A0;mgp=c(1.5,</span><span 
class="aesltt-10x-x-109">&#x00A0;0.5,</span><span 
class="aesltt-10x-x-109">&#x00A0;0))</span>
<br class="fancyvrb" /><a 
 id="x20-98028r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;for</span><span 
class="aesltt-10x-x-109">&#x00A0;(j</span><span 
class="aesltt-10x-x-109">&#x00A0;in</span><span 
class="aesltt-10x-x-109">&#x00A0;1:3)</span><span 
class="aesltt-10x-x-109">&#x00A0;{</span><br class="fancyvrb" /><a 
 id="x20-98030r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(inla.tmarginal(function(x)</span><span 
class="aesltt-10x-x-109">&#x00A0;1/sqrt(x),</span>
<br class="fancyvrb" /><a 
 id="x20-98032r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res123$marginals.hyperpar[[i.e123[j]]]),</span>
<br class="fancyvrb" /><a 
 id="x20-98034r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2,</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=bquote(sigma[.(j)]^2),</span>
<br class="fancyvrb" /><a 
 id="x20-98036r8"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Posterior</span><span 
class="aesltt-10x-x-109">&#x00A0;marginal</span><span 
class="aesltt-10x-x-109">&#x00A0;density</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span><br class="fancyvrb" /><a 
 id="x20-98038r9"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;abline(v=s123[j],</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2)</span><br class="fancyvrb" /><a 
 id="x20-98040r10"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;}</span></div>
<hr class="figure" /><div class="figure" 
><a 
 id="x20-980412"></a><img 
src="spde-tutorial108x.png" alt="PIC" class="graphics" width="422.52936pt" height="169.01889pt"  /><!--tex4ht:graphics  
name="spde-tutorial108x.png" src="figs/copy-vs123.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;16.2: </span><span  
class="content">Observation error standard deviations.</span></div><!--tex4ht:label?: x20-980412 -->
   </div><hr class="endfigure" />
<!--l. 364--><p class="indent" >   Finally, the random field parameters posterior marginals can be visualized with
</p>
   <div class="fancyvrb" id="fancyvrb660"><a 
 id="x20-98043r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;rfparams</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde2.result(res123,</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">s</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;spde)</span>
<br class="fancyvrb" /><a 
 id="x20-98045r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;par(mfrow=c(1,3),</span><span 
class="aesltt-10x-x-109">&#x00A0;mar=c(3,3,1,1),</span><span 
class="aesltt-10x-x-109">&#x00A0;mgp=c(1.5,</span><span 
class="aesltt-10x-x-109">&#x00A0;0.5,</span><span 
class="aesltt-10x-x-109">&#x00A0;0))</span><br class="fancyvrb" /><a 
 id="x20-98047r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;for</span><span 
class="aesltt-10x-x-109">&#x00A0;(j</span><span 
class="aesltt-10x-x-109">&#x00A0;in</span><span 
class="aesltt-10x-x-109">&#x00A0;15:17)</span><span 
class="aesltt-10x-x-109">&#x00A0;{</span>
<br class="fancyvrb" /><a 
 id="x20-98049r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(rfparams[[j]][[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=names(rfparams)[j],</span>
<br class="fancyvrb" /><a 
 id="x20-98051r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Posterior</span><span 
class="aesltt-10x-x-109">&#x00A0;marginal</span><span 
class="aesltt-10x-x-109">&#x00A0;density</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span>
<br class="fancyvrb" /><a 
 id="x20-98053r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;abline(v=c(10,</span><span 
class="aesltt-10x-x-109">&#x00A0;1,</span><span 
class="aesltt-10x-x-109">&#x00A0;sqrt(8)/10)[j-14],</span><span 
class="aesltt-10x-x-109">&#x00A0;lwd=2)</span><br class="fancyvrb" /><a 
 id="x20-98055r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;}</span></div>
<hr class="figure" /><div class="figure" 
><a 
 id="x20-980563"></a><img 
src="spde-tutorial109x.png" alt="PIC" class="graphics" width="422.52936pt" height="169.01889pt"  /><!--tex4ht:graphics  
name="spde-tutorial109x.png" src="figs/copy-vrfparams.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;16.3: </span><span  
class="content">Posterior marginal distributions for the random field parameters</span></div><!--tex4ht:label?: x20-980563 -->
   </div><hr class="endfigure" />
                                                                                 
                                                                                 
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialch17.html" >next</a>] [<a 
href="spde-tutorialch15.html" >prev</a>] [<a 
href="spde-tutorialch15.html#tailspde-tutorialch15.html" >prev-tail</a>] [<a 
href="spde-tutorialch16.html" >front</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch16.html" >up</a>] </p></div>
<!--l. 1--><p class="indent" >   <a 
 id="tailspde-tutorialch16.html"></a>  </p> 
</body></html> 
