<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>2 Non-Gaussian and covariates in the covariance</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,html,frames,2 --> 
<meta name="src" content="spde-tutorial.tex" /> 
<link rel="stylesheet" type="text/css" href="spde-tutorial.css" /> 
</head><body 
>
   <!--l. 116--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialch3.html" >next</a>] [<a 
href="spde-tutorialch1.html" >prev</a>] [<a 
href="spde-tutorialch1.html#tailspde-tutorialch1.html" >prev-tail</a>] [<a 
href="#tailspde-tutorialch2.html">tail</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch2.html" >up</a>] </p></div>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;2</span><br /><a 
 id="x6-340002"></a>Non-Gaussian and covariates in the covariance</h2>
   <h3 class="sectionHead"><span class="titlemark">2.1   </span> <a 
 id="x6-350002.1"></a>Non-Gaussian response: Precipitation on Paraná</h3>
<!--l. 3--><p class="noindent" >This content is part of the book available at <a 
href="http://www.r-inla.org/spde-book" class="url" ><span 
class="aett-10x-x-109">http://www.r-inla.org/spde-book</span></a>, whose
Gitbook version is freely available along all the code and datasets.
</p><!--l. 10--><p class="indent" >   A very common data in spatial statistics is the climate data. We have collected data from the
National Water Agency in Brazil, in Portuguese it is <span 
class="aeti-10x-x-109">Agencia Nacional de </span><span 
class="aeti-10x-x-109">Águas </span>- ANA. The
ANA collect data from many locations over Brazil. All these data are freely available from the
ANA website.
</p><!--l. 17--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1.1   </span> <a 
 id="x6-360002.1.1"></a>The data set</h4>
<!--l. 19--><p class="noindent" >We have daily rainfall data on each day of the year 2011 at 616 locations, including stations
within the Paraná state and around its border.
</p><!--l. 23--><p class="indent" >   We have these dataset on the <span 
class="aeb10-x-x-109">INLA </span>package and call it with  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4071"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor4072"><span 
class="aett-10x-x-109">(PRprec)</span></span>
</div>
</div>
   </div>
We have the coordinates at first two columns, altitude at third column and more 365 columns,
one for each day with the daily accumulated precipitation.
<!--l. 37--><p class="indent" >   In the bellow code we show some data from four stations: the with missing altitude with less
latitude, the stations with extremes longitudes and the station with greater altitude.
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4073"><span 
class="aett-10x-x-109">PRprec[ii</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4074"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4075"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4076"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4077"><span 
class="aett-10x-x-109">which</span></span><span id="textcolor4078"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4079"><span 
class="aett-10x-x-109">is.na</span></span><span id="textcolor4080"><span 
class="aett-10x-x-109">(PRprec</span></span><span id="textcolor4081"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4082"><span 
class="aett-10x-x-109">A))[</span></span><span id="textcolor4083"><span 
class="aett-10x-x-109">which.min</span></span><span id="textcolor4084"><span 
class="aett-10x-x-109">(PRprec</span></span><span id="textcolor4085"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4086"><span 
class="aett-10x-x-109">La[</span></span><span id="textcolor4087"><span 
class="aett-10x-x-109">is.na</span></span><span id="textcolor4088"><span 
class="aett-10x-x-109">(PRprec</span></span><span id="textcolor4089"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4090"><span 
class="aett-10x-x-109">A)])],</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4091"><span 
class="aett-10x-x-109">which</span></span><span id="textcolor4092"><span 
class="aett-10x-x-109">(PRprec</span></span><span id="textcolor4093"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4094"><span 
class="aett-10x-x-109">Lo</span></span><span id="textcolor4095"><span 
class="aett-10x-x-109">%in%</span></span><span id="textcolor4096"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor4097"><span 
class="aett-10x-x-109">(PRprec</span></span><span id="textcolor4098"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4099"><span 
class="aett-10x-x-109">Lo)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4100"><span 
class="aett-10x-x-109">which.max</span></span><span id="textcolor4101"><span 
class="aett-10x-x-109">(PRprec</span></span><span id="textcolor4102"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4103"><span 
class="aett-10x-x-109">A)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4104"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4105"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor4106"><span 
class="aett-10x-x-109">10</span></span><span id="textcolor4107"><span 
class="aett-10x-x-109">]</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-58">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Longitude&#x00A0;Latitude&#x00A0;Altitude&#x00A0;d0101&#x00A0;d0102&#x00A0;d0103&#x00A0;d0104&#x00A0;d0105&#x00A0;d0106&#x00A0;d0107
&#x00A0;<br />##&#x00A0;1239&#x00A0;&#x00A0;-48.9394&#x00A0;-26.1800&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;NA&#x00A0;&#x00A0;20.5&#x00A0;&#x00A0;&#x00A0;7.9&#x00A0;&#x00A0;&#x00A0;8.0&#x00A0;&#x00A0;&#x00A0;0.8&#x00A0;&#x00A0;&#x00A0;0.1&#x00A0;&#x00A0;15.6&#x00A0;&#x00A0;31.0
&#x00A0;<br />##&#x00A0;658&#x00A0;&#x00A0;&#x00A0;-48.2167&#x00A0;-25.0831&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;9&#x00A0;&#x00A0;18.1&#x00A0;&#x00A0;&#x00A0;8.1&#x00A0;&#x00A0;&#x00A0;2.3&#x00A0;&#x00A0;11.3&#x00A0;&#x00A0;23.6&#x00A0;&#x00A0;&#x00A0;0.0&#x00A0;&#x00A0;22.6
&#x00A0;<br />##&#x00A0;1325&#x00A0;&#x00A0;-54.4842&#x00A0;-25.6017&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;231&#x00A0;&#x00A0;43.8&#x00A0;&#x00A0;&#x00A0;0.2&#x00A0;&#x00A0;&#x00A0;4.6&#x00A0;&#x00A0;&#x00A0;0.4&#x00A0;&#x00A0;&#x00A0;0.0&#x00A0;&#x00A0;&#x00A0;0.0&#x00A0;&#x00A0;&#x00A0;0.0
&#x00A0;<br />##&#x00A0;885&#x00A0;&#x00A0;&#x00A0;-51.5167&#x00A0;-25.7331&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1446&#x00A0;&#x00A0;&#x00A0;0.0&#x00A0;&#x00A0;14.7&#x00A0;&#x00A0;&#x00A0;0.0&#x00A0;&#x00A0;&#x00A0;0.0&#x00A0;&#x00A0;28.1&#x00A0;&#x00A0;&#x00A0;2.5&#x00A0;&#x00A0;26.6
</div>
<!--l. 53--><p class="nopar" >
</p>
   </div>
We do visualize this four stations as red points in the right plot in Figure&#x00A0;<a 
href="#x6-360002.1.1">2.1.1<!--tex4ht:ref: fig:paranastations --></a>.
<!--l. 59--><p class="indent" >   There are a few problems in this data set. There are seven stations with missing
altitude and missing data on daily rainfall, which are displayed in red in the left plot
in Figure&#x00A0;<a 
href="#x6-360002.1.1">2.1.1<!--tex4ht:ref: fig:paranastations --></a>. If this information is considerend when building a model it will be
important to have it everywere in the state. There are digital elevation models that can be
considered to find out the altitude at these locations. It can also be considered a stochastic
model.
</p><!--l. 70--><p class="indent" >   We will analyse the daily rainfall mean in January 2011. However, we do have 269 missing
observations. So, we take the average over the number of days without missing data as follows
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4108"><span 
class="aett-10x-x-109">summary</span></span><span id="textcolor4109"><span 
class="aett-10x-x-109">(PRprec</span></span><span id="textcolor4110"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4111"><span 
class="aett-10x-x-109">precMean</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4112"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4113"><span 
class="aett-10x-x-109">rowMeans</span></span><span id="textcolor4114"><span 
class="aett-10x-x-109">(PRprec[,</span></span><span id="textcolor4115"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor4116"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor4117"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4118"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor4119"><span 
class="aett-10x-x-109">31</span></span><span id="textcolor4120"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4121"><span 
class="aett-10x-x-109">na.rm</span></span><span id="textcolor4122"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4123"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor4124"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-59">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;Min.&#x00A0;1st&#x00A0;Qu.&#x00A0;&#x00A0;Median&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mean&#x00A0;3rd&#x00A0;Qu.&#x00A0;&#x00A0;&#x00A0;&#x00A0;Max.&#x00A0;&#x00A0;&#x00A0;&#x00A0;NA's
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;0.500&#x00A0;&#x00A0;&#x00A0;4.966&#x00A0;&#x00A0;&#x00A0;6.540&#x00A0;&#x00A0;&#x00A0;6.958&#x00A0;&#x00A0;&#x00A0;8.629&#x00A0;&#x00A0;21.655&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;6
</div>
<!--l. 83--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor4125"><span 
class="aett-10x-x-109">table</span></span><span id="textcolor4126"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4127"><span 
class="aett-10x-x-109">rowSums</span></span><span id="textcolor4128"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4129"><span 
class="aett-10x-x-109">is.na</span></span><span id="textcolor4130"><span 
class="aett-10x-x-109">(PRprec[,</span></span><span id="textcolor4131"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor4132"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor4133"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4134"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor4135"><span 
class="aett-10x-x-109">31</span></span><span id="textcolor4136"><span 
class="aett-10x-x-109">])))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-60">
##
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;4&#x00A0;&#x00A0;&#x00A0;8&#x00A0;&#x00A0;17&#x00A0;&#x00A0;26&#x00A0;&#x00A0;31
&#x00A0;<br />##&#x00A0;604&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;6
</div>
<!--l. 91--><p class="nopar" >
</p>
   </div>
and still have missing data for it as we do have stations without data in January
2011.
<!--l. 97--><p class="indent" >   We will also consider the Paraná state border  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4137"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor4138"><span 
class="aett-10x-x-109">(PRborder)</span></span>
</div>
</div>
   </div>
to define the study domain.
<!--l. 107--><p class="indent" >   We can visualize the locations in Figure&#x00A0;<a 
href="#x6-360002.1.1">2.1.1<!--tex4ht:ref: fig:paranastations --></a>, with the commands bellow  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4139"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor4140"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4141"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor4142"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4143"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4144"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4145"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4146"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4147"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor4148"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4149"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor4150"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4151"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4152"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4153"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor4154"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4155"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor4156"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4157"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor4158"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4159"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor4160"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor4161"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor4162"><span 
class="aett-10x-x-109">(PRborder,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4163"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor4164"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4165"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor4166"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4167"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor4168"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4169"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4170"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4171"><span 
class="aett-10x-x-109">axes</span></span><span id="textcolor4172"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4173"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor4174"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4175"><span 
class="aett-10x-x-109">main</span></span><span id="textcolor4176"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4177"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Altitude</span><span 
class="tctt-1095">'</span></span><span id="textcolor4178"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor4179"><span 
class="aett-10x-x-109">points</span></span><span id="textcolor4180"><span 
class="aett-10x-x-109">(PRprec[</span></span><span id="textcolor4181"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4182"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor4183"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor4184"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4185"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor4186"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4187"><span 
class="aett-10x-x-109">is.na</span></span><span id="textcolor4188"><span 
class="aett-10x-x-109">(PRprec</span></span><span id="textcolor4189"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4190"><span 
class="aett-10x-x-109">Alt)</span></span><span id="textcolor4191"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor4192"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4193"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4194"><span 
class="aett-10x-x-109">cex</span></span><span id="textcolor4195"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4196"><span 
class="aett-10x-x-109">ifelse</span></span><span id="textcolor4197"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4198"><span 
class="aett-10x-x-109">is.na</span></span><span id="textcolor4199"><span 
class="aett-10x-x-109">(PRprec</span></span><span id="textcolor4200"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4201"><span 
class="aett-10x-x-109">Alt),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4202"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4203"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4204"><span 
class="aett-10x-x-109">.3</span></span><span id="textcolor4205"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor4206"><span 
class="aett-10x-x-109">PRprec</span></span><span id="textcolor4207"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4208"><span 
class="aett-10x-x-109">Alt</span></span><span id="textcolor4209"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor4210"><span 
class="aett-10x-x-109">1500</span></span><span id="textcolor4211"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor4212"><span 
class="aett-10x-x-109">legend</span></span><span id="textcolor4213"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4214"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">topright</span><span 
class="tctt-1095">'</span></span><span id="textcolor4215"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4216"><span 
class="aett-10x-x-109">format</span></span><span id="textcolor4217"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4218"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor4219"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor4220"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor4221"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor4222"><span 
class="aett-10x-x-109">350</span></span><span id="textcolor4223"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4224"><span 
class="aett-10x-x-109">bty</span></span><span id="textcolor4225"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4226"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">n</span><span 
class="tctt-1095">'</span></span><span id="textcolor4227"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4228"><span 
class="aett-10x-x-109">pch</span></span><span id="textcolor4229"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4230"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4231"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4232"><span 
class="aett-10x-x-109">pt.cex</span></span><span id="textcolor4233"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4234"><span 
class="aett-10x-x-109">.3</span></span><span id="textcolor4235"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor4236"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor4237"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor4238"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor4239"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor4240"><span 
class="aett-10x-x-109">35</span></span><span id="textcolor4241"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor4242"><span 
class="aett-10x-x-109">150</span></span><span id="textcolor4243"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor4244"><span 
class="aett-10x-x-109">lines</span></span><span id="textcolor4245"><span 
class="aett-10x-x-109">(PRborder[</span></span><span id="textcolor4246"><span 
class="aett-10x-x-109">1034</span></span><span id="textcolor4247"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor4248"><span 
class="aett-10x-x-109">1078</span></span><span id="textcolor4249"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4250"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor4251"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4252"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">cyan</span><span 
class="tctt-1095">'</span></span><span id="textcolor4253"><span 
class="aett-10x-x-109">)</span></span>
<br />
<br /><span id="textcolor4254"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor4255"><span 
class="aett-10x-x-109">(PRborder,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4256"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor4257"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4258"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor4259"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4260"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor4261"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4262"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4263"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4264"><span 
class="aett-10x-x-109">axes</span></span><span id="textcolor4265"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4266"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor4267"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4268"><span 
class="aett-10x-x-109">main</span></span><span id="textcolor4269"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4270"><span 
class="aett-10x-x-109">paste</span></span><span id="textcolor4271"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4272"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Mean</span><span 
class="aett-10x-x-109">&#x00A0;of</span><span 
class="aett-10x-x-109">&#x00A0;daily</span><span 
class="aett-10x-x-109">&#x00A0;accumulated</span><span 
class="aett-10x-x-109">&#x00A0;precipitation</span><span 
class="aett-10x-x-109">&#x00A0;(mm)</span><span 
class="tctt-1095">'</span></span><span id="textcolor4273"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor4274"><span 
class="aett-10x-x-109">points</span></span><span id="textcolor4275"><span 
class="aett-10x-x-109">(PRprec[</span></span><span id="textcolor4276"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4277"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor4278"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor4279"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4280"><span 
class="aett-10x-x-109">cex</span></span><span id="textcolor4281"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4282"><span 
class="aett-10x-x-109">0.3</span></span><span id="textcolor4283"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor4284"><span 
class="aett-10x-x-109">PRprec</span></span><span id="textcolor4285"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4286"><span 
class="aett-10x-x-109">precMean</span></span><span id="textcolor4287"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor4288"><span 
class="aett-10x-x-109">20</span></span><span id="textcolor4289"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor4290"><span 
class="aett-10x-x-109">legend</span></span><span id="textcolor4291"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4292"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">topright</span><span 
class="tctt-1095">'</span></span><span id="textcolor4293"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4294"><span 
class="aett-10x-x-109">format</span></span><span id="textcolor4295"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4296"><span 
class="aett-10x-x-109">seq</span></span><span id="textcolor4297"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4298"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4299"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4300"><span 
class="aett-10x-x-109">21</span></span><span id="textcolor4301"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4302"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor4303"><span 
class="aett-10x-x-109">)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4304"><span 
class="aett-10x-x-109">bty</span></span><span id="textcolor4305"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4306"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">n</span><span 
class="tctt-1095">'</span></span><span id="textcolor4307"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4308"><span 
class="aett-10x-x-109">pch</span></span><span id="textcolor4309"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4310"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4311"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4312"><span 
class="aett-10x-x-109">pt.cex</span></span><span id="textcolor4313"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4314"><span 
class="aett-10x-x-109">0.3</span></span><span id="textcolor4315"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor4316"><span 
class="aett-10x-x-109">seq</span></span><span id="textcolor4317"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4318"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4319"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4320"><span 
class="aett-10x-x-109">21</span></span><span id="textcolor4321"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4322"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor4323"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor4324"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor4325"><span 
class="aett-10x-x-109">20</span></span><span id="textcolor4326"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor4327"><span 
class="aett-10x-x-109">points</span></span><span id="textcolor4328"><span 
class="aett-10x-x-109">(PRprec[ii,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4329"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4330"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor4331"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor4332"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4333"><span 
class="aett-10x-x-109">pch</span></span><span id="textcolor4334"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4335"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor4336"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4337"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor4338"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4339"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor4340"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor4341"><span 
class="aett-10x-x-109">lines</span></span><span id="textcolor4342"><span 
class="aett-10x-x-109">(PRborder[</span></span><span id="textcolor4343"><span 
class="aett-10x-x-109">1034</span></span><span id="textcolor4344"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor4345"><span 
class="aett-10x-x-109">1078</span></span><span id="textcolor4346"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4347"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor4348"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4349"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">cyan</span><span 
class="tctt-1095">'</span></span><span id="textcolor4350"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x6-360011"></a>
                                                                                 
                                                                                 
<!--l. 134--><p class="noindent" ><img 
src="spde-tutorial33x.png" alt="PIC" class="graphics" width="426" height="170"  /><!--tex4ht:graphics  
name="spde-tutorial33x.png" src="figs/rainprmap-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;2.1:  </span><span  
class="content">Locations  of  Paraná  stations,  altitude  and  average  of  daily  accumulated
precipitation (mm) in January 2011.</span></div><!--tex4ht:label?: x6-360011 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 141--><p class="indent" >   The size of the points on left graph are proportional to altitude of the locations. The cyan
line in the east border is along the Atlantic Ocean. There are low altitudes near the sea,
hight altitudes around 50 to 100 kilometers from this coast and from the mid of the
state towards south as well. It decreases when goint towards the north and west sides
of the Paraná state. The size of the points in the right plot is proportional to the
daily average of the precipitation in January 2011. There are higher values near the
coast.
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1.2   </span> <a 
 id="x6-370002.1.2"></a>The model and covariate selection</h4>
<!--l. 156--><p class="noindent" >In this subsection we analise the average of the daily accumulated precipitation for each of the
31 days in January 2011. It must be a positive and we will consider a Gamma likelihood. In the
Gamma likelihood we have <span 
class="cmmi-10x-x-109">E</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">y</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">) = </span><span 
class="cmmi-10x-x-109">a</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmmi-10x-x-109">&#x2215;b</span><sub><span 
class="cmmi-8">i</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">&#x03BC;</span><sub><span 
class="cmmi-8">i</span></sub> and <span 
class="cmmi-10x-x-109">V </span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">y</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">) = </span><span 
class="cmmi-10x-x-109">a</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmmi-10x-x-109">&#x2215;b</span><sub><span 
class="cmmi-8">i</span></sub><sup><span 
class="cmr-8">2</span></sup> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">&#x03BC;</span><sub><span 
class="cmmi-8">i</span></sub><sup><span 
class="cmr-8">2</span></sup><span 
class="cmmi-10x-x-109">&#x2215;&#x03D5;</span>, where <span 
class="cmmi-10x-x-109">&#x03D5; </span>is a
precision parameter. Then we have to define a model for the linear predictor <span 
class="cmmi-10x-x-109">&#x03B7;</span><sub><span 
class="cmmi-8">i</span></sub> <span 
class="cmr-10x-x-109">=</span> <span 
class="cmr-10x-x-109">log</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">&#x03BC;</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">)</span>,
depending on the covariates <span 
class="cmbx-10x-x-109">F </span>and the spatial random field <span 
class="cmbx-10x-x-109">x </span>as follows
</p>
   <center class="math-display" >
<img 
src="spde-tutorial34x.png" alt="yi|Fi,&#x03B1;,xi,&#x03B8; ~ Gamma  (ai,bi)
  log(&#x03BC;i) = &#x03B1; + f (Fi) + xi
       xi ~ GF (0,&#x03A3;)
" class="math-display"  /></center>
<!--l. 173--><p class="nopar" > where, <span 
class="cmmi-10x-x-109">F</span><sub><span 
class="cmmi-8">i</span></sub> is a vector of covariates (the location coordinates and altitude) tha will assumes a
function detailed later and <span 
class="cmmi-10x-x-109">x </span>is the spatial latent Gaussian random field. We will consider a
Matérn covariance function with parameters <span 
class="cmmi-10x-x-109">&#x03BD;</span>, <span 
class="cmmi-10x-x-109">&#x03BA; </span>and <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">x</span></sub><sup><span 
class="cmr-8">2</span></sup>.
</p><!--l. 181--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><a 
 id="x6-380002.1.2"></a>Smoothed covariate effect</h5>
<!--l. 183--><p class="noindent" >To make an initial exploration of the relationship between the precipitation and the covariates,
we visualize some dispersion diagrams. After preliminary tests, it seems reazonable to construct
a new covariate. That is the distance from each station to the Atlantic Ocean. The
Paraná state border along the Atlantic Ocean is shown as cyan line in Figure&#x00A0;<a 
href="#x6-360002.1.1">2.1.1<!--tex4ht:ref: fig:paranastations --></a>).
We can compute the distance from each station to the neighbor coordinate of this
line.
</p><!--l. 194--><p class="indent" >   To have this distance in kilometers we use the <span 
class="aett-10x-x-109">spDists() </span>function from the <span 
class="aeb10-x-x-109">sp </span>package
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4351"><span 
class="aett-10x-x-109">coords</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4352"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4353"><span 
class="aett-10x-x-109">as.matrix</span></span><span id="textcolor4354"><span 
class="aett-10x-x-109">(PRprec[,</span></span><span id="textcolor4355"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4356"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor4357"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor4358"><span 
class="aett-10x-x-109">])</span></span>
<br /><span id="textcolor4359"><span 
class="aett-10x-x-109">mat.dists</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4360"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4361"><span 
class="aett-10x-x-109">spDists</span></span><span id="textcolor4362"><span 
class="aett-10x-x-109">(coords,</span><span 
class="aett-10x-x-109">&#x00A0;PRborder[</span></span><span id="textcolor4363"><span 
class="aett-10x-x-109">1034</span></span><span id="textcolor4364"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor4365"><span 
class="aett-10x-x-109">1078</span></span><span id="textcolor4366"><span 
class="aett-10x-x-109">,],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4367"><span 
class="aett-10x-x-109">longlat</span></span><span id="textcolor4368"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4369"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor4370"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
However, this function computes the distance between each location in the first set of points to
each point in the second set of points. So, we need to take the minimum along the lines of the
resulting matrix of distances  <div class="framedenv" id="kframe-1">
                                                                                 
                                                                                 
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4371"><span 
class="aett-10x-x-109">PRprec</span></span><span id="textcolor4372"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4373"><span 
class="aett-10x-x-109">"seaDist"</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4374"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4375"><span 
class="aett-10x-x-109">apply</span></span><span id="textcolor4376"><span 
class="aett-10x-x-109">(mat.dists,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4377"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4378"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;min)</span></span>
</div>
</div>
   </div>
<!--l. 216--><p class="indent" >   We can see the dispersion plots in Figure&#x00A0;<a 
href="#x6-380002.1.2">2.1.2<!--tex4ht:ref: fig:disppred --></a> It seems to have a non well defined non-linear
relationship with Longitude. Also, there is a similar, but inverse, relation with sea distance. We
will build two models, one with longitude as covariate and another with distance to sea as
covariate. We can compute fitting measures to proceed a model choise among this two
options.
</p>
   <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4379"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor4380"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4381"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor4382"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4383"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4384"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4385"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor4386"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4387"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor4388"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4389"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor4390"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4391"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4392"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4393"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor4394"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4395"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor4396"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4397"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor4398"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4399"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor4400"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4401"><span 
class="aett-10x-x-109">mgp</span></span><span id="textcolor4402"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4403"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4404"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4405"><span 
class="aett-10x-x-109">1.7</span></span><span id="textcolor4406"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4407"><span 
class="aett-10x-x-109">.7</span></span><span id="textcolor4408"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4409"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor4410"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4411"><span 
class="aett-10x-x-109">las</span></span><span id="textcolor4412"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4413"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4414"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor4415"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4416"><span 
class="aett-10x-x-109">(i</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4417"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4418"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4419"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4420"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4421"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor4422"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor4423"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4424"><span 
class="aett-10x-x-109">ncol</span></span><span id="textcolor4425"><span 
class="aett-10x-x-109">(PRprec)))</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4426"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor4427"><span 
class="aett-10x-x-109">(PRprec[</span></span><span id="textcolor4428"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4429"><span 
class="aett-10x-x-109">(i,</span></span><span id="textcolor4430"><span 
class="aett-10x-x-109">ncol</span></span><span id="textcolor4431"><span 
class="aett-10x-x-109">(PRprec)</span></span><span id="textcolor4432"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor4433"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4434"><span 
class="aett-10x-x-109">)],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4435"><span 
class="aett-10x-x-109">cex</span></span><span id="textcolor4436"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4437"><span 
class="aett-10x-x-109">.5</span></span><span id="textcolor4438"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x6-380012"></a>
                                                                                 
                                                                                 
<!--l. 237--><p class="noindent" ><img 
src="spde-tutorial35x.png" alt="PIC" class="graphics" width="426" height="284"  /><!--tex4ht:graphics  
name="spde-tutorial35x.png" src="figs/raindispfig-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;2.2: </span><span  
class="content">Dispersion plots of average of daily accumulated precipitation by Longitude
(top left), Latitude (top right), Altitude (bottom left) and distance to sea (bottom right).</span></div><!--tex4ht:label?: x6-380012 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 245--><p class="indent" >   To consider a non-linear relationship from a covariate we can set a randon walk
prior over its effect. To do that we can discretize this covariate in a set of knots and
place the random walk over. In this case the term in the linear predictor due to sea
distance (or longitude) is discretized into <span 
class="cmmi-10x-x-109">m </span>classes considering the <span 
class="aett-10x-x-109">inla.group()</span>
function. The model can be chosen from any one dimensional model available in INLA,
from <span 
class="aett-10x-x-109">rw1</span>, <span 
class="aett-10x-x-109">rw2</span>, <span 
class="aebx-10x-x-109">ar1 </span>or others. It can also be considered an one-dimensional Matérn
model.
</p><!--l. 259--><p class="indent" >   When considering intrinsic models as prior one should consider to scale it first, <span class="cite">[<a 
href="spde-tutorialli2.html#XsorbyeR:2014">Sørbye and
Rue, 2014</a>]</span>. After it, the precision parameter can be interpreted as the inverse of the random
effect marginal variance. It makes easier the process of defining a prior on it. The suggestion is
to consider the PC-prior, <span class="cite">[<a 
href="spde-tutorialli2.html#Xsimpsonetal:2017">Simspon et&#x00A0;al., 2017</a>]</span>. This can be done defining a reference standard
deviation <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmr-8">0</span></sub> and the right tail probability <span 
class="cmmi-10x-x-109">u </span>as <span 
class="cmmi-10x-x-109">P</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">&#x03C3; &#x003E; &#x03C3;</span><sub><span 
class="cmr-8">0</span></sub><span 
class="cmr-10x-x-109">) = </span><span 
class="cmmi-10x-x-109">u</span>. Setting <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmr-8">0</span></sub> <span 
class="cmr-10x-x-109">= 1 </span>and <span 
class="cmmi-10x-x-109">u </span><span 
class="cmr-10x-x-109">= 0</span><span 
class="cmmi-10x-x-109">.</span><span 
class="cmr-10x-x-109">01</span>
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4439"><span 
class="aett-10x-x-109">pcprec</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4440"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4441"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor4442"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4443"><span 
class="aett-10x-x-109">prior</span></span><span id="textcolor4444"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4445"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">pcprec</span><span 
class="tctt-1095">'</span></span><span id="textcolor4446"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4447"><span 
class="aett-10x-x-109">param</span></span><span id="textcolor4448"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4449"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4450"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4451"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4452"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4453"><span 
class="aett-10x-x-109">0.01</span></span><span id="textcolor4454"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
   <h5 class="subsubsectionHead"><a 
 id="x6-390002.1.2"></a>Define the spatial model and prepare the data</h5>
<!--l. 284--><p class="noindent" >In order to define the spatial model we need to define a mesh. We first define a boundary around
the points and use it to create the mesh  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4455"><span 
class="aett-10x-x-109">pts.bound</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4456"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4457"><span 
class="aett-10x-x-109">inla.nonconvex.hull</span></span><span id="textcolor4458"><span 
class="aett-10x-x-109">(coords,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4459"><span 
class="aett-10x-x-109">0.3</span></span><span id="textcolor4460"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4461"><span 
class="aett-10x-x-109">0.3</span></span><span id="textcolor4462"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor4463"><span 
class="aett-10x-x-109">mesh</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4464"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4465"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor4466"><span 
class="aett-10x-x-109">(coords,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4467"><span 
class="aett-10x-x-109">boundary</span></span><span id="textcolor4468"><span 
class="aett-10x-x-109">=pts.bound,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4469"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor4470"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4471"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4472"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4473"><span 
class="aett-10x-x-109">0.3</span></span><span id="textcolor4474"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4475"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4476"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4477"><span 
class="aett-10x-x-109">offset</span></span><span id="textcolor4478"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4479"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4480"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4481"><span 
class="aett-10x-x-109">1e-5</span></span><span id="textcolor4482"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4483"><span 
class="aett-10x-x-109">1.5</span></span><span id="textcolor4484"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4485"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor4486"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4487"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor4488"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<!--l. 297--><p class="indent" >   The projector matrix is computed by  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4489"><span 
class="aett-10x-x-109">A</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4490"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4491"><span 
class="aett-10x-x-109">inla.spde.make.A</span></span><span id="textcolor4492"><span 
class="aett-10x-x-109">(mesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4493"><span 
class="aett-10x-x-109">loc</span></span><span id="textcolor4494"><span 
class="aett-10x-x-109">=coords)</span></span>
</div>
</div>
   </div>
                                                                                 
                                                                                 
<!--l. 306--><p class="indent" >   The SPDE model considering the PC-prior derived in <span class="cite">[<a 
href="spde-tutorialli2.html#Xfuglstadetal:2017">Fuglstad et&#x00A0;al., 2017</a>]</span> for the model
parameters as the practical range, <img 
src="spde-tutorial36x.png" alt="&#x221A;8-&#x03BD;-"  class="sqrt"  /><span 
class="cmmi-10x-x-109">&#x2215;&#x03BA;</span>, and the marginal standard deviation is defined as
follows  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4495"><span 
class="aett-10x-x-109">spde</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4496"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4497"><span 
class="aett-10x-x-109">inla.spde2.pcmatern</span></span><span id="textcolor4498"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4499"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor4500"><span 
class="aett-10x-x-109">=mesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4501"><span 
class="aett-10x-x-109">alpha</span></span><span id="textcolor4502"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4503"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor4504"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4505"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;mesh</span><span 
class="aeitt-10x-x-109">&#x00A0;and</span><span 
class="aeitt-10x-x-109">&#x00A0;smoothness</span><span 
class="aeitt-10x-x-109">&#x00A0;parameter</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4506"><span 
class="aett-10x-x-109">prior.range</span></span><span id="textcolor4507"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4508"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4509"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4510"><span 
class="aett-10x-x-109">0.05</span></span><span id="textcolor4511"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4512"><span 
class="aett-10x-x-109">0.01</span></span><span id="textcolor4513"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4514"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;P(practic.range&#x003C;0.05)=0.01</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4515"><span 
class="aett-10x-x-109">prior.sigma</span></span><span id="textcolor4516"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4517"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4518"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4519"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4520"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4521"><span 
class="aett-10x-x-109">0.01</span></span><span id="textcolor4522"><span 
class="aett-10x-x-109">))</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4523"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;P(sigma&#x003E;1)=0.01</span></span>
</div>
</div>
   </div>
<!--l. 322--><p class="indent" >   The stack data is defined to include four effects: the GRF, intercept, west coordinate and
distance to sea  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4524"><span 
class="aett-10x-x-109">stk.dat</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4525"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4526"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor4527"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4528"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor4529"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4530"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor4531"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4532"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor4533"><span 
class="aett-10x-x-109">=PRprec</span></span><span id="textcolor4534"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4535"><span 
class="aett-10x-x-109">precMean),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4536"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor4537"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4538"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor4539"><span 
class="aett-10x-x-109">(A,</span></span><span id="textcolor4540"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4541"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4542"><span 
class="aett-10x-x-109">tag</span></span><span id="textcolor4543"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4544"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">dat</span><span 
class="tctt-1095">'</span></span><span id="textcolor4545"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4546"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor4547"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4548"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor4549"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4550"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor4551"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4552"><span 
class="aett-10x-x-109">s</span></span><span id="textcolor4553"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4554"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4555"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor4556"><span 
class="aett-10x-x-109">spde</span></span><span id="textcolor4557"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4558"><span 
class="aett-10x-x-109">n.spde),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4559"><span 
class="aett-10x-x-109">data.frame</span></span><span id="textcolor4560"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4561"><span 
class="aett-10x-x-109">Intercept</span></span><span id="textcolor4562"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4563"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4564"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4565"><span 
class="aett-10x-x-109">gWest</span></span><span id="textcolor4566"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4567"><span 
class="aett-10x-x-109">inla.group</span></span><span id="textcolor4568"><span 
class="aett-10x-x-109">(coords[,</span></span><span id="textcolor4569"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4570"><span 
class="aett-10x-x-109">]),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4571"><span 
class="aett-10x-x-109">gSeaDist</span></span><span id="textcolor4572"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4573"><span 
class="aett-10x-x-109">inla.group</span></span><span id="textcolor4574"><span 
class="aett-10x-x-109">(PRprec</span></span><span id="textcolor4575"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4576"><span 
class="aett-10x-x-109">seaDist),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4577"><span 
class="aett-10x-x-109">seaDist</span></span><span id="textcolor4578"><span 
class="aett-10x-x-109">=PRprec</span></span><span id="textcolor4579"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4580"><span 
class="aett-10x-x-109">seaDist)))</span></span>
</div>
</div>
   </div>
<!--l. 339--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><a 
 id="x6-400002.1.2"></a>Fitting the models</h5>
<!--l. 341--><p class="noindent" >We fit the two models using the same stack data. We just use different formula. For the model
with west coordinate we have  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4581"><span 
class="aett-10x-x-109">f.west</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4582"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4583"><span 
class="aett-10x-x-109">y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4584"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4585"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4586"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4587"><span 
class="aett-10x-x-109">Intercept</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4588"><span 
class="aett-10x-x-109">+</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4589"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor4590"><span 
class="aett-10x-x-109">(gWest,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4591"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor4592"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4593"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">rw1</span><span 
class="tctt-1095">'</span></span><span id="textcolor4594"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4595"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;first</span><span 
class="aeitt-10x-x-109">&#x00A0;random</span><span 
class="aeitt-10x-x-109">&#x00A0;walk</span><span 
class="aeitt-10x-x-109">&#x00A0;prior</span><span 
class="aeitt-10x-x-109">&#x00A0;</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4596"><span 
class="aett-10x-x-109">scale.model</span></span><span id="textcolor4597"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4598"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor4599"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4600"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;scaling</span><span 
class="aeitt-10x-x-109">&#x00A0;this</span><span 
class="aeitt-10x-x-109">&#x00A0;prior</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4601"><span 
class="aett-10x-x-109">hyper</span></span><span id="textcolor4602"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4603"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor4604"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4605"><span 
class="aett-10x-x-109">theta</span></span><span id="textcolor4606"><span 
class="aett-10x-x-109">=pcprec))</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4607"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4608"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;considering</span><span 
class="aeitt-10x-x-109">&#x00A0;the</span><span 
class="aeitt-10x-x-109">&#x00A0;PC</span><span 
class="aeitt-10x-x-109">&#x00A0;prior</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4609"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor4610"><span 
class="aett-10x-x-109">(s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4611"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor4612"><span 
class="aett-10x-x-109">=spde)</span></span>
<br /><span id="textcolor4613"><span 
class="aett-10x-x-109">r.west</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4614"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4615"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor4616"><span 
class="aett-10x-x-109">(f.west,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4617"><span 
class="aett-10x-x-109">family</span></span><span id="textcolor4618"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4619"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Gamma</span><span 
class="tctt-1095">'</span></span><span id="textcolor4620"><span 
class="aett-10x-x-109">,</span></span>
                                                                                 
                                                                                 
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4621"><span 
class="aett-10x-x-109">control.compute</span></span><span id="textcolor4622"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4623"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor4624"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4625"><span 
class="aett-10x-x-109">cpo</span></span><span id="textcolor4626"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4627"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor4628"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4629"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor4630"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4631"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor4632"><span 
class="aett-10x-x-109">(stk.dat),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4633"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor4634"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4635"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor4636"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4637"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor4638"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4639"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor4640"><span 
class="aett-10x-x-109">(stk.dat),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4641"><span 
class="aett-10x-x-109">link</span></span><span id="textcolor4642"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4643"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4644"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
<!--l. 361--><p class="indent" >   We have <span 
class="aett-10x-x-109">link=1 </span>in the <span 
class="aett-10x-x-109">control.predictor </span>to track the function link to be considered in the
computation of the fitted values.
</p><!--l. 365--><p class="indent" >   For the model with distance to sea covariate we have  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4645"><span 
class="aett-10x-x-109">f.seaD</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4646"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4647"><span 
class="aett-10x-x-109">y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4648"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4649"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4650"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4651"><span 
class="aett-10x-x-109">Intercept</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4652"><span 
class="aett-10x-x-109">+</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4653"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor4654"><span 
class="aett-10x-x-109">(gSeaDist,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4655"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor4656"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4657"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">rw1</span><span 
class="tctt-1095">'</span></span><span id="textcolor4658"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4659"><span 
class="aett-10x-x-109">scale.model</span></span><span id="textcolor4660"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4661"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor4662"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4663"><span 
class="aett-10x-x-109">hyper</span></span><span id="textcolor4664"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4665"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor4666"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4667"><span 
class="aett-10x-x-109">theta</span></span><span id="textcolor4668"><span 
class="aett-10x-x-109">=pcprec))</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4669"><span 
class="aett-10x-x-109">+</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4670"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor4671"><span 
class="aett-10x-x-109">(s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4672"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor4673"><span 
class="aett-10x-x-109">=spde)</span></span>
<br /><span id="textcolor4674"><span 
class="aett-10x-x-109">r.seaD</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4675"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4676"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor4677"><span 
class="aett-10x-x-109">(f.seaD,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4678"><span 
class="aett-10x-x-109">family</span></span><span id="textcolor4679"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4680"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Gamma</span><span 
class="tctt-1095">'</span></span><span id="textcolor4681"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4682"><span 
class="aett-10x-x-109">control.compute</span></span><span id="textcolor4683"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4684"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor4685"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4686"><span 
class="aett-10x-x-109">cpo</span></span><span id="textcolor4687"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4688"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor4689"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4690"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor4691"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4692"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor4693"><span 
class="aett-10x-x-109">(stk.dat),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4694"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor4695"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4696"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor4697"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4698"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor4699"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4700"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor4701"><span 
class="aett-10x-x-109">(stk.dat),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4702"><span 
class="aett-10x-x-109">link</span></span><span id="textcolor4703"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4704"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4705"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
<!--l. 382--><p class="indent" >   We can see in Figure&#x00A0;<a 
href="#x6-410002.1.2">2.1.2<!--tex4ht:ref: fig:dseaeff --></a> that the effect from distance to sea is almost linear. We them also
fit the model considering this option For the model with distance to sea covariate we have
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4706"><span 
class="aett-10x-x-109">f.seaD.l</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4707"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4708"><span 
class="aett-10x-x-109">y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4709"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4710"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4711"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4712"><span 
class="aett-10x-x-109">Intercept</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4713"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4714"><span 
class="aett-10x-x-109">seaDist</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4715"><span 
class="aett-10x-x-109">+</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4716"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor4717"><span 
class="aett-10x-x-109">(s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4718"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor4719"><span 
class="aett-10x-x-109">=spde)</span></span>
<br /><span id="textcolor4720"><span 
class="aett-10x-x-109">r.seaD.l</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4721"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4722"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor4723"><span 
class="aett-10x-x-109">(f.seaD.l,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4724"><span 
class="aett-10x-x-109">family</span></span><span id="textcolor4725"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4726"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Gamma</span><span 
class="tctt-1095">'</span></span><span id="textcolor4727"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4728"><span 
class="aett-10x-x-109">control.compute</span></span><span id="textcolor4729"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4730"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor4731"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4732"><span 
class="aett-10x-x-109">cpo</span></span><span id="textcolor4733"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4734"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor4735"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4736"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor4737"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4738"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor4739"><span 
class="aett-10x-x-109">(stk.dat),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4740"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor4741"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4742"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor4743"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4744"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor4745"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4746"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor4747"><span 
class="aett-10x-x-109">(stk.dat),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4748"><span 
class="aett-10x-x-109">link</span></span><span id="textcolor4749"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4750"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4751"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
                                                                                 
                                                                                 
<!--l. 400--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><a 
 id="x6-410002.1.2"></a>Compare the models and look at the results</h5>
<!--l. 402--><p class="noindent" >We have the negated sum of the log CPO from each model with  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4752"><span 
class="aett-10x-x-109">slcpo</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4753"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4754"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor4755"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4756"><span 
class="aett-10x-x-109">m</span></span><span id="textcolor4757"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4758"><span 
class="aett-10x-x-109">na.rm</span></span><span id="textcolor4759"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4760"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor4761"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4762"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor4763"><span 
class="aett-10x-x-109">sum</span></span><span id="textcolor4764"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4765"><span 
class="aett-10x-x-109">log</span></span><span id="textcolor4766"><span 
class="aett-10x-x-109">(m</span></span><span id="textcolor4767"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4768"><span 
class="aett-10x-x-109">cpo</span></span><span id="textcolor4769"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4770"><span 
class="aett-10x-x-109">cpo),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4771"><span 
class="aett-10x-x-109">na.rm</span></span><span id="textcolor4772"><span 
class="aett-10x-x-109">=na.rm)</span></span>
<br /><span id="textcolor4773"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4774"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4775"><span 
class="aett-10x-x-109">long</span></span><span id="textcolor4776"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4777"><span 
class="aett-10x-x-109">slcpo</span></span><span id="textcolor4778"><span 
class="aett-10x-x-109">(r.west),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4779"><span 
class="aett-10x-x-109">seaD</span></span><span id="textcolor4780"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4781"><span 
class="aett-10x-x-109">slcpo</span></span><span id="textcolor4782"><span 
class="aett-10x-x-109">(r.seaD),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4783"><span 
class="aett-10x-x-109">seaD.l</span></span><span id="textcolor4784"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4785"><span 
class="aett-10x-x-109">slcpo</span></span><span id="textcolor4786"><span 
class="aett-10x-x-109">(r.seaD.l))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-61">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;long&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;seaD&#x00A0;&#x00A0;&#x00A0;seaD.l
&#x00A0;<br />##&#x00A0;1278.632&#x00A0;1278.258&#x00A0;1273.838
</div>
<!--l. 414--><p class="nopar" >
</p>
   </div>
wich inform that the model with distance to sea as a linear effect has a bit better fit. It was just
to show one way to compare models considering how it fits the data. In this case the three
models have a very similar sum of the log CPO.
<!--l. 424--><p class="indent" >   We got the summary of posterior distribution of the intercept with  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4787"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor4788"><span 
class="aett-10x-x-109">(r.seaD.l</span></span><span id="textcolor4789"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4790"><span 
class="aett-10x-x-109">summary.fixed,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4791"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor4792"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-62">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant&#x00A0;0.5quant&#x00A0;0.975quant&#x00A0;&#x00A0;&#x00A0;&#x00A0;mode&#x00A0;kld
&#x00A0;<br />##&#x00A0;Intercept&#x00A0;&#x00A0;2.4293&#x00A0;0.0943&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2.2473&#x00A0;&#x00A0;&#x00A0;2.4276&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2.6216&#x00A0;&#x00A0;2.4245&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />##&#x00A0;seaDist&#x00A0;&#x00A0;&#x00A0;-0.0016&#x00A0;0.0002&#x00A0;&#x00A0;&#x00A0;&#x00A0;-0.0020&#x00A0;&#x00A0;-0.0015&#x00A0;&#x00A0;&#x00A0;&#x00A0;-0.0011&#x00A0;-0.0015&#x00A0;&#x00A0;&#x00A0;0
</div>
<!--l. 434--><p class="nopar" >
</p>
   </div>
<!--l. 438--><p class="indent" >   Summary of the PMD for the gamma likelihood dispersion parameter  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4793"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor4794"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4795"><span 
class="aett-10x-x-109">unlist</span></span><span id="textcolor4796"><span 
class="aett-10x-x-109">(r.seaD.l</span></span><span id="textcolor4797"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4798"><span 
class="aett-10x-x-109">summary.hy[</span></span><span id="textcolor4799"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4800"><span 
class="aett-10x-x-109">,]),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4801"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor4802"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-63">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant&#x00A0;&#x00A0;&#x00A0;0.5quant&#x00A0;0.975quant&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mode
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;14.8825&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.4495&#x00A0;&#x00A0;&#x00A0;&#x00A0;12.1855&#x00A0;&#x00A0;&#x00A0;&#x00A0;14.8332&#x00A0;&#x00A0;&#x00A0;&#x00A0;17.8772&#x00A0;&#x00A0;&#x00A0;&#x00A0;14.7595
</div>
<!--l. 447--><p class="nopar" >
</p>
   </div>
<!--l. 451--><p class="indent" >   The summary for the practical range and the standard deviation of the spatial process is
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4803"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor4804"><span 
class="aett-10x-x-109">(r.seaD.l</span></span><span id="textcolor4805"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4806"><span 
class="aett-10x-x-109">summary.hyper[</span></span><span id="textcolor4807"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor4808"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4809"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4810"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor4811"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-64">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant&#x00A0;0.5quant&#x00A0;0.975quant&#x00A0;&#x00A0;&#x00A0;mode
&#x00A0;<br />##&#x00A0;Range&#x00A0;for&#x00A0;s&#x00A0;0.6695&#x00A0;0.1437&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.4413&#x00A0;&#x00A0;&#x00A0;0.6508&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.0025&#x00A0;0.6132
&#x00A0;<br />##&#x00A0;Stdev&#x00A0;for&#x00A0;s&#x00A0;0.2336&#x00A0;0.0220&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.1932&#x00A0;&#x00A0;&#x00A0;0.2327&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.2796&#x00A0;0.2309
</div>
<!--l. 462--><p class="nopar" >
</p>
   </div>
<!--l. 466--><p class="indent" >   The posterior marginal distribution for <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub>, the practical range (in degrees), the standard
deviation for the spatial random field,
</p><!--l. 470--><p class="indent" >   mean and 95% credibility interval of the distance to sea effect at Figure&#x00A0;<a 
href="#x6-410002.1.2">2.1.2<!--tex4ht:ref: fig:dseaeff --></a>. We choose
<span 
class="cmr-10x-x-109">1</span><span 
class="cmmi-10x-x-109">&#x2215;&#x03BA; </span>instead <span 
class="cmmi-10x-x-109">&#x03BA; </span>because <span 
class="cmr-10x-x-109">1</span><span 
class="cmmi-10x-x-109">&#x2215;&#x03BA; </span>is the range parameter and in this case is expressed in degrees units.
Figure&#x00A0;<a 
href="#x6-410002.1.2">2.1.2<!--tex4ht:ref: fig:dseaeff --></a> we look  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4812"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor4813"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4814"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor4815"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4816"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4817"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4818"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor4819"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4820"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor4821"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4822"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor4823"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4824"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4825"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4826"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor4827"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4828"><span 
class="aett-10x-x-109">3.5</span></span><span id="textcolor4829"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4830"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor4831"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4832"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor4833"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4834"><span 
class="aett-10x-x-109">mgp</span></span><span id="textcolor4835"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4836"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4837"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4838"><span 
class="aett-10x-x-109">1.5</span></span><span id="textcolor4839"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4840"><span 
class="aett-10x-x-109">.5</span></span><span id="textcolor4841"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4842"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor4843"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4844"><span 
class="aett-10x-x-109">las</span></span><span id="textcolor4845"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4846"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor4847"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor4848"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor4849"><span 
class="aett-10x-x-109">(r.seaD.l</span></span><span id="textcolor4850"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4851"><span 
class="aett-10x-x-109">marginals.fix[[</span></span><span id="textcolor4852"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4853"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4854"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor4855"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4856"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor4857"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4858"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor4859"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4860"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Intercept</span><span 
class="tctt-1095">'</span></span><span id="textcolor4861"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4862"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor4863"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4864"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Density</span><span 
class="tctt-1095">'</span></span><span id="textcolor4865"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor4866"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor4867"><span 
class="aett-10x-x-109">(r.seaD.l</span></span><span id="textcolor4868"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4869"><span 
class="aett-10x-x-109">marginals.fix[[</span></span><span id="textcolor4870"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor4871"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4872"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor4873"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4874"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor4875"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4876"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor4877"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4878"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Sea</span><span 
class="aett-10x-x-109">&#x00A0;distance</span><span 
class="aett-10x-x-109">&#x00A0;coefficient</span><span 
class="tctt-1095">'</span></span><span id="textcolor4879"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4880"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor4881"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4882"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Density</span><span 
class="tctt-1095">'</span></span><span id="textcolor4883"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor4884"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor4885"><span 
class="aett-10x-x-109">(r.seaD</span></span><span id="textcolor4886"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4887"><span 
class="aett-10x-x-109">summary.random[[</span></span><span id="textcolor4888"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4889"><span 
class="aett-10x-x-109">]][,</span></span><span id="textcolor4890"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4891"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor4892"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor4893"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4894"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor4895"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4896"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor4897"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4898"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor4899"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4900"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Distance</span><span 
class="aett-10x-x-109">&#x00A0;to</span><span 
class="aett-10x-x-109">&#x00A0;sea</span><span 
class="aett-10x-x-109">&#x00A0;(Km)</span><span 
class="tctt-1095">'</span></span><span id="textcolor4901"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4902"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor4903"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4904"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Effect</span><span 
class="tctt-1095">'</span></span><span id="textcolor4905"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor4906"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor4907"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4908"><span 
class="aett-10x-x-109">h</span></span><span id="textcolor4909"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4910"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor4911"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4912"><span 
class="aett-10x-x-109">lty</span></span><span id="textcolor4913"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4914"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor4915"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor4916"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4917"><span 
class="aett-10x-x-109">(i</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4918"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4919"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4920"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4921"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor4922"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4923"><span 
class="aett-10x-x-109">6</span></span><span id="textcolor4924"><span 
class="aett-10x-x-109">))</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4925"><span 
class="aett-10x-x-109">lines</span></span><span id="textcolor4926"><span 
class="aett-10x-x-109">(r.seaD</span></span><span id="textcolor4927"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4928"><span 
class="aett-10x-x-109">summary.random[[</span></span><span id="textcolor4929"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4930"><span 
class="aett-10x-x-109">]][,</span></span><span id="textcolor4931"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4932"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4933"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4934"><span 
class="aett-10x-x-109">,i)],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4935"><span 
class="aett-10x-x-109">lty</span></span><span id="textcolor4936"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4937"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor4938"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor4939"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor4940"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4941"><span 
class="aett-10x-x-109">h</span></span><span id="textcolor4942"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4943"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor4944"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor4945"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4946"><span 
class="aett-10x-x-109">(j</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4947"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4948"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4949"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor4950"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor4951"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor4952"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor4953"><span 
class="aett-10x-x-109">(r.seaD.l</span></span><span id="textcolor4954"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4955"><span 
class="aett-10x-x-109">marginals.hy[[j]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4956"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor4957"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4958"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor4959"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4960"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor4961"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4962"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Density</span><span 
class="tctt-1095">'</span></span><span id="textcolor4963"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4964"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor4965"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4966"><span 
class="aett-10x-x-109">names</span></span><span id="textcolor4967"><span 
class="aett-10x-x-109">(r.seaD.l</span></span><span id="textcolor4968"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor4969"><span 
class="aett-10x-x-109">marginals.hy)[j])</span></span>
</div>
</div>
   </div>
<hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x6-410013"></a>
                                                                                 
                                                                                 
<!--l. 500--><p class="noindent" ><img 
src="spde-tutorial37x.png" alt="PIC" class="graphics" width="426" height="227"  /><!--tex4ht:graphics  
name="spde-tutorial37x.png" src="figs/rainseacoefsv-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;2.3: </span><span  
class="content">PMD for <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub>  (top left), PMD for the distance to sea coefficient (top mid),
posterior mean (continuous line) and 95% credibility interval (dashed lines) for the distance
to sea effect (top right), PMD for the Gamma likelihood precision (bottom left), PMD for
the practical range (bottom mid) and PMD for the standard deviation of the spatial field
(bottom right).</span></div><!--tex4ht:label?: x6-410013 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 512--><p class="indent" >   Suppose that we want to test the significance of the spatial random effect component on the
model. To access the significance of this effect, we can fit the model without the spatial effect
and compare the sum of the log CPO with the model including the spatial effect.
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4970"><span 
class="aett-10x-x-109">r0.seaD.l</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4971"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4972"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor4973"><span 
class="aett-10x-x-109">(y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4974"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4975"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4976"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4977"><span 
class="aett-10x-x-109">Intercept</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4978"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4979"><span 
class="aett-10x-x-109">seaDist,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4980"><span 
class="aett-10x-x-109">family</span></span><span id="textcolor4981"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4982"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Gamma</span><span 
class="tctt-1095">'</span></span><span id="textcolor4983"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4984"><span 
class="aett-10x-x-109">control.compute</span></span><span id="textcolor4985"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4986"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor4987"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4988"><span 
class="aett-10x-x-109">cpo</span></span><span id="textcolor4989"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4990"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor4991"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4992"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor4993"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4994"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor4995"><span 
class="aett-10x-x-109">(stk.dat),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4996"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor4997"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4998"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor4999"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5000"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor5001"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5002"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor5003"><span 
class="aett-10x-x-109">(stk.dat),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5004"><span 
class="aett-10x-x-109">link</span></span><span id="textcolor5005"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5006"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5007"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
And we can compare minus the log CPO sum  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5008"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor5009"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5010"><span 
class="aett-10x-x-109">seaD.l</span></span><span id="textcolor5011"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5012"><span 
class="aett-10x-x-109">slcpo</span></span><span id="textcolor5013"><span 
class="aett-10x-x-109">(r.seaD.l),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5014"><span 
class="aett-10x-x-109">seaD.l0</span></span><span id="textcolor5015"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5016"><span 
class="aett-10x-x-109">slcpo</span></span><span id="textcolor5017"><span 
class="aett-10x-x-109">(r0.seaD.l))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-65">
##&#x00A0;&#x00A0;&#x00A0;seaD.l&#x00A0;&#x00A0;seaD.l0
&#x00A0;<br />##&#x00A0;1273.838&#x00A0;1371.288
</div>
<!--l. 537--><p class="nopar" >
</p>
   </div>
and conclude that the spatial effect is useful.
   <h4 class="subsectionHead"><span class="titlemark">2.1.3   </span> <a 
 id="x6-420002.1.3"></a>Prediction of the random field</h4>
<!--l. 544--><p class="noindent" >We can visualize the spatial effect projecting it on a grid. We want to have a regular grid where
each pixel is a square with near 4 kilometers each side. We will use the (4/111) factor because
each degree has aproximately 111 kilometers to give the size of the pixels in degrees
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5018"><span 
class="aett-10x-x-109">(stepsize</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5019"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5020"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor5021"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor5022"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5023"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor5024"><span 
class="aett-10x-x-109">111</span></span><span id="textcolor5025"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-66">
##&#x00A0;[1]&#x00A0;0.03603604
</div>
<!--l. 557--><p class="nopar" >
</p>
   </div>
<!--l. 561--><p class="indent" >   The Paraná state shape is wider than height and we will use it to define the grid. We
consider the range along each axis and consider the size of the pixels to define the number of
pixels in each direction. We will divide the range along each axis by the of each coordinate and
roun it  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5026"><span 
class="aett-10x-x-109">(nxy</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5027"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5028"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor5029"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5030"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor5031"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5032"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor5033"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5034"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor5035"><span 
class="aett-10x-x-109">(PRborder[,</span></span><span id="textcolor5036"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5037"><span 
class="aett-10x-x-109">])),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5038"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor5039"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5040"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor5041"><span 
class="aett-10x-x-109">(PRborder[,</span></span><span id="textcolor5042"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor5043"><span 
class="aett-10x-x-109">])))</span></span><span id="textcolor5044"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor5045"><span 
class="aett-10x-x-109">stepsize))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-67">
##&#x00A0;[1]&#x00A0;183&#x00A0;117
</div>
<!--l. 576--><p class="nopar" >
</p>
   </div>
<!--l. 580--><p class="indent" >   The <span 
class="aett-10x-x-109">inla.mesh.projector() </span>create a projector matrix. If a set of coordinates is not
supplied it will create a grid automatically. We will change the limits and dimensions as desired
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5046"><span 
class="aett-10x-x-109">projgrid</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5047"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5048"><span 
class="aett-10x-x-109">inla.mesh.projector</span></span><span id="textcolor5049"><span 
class="aett-10x-x-109">(mesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5050"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor5051"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5052"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor5053"><span 
class="aett-10x-x-109">(PRborder[,</span></span><span id="textcolor5054"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5055"><span 
class="aett-10x-x-109">]),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5056"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor5057"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5058"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor5059"><span 
class="aett-10x-x-109">(PRborder[,</span></span><span id="textcolor5060"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor5061"><span 
class="aett-10x-x-109">]),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5062"><span 
class="aett-10x-x-109">dims</span></span><span id="textcolor5063"><span 
class="aett-10x-x-109">=nxy)</span></span>
</div>
</div>
   </div>
Them we can use it in the <span 
class="aett-10x-x-109">inla.mesh.project() </span>function to do the projection for both the
posterior mean and the posterior standard deviation  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5064"><span 
class="aett-10x-x-109">xmean</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5065"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5066"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor5067"><span 
class="aett-10x-x-109">(projgrid,</span><span 
class="aett-10x-x-109">&#x00A0;r.seaD</span></span><span id="textcolor5068"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5069"><span 
class="aett-10x-x-109">summary.random</span></span><span id="textcolor5070"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5071"><span 
class="aett-10x-x-109">s</span></span><span id="textcolor5072"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5073"><span 
class="aett-10x-x-109">mean)</span></span>
<br /><span id="textcolor5074"><span 
class="aett-10x-x-109">xsd</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5075"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5076"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor5077"><span 
class="aett-10x-x-109">(projgrid,</span><span 
class="aett-10x-x-109">&#x00A0;r.seaD</span></span><span id="textcolor5078"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5079"><span 
class="aett-10x-x-109">summary.random</span></span><span id="textcolor5080"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5081"><span 
class="aett-10x-x-109">s</span></span><span id="textcolor5082"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5083"><span 
class="aett-10x-x-109">sd)</span></span>
</div>
</div>
   </div>
<!--l. 604--><p class="indent" >   To improve the visualization we will assign NA for the pixels falling outside the
Paraná state border. We use the function <span 
class="aett-10x-x-109">inout() </span>from the <span 
class="aeb10-x-x-109">splancs </span>package to do that
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5084"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor5085"><span 
class="aett-10x-x-109">(splancs)</span></span>
<br /><span id="textcolor5086"><span 
class="aett-10x-x-109">table</span></span><span id="textcolor5087"><span 
class="aett-10x-x-109">(xy.in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5088"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5089"><span 
class="aett-10x-x-109">inout</span></span><span id="textcolor5090"><span 
class="aett-10x-x-109">(projgrid</span></span><span id="textcolor5091"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5092"><span 
class="aett-10x-x-109">lattice</span></span><span id="textcolor5093"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5094"><span 
class="aett-10x-x-109">loc,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5095"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor5096"><span 
class="aett-10x-x-109">(PRborder[,</span></span><span id="textcolor5097"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5098"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;PRborder[,</span></span><span id="textcolor5099"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor5100"><span 
class="aett-10x-x-109">])))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-68">
##
&#x00A0;<br />##&#x00A0;FALSE&#x00A0;&#x00A0;TRUE
&#x00A0;<br />##&#x00A0;&#x00A0;7865&#x00A0;13546
</div>
<!--l. 619--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor5101"><span 
class="aett-10x-x-109">xmean[</span></span><span id="textcolor5102"><span 
class="aett-10x-x-109">!</span></span><span id="textcolor5103"><span 
class="aett-10x-x-109">xy.in]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5104"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5105"><span 
class="aett-10x-x-109">xsd[</span></span><span id="textcolor5106"><span 
class="aett-10x-x-109">!</span></span><span id="textcolor5107"><span 
class="aett-10x-x-109">xy.in]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5108"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5109"><span 
class="aett-10x-x-109">NA</span></span>
</div>
</div>
   </div>
<!--l. 626--><p class="indent" >   The posterior mean and posterior standard deviation for the spatial effect at each pixel is
visualized in Figure&#x00A0;<a 
href="#x6-440002.1.4">2.1.4<!--tex4ht:ref: fig:xrain1 --></a>. In the top left of this figure one can see that the posterior mean varies
from -0.6 to 0.4. This is the variation after accounting for the distance to sea effect.
When comparing it with the standard deviation image, it seems to be considerable as
the standard deviations aries around 0.2. The variation in the standard deviation is
mainly due to the density of the stations over the region. At the top right plot in
Figure&#x00A0;<a 
href="#x6-440002.1.4">2.1.4<!--tex4ht:ref: fig:xrain1 --></a> the first green region from right to left is near the captital city of Curitiba
where the number of stations around is relatively bigger than in other regions of the
state.
</p><!--l. 644--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1.4   </span> <a 
 id="x6-430002.1.4"></a>Prediction of the response on a grid</h4>
<!--l. 646--><p class="noindent" >When the objective is to to predict the response a simple approach will be to add the other
terms to the spatial field projected in the previous Subsection and apply the inverse of the link
function. A full Bayesian analysis for this problem is the joint prediction with the estimation
process. However, it can be computationally expensive when the number of pixeis in
the grid is large. At the end of this subsection we show a cheap way for a specific
case.
</p><!--l. 657--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><a 
 id="x6-440002.1.4"></a>By computation of the posterior distributions</h5>
<!--l. 659--><p class="noindent" >Considering the grid from the previous subsection we can avoid to compute the posterior
marginal distributions at those pixels that are not inside the Paraná border. That is we consider
the corresponding lines of the projector matrix from the projector object built earlier
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5110"><span 
class="aett-10x-x-109">Aprd</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5111"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5112"><span 
class="aett-10x-x-109">projgrid</span></span><span id="textcolor5113"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5114"><span 
class="aett-10x-x-109">proj</span></span><span id="textcolor5115"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5116"><span 
class="aett-10x-x-109">A[</span></span><span id="textcolor5117"><span 
class="aett-10x-x-109">which</span></span><span id="textcolor5118"><span 
class="aett-10x-x-109">(xy.in),</span><span 
class="aett-10x-x-109">&#x00A0;]</span></span>
                                                                                 
                                                                                 
</div>
</div>
   </div>
<!--l. 673--><p class="indent" >   We need to have the covariate for every pixel. In order to have it we can extract these
coordinates from the projector object as well  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5119"><span 
class="aett-10x-x-109">prdcoo</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5120"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5121"><span 
class="aett-10x-x-109">projgrid</span></span><span id="textcolor5122"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5123"><span 
class="aett-10x-x-109">lattice</span></span><span id="textcolor5124"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5125"><span 
class="aett-10x-x-109">loc[</span></span><span id="textcolor5126"><span 
class="aett-10x-x-109">which</span></span><span id="textcolor5127"><span 
class="aett-10x-x-109">(xy.in),]</span></span>
</div>
</div>
   </div>
<!--l. 684--><p class="indent" >   Computing the distance to sea for each selected pixel  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5128"><span 
class="aett-10x-x-109">seaDist0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5129"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5130"><span 
class="aett-10x-x-109">apply</span></span><span id="textcolor5131"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5132"><span 
class="aett-10x-x-109">spDists</span></span><span id="textcolor5133"><span 
class="aett-10x-x-109">(PRborder[</span></span><span id="textcolor5134"><span 
class="aett-10x-x-109">1034</span></span><span id="textcolor5135"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor5136"><span 
class="aett-10x-x-109">1078</span></span><span id="textcolor5137"><span 
class="aett-10x-x-109">,],</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5138"><span 
class="aett-10x-x-109">prdcoo,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5139"><span 
class="aett-10x-x-109">longlat</span></span><span id="textcolor5140"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5141"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor5142"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5143"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor5144"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;min)</span></span>
</div>
</div>
   </div>
<!--l. 694--><p class="indent" >   Suppose that our model is the one with the smoothed effect of sea distance. We have to
discretize each computed distance in the same way as for the estimation data at the stations. We
have to collect the knots and order it  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5145"><span 
class="aett-10x-x-109">seaDist.k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5146"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5147"><span 
class="aett-10x-x-109">sort</span></span><span id="textcolor5148"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5149"><span 
class="aett-10x-x-109">unique</span></span><span id="textcolor5150"><span 
class="aett-10x-x-109">(stk.dat</span></span><span id="textcolor5151"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5152"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor5153"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5154"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor5155"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5156"><span 
class="aett-10x-x-109">gSeaDist))</span></span>
</div>
</div>
   </div>
We them have to identify to with knot each distance to sea computed for the pixels belongs to
and assign these knots for each pixel. The knots can are actually the mids of the breaks and we
will consider it as follows  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5157"><span 
class="aett-10x-x-109">seaDist.b</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5158"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5159"><span 
class="aett-10x-x-109">(seaDist.k[</span></span><span id="textcolor5160"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor5161"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5162"><span 
class="aett-10x-x-109">]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5163"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5164"><span 
class="aett-10x-x-109">seaDist.k[</span></span><span id="textcolor5165"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor5166"><span 
class="aett-10x-x-109">(seaDist.k)])</span></span><span id="textcolor5167"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor5168"><span 
class="aett-10x-x-109">2</span></span>
<br /><span id="textcolor5169"><span 
class="aett-10x-x-109">i0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5170"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5171"><span 
class="aett-10x-x-109">findInterval</span></span><span id="textcolor5172"><span 
class="aett-10x-x-109">(seaDist0,</span><span 
class="aett-10x-x-109">&#x00A0;seaDist.b)</span></span><span id="textcolor5173"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor5174"><span 
class="aett-10x-x-109">1</span></span>
<br /><span id="textcolor5175"><span 
class="aett-10x-x-109">gSeaDist0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5176"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5177"><span 
class="aett-10x-x-109">seaDist.k[i0]</span></span>
                                                                                 
                                                                                 
</div>
</div>
   </div>
<!--l. 722--><p class="indent" >   Building the stack data with the prediction scenario and joining it with the data with the
data for estimation  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5178"><span 
class="aett-10x-x-109">stk.prd</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5179"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5180"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor5181"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5182"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor5183"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5184"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5185"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5186"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor5187"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5188"><span 
class="aett-10x-x-109">NA</span></span><span id="textcolor5189"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5190"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor5191"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5192"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5193"><span 
class="aett-10x-x-109">(Aprd,</span></span><span id="textcolor5194"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5195"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5196"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor5197"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5198"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5199"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5200"><span 
class="aett-10x-x-109">s</span></span><span id="textcolor5201"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5202"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5203"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor5204"><span 
class="aett-10x-x-109">spde</span></span><span id="textcolor5205"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5206"><span 
class="aett-10x-x-109">n.spde,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5207"><span 
class="aett-10x-x-109">data.frame</span></span><span id="textcolor5208"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5209"><span 
class="aett-10x-x-109">Intercept</span></span><span id="textcolor5210"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5211"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5212"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5213"><span 
class="aett-10x-x-109">seaDist</span></span><span id="textcolor5214"><span 
class="aett-10x-x-109">=seaDist0)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5215"><span 
class="aett-10x-x-109">tag</span></span><span id="textcolor5216"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5217"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">prd</span><span 
class="tctt-1095">'</span></span><span id="textcolor5218"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor5219"><span 
class="aett-10x-x-109">stk.all</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5220"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5221"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor5222"><span 
class="aett-10x-x-109">(stk.dat,</span><span 
class="aett-10x-x-109">&#x00A0;stk.prd)</span></span>
</div>
</div>
   </div>
<!--l. 738--><p class="indent" >   We can now use the mode of theta found as known values in the new <span 
class="aett-10x-x-109">inla() </span>call. We can
also avoid computing things not needed such as quantiles. We can also avoid non needed
objects to be returned, such as the marginals distributions for the random effects and
predictor. Since the number of latent variables is the main issue in this case, the Gaussian
approximation will reduce a lot the computation time. It can be considered using
<span 
class="aett-10x-x-109">control.inla=list(strategy=&#8217;gaussian&#8217;</span>.
</p>
   <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5223"><span 
class="aett-10x-x-109">r2.seaD.l</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5224"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5225"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor5226"><span 
class="aett-10x-x-109">(f.seaD.l,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5227"><span 
class="aett-10x-x-109">family</span></span><span id="textcolor5228"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5229"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Gamma</span><span 
class="tctt-1095">'</span></span><span id="textcolor5230"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5231"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor5232"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5233"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor5234"><span 
class="aett-10x-x-109">(stk.all),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5235"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor5236"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5237"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5238"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5239"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor5240"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5241"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor5242"><span 
class="aett-10x-x-109">(stk.all),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5243"><span 
class="aett-10x-x-109">compute</span></span><span id="textcolor5244"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5245"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor5246"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5247"><span 
class="aett-10x-x-109">link</span></span><span id="textcolor5248"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5249"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5250"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5251"><span 
class="aett-10x-x-109">quantiles</span></span><span id="textcolor5252"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5253"><span 
class="aett-10x-x-109">NULL</span></span><span id="textcolor5254"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5255"><span 
class="aett-10x-x-109">control.inla</span></span><span id="textcolor5256"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5257"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5258"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5259"><span 
class="aett-10x-x-109">strategy</span></span><span id="textcolor5260"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5261"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">gaussian</span><span 
class="tctt-1095">'</span></span><span id="textcolor5262"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5263"><span 
class="aett-10x-x-109">control.results</span></span><span id="textcolor5264"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5265"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5266"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5267"><span 
class="aett-10x-x-109">return.marginals.random</span></span><span id="textcolor5268"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5269"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor5270"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5271"><span 
class="aett-10x-x-109">return.marginals.predictor</span></span><span id="textcolor5272"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5273"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor5274"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5275"><span 
class="aett-10x-x-109">control.mode</span></span><span id="textcolor5276"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5277"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5278"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5279"><span 
class="aett-10x-x-109">theta</span></span><span id="textcolor5280"><span 
class="aett-10x-x-109">=r.seaD.l</span></span><span id="textcolor5281"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5282"><span 
class="aett-10x-x-109">mode</span></span><span id="textcolor5283"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5284"><span 
class="aett-10x-x-109">theta,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5285"><span 
class="aett-10x-x-109">restart</span></span><span id="textcolor5286"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5287"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor5288"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
<!--l. 767--><p class="indent" >   We have to find the index for the predictions in the grid. It can be done using the
<span 
class="aett-10x-x-109">inla.stack.index() </span>function. We also have to assign it into the right positions of a matrix
with the same dimension as the grid. We will do it for both, the posterior predicted mean and its
standard deviation  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
                                                                                 
                                                                                 
<div class="obeylines-v">
<span id="textcolor5289"><span 
class="aett-10x-x-109">id.prd</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5290"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5291"><span 
class="aett-10x-x-109">inla.stack.index</span></span><span id="textcolor5292"><span 
class="aett-10x-x-109">(stk.all,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5293"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">prd</span><span 
class="tctt-1095">'</span></span><span id="textcolor5294"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor5295"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5296"><span 
class="aett-10x-x-109">data</span></span>
<br /><span id="textcolor5297"><span 
class="aett-10x-x-109">sd.prd</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5298"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5299"><span 
class="aett-10x-x-109">m.prd</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5300"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5301"><span 
class="aett-10x-x-109">matrix</span></span><span id="textcolor5302"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5303"><span 
class="aett-10x-x-109">NA</span></span><span id="textcolor5304"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;nxy[</span></span><span id="textcolor5305"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5306"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;nxy[</span></span><span id="textcolor5307"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor5308"><span 
class="aett-10x-x-109">])</span></span>
<br /><span id="textcolor5309"><span 
class="aett-10x-x-109">m.prd[xy.in]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5310"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5311"><span 
class="aett-10x-x-109">r2.seaD.l</span></span><span id="textcolor5312"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5313"><span 
class="aett-10x-x-109">summary.fitted.values</span></span><span id="textcolor5314"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5315"><span 
class="aett-10x-x-109">mean[id.prd]</span></span>
<br /><span id="textcolor5316"><span 
class="aett-10x-x-109">sd.prd[xy.in]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5317"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5318"><span 
class="aett-10x-x-109">r2.seaD.l</span></span><span id="textcolor5319"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5320"><span 
class="aett-10x-x-109">summary.fitted.values</span></span><span id="textcolor5321"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5322"><span 
class="aett-10x-x-109">sd[id.prd]</span></span>
</div>
</div>
   </div>
This result is shown in the botton plot of Figure&#x00A0;<a 
href="#x6-440002.1.4">2.1.4<!--tex4ht:ref: fig:xrain1 --></a> with the following commands
<div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5323"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor5324"><span 
class="aett-10x-x-109">(gridExtra)</span></span>
<br /><span id="textcolor5325"><span 
class="aett-10x-x-109">do.call</span></span><span id="textcolor5326"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5327"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">grid.arrange</span><span 
class="tctt-1095">'</span></span><span id="textcolor5328"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5329"><span 
class="aett-10x-x-109">lapply</span></span><span id="textcolor5330"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5331"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5332"><span 
class="aett-10x-x-109">(xmean,</span><span 
class="aett-10x-x-109">&#x00A0;xsd,</span><span 
class="aett-10x-x-109">&#x00A0;m.prd,</span><span 
class="aett-10x-x-109">&#x00A0;sd.prd),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5333"><span 
class="aett-10x-x-109">levelplot,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5334"><span 
class="aett-10x-x-109">col.regions</span></span><span id="textcolor5335"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5336"><span 
class="aett-10x-x-109">terrain.colors</span></span><span id="textcolor5337"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5338"><span 
class="aett-10x-x-109">16</span></span><span id="textcolor5339"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5340"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor5341"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5342"><span 
class="tctt-1095">''</span></span><span id="textcolor5343"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5344"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor5345"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5346"><span 
class="tctt-1095">''</span></span><span id="textcolor5347"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5348"><span 
class="aett-10x-x-109">scales</span></span><span id="textcolor5349"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5350"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5351"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5352"><span 
class="aett-10x-x-109">draw</span></span><span id="textcolor5353"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5354"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor5355"><span 
class="aett-10x-x-109">)))</span></span>
</div>
</div>
   </div>
<hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x6-440014"></a>
                                                                                 
                                                                                 
<!--l. 800--><p class="noindent" ><img 
src="spde-tutorial38x.png" alt="PIC" class="graphics" width="426" height="298"  /><!--tex4ht:graphics  
name="spde-tutorial38x.png" src="figs/rainxrain1-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;2.4: </span><span  
class="content">Posterior mean and standard deviation of the random field (top left and top
right, respectively). Posterior mean and standard deviation for the response (bottom left
and bottom right, respectively).</span></div><!--tex4ht:label?: x6-440014 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 809--><p class="indent" >   The posterior mean for the expected ranifall in January 2011 was higher near the sea and
lower n the north west side of the Paraná state. Since the linear effect from the distance to sea
will drive this pattern, the spatial effect in this case is there to fit deviations from this pattern.
That is, the spatial effect is higher near the sea and summing up with the higher
effect from distance to sea fitted the higher observed values there. The spatial effect is
also higher in a region of the west side causing the expected values to be not so low
there.
</p>
   <h5 class="subsubsectionHead"><a 
 id="x6-450002.1.4"></a>Sampling at mesh nodes and interpolating</h5>
<!--l. 825--><p class="noindent" >When all the covariates are smooth over space, it makes sence to make the predictions at the
mesh nodes, where we have the spatial effect, and them project it on the grid. However, as long
a covariate is not smooth over space this approach no longer makes sence. The advantage of this
approach is that it is computationally cheap than to compute the full posterior marginals like in
the previous subsection.
</p><!--l. 835--><p class="indent" >   In our example the idea is to compute the distance to sea effect at the mesh nodes. Them,
compute the linear predictor at the mesh nodes. By that, it is possible to predict the response at
the mesh nodes and them do interpolate it.
</p><!--l. 841--><p class="indent" >   The first step is to have the enviromental covariate at the mesh nodes  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5356"><span 
class="aett-10x-x-109">seaDist.mesh</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5357"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5358"><span 
class="aett-10x-x-109">apply</span></span><span id="textcolor5359"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5360"><span 
class="aett-10x-x-109">spDists</span></span><span id="textcolor5361"><span 
class="aett-10x-x-109">(PRborder[</span></span><span id="textcolor5362"><span 
class="aett-10x-x-109">1034</span></span><span id="textcolor5363"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor5364"><span 
class="aett-10x-x-109">1078</span></span><span id="textcolor5365"><span 
class="aett-10x-x-109">,],</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5366"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor5367"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5368"><span 
class="aett-10x-x-109">loc[,</span></span><span id="textcolor5369"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5370"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor5371"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor5372"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5373"><span 
class="aett-10x-x-109">longlat</span></span><span id="textcolor5374"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5375"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor5376"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5377"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor5378"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;min)</span></span>
</div>
</div>
   </div>
<!--l. 853--><p class="indent" >   It consists in geting samples from the linear predictor at the mesh nodes. Them, interpolate
it to grid and compute the expected value, in the response scale by applying the inverse link.
When we do it for each sample, we can have any functional, for example, the mean and standard
error.
</p><!--l. 860--><p class="indent" >   Building the stack for predict into the mesh  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5379"><span 
class="aett-10x-x-109">stk.mesh</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5380"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5381"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor5382"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5383"><span 
class="aett-10x-x-109">tag</span></span><span id="textcolor5384"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5385"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">mesh</span><span 
class="tctt-1095">'</span></span><span id="textcolor5386"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5387"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor5388"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5389"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5390"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5391"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor5392"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5393"><span 
class="aett-10x-x-109">NA</span></span><span id="textcolor5394"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5395"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor5396"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5397"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5398"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5399"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5400"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor5401"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5402"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5403"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor5404"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5405"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5406"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5407"><span 
class="aett-10x-x-109">s</span></span><span id="textcolor5408"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5409"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5410"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor5411"><span 
class="aett-10x-x-109">spde</span></span><span id="textcolor5412"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5413"><span 
class="aett-10x-x-109">n.spde,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5414"><span 
class="aett-10x-x-109">data.frame</span></span><span id="textcolor5415"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5416"><span 
class="aett-10x-x-109">Intercept</span></span><span id="textcolor5417"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5418"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5419"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5420"><span 
class="aett-10x-x-109">seaDist</span></span><span id="textcolor5421"><span 
class="aett-10x-x-109">=seaDist.mesh)))</span></span>
<br /><span id="textcolor5422"><span 
class="aett-10x-x-109">stk.b</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5423"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5424"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor5425"><span 
class="aett-10x-x-109">(stk.dat,</span><span 
class="aett-10x-x-109">&#x00A0;stk.mesh)</span></span>
</div>
</div>
   </div>
                                                                                 
                                                                                 
<!--l. 873--><p class="indent" >   Fitting the model again and asking for the configuration, which will include in the output
the precision matrix for each hyperparameter configuration needed for sampling from the joint
posterior  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5426"><span 
class="aett-10x-x-109">rm.seaD.l</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5427"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5428"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor5429"><span 
class="aett-10x-x-109">(f.seaD.l,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5430"><span 
class="aett-10x-x-109">family</span></span><span id="textcolor5431"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5432"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Gamma</span><span 
class="tctt-1095">'</span></span><span id="textcolor5433"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5434"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor5435"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5436"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor5437"><span 
class="aett-10x-x-109">(stk.b),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5438"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor5439"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5440"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5441"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5442"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor5443"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5444"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor5445"><span 
class="aett-10x-x-109">(stk.b),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5446"><span 
class="aett-10x-x-109">compute</span></span><span id="textcolor5447"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5448"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor5449"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5450"><span 
class="aett-10x-x-109">link</span></span><span id="textcolor5451"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5452"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5453"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5454"><span 
class="aett-10x-x-109">quantiles</span></span><span id="textcolor5455"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5456"><span 
class="aett-10x-x-109">NULL</span></span><span id="textcolor5457"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5458"><span 
class="aett-10x-x-109">control.results</span></span><span id="textcolor5459"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5460"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5461"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5462"><span 
class="aett-10x-x-109">return.marginals.random</span></span><span id="textcolor5463"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5464"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor5465"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5466"><span 
class="aett-10x-x-109">return.marginals.predictor</span></span><span id="textcolor5467"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5468"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor5469"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5470"><span 
class="aett-10x-x-109">control.compute</span></span><span id="textcolor5471"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5472"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5473"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5474"><span 
class="aett-10x-x-109">config</span></span><span id="textcolor5475"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5476"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor5477"><span 
class="aett-10x-x-109">))</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5478"><span 
class="aeitt-10x-x-109">##</span><span 
class="aeitt-10x-x-109">&#x00A0;need</span><span 
class="aeitt-10x-x-109">&#x00A0;to</span><span 
class="aeitt-10x-x-109">&#x00A0;sample</span></span>
</div>
</div>
   </div>
<!--l. 893--><p class="indent" >   Sampling from the model  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5479"><span 
class="aett-10x-x-109">sampl</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5480"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5481"><span 
class="aett-10x-x-109">inla.posterior.sample</span></span><span id="textcolor5482"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5483"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor5484"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5485"><span 
class="aett-10x-x-109">1000</span></span><span id="textcolor5486"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5487"><span 
class="aett-10x-x-109">result</span></span><span id="textcolor5488"><span 
class="aett-10x-x-109">=rm.seaD.l)</span></span>
</div>
</div>
   </div>
<!--l. 902--><p class="indent" >   The first <span 
class="cmmi-10x-x-109">n </span>elements of the latent field are the linear predictor for the observed data and the
next <span 
class="cmmi-10x-x-109">m </span>elements are for the location at the mesh nodes.  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5489"><span 
class="aett-10x-x-109">dim</span></span><span id="textcolor5490"><span 
class="aett-10x-x-109">(pred.nodes</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5491"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5492"><span 
class="aett-10x-x-109">exp</span></span><span id="textcolor5493"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5494"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor5495"><span 
class="aett-10x-x-109">(sampl,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5496"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor5497"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5498"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor5499"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5500"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor5501"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5502"><span 
class="aett-10x-x-109">latent[</span></span><span id="textcolor5503"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor5504"><span 
class="aett-10x-x-109">(PRprec)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5505"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5506"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5507"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor5508"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor5509"><span 
class="aett-10x-x-109">(mesh</span></span><span id="textcolor5510"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5511"><span 
class="aett-10x-x-109">loc)])))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-69">
##&#x00A0;[1]&#x00A0;&#x00A0;967&#x00A0;1000
</div>
<!--l. 912--><p class="nopar" >
</p>
   </div>
Computing the mean and standard deviation over the samples and projecting it  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5512"><span 
class="aett-10x-x-109">sd.prd.s</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5513"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5514"><span 
class="aett-10x-x-109">m.prd.s</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5515"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5516"><span 
class="aett-10x-x-109">matrix</span></span><span id="textcolor5517"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5518"><span 
class="aett-10x-x-109">NA</span></span><span id="textcolor5519"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;nxy[</span></span><span id="textcolor5520"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5521"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;nxy[</span></span><span id="textcolor5522"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor5523"><span 
class="aett-10x-x-109">])</span></span>
<br /><span id="textcolor5524"><span 
class="aett-10x-x-109">m.prd.s[xy.in]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5525"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5526"><span 
class="aett-10x-x-109">drop</span></span><span id="textcolor5527"><span 
class="aett-10x-x-109">(Aprd</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5528"><span 
class="aett-10x-x-109">%*%</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5529"><span 
class="aett-10x-x-109">rowMeans</span></span><span id="textcolor5530"><span 
class="aett-10x-x-109">(pred.nodes))</span></span>
<br /><span id="textcolor5531"><span 
class="aett-10x-x-109">sd.prd.s[xy.in]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5532"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5533"><span 
class="aett-10x-x-109">drop</span></span><span id="textcolor5534"><span 
class="aett-10x-x-109">(Aprd</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5535"><span 
class="aett-10x-x-109">%*%</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5536"><span 
class="aett-10x-x-109">apply</span></span><span id="textcolor5537"><span 
class="aett-10x-x-109">(pred.nodes,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5538"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5539"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;sd))</span></span>
</div>
</div>
   </div>
and we can see that it is similar to the computed analitically  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5540"><span 
class="aett-10x-x-109">cor</span></span><span id="textcolor5541"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5542"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor5543"><span 
class="aett-10x-x-109">(m.prd.s),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5544"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor5545"><span 
class="aett-10x-x-109">(m.prd),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5546"><span 
class="aett-10x-x-109">use</span></span><span id="textcolor5547"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5548"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">p</span><span 
class="tctt-1095">'</span></span><span id="textcolor5549"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-70">
##&#x00A0;[1]&#x00A0;0.9997923
</div>
<!--l. 933--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor5550"><span 
class="aett-10x-x-109">cor</span></span><span id="textcolor5551"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5552"><span 
class="aett-10x-x-109">log</span></span><span id="textcolor5553"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5554"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor5555"><span 
class="aett-10x-x-109">(sd.prd.s)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5556"><span 
class="aett-10x-x-109">log</span></span><span id="textcolor5557"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5558"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor5559"><span 
class="aett-10x-x-109">(sd.prd)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5560"><span 
class="aett-10x-x-109">use</span></span><span id="textcolor5561"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5562"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">p</span><span 
class="tctt-1095">'</span></span><span id="textcolor5563"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-71">
##&#x00A0;[1]&#x00A0;0.9605723
</div>
<!--l. 939--><p class="nopar" >
</p>
   </div>
   <h3 class="sectionHead"><span class="titlemark">2.2   </span> <a 
 id="x6-460002.2"></a>Survival analysis</h3>
<!--l. 3--><p class="noindent" >This content is part of the book available at <a 
href="http://www.r-inla.org/spde-book" class="url" ><span 
class="aett-10x-x-109">http://www.r-inla.org/spde-book</span></a>, whose
Gitbook version is freely available along all the code and datasets.
</p><!--l. 11--><p class="indent" >   In this chapter we shown how to fit a survival model using a continuous spatial random effect
modeled throught the SPDE approach. We use the data presented in&#x00A0;<span class="cite">[<a 
href="spde-tutorialli2.html#XhendersonSG:2003">Henderson et&#x00A0;al., 2003</a>]</span>.
The original code for the analysis in&#x00A0;<span class="cite">[<a 
href="spde-tutorialli2.html#XlindgrenRL:2011">Lindgren et&#x00A0;al., 2011</a>]</span> is adapted here to use the stack
functionality. In the section&#x00A0;<a 
href="#x6-470002.2.1">2.2.1<!--tex4ht:ref: sec:parsurv --></a> we show how to fit a parametric survival model and in the
section&#x00A0;<a 
href="#x6-480002.2.2">2.2.2<!--tex4ht:ref: sec:coxph --></a> we also show how to fit the semiparametric Cox proportional hazard
model.
</p><!--l. 21--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2.1   </span> <a 
 id="x6-470002.2.1"></a>Parametric survival model</h4>
<!--l. 23--><p class="noindent" >We load the Leukaemia survival data using  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5564"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor5565"><span 
class="aett-10x-x-109">(Leuk)</span></span>
<br /><span id="textcolor5566"><span 
class="aett-10x-x-109">Leuk</span></span><span id="textcolor5567"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5568"><span 
class="aett-10x-x-109">time</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5569"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5570"><span 
class="aett-10x-x-109">Leuk</span></span><span id="textcolor5571"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5572"><span 
class="aett-10x-x-109">time</span></span><span id="textcolor5573"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor5574"><span 
class="aett-10x-x-109">365.25</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5575"><span 
class="aeitt-10x-x-109">##</span><span 
class="aeitt-10x-x-109">&#x00A0;to</span><span 
class="aeitt-10x-x-109">&#x00A0;yearly</span></span>
<br /><span id="textcolor5576"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor5577"><span 
class="aett-10x-x-109">(Leuk,</span><span 
class="aett-10x-x-109">&#x00A0;summary)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-72">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;time&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cens&#x00A0;&#x00A0;&#x00A0;&#x00A0;xcoord&#x00A0;&#x00A0;&#x00A0;&#x00A0;ycoord&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;age&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sex
&#x00A0;<br />##&#x00A0;Min.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.002737851&#x00A0;0.0000000&#x00A0;0.0000000&#x00A0;0.0000000&#x00A0;14.00000&#x00A0;0.0000000
&#x00A0;<br />##&#x00A0;1st&#x00A0;Qu.&#x00A0;&#x00A0;0.112251882&#x00A0;1.0000000&#x00A0;0.2243660&#x00A0;0.1791621&#x00A0;49.00000&#x00A0;0.0000000
&#x00A0;<br />##&#x00A0;Median&#x00A0;&#x00A0;&#x00A0;0.506502396&#x00A0;1.0000000&#x00A0;0.4641676&#x00A0;0.2899669&#x00A0;65.00000&#x00A0;1.0000000
&#x00A0;<br />##&#x00A0;Mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.459240345&#x00A0;0.8427613&#x00A0;0.4043774&#x00A0;0.3565639&#x00A0;60.72579&#x00A0;0.5244487
&#x00A0;<br />##&#x00A0;3rd&#x00A0;Qu.&#x00A0;&#x00A0;1.467488022&#x00A0;1.0000000&#x00A0;0.6014333&#x00A0;0.5259096&#x00A0;74.00000&#x00A0;1.0000000
&#x00A0;<br />##&#x00A0;Max.&#x00A0;&#x00A0;&#x00A0;&#x00A0;13.626283368&#x00A0;1.0000000&#x00A0;0.7739802&#x00A0;1.0000000&#x00A0;92.00000&#x00A0;1.0000000
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;wbc&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tpi&#x00A0;district
&#x00A0;<br />##&#x00A0;Min.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.00000&#x00A0;-6.0900000&#x00A0;&#x00A0;1.00000
&#x00A0;<br />##&#x00A0;1st&#x00A0;Qu.&#x00A0;&#x00A0;&#x00A0;1.80000&#x00A0;-2.7050000&#x00A0;&#x00A0;7.00000
&#x00A0;<br />##&#x00A0;Median&#x00A0;&#x00A0;&#x00A0;&#x00A0;7.90000&#x00A0;-0.3700000&#x00A0;16.00000
&#x00A0;<br />##&#x00A0;Mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;38.59391&#x00A0;&#x00A0;0.3397601&#x00A0;13.79099
&#x00A0;<br />##&#x00A0;3rd&#x00A0;Qu.&#x00A0;&#x00A0;38.65000&#x00A0;&#x00A0;2.9300000&#x00A0;20.00000
&#x00A0;<br />##&#x00A0;Max.&#x00A0;&#x00A0;&#x00A0;&#x00A0;500.00000&#x00A0;&#x00A0;9.5500000&#x00A0;24.00000
</div>
<!--l. 46--><p class="nopar" >
</p>
   </div>
<!--l. 50--><p class="indent" >   The mesh is builded using the following code  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5578"><span 
class="aett-10x-x-109">loc</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5579"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5580"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor5581"><span 
class="aett-10x-x-109">(Leuk</span></span><span id="textcolor5582"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5583"><span 
class="aett-10x-x-109">xcoord,</span><span 
class="aett-10x-x-109">&#x00A0;Leuk</span></span><span id="textcolor5584"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5585"><span 
class="aett-10x-x-109">ycoord)</span></span>
<br /><span id="textcolor5586"><span 
class="aett-10x-x-109">bnd1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5587"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5588"><span 
class="aett-10x-x-109">inla.nonconvex.hull</span></span><span id="textcolor5589"><span 
class="aett-10x-x-109">(loc,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5590"><span 
class="aett-10x-x-109">convex</span></span><span id="textcolor5591"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5592"><span 
class="aett-10x-x-109">0.05</span></span><span id="textcolor5593"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor5594"><span 
class="aett-10x-x-109">bnd2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5595"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5596"><span 
class="aett-10x-x-109">inla.nonconvex.hull</span></span><span id="textcolor5597"><span 
class="aett-10x-x-109">(loc,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5598"><span 
class="aett-10x-x-109">convex</span></span><span id="textcolor5599"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5600"><span 
class="aett-10x-x-109">0.25</span></span><span id="textcolor5601"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor5602"><span 
class="aett-10x-x-109">mesh</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5603"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5604"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor5605"><span 
class="aett-10x-x-109">(loc,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5606"><span 
class="aett-10x-x-109">boundary</span></span><span id="textcolor5607"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5608"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5609"><span 
class="aett-10x-x-109">(bnd1,</span><span 
class="aett-10x-x-109">&#x00A0;bnd2),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5610"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor5611"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5612"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor5613"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5614"><span 
class="aett-10x-x-109">0.05</span></span><span id="textcolor5615"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5616"><span 
class="aett-10x-x-109">0.2</span></span><span id="textcolor5617"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5618"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor5619"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5620"><span 
class="aett-10x-x-109">0.005</span></span><span id="textcolor5621"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<!--l. 63--><p class="indent" >   The projector matrix is obtained with  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5622"><span 
class="aett-10x-x-109">A</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5623"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5624"><span 
class="aett-10x-x-109">inla.spde.make.A</span></span><span id="textcolor5625"><span 
class="aett-10x-x-109">(mesh,</span><span 
class="aett-10x-x-109">&#x00A0;loc)</span></span>
</div>
</div>
   </div>
<!--l. 72--><p class="indent" >   Defining the SPDE model considering the PC-prior derived in <span class="cite">[<a 
href="spde-tutorialli2.html#Xfuglstadetal:2017">Fuglstad et&#x00A0;al., 2017</a>]</span> for the
model parameters as the practical range, <img 
src="spde-tutorial39x.png" alt="&#x221A; ---
  8&#x03BD;"  class="sqrt"  /><span 
class="cmmi-10x-x-109">&#x2215;&#x03BA;</span>, and the marginal standard deviation.
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
                                                                                 
                                                                                 
<div class="obeylines-v">
<span id="textcolor5626"><span 
class="aett-10x-x-109">spde</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5627"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5628"><span 
class="aett-10x-x-109">inla.spde2.pcmatern</span></span><span id="textcolor5629"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5630"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor5631"><span 
class="aett-10x-x-109">=mesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5632"><span 
class="aett-10x-x-109">alpha</span></span><span id="textcolor5633"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5634"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor5635"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5636"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;mesh</span><span 
class="aeitt-10x-x-109">&#x00A0;and</span><span 
class="aeitt-10x-x-109">&#x00A0;smoothness</span><span 
class="aeitt-10x-x-109">&#x00A0;parameter</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5637"><span 
class="aett-10x-x-109">prior.range</span></span><span id="textcolor5638"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5639"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor5640"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5641"><span 
class="aett-10x-x-109">0.05</span></span><span id="textcolor5642"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5643"><span 
class="aett-10x-x-109">0.01</span></span><span id="textcolor5644"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5645"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;P(practic.range&#x003C;0.05)=0.01</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5646"><span 
class="aett-10x-x-109">prior.sigma</span></span><span id="textcolor5647"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5648"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor5649"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5650"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5651"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5652"><span 
class="aett-10x-x-109">0.01</span></span><span id="textcolor5653"><span 
class="aett-10x-x-109">))</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5654"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;P(sigma&#x003E;1)=0.01</span></span>
</div>
</div>
   </div>
<!--l. 87--><p class="indent" >   The model formula, including the intercept, covariates and the SPDE model is
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5655"><span 
class="aett-10x-x-109">formula</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5656"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5657"><span 
class="aett-10x-x-109">inla.surv</span></span><span id="textcolor5658"><span 
class="aett-10x-x-109">(time,</span><span 
class="aett-10x-x-109">&#x00A0;cens)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5659"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5660"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5661"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5662"><span 
class="aett-10x-x-109">a0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5663"><span 
class="aett-10x-x-109">+</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5664"><span 
class="aett-10x-x-109">sex</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5665"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5666"><span 
class="aett-10x-x-109">age</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5667"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5668"><span 
class="aett-10x-x-109">wbc</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5669"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5670"><span 
class="aett-10x-x-109">tpi</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5671"><span 
class="aett-10x-x-109">+</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5672"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor5673"><span 
class="aett-10x-x-109">(spatial,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5674"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor5675"><span 
class="aett-10x-x-109">=spde)</span></span>
</div>
</div>
   </div>
<!--l. 99--><p class="indent" >   The trick for building the data stack is to include all the variables needed to the
formula. So, for the response we have the <span 
class="aett-10x-x-109">time </span>and the censoring pattern <span 
class="aett-10x-x-109">cens</span>. The
spatial stuff, the intercept and the covariates are included like in the other models.
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5676"><span 
class="aett-10x-x-109">stk</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5677"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5678"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor5679"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5680"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor5681"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5682"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5683"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5684"><span 
class="aett-10x-x-109">time</span></span><span id="textcolor5685"><span 
class="aett-10x-x-109">=Leuk</span></span><span id="textcolor5686"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5687"><span 
class="aett-10x-x-109">time,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5688"><span 
class="aett-10x-x-109">cens</span></span><span id="textcolor5689"><span 
class="aett-10x-x-109">=Leuk</span></span><span id="textcolor5690"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5691"><span 
class="aett-10x-x-109">cens),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5692"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor5693"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5694"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5695"><span 
class="aett-10x-x-109">(A,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5696"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5697"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5698"><span 
class="aett-10x-x-109">effect</span></span><span id="textcolor5699"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5700"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5701"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5702"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5703"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5704"><span 
class="aett-10x-x-109">spatial</span></span><span id="textcolor5705"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5706"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5707"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor5708"><span 
class="aett-10x-x-109">spde</span></span><span id="textcolor5709"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5710"><span 
class="aett-10x-x-109">n.spde),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5711"><span 
class="aett-10x-x-109">data.frame</span></span><span id="textcolor5712"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5713"><span 
class="aett-10x-x-109">a0</span></span><span id="textcolor5714"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5715"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5716"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;Leuk[,</span></span><span id="textcolor5717"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor5718"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor5719"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5720"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5721"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor5722"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor5723"><span 
class="aett-10x-x-109">)])))</span></span>
</div>
</div>
   </div>
<!--l. 117--><p class="indent" >   Now, we just had to fit the model. In this example we use the &#8217;weibullsurv&#8217; likelihood.
Hovewer, other parametric likelihoods can be used as well.  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5724"><span 
class="aett-10x-x-109">r</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5725"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5726"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor5727"><span 
class="aett-10x-x-109">(formula,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5728"><span 
class="aett-10x-x-109">family</span></span><span id="textcolor5729"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5730"><span 
class="aett-10x-x-109">"weibullsurv"</span></span><span id="textcolor5731"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5732"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor5733"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5734"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor5735"><span 
class="aett-10x-x-109">(stk),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5736"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor5737"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5738"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5739"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5740"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor5741"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5742"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor5743"><span 
class="aett-10x-x-109">(stk)))</span></span>
                                                                                 
                                                                                 
</div>
</div>
   </div>
<!--l. 129--><p class="indent" >   The intercept and the covariate effects can be extracted with  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5744"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor5745"><span 
class="aett-10x-x-109">(r</span></span><span id="textcolor5746"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5747"><span 
class="aett-10x-x-109">summary.fix,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5748"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor5749"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-73">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant&#x00A0;0.5quant&#x00A0;0.975quant&#x00A0;&#x00A0;&#x00A0;&#x00A0;mode&#x00A0;kld
&#x00A0;<br />##&#x00A0;a0&#x00A0;&#x00A0;-2.1755&#x00A0;0.2025&#x00A0;&#x00A0;&#x00A0;&#x00A0;-2.5719&#x00A0;&#x00A0;-2.1770&#x00A0;&#x00A0;&#x00A0;&#x00A0;-1.7680&#x00A0;-2.1783&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />##&#x00A0;sex&#x00A0;&#x00A0;0.0719&#x00A0;0.0693&#x00A0;&#x00A0;&#x00A0;&#x00A0;-0.0641&#x00A0;&#x00A0;&#x00A0;0.0719&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.2080&#x00A0;&#x00A0;0.0718&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />##&#x00A0;age&#x00A0;&#x00A0;0.0328&#x00A0;0.0022&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.0285&#x00A0;&#x00A0;&#x00A0;0.0328&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.0372&#x00A0;&#x00A0;0.0328&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />##&#x00A0;wbc&#x00A0;&#x00A0;0.0031&#x00A0;0.0005&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.0021&#x00A0;&#x00A0;&#x00A0;0.0031&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.0040&#x00A0;&#x00A0;0.0031&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />##&#x00A0;tpi&#x00A0;&#x00A0;0.0247&#x00A0;0.0099&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.0053&#x00A0;&#x00A0;&#x00A0;0.0247&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.0441&#x00A0;&#x00A0;0.0248&#x00A0;&#x00A0;&#x00A0;0
</div>
<!--l. 142--><p class="nopar" >
</p>
   </div>
and the hyperparameters with  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5750"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor5751"><span 
class="aett-10x-x-109">(r</span></span><span id="textcolor5752"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5753"><span 
class="aett-10x-x-109">summary.hy,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5754"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor5755"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-74">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant&#x00A0;0.5quant&#x00A0;0.975quant
&#x00A0;<br />##&#x00A0;alpha&#x00A0;parameter&#x00A0;for&#x00A0;weibullsurv&#x00A0;0.599&#x00A0;0.016&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.567&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.600&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.631
&#x00A0;<br />##&#x00A0;Range&#x00A0;for&#x00A0;spatial&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.303&#x00A0;0.153&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.111&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.269&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.693
&#x00A0;<br />##&#x00A0;Stdev&#x00A0;for&#x00A0;spatial&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.279&#x00A0;0.071&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.166&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.270&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.444
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mode
&#x00A0;<br />##&#x00A0;alpha&#x00A0;parameter&#x00A0;for&#x00A0;weibullsurv&#x00A0;0.600
&#x00A0;<br />##&#x00A0;Range&#x00A0;for&#x00A0;spatial&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.215
&#x00A0;<br />##&#x00A0;Stdev&#x00A0;for&#x00A0;spatial&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.252
</div>
<!--l. 160--><p class="nopar" >
</p>
   </div>
<!--l. 164--><p class="indent" >   We visualize the spatial effect into the map. The map of the districts is also available into the
INLA package. First, we define a projection from the mesh into a grid  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5756"><span 
class="aett-10x-x-109">r0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5757"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5758"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor5759"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5760"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor5761"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5762"><span 
class="aett-10x-x-109">bbox</span></span><span id="textcolor5763"><span 
class="aett-10x-x-109">(nwEngland)[</span></span><span id="textcolor5764"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5765"><span 
class="aett-10x-x-109">,]))</span></span><span id="textcolor5766"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor5767"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor5768"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5769"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor5770"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5771"><span 
class="aett-10x-x-109">bbox</span></span><span id="textcolor5772"><span 
class="aett-10x-x-109">(nwEngland)[</span></span><span id="textcolor5773"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor5774"><span 
class="aett-10x-x-109">,]))</span></span>
<br /><span id="textcolor5775"><span 
class="aett-10x-x-109">prj</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5776"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5777"><span 
class="aett-10x-x-109">inla.mesh.projector</span></span><span id="textcolor5778"><span 
class="aett-10x-x-109">(mesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5779"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor5780"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5781"><span 
class="aett-10x-x-109">bbox</span></span><span id="textcolor5782"><span 
class="aett-10x-x-109">(nwEngland)[</span></span><span id="textcolor5783"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5784"><span 
class="aett-10x-x-109">,],</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5785"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor5786"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5787"><span 
class="aett-10x-x-109">bbox</span></span><span id="textcolor5788"><span 
class="aett-10x-x-109">(nwEngland)[</span></span><span id="textcolor5789"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor5790"><span 
class="aett-10x-x-109">,],</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5791"><span 
class="aett-10x-x-109">dims</span></span><span id="textcolor5792"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5793"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor5794"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5795"><span 
class="aett-10x-x-109">200</span></span><span id="textcolor5796"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor5797"><span 
class="aett-10x-x-109">r0,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5798"><span 
class="aett-10x-x-109">200</span></span><span id="textcolor5799"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
then we interplate it and assign NA for grid points not inside the map  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5800"><span 
class="aett-10x-x-109">m.spat</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5801"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5802"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor5803"><span 
class="aett-10x-x-109">(prj,</span><span 
class="aett-10x-x-109">&#x00A0;r</span></span><span id="textcolor5804"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5805"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor5806"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5807"><span 
class="aett-10x-x-109">spatial</span></span><span id="textcolor5808"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5809"><span 
class="aett-10x-x-109">mean)</span></span>
<br /><span id="textcolor5810"><span 
class="aett-10x-x-109">sd.spat</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5811"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5812"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor5813"><span 
class="aett-10x-x-109">(prj,</span><span 
class="aett-10x-x-109">&#x00A0;r</span></span><span id="textcolor5814"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5815"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor5816"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5817"><span 
class="aett-10x-x-109">spatial</span></span><span id="textcolor5818"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5819"><span 
class="aett-10x-x-109">sd)</span></span>
<br /><span id="textcolor5820"><span 
class="aett-10x-x-109">ov</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5821"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5822"><span 
class="aett-10x-x-109">over</span></span><span id="textcolor5823"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5824"><span 
class="aett-10x-x-109">SpatialPoints</span></span><span id="textcolor5825"><span 
class="aett-10x-x-109">(prj</span></span><span id="textcolor5826"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5827"><span 
class="aett-10x-x-109">lattice</span></span><span id="textcolor5828"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5829"><span 
class="aett-10x-x-109">loc),</span><span 
class="aett-10x-x-109">&#x00A0;nwEngland)</span></span>
<br /><span id="textcolor5830"><span 
class="aett-10x-x-109">sd.spat[</span></span><span id="textcolor5831"><span 
class="aett-10x-x-109">is.na</span></span><span id="textcolor5832"><span 
class="aett-10x-x-109">(ov)]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5833"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5834"><span 
class="aett-10x-x-109">m.spat[</span></span><span id="textcolor5835"><span 
class="aett-10x-x-109">is.na</span></span><span id="textcolor5836"><span 
class="aett-10x-x-109">(ov)]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5837"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5838"><span 
class="aett-10x-x-109">NA</span></span>
</div>
</div>
   </div>
<!--l. 189--><p class="indent" >   The posterior mean and standard deviation are in Figure&#x00A0;<a 
href="#x6-470002.2.1">2.2.1<!--tex4ht:ref: fig:wsmap --></a>. As a result, the spatial effect
has continuous variation along the region, rather than constant inside each district.
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
                                                                                 
                                                                                 
<div class="obeylines-v">
<span id="textcolor5839"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor5840"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5841"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor5842"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5843"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor5844"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5845"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5846"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor5847"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor5848"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5849"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor5850"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5851"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor5852"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5853"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor5854"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor5855"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor5856"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor5857"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor5858"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor5859"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor5860"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor5861"><span 
class="aett-10x-x-109">image.plot</span></span><span id="textcolor5862"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5863"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor5864"><span 
class="aett-10x-x-109">=prj</span></span><span id="textcolor5865"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5866"><span 
class="aett-10x-x-109">x,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5867"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor5868"><span 
class="aett-10x-x-109">=prj</span></span><span id="textcolor5869"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5870"><span 
class="aett-10x-x-109">y,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5871"><span 
class="aett-10x-x-109">z</span></span><span id="textcolor5872"><span 
class="aett-10x-x-109">=m.spat,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5873"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor5874"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5875"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5876"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5877"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor5878"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5879"><span 
class="tctt-1095">''</span></span><span id="textcolor5880"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5881"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor5882"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5883"><span 
class="tctt-1095">''</span></span><span id="textcolor5884"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5885"><span 
class="aett-10x-x-109">axes</span></span><span id="textcolor5886"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5887"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor5888"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5889"><span 
class="aett-10x-x-109">horizontal</span></span><span id="textcolor5890"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5891"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor5892"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor5893"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor5894"><span 
class="aett-10x-x-109">(nwEngland,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5895"><span 
class="aett-10x-x-109">add</span></span><span id="textcolor5896"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5897"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor5898"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor5899"><span 
class="aett-10x-x-109">image.plot</span></span><span id="textcolor5900"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5901"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor5902"><span 
class="aett-10x-x-109">=prj</span></span><span id="textcolor5903"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5904"><span 
class="aett-10x-x-109">x,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5905"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor5906"><span 
class="aett-10x-x-109">=prj</span></span><span id="textcolor5907"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5908"><span 
class="aett-10x-x-109">y,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5909"><span 
class="aett-10x-x-109">z</span></span><span id="textcolor5910"><span 
class="aett-10x-x-109">=sd.spat,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5911"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor5912"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5913"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5914"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5915"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor5916"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5917"><span 
class="tctt-1095">''</span></span><span id="textcolor5918"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5919"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor5920"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5921"><span 
class="tctt-1095">''</span></span><span id="textcolor5922"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5923"><span 
class="aett-10x-x-109">axes</span></span><span id="textcolor5924"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5925"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor5926"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5927"><span 
class="aett-10x-x-109">horizontal</span></span><span id="textcolor5928"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5929"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor5930"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor5931"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor5932"><span 
class="aett-10x-x-109">(nwEngland,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5933"><span 
class="aett-10x-x-109">add</span></span><span id="textcolor5934"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5935"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor5936"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x6-470015"></a>
                                                                                 
                                                                                 
<!--l. 208--><p class="noindent" ><img 
src="spde-tutorial40x.png" alt="PIC" class="graphics" width="413" height="312"  /><!--tex4ht:graphics  
name="spde-tutorial40x.png" src="figs/survivalwsmap-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;2.5: </span><span  
class="content">Map of the spatial effect in the Weibull survival model. Posterior mean (left)
and posterior standard deviation (right).</span></div><!--tex4ht:label?: x6-470015 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">2.2.2   </span> <a 
 id="x6-480002.2.2"></a>Cox proportional hazard survival model</h4>
<!--l. 217--><p class="noindent" >The Cox proportinal hazard (coxph) survival model can be written as a Poisson regression. In
<span 
class="aett-10x-x-109">R-INLA </span>it is done internally using the <span 
class="aett-10x-x-109">inla.coxph() </span>function. We need this function to
pre-prepare the data before using it as input for the <span 
class="aett-10x-x-109">inla.stack() </span>function. So, we
have to supply the data converted into the Poisson regression data to <span 
class="aett-10x-x-109">inla.stack()</span>
to prepare then the data stack in order to have the SPDE model included in the
model.
</p><!--l. 227--><p class="indent" >   We first define a formula without the spatial effect to have the data extended to the Poisson
model.  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5937"><span 
class="aett-10x-x-109">formula0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5938"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5939"><span 
class="aett-10x-x-109">inla.surv</span></span><span id="textcolor5940"><span 
class="aett-10x-x-109">(time,</span><span 
class="aett-10x-x-109">&#x00A0;cens)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5941"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5942"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5943"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5944"><span 
class="aett-10x-x-109">a0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5945"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5946"><span 
class="aett-10x-x-109">sex</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5947"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5948"><span 
class="aett-10x-x-109">age</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5949"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5950"><span 
class="aett-10x-x-109">wbc</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5951"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5952"><span 
class="aett-10x-x-109">tpi</span></span>
<br /><span id="textcolor5953"><span 
class="aett-10x-x-109">cph.leuk</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5954"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5955"><span 
class="aett-10x-x-109">inla.coxph</span></span><span id="textcolor5956"><span 
class="aett-10x-x-109">(formula0,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5957"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor5958"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5959"><span 
class="aett-10x-x-109">data.frame</span></span><span id="textcolor5960"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5961"><span 
class="aett-10x-x-109">a0</span></span><span id="textcolor5962"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5963"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5964"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;Leuk[,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5965"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor5966"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5967"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5968"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor5969"><span 
class="aett-10x-x-109">8</span></span><span id="textcolor5970"><span 
class="aett-10x-x-109">)]),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5971"><span 
class="aett-10x-x-109">control.hazard</span></span><span id="textcolor5972"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5973"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor5974"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5975"><span 
class="aett-10x-x-109">n.intervals</span></span><span id="textcolor5976"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5977"><span 
class="aett-10x-x-109">25</span></span><span id="textcolor5978"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
<!--l. 239--><p class="indent" >   For comparison pourpose we can fit this model using  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5979"><span 
class="aett-10x-x-109">cph.res0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5980"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5981"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor5982"><span 
class="aett-10x-x-109">(formula0,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5983"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">coxph</span><span 
class="tctt-1095">'</span></span><span id="textcolor5984"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5985"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor5986"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5987"><span 
class="aett-10x-x-109">data.frame</span></span><span id="textcolor5988"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5989"><span 
class="aett-10x-x-109">a0</span></span><span id="textcolor5990"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor5991"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor5992"><span 
class="aett-10x-x-109">,Leuk))</span></span>
</div>
</div>
   </div>
<!--l. 248--><p class="indent" >   Then, we have to include the spatial effect in the formula  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor5993"><span 
class="aett-10x-x-109">cph.formula</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5994"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5995"><span 
class="aett-10x-x-109">update</span></span><span id="textcolor5996"><span 
class="aett-10x-x-109">(cph.leuk</span></span><span id="textcolor5997"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor5998"><span 
class="aett-10x-x-109">formula,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor5999"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">.</span><span 
class="aett-10x-x-109">&#x00A0;~</span><span 
class="aett-10x-x-109">&#x00A0;.</span><span 
class="aett-10x-x-109">&#x00A0;+</span><span 
class="aett-10x-x-109">&#x00A0;f(spatial,</span><span 
class="aett-10x-x-109">&#x00A0;model=spde)</span><span 
class="tctt-1095">'</span></span><span id="textcolor6000"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<!--l. 258--><p class="indent" >   The projector matrix can be built with  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
                                                                                 
                                                                                 
<div class="obeylines-v">
<span id="textcolor6001"><span 
class="aett-10x-x-109">cph.A</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6002"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6003"><span 
class="aett-10x-x-109">inla.spde.make.A</span></span><span id="textcolor6004"><span 
class="aett-10x-x-109">(mesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6005"><span 
class="aett-10x-x-109">loc</span></span><span id="textcolor6006"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6007"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor6008"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6009"><span 
class="aett-10x-x-109">cph.leuk</span></span><span id="textcolor6010"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6011"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor6012"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6013"><span 
class="aett-10x-x-109">xcoord,</span><span 
class="aett-10x-x-109">&#x00A0;cph.leuk</span></span><span id="textcolor6014"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6015"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor6016"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6017"><span 
class="aett-10x-x-109">ycoord))</span></span>
</div>
</div>
   </div>
<!--l. 268--><p class="indent" >   And the stack is built considering the relevant data from the output of the <span 
class="aett-10x-x-109">inla.coxph()</span>
function  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6018"><span 
class="aett-10x-x-109">cph.stk</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6019"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6020"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor6021"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6022"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor6023"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6024"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor6025"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6026"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor6027"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6028"><span 
class="aett-10x-x-109">E</span></span><span id="textcolor6029"><span 
class="aett-10x-x-109">=cph.leuk</span></span><span id="textcolor6030"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6031"><span 
class="aett-10x-x-109">E),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6032"><span 
class="aett-10x-x-109">cph.leuk</span></span><span id="textcolor6033"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6034"><span 
class="aett-10x-x-109">data[</span></span><span id="textcolor6035"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor6036"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6037"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">y..coxph</span><span 
class="tctt-1095">'</span></span><span id="textcolor6038"><span 
class="aett-10x-x-109">)]),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6039"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor6040"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6041"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor6042"><span 
class="aett-10x-x-109">(cph.A,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6043"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6044"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6045"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor6046"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6047"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor6048"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6049"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor6050"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6051"><span 
class="aett-10x-x-109">spatial</span></span><span id="textcolor6052"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6053"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6054"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor6055"><span 
class="aett-10x-x-109">spde</span></span><span id="textcolor6056"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6057"><span 
class="aett-10x-x-109">n.spde),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6058"><span 
class="aett-10x-x-109">cph.leuk</span></span><span id="textcolor6059"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6060"><span 
class="aett-10x-x-109">data[</span></span><span id="textcolor6061"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor6062"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6063"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">baseline.hazard</span><span 
class="tctt-1095">'</span></span><span id="textcolor6064"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6065"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">a0</span><span 
class="tctt-1095">'</span></span><span id="textcolor6066"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6067"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">age</span><span 
class="tctt-1095">'</span></span><span id="textcolor6068"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6069"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">sex</span><span 
class="tctt-1095">'</span></span><span id="textcolor6070"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6071"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">wbc</span><span 
class="tctt-1095">'</span></span><span id="textcolor6072"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6073"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">tpi</span><span 
class="tctt-1095">'</span></span><span id="textcolor6074"><span 
class="aett-10x-x-109">)]))</span></span>
<br /><span id="textcolor6075"><span 
class="aett-10x-x-109">cph.data</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6076"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6077"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor6078"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6079"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor6080"><span 
class="aett-10x-x-109">(cph.stk),</span><span 
class="aett-10x-x-109">&#x00A0;cph.leuk</span></span><span id="textcolor6081"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6082"><span 
class="aett-10x-x-109">data.list)</span></span>
</div>
</div>
   </div>
<!--l. 285--><p class="indent" >   Then, we only had to use it considering the Poisson likelihood  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6083"><span 
class="aett-10x-x-109">cph.res</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6084"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6085"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor6086"><span 
class="aett-10x-x-109">(cph.formula,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6087"><span 
class="aett-10x-x-109">family</span></span><span id="textcolor6088"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6089"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Poisson</span><span 
class="tctt-1095">'</span></span><span id="textcolor6090"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6091"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor6092"><span 
class="aett-10x-x-109">=cph.data,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6093"><span 
class="aett-10x-x-109">E</span></span><span id="textcolor6094"><span 
class="aett-10x-x-109">=cph.data</span></span><span id="textcolor6095"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6096"><span 
class="aett-10x-x-109">E,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6097"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor6098"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6099"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor6100"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6101"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor6102"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6103"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor6104"><span 
class="aett-10x-x-109">(cph.stk)))</span></span>
</div>
</div>
   </div>
<!--l. 296--><p class="indent" >   We can compare the results with the result from the <span 
class="aeb10-x-x-109">survival </span>package.  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6105"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor6106"><span 
class="aett-10x-x-109">(survival)</span></span>
<br /><span id="textcolor6107"><span 
class="aett-10x-x-109">m0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6108"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6109"><span 
class="aett-10x-x-109">coxph</span></span><span id="textcolor6110"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6111"><span 
class="aett-10x-x-109">Surv</span></span><span id="textcolor6112"><span 
class="aett-10x-x-109">(time,</span><span 
class="aett-10x-x-109">&#x00A0;cens)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6113"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6114"><span 
class="aett-10x-x-109">sex</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6115"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6116"><span 
class="aett-10x-x-109">age</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6117"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6118"><span 
class="aett-10x-x-109">wbc</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6119"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6120"><span 
class="aett-10x-x-109">tpi,</span><span 
class="aett-10x-x-109">&#x00A0;Leuk)</span></span>
<br /><span id="textcolor6121"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor6122"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6123"><span 
class="aett-10x-x-109">survival</span></span><span id="textcolor6124"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6125"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor6126"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6127"><span 
class="aett-10x-x-109">NA</span></span><span id="textcolor6128"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6129"><span 
class="aett-10x-x-109">coef</span></span><span id="textcolor6130"><span 
class="aett-10x-x-109">(m0)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6131"><span 
class="aett-10x-x-109">r0</span></span><span id="textcolor6132"><span 
class="aett-10x-x-109">=cph.res0</span></span><span id="textcolor6133"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6134"><span 
class="aett-10x-x-109">summary.fix[,</span></span><span id="textcolor6135"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6136"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6137"><span 
class="aett-10x-x-109">r1</span></span><span id="textcolor6138"><span 
class="aett-10x-x-109">=cph.res</span></span><span id="textcolor6139"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6140"><span 
class="aett-10x-x-109">summary.fix[,</span></span><span id="textcolor6141"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6142"><span 
class="aett-10x-x-109">])</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-75">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;survival&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;r0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;r1
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;NA&#x00A0;-4.293352224&#x00A0;-4.261112961
&#x00A0;<br />##&#x00A0;sex&#x00A0;0.052175883&#x00A0;&#x00A0;0.057889749&#x00A0;&#x00A0;0.068680086
&#x00A0;<br />##&#x00A0;age&#x00A0;0.029617048&#x00A0;&#x00A0;0.033255545&#x00A0;&#x00A0;0.034802292
&#x00A0;<br />##&#x00A0;wbc&#x00A0;0.003072442&#x00A0;&#x00A0;0.003395482&#x00A0;&#x00A0;0.003428054
&#x00A0;<br />##&#x00A0;tpi&#x00A0;0.029284096&#x00A0;&#x00A0;0.034243161&#x00A0;&#x00A0;0.032362351
</div>
<!--l. 312--><p class="nopar" >
</p>
   </div>
<!--l. 316--><p class="indent" >   The spatial effect fitted very is similar to that from the Weibull model  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6143"><span 
class="aett-10x-x-109">cor</span></span><span id="textcolor6144"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6145"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor6146"><span 
class="aett-10x-x-109">(m.spat),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6147"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor6148"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6149"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor6150"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6151"><span 
class="aett-10x-x-109">prj,</span><span 
class="aett-10x-x-109">&#x00A0;cph.res</span></span><span id="textcolor6152"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6153"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor6154"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6155"><span 
class="aett-10x-x-109">spatial</span></span><span id="textcolor6156"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6157"><span 
class="aett-10x-x-109">mean)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6158"><span 
class="aett-10x-x-109">use</span></span><span id="textcolor6159"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6160"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">p</span><span 
class="tctt-1095">'</span></span><span id="textcolor6161"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-76">
##&#x00A0;[1]&#x00A0;0.9941699
</div>
<!--l. 326--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor6162"><span 
class="aett-10x-x-109">cor</span></span><span id="textcolor6163"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6164"><span 
class="aett-10x-x-109">log</span></span><span id="textcolor6165"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6166"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor6167"><span 
class="aett-10x-x-109">(sd.spat)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6168"><span 
class="aett-10x-x-109">log</span></span><span id="textcolor6169"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6170"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor6171"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6172"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor6173"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6174"><span 
class="aett-10x-x-109">prj,</span><span 
class="aett-10x-x-109">&#x00A0;cph.res</span></span><span id="textcolor6175"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6176"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor6177"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6178"><span 
class="aett-10x-x-109">spatial</span></span><span id="textcolor6179"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6180"><span 
class="aett-10x-x-109">sd))),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6181"><span 
class="aett-10x-x-109">use</span></span><span id="textcolor6182"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6183"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">p</span><span 
class="tctt-1095">'</span></span><span id="textcolor6184"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-77">
##&#x00A0;[1]&#x00A0;0.9984177
</div>
<!--l. 334--><p class="nopar" >
</p>
   </div>
   <h3 class="sectionHead"><span class="titlemark">2.3   </span> <a 
 id="x6-490002.3"></a>Explanatory variables in the covariance</h3>
<!--l. 3--><p class="noindent" >This content is part of the book available at <a 
href="http://www.r-inla.org/spde-book" class="url" ><span 
class="aett-10x-x-109">http://www.r-inla.org/spde-book</span></a>, whose
Gitbook version is freely available along all the code and datasets. We strongly recommend to
consider this.
</p><!--l. 9--><p class="indent" >   In this example we will show how an example of the model proposed in&#x00A0;<span class="cite">[<a 
href="spde-tutorialli2.html#XingebrigtsenLS:2013">Ingebrigtsen et&#x00A0;al.,
2014</a>]</span>. This is a way to include explanatory variables (covariates) in both the SPDE model
parameters, the local precision and the range.
</p><!--l. 17--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.3.1   </span> <a 
 id="x6-500002.3.1"></a>Introduction</h4>
<!--l. 19--><p class="noindent" >We start to remember the definition for the precision matrix considering the equations (<a 
href="spde-tutorialch1.html#x5-12002r10">1.10<!--tex4ht:ref: eq:Qalpha --></a>)
and (<a 
href="spde-tutorialch1.html#x5-12004r11">1.11<!--tex4ht:ref: eq:Qfrac --></a>). Considering <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 1 </span>and <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 2 </span>we have </p>
     <ul class="itemize1">
     <li class="itemize"><span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 1</span>: <span 
class="cmmib-10x-x-109">Q</span><sub><span 
class="cmr-8">1</span><span 
class="cmmi-8">,&#x03BA;</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmib-10x-x-109">K</span><sub><span 
class="cmmi-8">&#x03BA;</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">&#x03BA;</span><sup><span 
class="cmr-8">2</span></sup><span 
class="cmmib-10x-x-109">C </span><span 
class="cmr-10x-x-109">+ </span><span 
class="cmmib-10x-x-109">G</span>
     </li>
     <li class="itemize"><span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 2</span>: <span 
class="cmmib-10x-x-109">Q</span><sub><span 
class="cmr-8">2</span><span 
class="cmmi-8">,&#x03BA;</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmib-10x-x-109">K</span><sub><span 
class="cmmi-8">&#x03BA;</span></sub><span 
class="cmmib-10x-x-109">C</span><sup><span 
class="cmsy-8">-</span><span 
class="cmr-8">1</span></sup><span 
class="cmmib-10x-x-109">K</span><sub><span 
class="cmmi-8">&#x03BA;</span></sub> = <span 
class="cmmi-10x-x-109">&#x03BA;</span><sup><span 
class="cmr-8">4</span></sup><span 
class="cmmib-10x-x-109">C </span><span 
class="cmr-10x-x-109">+ </span><span 
class="cmmi-10x-x-109">&#x03BA;</span><sup><span 
class="cmr-8">2</span></sup><span 
class="cmmib-10x-x-109">G </span><span 
class="cmr-10x-x-109">+ </span><span 
class="cmmi-10x-x-109">&#x03BA;</span><sup><span 
class="cmr-8">2</span></sup><span 
class="cmmib-10x-x-109">G </span><span 
class="cmr-10x-x-109">+ </span><span 
class="cmmib-10x-x-109">GC</span><sup><span 
class="cmsy-8">-</span><span 
class="cmr-8">1</span></sup><span 
class="cmmib-10x-x-109">G</span></li></ul>
<!--l. 29--><p class="indent" >   The approach is to consider a regression like model for <span 
class="cmr-10x-x-109">log</span> <span 
class="cmmi-10x-x-109">&#x03C4; </span>and <span 
class="cmr-10x-x-109">log</span> <span 
class="cmmi-10x-x-109">&#x03BA;</span>. In order to implement
it, the precision matrix are written in a more general way as
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-50001r1"></a>
   <center class="math-display" >
<img 
src="spde-tutorial41x.png" alt="      (0)  (1)  (0) (1)    (2) (1)  (1)     (1)T  (1)  (2)     (2)   (0)
Q = D    (D    M   D    + D   D   M     + (M   ) D    D   + M    )D
" class="math-display"  /></center></td><td class="equation-label">(2.1)</td></tr></table>
<!--l. 37--><p class="nopar" >
where <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(0)</span></sup>, <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(1)</span></sup> and <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(2)</span></sup>, are provided from the finite element method - FEM based on the
mesh. For <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 1 </span>(<span 
class="cmmi-10x-x-109">&#x03BD; </span><span 
class="cmr-10x-x-109">= 0</span>), we have <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(0)</span></sup> <span 
class="cmr-10x-x-109">=</span> <span 
class="cmmib-10x-x-109">C</span>, <span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(1)</span></sup><span 
class="cmr-10x-x-109">)</span><sub><span 
class="cmmi-8">ij</span></sub> <span 
class="cmr-10x-x-109">= 0 </span>and <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(2)</span></sup> <span 
class="cmr-10x-x-109">=</span> <span 
class="cmmib-10x-x-109">G</span>. For <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 2 </span>(<span 
class="cmmi-10x-x-109">&#x03BD; </span><span 
class="cmr-10x-x-109">= 1</span>),
we have <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(0)</span></sup> <span 
class="cmr-10x-x-109">=</span> <span 
class="cmmib-10x-x-109">C</span>, <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(1)</span></sup> <span 
class="cmr-10x-x-109">=</span> <span 
class="cmmib-10x-x-109">G</span> and <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(2)</span></sup> <span 
class="cmr-10x-x-109">=</span> <span 
class="cmmib-10x-x-109">G</span><span 
class="cmmib-10x-x-109">C</span><sup><span 
class="cmsy-8">-</span><span 
class="cmr-8">1</span></sup><span 
class="cmmib-10x-x-109">G</span>.
                                                                                 
                                                                                 
</p><!--l. 48--><p class="indent" >   All <span 
class="cmmib-10x-x-109">D</span><sup><span 
class="cmr-8">(0)</span></sup>, <span 
class="cmmib-10x-x-109">D</span><sup><span 
class="cmr-8">(1)</span></sup> and <span 
class="cmmib-10x-x-109">D</span><sup><span 
class="cmr-8">(2)</span></sup> are diagonal with elements used to describe non-stationarity. The
definition of these matrices are
</p><table 
class="align-star">
                          <tr><td 
class="align-odd"><span 
class="cmmib-10x-x-109">D</span><sup><span 
class="cmr-8">(0)</span></sup> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">diag</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmmib-10x-x-109">D</span><sub>
<span 
class="cmmi-8">i</span></sub><sup><span 
class="cmr-8">(0)</span></sup><span 
class="cmsy-10x-x-109">} </span><span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">diag</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmmi-10x-x-109">e</span><sup><span 
class="cmmi-8">&#x03D5;</span><sub><span 
class="cmmi-6">i</span></sub><sup><span 
class="cmr-6">(0)</span></sup>
       </sup><span 
class="cmsy-10x-x-109">}</span></td>                          <td 
class="align-even"></td>                          <td 
class="align-label">
                          </td></tr><tr><td 
class="align-odd"><span 
class="cmmib-10x-x-109">D</span><sup><span 
class="cmr-8">(1)</span></sup> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">diag</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmmib-10x-x-109">D</span><sub>
<span 
class="cmmi-8">i</span></sub><sup><span 
class="cmr-8">(1)</span></sup><span 
class="cmsy-10x-x-109">} </span><span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">diag</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmmi-10x-x-109">e</span><sup><span 
class="cmmi-8">&#x03D5;</span><sub><span 
class="cmmi-6">i</span></sub><sup><span 
class="cmr-6">(1)</span></sup>
       </sup><span 
class="cmsy-10x-x-109">}</span></td>                          <td 
class="align-even"></td>                          <td 
class="align-label">
                          </td></tr><tr><td 
class="align-odd"><span 
class="cmmib-10x-x-109">D</span><sup><span 
class="cmr-8">(2)</span></sup> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">diag</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmmib-10x-x-109">D</span><sub>
<span 
class="cmmi-8">i</span></sub><sup><span 
class="cmr-8">(2)</span></sup><span 
class="cmsy-10x-x-109">} </span><span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">diag</span><span 
class="cmsy-10x-x-109">{</span><span 
class="cmmi-10x-x-109">&#x03D5;</span><sub>
<span 
class="cmmi-8">i</span></sub><sup><span 
class="cmr-8">(2)</span></sup><span 
class="cmsy-10x-x-109">}</span></td>                          <td 
class="align-even"></td>                          <td 
class="align-label"></td></tr></table>
<!--l. 57--><p class="indent" >   where
</p>
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="spde-tutorial42x.png" alt="             &#x2211;p
&#x03D5;(ki) = B (ki,)0 +    B (ki,)j &#x03B8;j, i = 1,...,n
             j=1
" class="math-display"  /></center></td></tr></table>
<!--l. 61--><p class="nopar" >
with the <span 
class="cmmib-10x-x-109">B</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">k</span><span 
class="cmr-8">)</span></sup> <span 
class="cmr-10x-x-109">: </span><span 
class="cmmi-10x-x-109">n</span>-by-<span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">p </span><span 
class="cmr-10x-x-109">+ 1) </span>user defined matrix.
</p><!--l. 65--><p class="indent" >   The default stationary SPDE model uses <span 
class="cmmib-10x-x-109">B</span><sup><span 
class="cmr-8">(0)</span></sup> <span 
class="cmr-10x-x-109">= [0</span><span style="margin-left:3.04074pt" class="tmspace"></span><span 
class="cmr-10x-x-109">1</span><span style="margin-left:3.04074pt" class="tmspace"></span><span 
class="cmr-10x-x-109">0] </span>(one by three) matrix for
the local precision parameter <span 
class="cmmi-10x-x-109">&#x03C4;</span>, <span 
class="cmmib-10x-x-109">B</span><sup><span 
class="cmr-8">(1)</span></sup> <span 
class="cmr-10x-x-109">= [0</span><span style="margin-left:3.04074pt" class="tmspace"></span><span 
class="cmr-10x-x-109">0</span><span style="margin-left:3.04074pt" class="tmspace"></span><span 
class="cmr-10x-x-109">1] </span>(one by three) matrix for the scaling
parameter <span 
class="cmmi-10x-x-109">&#x03BA;</span>, and <span 
class="cmmib-10x-x-109">B</span><sup><span 
class="cmr-8">(2)</span></sup> <span 
class="cmr-10x-x-109">= 1</span>. When these basis matrices are supplied as just one line
matrix, the actual basis matrix will be formed having all lines equals to this unique line
matrix.
</p><!--l. 76--><p class="indent" >   In the next section, we add one of the location coordinates as a fourth column for <span 
class="cmmib-10x-x-109">B</span><sup><span 
class="cmr-8">(1)</span></sup> in
order to build a non-stationary model.
                                                                                 
                                                                                 
</p><!--l. 80--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.3.2   </span> <a 
 id="x6-510002.3.2"></a>An example</h4>
<!--l. 82--><p class="noindent" >We now will define a model were the local precision depends on one of the coordinates. Note
that in order to build a precision matrix defined in the equation&#x00A0;(<a 
href="#x6-50001r1">2.1<!--tex4ht:ref: eq:Qnst --></a>), one also needs <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(0)</span></sup>,
<span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(1)</span></sup> and <span 
class="cmmib-10x-x-109">M</span><sup><span 
class="cmr-8">(2)</span></sup> defined at the mesh nodes.
</p><!--l. 89--><p class="indent" >   First, we define a polygon to define a mesh. We define an unitary square  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6185"><span 
class="aett-10x-x-109">pl01</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6186"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6187"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor6188"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6189"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor6190"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6191"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor6192"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor6193"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6194"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor6195"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6196"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor6197"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor6198"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor6199"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor6200"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6201"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor6202"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6203"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor6204"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor6205"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor6206"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor6207"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6208"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor6209"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6210"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor6211"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor6212"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
and build a mesh using this polygon with  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6213"><span 
class="aett-10x-x-109">(mesh</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6214"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6215"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor6216"><span 
class="aett-10x-x-109">(,</span><span 
class="aett-10x-x-109">&#x00A0;pl01,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6217"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor6218"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6219"><span 
class="aett-10x-x-109">0.03</span></span><span id="textcolor6220"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6221"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor6222"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6223"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor6224"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6225"><span 
class="aett-10x-x-109">0.07</span></span><span id="textcolor6226"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor6227"><span 
class="aett-10x-x-109">.12</span></span><span id="textcolor6228"><span 
class="aett-10x-x-109">)))</span></span><span id="textcolor6229"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6230"><span 
class="aett-10x-x-109">n</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-78">
##&#x00A0;[1]&#x00A0;924
</div>
<!--l. 107--><p class="nopar" >
</p>
   </div>
<!--l. 111--><p class="indent" >   Now, we define the non-stationary SPDE model. We want to define a model where the local
precision depends on the first coordinate. So, we have to consider a fourth column for <span 
class="cmmib-10x-x-109">B</span><sup><span 
class="cmr-8">(1)</span></sup>,
supplied as in the <span 
class="aett-10x-x-109">B.tau </span>argument of the <span 
class="aett-10x-x-109">inla.spde2.matern() </span>function. By doing it, we also
do need to set prior <span 
class="cmmi-10x-x-109">&#x03B8; </span>according to its new dimension, a three length vector. The default is a
Gaussian distribution and we just need to specify the mean and precision diagonal, two vectors
as follows:  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6231"><span 
class="aett-10x-x-109">spde</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6232"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6233"><span 
class="aett-10x-x-109">inla.spde2.matern</span></span><span id="textcolor6234"><span 
class="aett-10x-x-109">(mesh,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6235"><span 
class="aett-10x-x-109">B.tau</span></span><span id="textcolor6236"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6237"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor6238"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6239"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor6240"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6241"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6242"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6243"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor6244"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6245"><span 
class="aett-10x-x-109">sin</span></span><span id="textcolor6246"><span 
class="aett-10x-x-109">(pi</span></span><span id="textcolor6247"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor6248"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor6249"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6250"><span 
class="aett-10x-x-109">loc[,</span></span><span id="textcolor6251"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6252"><span 
class="aett-10x-x-109">])),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6253"><span 
class="aett-10x-x-109">B.kappa</span></span><span id="textcolor6254"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6255"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor6256"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6257"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor6258"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6259"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor6260"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6261"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6262"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6263"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor6264"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6265"><span 
class="aett-10x-x-109">theta.prior.mean</span></span><span id="textcolor6266"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6267"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor6268"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6269"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor6270"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6271"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor6272"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6273"><span 
class="aett-10x-x-109">theta.prior.prec</span></span><span id="textcolor6274"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6275"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor6276"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6277"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6278"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6279"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor6280"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
where it was set <span 
class="cmmib-10x-x-109">B</span><sup><span 
class="cmr-8">(1)</span></sup> to define
   <center class="math-display" >
<img 
src="spde-tutorial43x.png" alt="     &#x03B8;1+&#x03B8;3sin(&#x03C0;loc[i,1])
&#x03C4;i = e   " class="math-display"  /></center>
having the local precision non-constant. In this case it also implies in a marginal variance
non-constant as well, as the marginal variance is:
   <center class="math-display" >
<img 
src="spde-tutorial44x.png" alt=" 2       2 2 -1
&#x03C3; =  (4&#x03C0; &#x03C4; &#x03BA; )  .
" class="math-display"  /></center>
                                                                                 
                                                                                 
<!--l. 138--><p class="indent" >   We can have a feeling about the model just defined setting values for <span 
class="cmmi-10x-x-109">&#x03B8;</span>, build the covariance
and look at the marginal variance (our interest). We consider two different cases:
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6281"><span 
class="aett-10x-x-109">theta1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6282"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6283"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor6284"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6285"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor6286"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6287"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6288"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor6289"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6290"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor6291"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6292"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor6293"><span 
class="aett-10x-x-109">theta2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6294"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6295"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor6296"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6297"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor6298"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6299"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6300"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor6301"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6302"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6303"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
The precision matrices are built with  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6304"><span 
class="aett-10x-x-109">Q1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6305"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6306"><span 
class="aett-10x-x-109">inla.spde2.precision</span></span><span id="textcolor6307"><span 
class="aett-10x-x-109">(spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6308"><span 
class="aett-10x-x-109">theta</span></span><span id="textcolor6309"><span 
class="aett-10x-x-109">=theta1)</span></span>
<br /><span id="textcolor6310"><span 
class="aett-10x-x-109">Q2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6311"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6312"><span 
class="aett-10x-x-109">inla.spde2.precision</span></span><span id="textcolor6313"><span 
class="aett-10x-x-109">(spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6314"><span 
class="aett-10x-x-109">theta</span></span><span id="textcolor6315"><span 
class="aett-10x-x-109">=theta2)</span></span>
</div>
</div>
   </div>
As we have the x-coordinate in the (0,1) interval, and the sin function is positive and
non-decreasing in this interval, the second precision matrix has larger values of <span 
class="cmmi-10x-x-109">&#x03C4;</span><sub><span 
class="cmmi-8">i</span></sub>, implying in a
lower marginal variance.
<!--l. 166--><p class="indent" >   To clarify, we compute both covariance matrix implied. The covariance matrix
of
</p>
   <center class="math-display" >
<img 
src="spde-tutorial45x.png" alt="      &#x2211;n
x(s) =    Ak(s)wk
      k=1  " class="math-display"  /></center> at
the mesh nodes as the inverse of the precision matrix. The <span 
class="aett-10x-x-109">inla.qinv() </span>function computes the
diagonal of the covariance matrix and the covariance elements at the non-zero elements of <span 
class="cmmib-10x-x-109">Q</span>
efficiently.
   <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6316"><span 
class="aett-10x-x-109">cov1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6317"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6318"><span 
class="aett-10x-x-109">inla.qinv</span></span><span id="textcolor6319"><span 
class="aett-10x-x-109">(Q1);</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;cov2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6320"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6321"><span 
class="aett-10x-x-109">inla.qinv</span></span><span id="textcolor6322"><span 
class="aett-10x-x-109">(Q2)</span></span>
                                                                                 
                                                                                 
</div>
</div>
   </div>
<!--l. 182--><p class="indent" >   A summary of the variances implied (diagonal of the covariance matrix) for both covariance
matrices is obtained with  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6323"><span 
class="aett-10x-x-109">v1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6324"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6325"><span 
class="aett-10x-x-109">diag</span></span><span id="textcolor6326"><span 
class="aett-10x-x-109">(cov1);</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;v2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6327"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6328"><span 
class="aett-10x-x-109">diag</span></span><span id="textcolor6329"><span 
class="aett-10x-x-109">(cov2)</span></span>
<br /><span id="textcolor6330"><span 
class="aett-10x-x-109">rbind</span></span><span id="textcolor6331"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6332"><span 
class="aett-10x-x-109">v1</span></span><span id="textcolor6333"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6334"><span 
class="aett-10x-x-109">summary</span></span><span id="textcolor6335"><span 
class="aett-10x-x-109">(v1),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6336"><span 
class="aett-10x-x-109">v2</span></span><span id="textcolor6337"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6338"><span 
class="aett-10x-x-109">summary</span></span><span id="textcolor6339"><span 
class="aett-10x-x-109">(v2))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-79">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Min.&#x00A0;&#x00A0;&#x00A0;&#x00A0;1st&#x00A0;Qu.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Median&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;3rd&#x00A0;Qu.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Max.
&#x00A0;<br />##&#x00A0;v1&#x00A0;0.004240680&#x00A0;0.01152236&#x00A0;0.03118176&#x00A0;0.04007248&#x00A0;0.06623656&#x00A0;0.1785956
&#x00A0;<br />##&#x00A0;v2&#x00A0;0.001495176&#x00A0;0.00226529&#x00A0;0.00492362&#x00A0;0.01620805&#x00A0;0.01432440&#x00A0;0.1564980
</div>
<!--l. 195--><p class="nopar" >
</p>
   </div>
showing large values for the first case.
<!--l. 200--><p class="indent" >   We can see the marginal variance at the mesh nodes considering both process in the
Figure&#x00A0;<a 
href="#x6-510002.3.2">2.3.2<!--tex4ht:ref: fig:varns --></a>. Commands to make the figure&#x00A0;<a 
href="#x6-510002.3.2">2.3.2<!--tex4ht:ref: fig:varns --></a>:  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6340"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor6341"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6342"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor6343"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6344"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor6345"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6346"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6347"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor6348"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor6349"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6350"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor6351"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6352"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor6353"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6354"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor6355"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor6356"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor6357"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor6358"><span 
class="aett-10x-x-109">.5</span></span><span id="textcolor6359"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor6360"><span 
class="aett-10x-x-109">.5</span></span><span id="textcolor6361"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6362"><span 
class="aett-10x-x-109">mgp</span></span><span id="textcolor6363"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6364"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor6365"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6366"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor6367"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6368"><span 
class="aett-10x-x-109">.7</span></span><span id="textcolor6369"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6370"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor6371"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6372"><span 
class="aett-10x-x-109">las</span></span><span id="textcolor6373"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6374"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6375"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor6376"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor6377"><span 
class="aett-10x-x-109">(mesh</span></span><span id="textcolor6378"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6379"><span 
class="aett-10x-x-109">loc[,</span></span><span id="textcolor6380"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6381"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;v1,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6382"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor6383"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6384"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor6385"><span 
class="aett-10x-x-109">(v1,v2),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6386"><span 
class="aett-10x-x-109">las</span></span><span id="textcolor6387"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6388"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6389"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6390"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor6391"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6392"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">x-coordinate</span><span 
class="tctt-1095">'</span></span><span id="textcolor6393"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6394"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor6395"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6396"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">marginal</span><span 
class="aett-10x-x-109">&#x00A0;variance</span><span 
class="tctt-1095">'</span></span><span id="textcolor6397"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor6398"><span 
class="aett-10x-x-109">points</span></span><span id="textcolor6399"><span 
class="aett-10x-x-109">(mesh</span></span><span id="textcolor6400"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6401"><span 
class="aett-10x-x-109">loc[,</span></span><span id="textcolor6402"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6403"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;v2,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6404"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor6405"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6406"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor6407"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor6408"><span 
class="aett-10x-x-109">i1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6409"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6410"><span 
class="aett-10x-x-109">which</span></span><span id="textcolor6411"><span 
class="aett-10x-x-109">((mesh</span></span><span id="textcolor6412"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6413"><span 
class="aett-10x-x-109">loc[,</span></span><span id="textcolor6414"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6415"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor6416"><span 
class="aett-10x-x-109">&#x003E;</span></span><span id="textcolor6417"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor6418"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6419"><span 
class="aett-10x-x-109">&amp;</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6420"><span 
class="aett-10x-x-109">(mesh</span></span><span id="textcolor6421"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6422"><span 
class="aett-10x-x-109">loc[,</span></span><span id="textcolor6423"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6424"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor6425"><span 
class="aett-10x-x-109">&#x003C;</span></span><span id="textcolor6426"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6427"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6428"><span 
class="aett-10x-x-109">&amp;</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6429"><span 
class="aett-10x-x-109">(mesh</span></span><span id="textcolor6430"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6431"><span 
class="aett-10x-x-109">loc[,</span></span><span id="textcolor6432"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor6433"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor6434"><span 
class="aett-10x-x-109">&#x003E;</span></span><span id="textcolor6435"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor6436"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6437"><span 
class="aett-10x-x-109">&amp;</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6438"><span 
class="aett-10x-x-109">(mesh</span></span><span id="textcolor6439"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6440"><span 
class="aett-10x-x-109">loc[,</span></span><span id="textcolor6441"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor6442"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor6443"><span 
class="aett-10x-x-109">&#x003C;</span></span><span id="textcolor6444"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6445"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor6446"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor6447"><span 
class="aett-10x-x-109">(mesh</span></span><span id="textcolor6448"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6449"><span 
class="aett-10x-x-109">loc[i1,</span></span><span id="textcolor6450"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6451"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;v1[i1],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6452"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor6453"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6454"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor6455"><span 
class="aett-10x-x-109">(v1[i1],v2[i1]),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6456"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor6457"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6458"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">x-coordinate</span><span 
class="tctt-1095">'</span></span><span id="textcolor6459"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6460"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor6461"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6462"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">marginal</span><span 
class="aett-10x-x-109">&#x00A0;variance</span><span 
class="tctt-1095">'</span></span><span id="textcolor6463"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6464"><span 
class="aett-10x-x-109">las</span></span><span id="textcolor6465"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6466"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6467"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor6468"><span 
class="aett-10x-x-109">points</span></span><span id="textcolor6469"><span 
class="aett-10x-x-109">(mesh</span></span><span id="textcolor6470"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6471"><span 
class="aett-10x-x-109">loc[i1,</span></span><span id="textcolor6472"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6473"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;v2[i1],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6474"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor6475"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6476"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor6477"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor6478"><span 
class="aett-10x-x-109">legend</span></span><span id="textcolor6479"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6480"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">topleft</span><span 
class="tctt-1095">'</span></span><span id="textcolor6481"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6482"><span 
class="aett-10x-x-109">as.expression</span></span><span id="textcolor6483"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6484"><span 
class="aett-10x-x-109">lapply</span></span><span id="textcolor6485"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6486"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor6487"><span 
class="aett-10x-x-109">(theta1[</span></span><span id="textcolor6488"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor6489"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;theta2[</span></span><span id="textcolor6490"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor6491"><span 
class="aett-10x-x-109">]),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6492"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor6493"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6494"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor6495"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6496"><span 
class="aett-10x-x-109">bquote</span></span><span id="textcolor6497"><span 
class="aett-10x-x-109">(theta[</span></span><span id="textcolor6498"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor6499"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor6500"><span 
class="aett-10x-x-109">==</span></span><span id="textcolor6501"><span 
class="aett-10x-x-109">.</span></span><span id="textcolor6502"><span 
class="aett-10x-x-109">(x)))),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6503"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor6504"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6505"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6506"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor6507"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor6508"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x6-510016"></a>
                                                                                 
                                                                                 
<!--l. 224--><p class="noindent" ><img 
src="spde-tutorial46x.png" alt="PIC" class="graphics" width="426" height="298"  /><!--tex4ht:graphics  
name="spde-tutorial46x.png" src="figs/nonstationarvvarns-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;2.6: </span><span  
class="content">Marginal variances at mesh nodes implied by both non-stationary process
defined, considering all the mesh points (left) and only those inside the region domain
(right).</span></div><!--tex4ht:label?: x6-510016 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 233--><p class="indent" >   In the plot at left we have some marginal variances that does not follows the pattern. For
example, it is clear that some points in the right plot does not follows the expected pattern when
<span 
class="cmmi-10x-x-109">x </span><span 
class="cmsy-10x-x-109">- </span><span 
class="cmmi-10x-x-109">axis </span>is near 0.5. These points are marginal variances computed for the mesh
nodes for <span 
class="cmmi-10x-x-109">y </span><span 
class="cmsy-10x-x-109">- </span><span 
class="cmmi-10x-x-109">axis </span>near bellow 0 or above 1, outside the domain. This is expected
as the variance of the approximation happens to be bigger at the boundary of the
mesh.
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.3.3   </span> <a 
 id="x6-520002.3.3"></a>Simulation at the mesh nodes</h4>
<!--l. 244--><p class="noindent" >Both precision matrix defined previously consider that the locations are the mesh
nodes. So, the simulation made with it is a realization of the random field on each
point of the mesh nodes. We use the same seed for each simulation, just to show
it.
</p>
   <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6509"><span 
class="aett-10x-x-109">sample1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6510"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6511"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor6512"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6513"><span 
class="aett-10x-x-109">inla.qsample</span></span><span id="textcolor6514"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6515"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6516"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;Q1,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6517"><span 
class="aett-10x-x-109">seed</span></span><span id="textcolor6518"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6519"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6520"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor6521"><span 
class="aett-10x-x-109">sample2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6522"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6523"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor6524"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6525"><span 
class="aett-10x-x-109">inla.qsample</span></span><span id="textcolor6526"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6527"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6528"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;Q2,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6529"><span 
class="aett-10x-x-109">seed</span></span><span id="textcolor6530"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6531"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6532"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
<!--l. 262--><p class="indent" >   We compute the standard deviations for both the samples considering groups defined in
accord to the first coordinate of the locations:  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6533"><span 
class="aett-10x-x-109">tapply</span></span><span id="textcolor6534"><span 
class="aett-10x-x-109">(sample1,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6535"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor6536"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6537"><span 
class="aett-10x-x-109">inla.group</span></span><span id="textcolor6538"><span 
class="aett-10x-x-109">(mesh</span></span><span id="textcolor6539"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6540"><span 
class="aett-10x-x-109">loc[,</span></span><span id="textcolor6541"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6542"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6543"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor6544"><span 
class="aett-10x-x-109">),</span></span><span id="textcolor6545"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor6546"><span 
class="aett-10x-x-109">),</span><span 
class="aett-10x-x-109">&#x00A0;var)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-80">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;-0.073&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.18&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.496&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.825&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.071
&#x00A0;<br />##&#x00A0;0.008349852&#x00A0;0.021988985&#x00A0;0.051450362&#x00A0;0.022831676&#x00A0;0.007851851
</div>
<!--l. 273--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor6547"><span 
class="aett-10x-x-109">tapply</span></span><span id="textcolor6548"><span 
class="aett-10x-x-109">(sample2,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6549"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor6550"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6551"><span 
class="aett-10x-x-109">inla.group</span></span><span id="textcolor6552"><span 
class="aett-10x-x-109">(mesh</span></span><span id="textcolor6553"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6554"><span 
class="aett-10x-x-109">loc[,</span></span><span id="textcolor6555"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6556"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6557"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor6558"><span 
class="aett-10x-x-109">),</span></span><span id="textcolor6559"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor6560"><span 
class="aett-10x-x-109">),</span><span 
class="aett-10x-x-109">&#x00A0;var)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-81">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;-0.073&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.18&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.496&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.825&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.071
&#x00A0;<br />##&#x00A0;0.026432644&#x00A0;0.003051414&#x00A0;0.001069714&#x00A0;0.004342003&#x00A0;0.024451202
</div>
<!--l. 280--><p class="nopar" >
</p>
   </div>
We observe that the variance of the sample from the first random field increase near 0.5 and
decrease near 0 and near 1. For the sample of the second random field the opposite happens and
we have larger values, as it has lower local precision.
<!--l. 290--><p class="indent" >   One can see the simulated values projected to a grid in Figure&#x00A0;<a 
href="#x6-520002.3.3">2.3.3<!--tex4ht:ref: fig:s12ns --></a>. We use a projector
matrix to project the simulated values in the grid limited in the unit square with limits (0,0) and
(1,1) with  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6561"><span 
class="aett-10x-x-109">proj</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6562"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6563"><span 
class="aett-10x-x-109">inla.mesh.projector</span></span><span id="textcolor6564"><span 
class="aett-10x-x-109">(mesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6565"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor6566"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6567"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor6568"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor6569"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6570"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6571"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor6572"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6573"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor6574"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor6575"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6576"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor6577"><span 
class="aett-10x-x-109">grid.arrange</span></span><span id="textcolor6578"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6579"><span 
class="aett-10x-x-109">levelplot</span></span><span id="textcolor6580"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6581"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor6582"><span 
class="aett-10x-x-109">(proj,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6583"><span 
class="aett-10x-x-109">field</span></span><span id="textcolor6584"><span 
class="aett-10x-x-109">=sample1),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6585"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor6586"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6587"><span 
class="tctt-1095">''</span></span><span id="textcolor6588"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6589"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor6590"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6591"><span 
class="tctt-1095">''</span></span><span id="textcolor6592"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6593"><span 
class="aett-10x-x-109">scale</span></span><span id="textcolor6594"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6595"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor6596"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6597"><span 
class="aett-10x-x-109">draw</span></span><span id="textcolor6598"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6599"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor6600"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6601"><span 
class="aett-10x-x-109">col.regions</span></span><span id="textcolor6602"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6603"><span 
class="aett-10x-x-109">topo.colors</span></span><span id="textcolor6604"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6605"><span 
class="aett-10x-x-109">100</span></span><span id="textcolor6606"><span 
class="aett-10x-x-109">)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6607"><span 
class="aett-10x-x-109">levelplot</span></span><span id="textcolor6608"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6609"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor6610"><span 
class="aett-10x-x-109">(proj,</span></span><span id="textcolor6611"><span 
class="aett-10x-x-109">field</span></span><span id="textcolor6612"><span 
class="aett-10x-x-109">=sample2),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6613"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor6614"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6615"><span 
class="tctt-1095">''</span></span><span id="textcolor6616"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6617"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor6618"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6619"><span 
class="tctt-1095">''</span></span><span id="textcolor6620"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6621"><span 
class="aett-10x-x-109">scale</span></span><span id="textcolor6622"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6623"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor6624"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6625"><span 
class="aett-10x-x-109">draw</span></span><span id="textcolor6626"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6627"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor6628"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6629"><span 
class="aett-10x-x-109">col.regions</span></span><span id="textcolor6630"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6631"><span 
class="aett-10x-x-109">topo.colors</span></span><span id="textcolor6632"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6633"><span 
class="aett-10x-x-109">100</span></span><span id="textcolor6634"><span 
class="aett-10x-x-109">)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6635"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor6636"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6637"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6638"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x6-520017"></a>
                                                                                 
                                                                                 
<!--l. 311--><p class="noindent" ><img 
src="spde-tutorial47x.png" alt="PIC" class="graphics" width="426" height="298"  /><!--tex4ht:graphics  
name="spde-tutorial47x.png" src="figs/nonstationarvplotsamples-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;2.7: </span><span  
class="content">Two simulated random fields, using two diferent <span 
class="cmmi-10x-x-109">&#x03B8; </span>in the same basis functions.</span></div><!--tex4ht:label?: x6-520017 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
   <h5 class="subsubsectionHead"><a 
 id="x6-530002.3.3"></a>Simulation with linear constraint</h5>
<!--l. 320--><p class="noindent" >The linear constraint is common for models intrinsic models, such the random walks in
one or two dimensions. This is not the case for the models we have defined in this
chapter. However, we would like to show the use of linear constraints for the SPDE
models.
</p><!--l. 326--><p class="indent" >   Because the SPDE models are based in the Finite Element Method (FEM) approximation,
the sum-to-zero restriction in this case is non trivial. The issue is that
</p>
   <center class="math-display" >
<img 
src="spde-tutorial48x.png" alt="&#x2211;
   xk
 k  " class="math-display"  /></center>
doesn&#8217;t mean anything for the mesh-based spde-models. Whereas
   <center class="math-display" >
<img 
src="spde-tutorial49x.png" alt="&#x222B;          &#x222B;
  x(s)ds =   &#x03A8; (s)xkds  " class="math-display"  /></center> does
mean something, and that integral is equal to
   <center class="math-display" >
<img 
src="spde-tutorial50x.png" alt="&#x2211;
   Ckkxk.
 k  " class="math-display"  /></center> So
the constraint
   <center class="math-display" >
<img 
src="spde-tutorial51x.png" alt="&#x222B;
   x(s)ds = 0  " class="math-display"  /></center> is
provided by
   <center class="math-display" >
<img 
src="spde-tutorial52x.png" alt="A *x = 0,whereA    = C   ,
                 1k     kk  " class="math-display"  /></center>
where <span 
class="cmmib-10x-x-109">C</span> is the matrix used in the FEM.
<!--l. 349--><p class="indent" >   Using <span 
class="cmmi-10x-x-109">A </span><span 
class="cmr-10x-x-109">= (1</span><span 
class="cmmi-10x-x-109">,...,</span><span 
class="cmr-10x-x-109">1) </span>instead of <span 
class="cmmi-10x-x-109">diag</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">C</span><span 
class="cmr-10x-x-109">) </span>leads to very bad behavior for irregular meshes. So, if
we want a linear constraint, we need to use <span 
class="cmmib-10x-x-109">C</span>.
</p><!--l. 354--><p class="indent" >   The <span 
class="cmmib-10x-x-109">C </span>matrix is obtained by the <span 
class="aett-10x-x-109">inla.mesh.fem() </span>function and is available directly in
outputs of <span 
class="aett-10x-x-109">inla.spde2.matern() </span>function. So, we do the simulation with
</p>
   <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6639"><span 
class="aett-10x-x-109">s1r</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6640"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6641"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor6642"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6643"><span 
class="aett-10x-x-109">inla.qsample</span></span><span id="textcolor6644"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6645"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6646"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;Q1,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6647"><span 
class="aett-10x-x-109">seed</span></span><span id="textcolor6648"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6649"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6650"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6651"><span 
class="aett-10x-x-109">constr</span></span><span id="textcolor6652"><span 
class="aett-10x-x-109">=spde</span></span><span id="textcolor6653"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6654"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor6655"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6656"><span 
class="aett-10x-x-109">extraconstr))</span></span>
<br /><span id="textcolor6657"><span 
class="aett-10x-x-109">s2r</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6658"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6659"><span 
class="aett-10x-x-109">as.vector</span></span><span id="textcolor6660"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6661"><span 
class="aett-10x-x-109">inla.qsample</span></span><span id="textcolor6662"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6663"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6664"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;Q2,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6665"><span 
class="aett-10x-x-109">seed</span></span><span id="textcolor6666"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6667"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6668"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6669"><span 
class="aett-10x-x-109">constr</span></span><span id="textcolor6670"><span 
class="aett-10x-x-109">=spde</span></span><span id="textcolor6671"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6672"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor6673"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6674"><span 
class="aett-10x-x-109">extraconstr))</span></span>
</div>
</div>
   </div>
<!--l. 370--><p class="indent" >   So, we have  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6675"><span 
class="aett-10x-x-109">rbind</span></span><span id="textcolor6676"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6677"><span 
class="aett-10x-x-109">s1r</span></span><span id="textcolor6678"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6679"><span 
class="aett-10x-x-109">summary</span></span><span id="textcolor6680"><span 
class="aett-10x-x-109">(s1r),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6681"><span 
class="aett-10x-x-109">s2r</span></span><span id="textcolor6682"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6683"><span 
class="aett-10x-x-109">summary</span></span><span id="textcolor6684"><span 
class="aett-10x-x-109">(s2r))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-82">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Min.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1st&#x00A0;Qu.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Median&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;3rd&#x00A0;Qu.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Max.
&#x00A0;<br />##&#x00A0;s1r&#x00A0;-0.4398902&#x00A0;-0.03011807&#x00A0;0.05297405&#x00A0;0.06406453&#x00A0;0.15705918&#x00A0;0.7764824
&#x00A0;<br />##&#x00A0;s2r&#x00A0;-0.5972559&#x00A0;-0.01839594&#x00A0;0.02173815&#x00A0;0.02401019&#x00A0;0.06044255&#x00A0;0.4819459
</div>
<!--l. 380--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor6685"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor6686"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6687"><span 
class="aett-10x-x-109">cor1</span></span><span id="textcolor6688"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6689"><span 
class="aett-10x-x-109">cor</span></span><span id="textcolor6690"><span 
class="aett-10x-x-109">(sample1,</span><span 
class="aett-10x-x-109">&#x00A0;s1r),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6691"><span 
class="aett-10x-x-109">cor2</span></span><span id="textcolor6692"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6693"><span 
class="aett-10x-x-109">cor</span></span><span id="textcolor6694"><span 
class="aett-10x-x-109">(sample2,</span><span 
class="aett-10x-x-109">&#x00A0;s2r))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-83">
##&#x00A0;cor1&#x00A0;cor2
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;&#x00A0;1
</div>
<!--l. 387--><p class="nopar" >
</p>
   </div>
where the mean of the process simulated at mesh nodes have mean near zero.
<!--l. 393--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.3.4   </span> <a 
 id="x6-540002.3.4"></a>Estimation with data simulated at the mesh nodes</h4>
<!--l. 395--><p class="noindent" >The model can be fitted easily with the data simulated at mesh nodes. Considering that we have
data exactly at each mesh node, we don&#8217;t need the use of any predictor matrix and the stack
functionality. Because we have just realizations of the random field, we don&#8217;t have noise and
need to fix the precision of the Gaussian likelihood in a high value, for example on the value <span 
class="cmmi-10x-x-109">e</span><sup><span 
class="cmr-8">20</span></sup>
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6695"><span 
class="aett-10x-x-109">clik</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6696"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6697"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor6698"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6699"><span 
class="aett-10x-x-109">hyper</span></span><span id="textcolor6700"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6701"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor6702"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6703"><span 
class="aett-10x-x-109">prec</span></span><span id="textcolor6704"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6705"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor6706"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6707"><span 
class="aett-10x-x-109">initial</span></span><span id="textcolor6708"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6709"><span 
class="aett-10x-x-109">20</span></span><span id="textcolor6710"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6711"><span 
class="aett-10x-x-109">fixed</span></span><span id="textcolor6712"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6713"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor6714"><span 
class="aett-10x-x-109">)))</span></span>
</div>
</div>
   </div>
Remember that we have a zero mean random field, so we also do not have fixed parameters to
fit. We just do  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6715"><span 
class="aett-10x-x-109">formula</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6716"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6717"><span 
class="aett-10x-x-109">y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6718"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6719"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6720"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6721"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor6722"><span 
class="aett-10x-x-109">(i,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6723"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor6724"><span 
class="aett-10x-x-109">=spde)</span></span>
<br /><span id="textcolor6725"><span 
class="aett-10x-x-109">fit1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6726"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6727"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor6728"><span 
class="aett-10x-x-109">(formula,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6729"><span 
class="aett-10x-x-109">control.family</span></span><span id="textcolor6730"><span 
class="aett-10x-x-109">=clik,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6731"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor6732"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6733"><span 
class="aett-10x-x-109">data.frame</span></span><span id="textcolor6734"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6735"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor6736"><span 
class="aett-10x-x-109">=sample1,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6737"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor6738"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6739"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6740"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor6741"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor6742"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6743"><span 
class="aett-10x-x-109">n))</span></span>
<br /><span id="textcolor6744"><span 
class="aett-10x-x-109">fit2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6745"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6746"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor6747"><span 
class="aett-10x-x-109">(formula,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6748"><span 
class="aett-10x-x-109">control.family</span></span><span id="textcolor6749"><span 
class="aett-10x-x-109">=clik,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6750"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor6751"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6752"><span 
class="aett-10x-x-109">data.frame</span></span><span id="textcolor6753"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6754"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor6755"><span 
class="aett-10x-x-109">=sample2,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6756"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor6757"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6758"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6759"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor6760"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor6761"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6762"><span 
class="aett-10x-x-109">n))</span></span>
</div>
</div>
   </div>
<!--l. 428--><p class="indent" >   We look at the summary of the posterior for <span 
class="cmmi-10x-x-109">&#x03B8; </span>(joined with the true values). For the first
sample  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6763"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor6764"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6765"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor6766"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6767"><span 
class="aett-10x-x-109">true</span></span><span id="textcolor6768"><span 
class="aett-10x-x-109">=theta1,</span><span 
class="aett-10x-x-109">&#x00A0;fit1</span></span><span id="textcolor6769"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6770"><span 
class="aett-10x-x-109">summary.hy),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6771"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor6772"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-84">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;true&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant&#x00A0;0.5quant&#x00A0;0.975quant&#x00A0;&#x00A0;&#x00A0;&#x00A0;mode
&#x00A0;<br />##&#x00A0;Theta1&#x00A0;for&#x00A0;i&#x00A0;&#x00A0;&#x00A0;-1&#x00A0;-0.9621&#x00A0;0.0289&#x00A0;&#x00A0;&#x00A0;&#x00A0;-1.0249&#x00A0;&#x00A0;-0.9594&#x00A0;&#x00A0;&#x00A0;&#x00A0;-0.9123&#x00A0;-0.9495
&#x00A0;<br />##&#x00A0;Theta2&#x00A0;for&#x00A0;i&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;1.9321&#x00A0;0.1144&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.7308&#x00A0;&#x00A0;&#x00A0;1.9228&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2.1776&#x00A0;&#x00A0;1.8893
&#x00A0;<br />##&#x00A0;Theta3&#x00A0;for&#x00A0;i&#x00A0;&#x00A0;&#x00A0;-1&#x00A0;-0.9589&#x00A0;0.0513&#x00A0;&#x00A0;&#x00A0;&#x00A0;-1.0431&#x00A0;&#x00A0;-0.9649&#x00A0;&#x00A0;&#x00A0;&#x00A0;-0.8452&#x00A0;-0.9878
</div>
<!--l. 441--><p class="nopar" >
</p>
   </div>
and for the second  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6773"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor6774"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6775"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor6776"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6777"><span 
class="aett-10x-x-109">true</span></span><span id="textcolor6778"><span 
class="aett-10x-x-109">=theta2,</span><span 
class="aett-10x-x-109">&#x00A0;fit2</span></span><span id="textcolor6779"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6780"><span 
class="aett-10x-x-109">summary.hy),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6781"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor6782"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-85">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;true&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant&#x00A0;0.5quant&#x00A0;0.975quant&#x00A0;&#x00A0;&#x00A0;&#x00A0;mode
&#x00A0;<br />##&#x00A0;Theta1&#x00A0;for&#x00A0;i&#x00A0;&#x00A0;&#x00A0;-1&#x00A0;-1.0276&#x00A0;0.0335&#x00A0;&#x00A0;&#x00A0;&#x00A0;-1.0914&#x00A0;&#x00A0;-1.0285&#x00A0;&#x00A0;&#x00A0;&#x00A0;-0.9596&#x00A0;-1.0317
&#x00A0;<br />##&#x00A0;Theta2&#x00A0;for&#x00A0;i&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;2.0957&#x00A0;0.1045&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.8758&#x00A0;&#x00A0;&#x00A0;2.1023&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2.2846&#x00A0;&#x00A0;2.1266
&#x00A0;<br />##&#x00A0;Theta3&#x00A0;for&#x00A0;i&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;1.0502&#x00A0;0.0433&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.9643&#x00A0;&#x00A0;&#x00A0;1.0504&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.1347&#x00A0;&#x00A0;1.0514
</div>
<!--l. 455--><p class="nopar" >
</p>
   </div>
We can see good results for both cases. We will see more results later.
<!--l. 461--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.3.5   </span> <a 
 id="x6-550002.3.5"></a>Estimation with locations not at the mesh nodes</h4>
<!--l. 463--><p class="noindent" >Suppose that we have the data at the locations simulated by the commands below
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6783"><span 
class="aett-10x-x-109">set.seed</span></span><span id="textcolor6784"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6785"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor6786"><span 
class="aett-10x-x-109">);</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;n</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6787"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6788"><span 
class="aett-10x-x-109">100</span></span>
<br /><span id="textcolor6789"><span 
class="aett-10x-x-109">loc</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6790"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6791"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor6792"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6793"><span 
class="aett-10x-x-109">runif</span></span><span id="textcolor6794"><span 
class="aett-10x-x-109">(n),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6795"><span 
class="aett-10x-x-109">runif</span></span><span id="textcolor6796"><span 
class="aett-10x-x-109">(n))</span></span>
</div>
</div>
   </div>
<!--l. 474--><p class="indent" >   Now, we do the projection of the simulated data from the mesh vertices to these locations.
To do it, we need a projector matrix  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6797"><span 
class="aett-10x-x-109">projloc</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6798"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6799"><span 
class="aett-10x-x-109">inla.mesh.projector</span></span><span id="textcolor6800"><span 
class="aett-10x-x-109">(mesh,</span><span 
class="aett-10x-x-109">&#x00A0;loc)</span></span>
</div>
</div>
   </div>
with  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6801"><span 
class="aett-10x-x-109">x1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6802"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6803"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor6804"><span 
class="aett-10x-x-109">(projloc,</span><span 
class="aett-10x-x-109">&#x00A0;sample1)</span></span>
<br /><span id="textcolor6805"><span 
class="aett-10x-x-109">x2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6806"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6807"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor6808"><span 
class="aett-10x-x-109">(projloc,</span><span 
class="aett-10x-x-109">&#x00A0;sample2)</span></span>
                                                                                 
                                                                                 
</div>
</div>
   </div>
and we have the sample data at these locations.
<!--l. 495--><p class="indent" >   Now, because the this locations aren&#8217;t vertices of the mesh, we need to use the stack
functionality. First, we need the predictor matrix. But this is the same used to &#8217;sample&#8217; the
data.
</p><!--l. 500--><p class="indent" >   And we define the stack for each one of the samples  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6809"><span 
class="aett-10x-x-109">stk1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6810"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6811"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor6812"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6813"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor6814"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6815"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor6816"><span 
class="aett-10x-x-109">=x1),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6817"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor6818"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6819"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor6820"><span 
class="aett-10x-x-109">(projloc</span></span><span id="textcolor6821"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6822"><span 
class="aett-10x-x-109">proj</span></span><span id="textcolor6823"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6824"><span 
class="aett-10x-x-109">A),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6825"><span 
class="aett-10x-x-109">tag</span></span><span id="textcolor6826"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6827"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">d</span><span 
class="tctt-1095">'</span></span><span id="textcolor6828"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6829"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor6830"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6831"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor6832"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6833"><span 
class="aett-10x-x-109">data.frame</span></span><span id="textcolor6834"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6835"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor6836"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6837"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6838"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor6839"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor6840"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6841"><span 
class="aett-10x-x-109">n)))</span></span>
<br /><span id="textcolor6842"><span 
class="aett-10x-x-109">stk2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6843"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6844"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor6845"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6846"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor6847"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6848"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor6849"><span 
class="aett-10x-x-109">=x2),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6850"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor6851"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6852"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor6853"><span 
class="aett-10x-x-109">(projloc</span></span><span id="textcolor6854"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6855"><span 
class="aett-10x-x-109">proj</span></span><span id="textcolor6856"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6857"><span 
class="aett-10x-x-109">A),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6858"><span 
class="aett-10x-x-109">tag</span></span><span id="textcolor6859"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6860"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">d</span><span 
class="tctt-1095">'</span></span><span id="textcolor6861"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6862"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor6863"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6864"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor6865"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6866"><span 
class="aett-10x-x-109">data.frame</span></span><span id="textcolor6867"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6868"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor6869"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6870"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor6871"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor6872"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor6873"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6874"><span 
class="aett-10x-x-109">n)))</span></span>
</div>
</div>
   </div>
<!--l. 512--><p class="indent" >   And we fit the model with  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6875"><span 
class="aett-10x-x-109">res1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6876"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6877"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor6878"><span 
class="aett-10x-x-109">(formula,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6879"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor6880"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6881"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor6882"><span 
class="aett-10x-x-109">(stk1),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6883"><span 
class="aett-10x-x-109">control.family</span></span><span id="textcolor6884"><span 
class="aett-10x-x-109">=clik,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6885"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor6886"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6887"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor6888"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6889"><span 
class="aett-10x-x-109">compute</span></span><span id="textcolor6890"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6891"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor6892"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6893"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor6894"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6895"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor6896"><span 
class="aett-10x-x-109">(stk1)))</span></span>
<br /><span id="textcolor6897"><span 
class="aett-10x-x-109">res2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6898"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6899"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor6900"><span 
class="aett-10x-x-109">(formula,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6901"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor6902"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6903"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor6904"><span 
class="aett-10x-x-109">(stk2),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6905"><span 
class="aett-10x-x-109">control.family</span></span><span id="textcolor6906"><span 
class="aett-10x-x-109">=clik,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6907"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor6908"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6909"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor6910"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6911"><span 
class="aett-10x-x-109">compute</span></span><span id="textcolor6912"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6913"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor6914"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6915"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor6916"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor6917"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor6918"><span 
class="aett-10x-x-109">(stk2)))</span></span>
</div>
</div>
   </div>
<!--l. 524--><p class="indent" >   The true and summary of marginal posterior distribution for <span 
class="cmmi-10x-x-109">&#x03B8;</span>:  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6919"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor6920"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6921"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor6922"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6923"><span 
class="aett-10x-x-109">True</span></span><span id="textcolor6924"><span 
class="aett-10x-x-109">=theta1,</span><span 
class="aett-10x-x-109">&#x00A0;res1</span></span><span id="textcolor6925"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6926"><span 
class="aett-10x-x-109">summary.hy),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6927"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor6928"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-86">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;True&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant&#x00A0;0.5quant&#x00A0;0.975quant&#x00A0;&#x00A0;&#x00A0;&#x00A0;mode
&#x00A0;<br />##&#x00A0;Theta1&#x00A0;for&#x00A0;i&#x00A0;&#x00A0;&#x00A0;-1&#x00A0;-1.0405&#x00A0;0.1811&#x00A0;&#x00A0;&#x00A0;&#x00A0;-1.4082&#x00A0;&#x00A0;-1.0354&#x00A0;&#x00A0;&#x00A0;&#x00A0;-0.6958&#x00A0;-1.0175
&#x00A0;<br />##&#x00A0;Theta2&#x00A0;for&#x00A0;i&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;2.1852&#x00A0;0.1866&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.8092&#x00A0;&#x00A0;&#x00A0;2.1888&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2.5442&#x00A0;&#x00A0;2.2019
&#x00A0;<br />##&#x00A0;Theta3&#x00A0;for&#x00A0;i&#x00A0;&#x00A0;&#x00A0;-1&#x00A0;-0.9754&#x00A0;0.2436&#x00A0;&#x00A0;&#x00A0;&#x00A0;-1.4377&#x00A0;&#x00A0;-0.9823&#x00A0;&#x00A0;&#x00A0;&#x00A0;-0.4800&#x00A0;-1.0072
</div>
<!--l. 536--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor6929"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor6930"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6931"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor6932"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6933"><span 
class="aett-10x-x-109">True</span></span><span id="textcolor6934"><span 
class="aett-10x-x-109">=theta2,</span><span 
class="aett-10x-x-109">&#x00A0;res2</span></span><span id="textcolor6935"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6936"><span 
class="aett-10x-x-109">summary.hy),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6937"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor6938"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-87">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;True&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant&#x00A0;0.5quant&#x00A0;0.975quant&#x00A0;&#x00A0;&#x00A0;&#x00A0;mode
&#x00A0;<br />##&#x00A0;Theta1&#x00A0;for&#x00A0;i&#x00A0;&#x00A0;&#x00A0;-1&#x00A0;-0.9717&#x00A0;0.1758&#x00A0;&#x00A0;&#x00A0;&#x00A0;-1.3157&#x00A0;&#x00A0;-0.9727&#x00A0;&#x00A0;&#x00A0;&#x00A0;-0.6232&#x00A0;-0.9761
&#x00A0;<br />##&#x00A0;Theta2&#x00A0;for&#x00A0;i&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;2.1779&#x00A0;0.1880&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.7958&#x00A0;&#x00A0;&#x00A0;2.1835&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2.5349&#x00A0;&#x00A0;2.2031
&#x00A0;<br />##&#x00A0;Theta3&#x00A0;for&#x00A0;i&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;0.9291&#x00A0;0.2384&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.4592&#x00A0;&#x00A0;&#x00A0;0.9298&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.3959&#x00A0;&#x00A0;0.9326
</div>
<!--l. 545--><p class="nopar" >
</p>
   </div>
<!--l. 549--><p class="indent" >   To make the visualization more good, we take the logarithm of the variance.  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6939"><span 
class="aett-10x-x-109">x1.mean</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6940"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6941"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor6942"><span 
class="aett-10x-x-109">(proj,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6943"><span 
class="aett-10x-x-109">field</span></span><span id="textcolor6944"><span 
class="aett-10x-x-109">=res1</span></span><span id="textcolor6945"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6946"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor6947"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6948"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor6949"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6950"><span 
class="aett-10x-x-109">mean)</span></span>
<br /><span id="textcolor6951"><span 
class="aett-10x-x-109">x1.var</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6952"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6953"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor6954"><span 
class="aett-10x-x-109">(proj,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6955"><span 
class="aett-10x-x-109">field</span></span><span id="textcolor6956"><span 
class="aett-10x-x-109">=res1</span></span><span id="textcolor6957"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6958"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor6959"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6960"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor6961"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6962"><span 
class="aett-10x-x-109">sd</span></span><span id="textcolor6963"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor6964"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor6965"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor6966"><span 
class="aett-10x-x-109">x2.mean</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6967"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6968"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor6969"><span 
class="aett-10x-x-109">(proj,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6970"><span 
class="aett-10x-x-109">field</span></span><span id="textcolor6971"><span 
class="aett-10x-x-109">=res2</span></span><span id="textcolor6972"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6973"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor6974"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6975"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor6976"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6977"><span 
class="aett-10x-x-109">mean)</span></span>
<br /><span id="textcolor6978"><span 
class="aett-10x-x-109">x2.var</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6979"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6980"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor6981"><span 
class="aett-10x-x-109">(proj,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6982"><span 
class="aett-10x-x-109">field</span></span><span id="textcolor6983"><span 
class="aett-10x-x-109">=res2</span></span><span id="textcolor6984"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6985"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor6986"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6987"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor6988"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor6989"><span 
class="aett-10x-x-109">sd</span></span><span id="textcolor6990"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor6991"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor6992"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<!--l. 562--><p class="indent" >   We visualize, for both random fields, the simulated, the predicted (posterior mean) and the
posterior variance in Figure&#x00A0;<a 
href="#x6-550002.3.5">2.3.5<!--tex4ht:ref: fig:visprojp --></a> with commands below  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor6993"><span 
class="aett-10x-x-109">do.call</span></span><span id="textcolor6994"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6995"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor6996"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor6997"><span 
class="aett-10x-x-109">...</span></span><span id="textcolor6998"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor6999"><span 
class="aett-10x-x-109">grid.arrange</span></span><span id="textcolor7000"><span 
class="aett-10x-x-109">(...,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor7001"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor7002"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor7003"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor7004"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor7005"><span 
class="aett-10x-x-109">lapply</span></span><span id="textcolor7006"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor7007"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor7008"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor7009"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor7010"><span 
class="aett-10x-x-109">(proj,</span><span 
class="aett-10x-x-109">&#x00A0;sample1),</span><span 
class="aett-10x-x-109">&#x00A0;x1.mean,</span><span 
class="aett-10x-x-109">&#x00A0;x1.var,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor7011"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor7012"><span 
class="aett-10x-x-109">(proj,</span><span 
class="aett-10x-x-109">&#x00A0;sample2),</span><span 
class="aett-10x-x-109">&#x00A0;x2.mean,</span><span 
class="aett-10x-x-109">&#x00A0;x2.var),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor7013"><span 
class="aett-10x-x-109">levelplot,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor7014"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor7015"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor7016"><span 
class="tctt-1095">''</span></span><span id="textcolor7017"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor7018"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor7019"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor7020"><span 
class="tctt-1095">''</span></span><span id="textcolor7021"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor7022"><span 
class="aett-10x-x-109">col.regions</span></span><span id="textcolor7023"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor7024"><span 
class="aett-10x-x-109">topo.colors</span></span><span id="textcolor7025"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor7026"><span 
class="aett-10x-x-109">100</span></span><span id="textcolor7027"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor7028"><span 
class="aett-10x-x-109">scale</span></span><span id="textcolor7029"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor7030"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor7031"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor7032"><span 
class="aett-10x-x-109">draw</span></span><span id="textcolor7033"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor7034"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor7035"><span 
class="aett-10x-x-109">)))</span></span>
</div>
</div>
   </div>
<hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x6-550018"></a>
                                                                                 
                                                                                 
<!--l. 580--><p class="noindent" ><img 
src="spde-tutorial53x.png" alt="PIC" class="graphics" width="426" height="213"  /><!--tex4ht:graphics  
name="spde-tutorial53x.png" src="figs/nonstationarfvisprojp-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;2.8: </span><span  
class="content">Simulated (top and bottom left), posterior mean (top and bottom mid) and
the posterior variance (top and bottom right) for both random fields.</span></div><!--tex4ht:label?: x6-550018 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 589--><p class="indent" >   We see in the Figure&#x00A0;<a 
href="#x6-550002.3.5">2.3.5<!--tex4ht:ref: fig:visprojp --></a> that the predicted values are similar to the simulated ones. Also,
we see that the posterior variance of the first model increase near 0.5 for the first coordinate.
And we see the opposite for the second random field. Also, we see that the variance of the first is
greater than the second.
                                                                                 
                                                                                 
</p>
   <!--l. 121--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialch3.html" >next</a>] [<a 
href="spde-tutorialch1.html" >prev</a>] [<a 
href="spde-tutorialch1.html#tailspde-tutorialch1.html" >prev-tail</a>] [<a 
href="spde-tutorialch2.html" >front</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch2.html" >up</a>] </p></div>
<!--l. 121--><p class="indent" >   <a 
 id="tailspde-tutorialch2.html"></a>   </p> 
</body></html> 
