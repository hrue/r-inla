<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>13 Point process: inference for the log-Cox process</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- xhtml,html,frames,2 --> 
<meta name="src" content="spde-tutorial.tex" /> 
<meta name="date" content="2017-01-22 14:18:00" /> 
<link rel="stylesheet" type="text/css" href="spde-tutorial.css" /> 
</head><body 
>
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialch14.html" >next</a>] [<a 
href="spde-tutorialch12.html" >prev</a>] [<a 
href="spde-tutorialch12.html#tailspde-tutorialch12.html" >prev-tail</a>] [<a 
href="#tailspde-tutorialch13.html">tail</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch13.html" >up</a>] </p></div>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;13</span><br /><a 
 id="x17-8300013"></a>Point process: inference for the log-Cox process</h2>
<!--l. 5--><p class="noindent" >Under the log-Cox model assumption, there is a latent Gaussian Random Field (LGRF) and the
inference can be done using <span 
class="aessbx-10x-x-109">INLA </span><span class="cite">[<a 
href="spde-tutorialli2.html#Xillianetal:2012">Illian et&#x00A0;al., 2012</a>]</span>.
</p><!--l. 10--><p class="indent" >   A common aproach to fit the log-Cox process is to divide the study region into cells, that
forms a lattice, and count the number of points into each one. This counts are modeled using the
Poisson likelihood.
</p><!--l. 15--><p class="indent" >   A good approach for inference of log-Cox model is to use the SPDE approach instead
occurence counts on cells, <span class="cite">[<a 
href="spde-tutorialli2.html#Xsimpsonetal:2011">Simpson et&#x00A0;al., 2011</a>]</span>. There are the main advantages on this
approach the consideration of the loc-Cox likelihood directly.
</p>
   <h3 class="sectionHead"><span class="titlemark">13.1   </span> <a 
 id="x17-8400013.1"></a>Data simulation</h3>
<!--l. 23--><p class="noindent" >The data simulated on this section is used also on the Chapter&#x00A0;<span 
class="aebx-10x-x-109">??</span>.
</p><!--l. 26--><p class="indent" >   In this section we use the <span 
class="aett-10x-x-109">rLGCP() </span>function from <span 
class="aessbx-10x-x-109">spatstat </span>package to do the simulation. By
default that function do simulation on window over the <span 
class="cmr-10x-x-109">(0</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmr-10x-x-109">1) </span><span 
class="cmsy-10x-x-109">&#x00D7; </span><span 
class="cmr-10x-x-109">(0</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmr-10x-x-109">1) </span>square. We choose to do
simulation over the <span 
class="cmr-10x-x-109">(0</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmr-10x-x-109">3) </span><span 
class="cmsy-10x-x-109">&#x00D7; </span><span 
class="cmr-10x-x-109">(0</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmr-10x-x-109">3) </span>square.
</p>
   <div class="fancyvrb" id="fancyvrb551"><a 
 id="x17-84002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;require(spatstat)</span><br class="fancyvrb" /><a 
 id="x17-84004r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;win</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;owin(c(0,3),</span><span 
class="aesltt-10x-x-109">&#x00A0;c(0,3))</span></div>
<!--l. 39--><p class="indent" >   This function uses the <span 
class="aett-10x-x-109">GaussRF() </span>function from the <span 
class="aessbx-10x-x-109">RandomFields </span>package. The <span 
class="aett-10x-x-109">rLGCP </span>uses
the <span 
class="aett-10x-x-109">GaussRF() </span>function to do simulation of the LGRF over a grid on the provided window and
use it to do the point process simulation.
</p><!--l. 45--><p class="indent" >   There is an internal parameter to control the resolution of the grid. We change it
to
</p>
   <div class="fancyvrb" id="fancyvrb552"><a 
 id="x17-84006r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;spatstat.options(npixel=300)</span></div>
<!--l. 53--><p class="indent" >   First we define the model parameter for the model is the mean of the LGRF. This is directly
related to expected number of points of the spatial pattern. The expected number of points is its
exponential times the area fo the window. We use
</p>
   <div class="fancyvrb" id="fancyvrb553"><a 
 id="x17-84008r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;beta0</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;3</span></div>
<!--l. 65--><p class="noindent" >So, the expected number of points is
</p>
   <div class="fancyvrb" id="fancyvrb554"><a 
 id="x17-84010r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;exp(beta0)</span><span 
class="aesltt-10x-x-109">&#x00A0;*</span><span 
class="aesltt-10x-x-109">&#x00A0;diff(range(win$x))</span><span 
class="aesltt-10x-x-109">&#x00A0;*</span><span 
class="aesltt-10x-x-109">&#x00A0;diff(range(win$y))</span></div>
<!--l. 70--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb555"><a 
 id="x17-84012r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;180.7698</span></div>
<!--l. 74--><p class="noindent" >Is also possible to use a functional, see Chapter&#x00A0;<span 
class="aebx-10x-x-109">??</span>.
</p><!--l. 76--><p class="indent" >   In the estimation process we use the Matern covariance function with <span 
class="cmmi-10x-x-109">&#x03BD; </span><span 
class="cmr-10x-x-109">= 1</span>. So, here we just
fix it on this value. The other parameters are the variance and scale
</p>
   <div class="fancyvrb" id="fancyvrb556"><a 
 id="x17-84014r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;sigma2x</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;0.2;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;kappa</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;2</span></div>
<!--l. 86--><p class="indent" >   Doing the simulation
                                                                                 
                                                                                 
</p>
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialch14.html" >next</a>] [<a 
href="spde-tutorialch12.html" >prev</a>] [<a 
href="spde-tutorialch12.html#tailspde-tutorialch12.html" >prev-tail</a>] [<a 
href="spde-tutorialch13.html" >front</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch13.html" >up</a>] </p></div>
<!--l. 1--><p class="indent" >   <a 
 id="tailspde-tutorialch13.html"></a>  </p> 
</body></html> 
