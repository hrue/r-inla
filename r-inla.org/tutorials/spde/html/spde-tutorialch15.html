<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>15 Dynamic regression example</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- xhtml,html,frames,2 --> 
<meta name="src" content="spde-tutorial.tex" /> 
<meta name="date" content="2017-01-22 14:18:00" /> 
<link rel="stylesheet" type="text/css" href="spde-tutorial.css" /> 
</head><body 
>
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialch16.html" >next</a>] [<a 
href="spde-tutorialch14.html" >prev</a>] [<a 
href="spde-tutorialch14.html#tailspde-tutorialch14.html" >prev-tail</a>] [<a 
href="#tailspde-tutorialch15.html">tail</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch15.html" >up</a>] </p></div>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;15</span><br /><a 
 id="x19-9000015"></a>Dynamic regression example</h2>
<!--l. 5--><p class="noindent" >There is a large literature about dynamic models with also some books about it, from <span class="cite">[<a 
href="spde-tutorialli2.html#XwestH:1997">West and
Harrison, 1997</a>]</span> to <span class="cite">[<a 
href="spde-tutorialli2.html#XPetrisPC:2009">Petris et&#x00A0;al., 2009</a>]</span>. These models basically defines an hierarchical framework
for a class of time series models. A particular case is the dynamic regression model, were the
regression coefficients are modeled as time series. That is the case when the regression
coefficients vary smoothly over time.
</p>
   <h3 class="sectionHead"><span class="titlemark">15.1   </span> <a 
 id="x19-9100015.1"></a>Dynamic space-time regression</h3>
<!--l. 17--><p class="noindent" >The specific class of models for spatially structured time series was proposed by <span class="cite">[<a 
href="spde-tutorialli2.html#XgelfandKSB:2003">Gelfand et&#x00A0;al.,
2003</a>]</span>, where the regression coefficients varies smoothly over time and space. For the
areal data case, the use of proper Gaussian Markov random fields (PGMRF) over
space as proposed by <span class="cite">[<a 
href="spde-tutorialli2.html#XvivarF:2009">Vivar and Ferreira, 2009</a>]</span>. There exists a particular class of such
models called &#8220;spatially varying coefficient models&#8221; were the regression coefficients
veries over space, <span class="cite">[<a 
href="spde-tutorialli2.html#XassuncaoGA:1999">Assunção et&#x00A0;al., 1999</a>]</span>, <span class="cite">[<a 
href="spde-tutorialli2.html#XassuncaoPC:2002">Assunção et&#x00A0;al., 2002</a>]</span>, <span class="cite">[<a 
href="spde-tutorialli2.html#XgamermanMR:2003">Gamerman et&#x00A0;al.,
2003</a>]</span>.
</p><!--l. 27--><p class="indent" >   In <span class="cite">[<a 
href="spde-tutorialli2.html#XgelfandKSB:2003">Gelfand et&#x00A0;al., 2003</a>]</span> the Gibbs sampler were used for inference and it was claimed that
better algorithms is needed due to strong autocorrelations. In <span class="cite">[<a 
href="spde-tutorialli2.html#XvivarF:2009">Vivar and Ferreira, 2009</a>]</span> the use
of forward information filtering and backward sampling (FIFBS) recursions were proposed. Both
MCMC algorithms are computationally expensive.
</p><!--l. 33--><p class="indent" >   One can avoid the FFBS algorithm as a relation between the Kalman-filter and the Cholesky
factorization is provided in <span class="cite">[<a 
href="spde-tutorialli2.html#XknorrheldR:2002">Knorr-Held and Rue, 2002</a>]</span>. The Cholesky fator is more general and
has superior performance when using sparse matrix methods, <span class="cite">[<a 
href="spde-tutorialli2.html#XRueHeld:2005">Rue and Held, 2005</a>, p. 149]</span>.
Additionally, the restriction that the prior for the latent field has to be proper can be
avoided.
</p><!--l. 39--><p class="indent" >   When the likelihood is Gaussian, there is no approximation needed in the inference process
since the distribution of the latent field given the data and the hyperparameters is Gaussian.
So, the main task is to perform inference for the hyperparameters in the model. For
this, the mode and curvature around can be found without any sampling method.
For the class of models in&#x00A0;<span class="cite">[<a 
href="spde-tutorialli2.html#XvivarF:2009">Vivar and Ferreira, 2009</a>]</span> it is natural to use INLA, as
shown in <span class="cite">[<a 
href="spde-tutorialli2.html#XcardenasKR:2012">Ruiz-Cárdenas et&#x00A0;al., 2012</a>]</span>, and for the models in&#x00A0;<span class="cite">[<a 
href="spde-tutorialli2.html#XgelfandKSB:2003">Gelfand et&#x00A0;al., 2003</a>]</span> we
can use the SPDE approach when considering the Matérn covariance for the spatial
part.
</p><!--l. 47--><p class="indent" >   In this section we show how to fit the space-time dynamic regression model as in <span class="cite">[<a 
href="spde-tutorialli2.html#XgelfandKSB:2003">Gelfand
et&#x00A0;al., 2003</a>]</span>, considering the Matérn spatial covariance and the AR(1) model for time which
corresponds to the exponential correlation function. This particular covariance choise correspond
to the model in <span class="cite">[<a 
href="spde-tutorialli2.html#Xcameletti:2012">Cameletti et&#x00A0;al., 2012</a>]</span>, where only the intercept is dynamic. Here, we show the
case when we have a dynamic intercept and a dynamic regression coefficient for an harmonic
over time.
</p><!--l. 55--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">15.2   </span> <a 
 id="x19-9200015.2"></a>Simulation from the model</h3>
<!--l. 57--><p class="noindent" >We can start on defining the spatial locations:
</p>
   <div class="fancyvrb" id="fancyvrb614"><a 
 id="x19-92002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;n</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;100;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;set.seed(1);</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;coo</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;matrix(runif(2*n),</span><span 
class="aesltt-10x-x-109">&#x00A0;n)</span></div>
<!--l. 64--><p class="indent" >   To sample from a random field on a set of location, we use the following function
                                                                                 
                                                                                 
</p>
   <div class="fancyvrb" id="fancyvrb615"><a 
 id="x19-92004r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;rrf</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;function(n,</span><span 
class="aesltt-10x-x-109">&#x00A0;coords,</span><span 
class="aesltt-10x-x-109">&#x00A0;kappa,</span><span 
class="aesltt-10x-x-109">&#x00A0;variance,</span><span 
class="aesltt-10x-x-109">&#x00A0;nu=1)</span><span 
class="aesltt-10x-x-109">&#x00A0;{</span>
<br class="fancyvrb" /><a 
 id="x19-92006r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;m</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;as.matrix(dist(coords))</span><br class="fancyvrb" /><a 
 id="x19-92008r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;m</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;exp((1-nu)*log(2)</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;nu*log(kappa*m)-</span>
<br class="fancyvrb" /><a 
 id="x19-92010r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;lgamma(nu))*besselK(m*kappa,</span><span 
class="aesltt-10x-x-109">&#x00A0;nu)</span><br class="fancyvrb" /><a 
 id="x19-92012r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;diag(m)</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;1</span>
<br class="fancyvrb" /><a 
 id="x19-92014r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;crossprod(chol(variance*m),</span><br class="fancyvrb" /><a 
 id="x19-92016r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;matrix(rnorm(nrow(coords)*n),</span><span 
class="aesltt-10x-x-109">&#x00A0;ncol=n))</span><br class="fancyvrb" /><a 
 id="x19-92018r8"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;}</span></div>
<!--l. 79--><p class="indent" >   We use the above function to draw <span 
class="cmmi-10x-x-109">k </span>(number of time points) samples from the random field.
Then, we make it temporally correlated considering the time autoregression
</p>
   <div class="fancyvrb" id="fancyvrb616"><a 
 id="x19-92020r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;kappa</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;c(10,</span><span 
class="aesltt-10x-x-109">&#x00A0;12);</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;sigma2</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;c(1/2,</span><span 
class="aesltt-10x-x-109">&#x00A0;1/4)</span><br class="fancyvrb" /><a 
 id="x19-92022r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;k</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;15;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;rho</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;c(0.7,</span><span 
class="aesltt-10x-x-109">&#x00A0;0.5)</span>
<br class="fancyvrb" /><a 
 id="x19-92024r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;set.seed(2);</span><span 
class="aesltt-10x-x-109">&#x00A0;beta0</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;rrf(k,</span><span 
class="aesltt-10x-x-109">&#x00A0;coo,</span><span 
class="aesltt-10x-x-109">&#x00A0;kappa[1],</span><span 
class="aesltt-10x-x-109">&#x00A0;sigma2[1])</span>
<br class="fancyvrb" /><a 
 id="x19-92026r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;set.seed(3);</span><span 
class="aesltt-10x-x-109">&#x00A0;beta1</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;rrf(k,</span><span 
class="aesltt-10x-x-109">&#x00A0;coo,</span><span 
class="aesltt-10x-x-109">&#x00A0;kappa[2],</span><span 
class="aesltt-10x-x-109">&#x00A0;sigma2[2])</span>
<br class="fancyvrb" /><a 
 id="x19-92028r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;beta0[,1]</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;beta0[,1]</span><span 
class="aesltt-10x-x-109">&#x00A0;/</span><span 
class="aesltt-10x-x-109">&#x00A0;(1-rho[1]^2)</span><br class="fancyvrb" /><a 
 id="x19-92030r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;beta1[,1]</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;beta1[,1]</span><span 
class="aesltt-10x-x-109">&#x00A0;/</span><span 
class="aesltt-10x-x-109">&#x00A0;(1-rho[2]^2)</span>
<br class="fancyvrb" /><a 
 id="x19-92032r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;for</span><span 
class="aesltt-10x-x-109">&#x00A0;(j</span><span 
class="aesltt-10x-x-109">&#x00A0;in</span><span 
class="aesltt-10x-x-109">&#x00A0;2:k)</span><span 
class="aesltt-10x-x-109">&#x00A0;{</span><br class="fancyvrb" /><a 
 id="x19-92034r8"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;beta0[,</span><span 
class="aesltt-10x-x-109">&#x00A0;j]</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;beta0[,j-1]*rho[1]</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;beta0[,j]</span><span 
class="aesltt-10x-x-109">&#x00A0;*</span><span 
class="aesltt-10x-x-109">&#x00A0;(1-rho[1]^2)</span>
<br class="fancyvrb" /><a 
 id="x19-92036r9"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;beta1[,</span><span 
class="aesltt-10x-x-109">&#x00A0;j]</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;beta1[,j-1]*rho[2]</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;beta1[,j]</span><span 
class="aesltt-10x-x-109">&#x00A0;*</span><span 
class="aesltt-10x-x-109">&#x00A0;(1-rho[2]^2)</span><br class="fancyvrb" /><a 
 id="x19-92038r10"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;}</span></div>
<!--l. 95--><p class="noindent" >where the <span 
class="cmr-10x-x-109">(1 </span><span 
class="cmsy-10x-x-109">- </span><span 
class="cmmi-10x-x-109">&#x03C1;</span><sub><span 
class="cmmi-8">j</span></sub><sup><span 
class="cmr-8">2</span></sup><span 
class="cmr-10x-x-109">) </span>term is in accord to the parametrization of the AR(<span 
class="cmr-10x-x-109">1</span>) model in INLA.
</p><!--l. 98--><p class="indent" >   To get the response, we define the harmonic as a function over time, compute the mean and
add an error term
</p>
   <div class="fancyvrb" id="fancyvrb617"><a 
 id="x19-92040r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;set.seed(4);</span><span 
class="aesltt-10x-x-109">&#x00A0;hh</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;runif(n*k)</span><span 
class="aesltt-10x-x-109">&#x00A0;###</span><span 
class="aesltt-10x-x-109">&#x00A0;simlate</span><span 
class="aesltt-10x-x-109">&#x00A0;the</span><span 
class="aesltt-10x-x-109">&#x00A0;covariate</span><span 
class="aesltt-10x-x-109">&#x00A0;values</span><br class="fancyvrb" /><a 
 id="x19-92042r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;mu.beta</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;c(-5,</span><span 
class="aesltt-10x-x-109">&#x00A0;1);</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;taue</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;20</span>
<br class="fancyvrb" /><a 
 id="x19-92044r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;set.seed(5);</span><span 
class="aesltt-10x-x-109">&#x00A0;error</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;rnorm(n*k,</span><span 
class="aesltt-10x-x-109">&#x00A0;0,</span><span 
class="aesltt-10x-x-109">&#x00A0;sqrt(1/taue))</span><span 
class="aesltt-10x-x-109">&#x00A0;###</span><span 
class="aesltt-10x-x-109">&#x00A0;error</span><span 
class="aesltt-10x-x-109">&#x00A0;in</span><span 
class="aesltt-10x-x-109">&#x00A0;the</span><span 
class="aesltt-10x-x-109">&#x00A0;observation</span>
<br class="fancyvrb" /><a 
 id="x19-92046r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;length(y</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;(mu.beta[1]</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;beta0)</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;(mu.beta[2]+beta1)*hh</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;###</span><span 
class="aesltt-10x-x-109">&#x00A0;dynamic</span><span 
class="aesltt-10x-x-109">&#x00A0;regression</span><span 
class="aesltt-10x-x-109">&#x00A0;part</span>
<br class="fancyvrb" /><a 
 id="x19-92048r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;error)</span></div>
<!--l. 108--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb618"><a 
 id="x19-92050r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;1500</span></div>
<!--l. 113--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">15.3   </span> <a 
 id="x19-9300015.3"></a>Fitting the model</h3>
<!--l. 115--><p class="noindent" >We have two space-time terms on the model, each one with three hyperparameters: precision,
spatial scale, temporal scale (or temporal correlation). So, considering the likelihood, <span 
class="cmr-10x-x-109">7</span>
hyperparameters in total. To perform fast inference, we choose to have a crude mesh with with
small number of vertices.
</p>
   <div class="fancyvrb" id="fancyvrb619"><a 
 id="x19-93002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;(mesh</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.2d(coo,</span><span 
class="aesltt-10x-x-109">&#x00A0;max.edge=c(0.2,</span><span 
class="aesltt-10x-x-109">&#x00A0;0.4),</span><span 
class="aesltt-10x-x-109">&#x00A0;###</span><span 
class="aesltt-10x-x-109">&#x00A0;coarse</span><span 
class="aesltt-10x-x-109">&#x00A0;mesh</span>
<br class="fancyvrb" /><a 
 id="x19-93004r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;offset=c(0.05,</span><span 
class="aesltt-10x-x-109">&#x00A0;0.4),</span><span 
class="aesltt-10x-x-109">&#x00A0;cutoff=0.1))$n</span></div>
<!--l. 126--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb620"><a 
 id="x19-93006r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;132</span></div>
<!--l. 129--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb621"><a 
 id="x19-93008r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;spde</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde2.matern(mesh)</span></div>
<!--l. 134--><p class="indent" >   We do need one set of index for each call of the <span 
class="aett-10x-x-109">f() </span>function, no matter if they are the same,
so:
                                                                                 
                                                                                 
</p>
   <div class="fancyvrb" id="fancyvrb622"><a 
 id="x19-93010r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;i0</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde.make.index(</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">i0</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;spde$n.spde,</span><span 
class="aesltt-10x-x-109">&#x00A0;n.group=k)</span>
<br class="fancyvrb" /><a 
 id="x19-93012r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;i1</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde.make.index(</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">i1</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;spde$n.spde,</span><span 
class="aesltt-10x-x-109">&#x00A0;n.group=k)</span></div>
<!--l. 143--><p class="indent" >   In the SPDE approach, the space-time model is defined in a set of mesh nodes. As we have
considered continuous time, it is also defined on a set of time knots. So, we have to deal with the
projection from the model domain (nodes, knots) to the space-time data locations. For the
intercept it is the same way as in the other examples. For the regression coefficients, we need to
account for the covariate value in the projection matrix. It can be seen as follows
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="spde-tutorial103x.png" alt="&#x03B7;  =   &#x03BC;&#x03B2;0 + &#x03BC; &#x03B2;2h + A &#x03B2;0 + (A &#x03B2;1)h
   =   &#x03BC;&#x03B2;0 + &#x03BC; &#x03B2;1h + A &#x03B2;0 + (A &#x2295; (h1 &#x2032;))&#x03B2;1               (15.1)
" class="math-display"  /><a 
 id="x19-93013r15.1"></a></center>
</div>where <span 
class="cmmib-10x-x-109">A</span><span 
class="cmsy-10x-x-109">&#x2295; </span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmib-10x-x-109">h</span><span 
class="cmbx-10x-x-109">1</span><sup><span 
class="cmsy-8">&#x2032;</span></sup><span 
class="cmr-10x-x-109">) </span>is the row-wise Kronecker product between <span 
class="cmmib-10x-x-109">A </span>and a the vector <span 
class="cmmib-10x-x-109">h </span>(with
length equal the number of rows in <span 
class="cmmib-10x-x-109">A</span>) expressed as the Kronecker sum of <span 
class="cmmib-10x-x-109">A </span>and <span 
class="cmmib-10x-x-109">h</span><span 
class="cmbx-10x-x-109">1</span><sup><span 
class="cmr-8">1</span></sup>.
This operation can be performed usind the <span 
class="aett-10x-x-109">inla.row.kron() </span>function and is done
internally in the function <span 
class="aett-10x-x-109">inla.spde.make.A() </span>when supplying a vector in the <span 
class="aett-10x-x-109">weights</span>
argument.
<!--l. 164--><p class="indent" >   The space-time projector matrix <span 
class="cmmib-10x-x-109">A </span>is defined as follows:
</p>
   <div class="fancyvrb" id="fancyvrb623"><a 
 id="x19-93015r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;A0</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde.make.A(mesh,</span><span 
class="aesltt-10x-x-109">&#x00A0;cbind(rep(coo[,1],</span><span 
class="aesltt-10x-x-109">&#x00A0;k),</span><span 
class="aesltt-10x-x-109">&#x00A0;rep(coo[,2],</span><span 
class="aesltt-10x-x-109">&#x00A0;k)),</span>
<br class="fancyvrb" /><a 
 id="x19-93017r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;group=rep(1:k,</span><span 
class="aesltt-10x-x-109">&#x00A0;each=n))</span>
<br class="fancyvrb" /><a 
 id="x19-93019r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;A1</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde.make.A(mesh,</span><span 
class="aesltt-10x-x-109">&#x00A0;cbind(rep(coo[,1],</span><span 
class="aesltt-10x-x-109">&#x00A0;k),</span><span 
class="aesltt-10x-x-109">&#x00A0;rep(coo[,2],</span><span 
class="aesltt-10x-x-109">&#x00A0;k)),</span>
<br class="fancyvrb" /><a 
 id="x19-93021r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;group=rep(1:k,</span><span 
class="aesltt-10x-x-109">&#x00A0;each=n),</span><span 
class="aesltt-10x-x-109">&#x00A0;weights=hh)</span></div>
<!--l. 174--><p class="indent" >   The data stack is as follows
</p>
   <div class="fancyvrb" id="fancyvrb624"><a 
 id="x19-93023r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stk.y</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(data=list(y=as.vector(y)),</span><span 
class="aesltt-10x-x-109">&#x00A0;tag=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">y</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x19-93025r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;A=list(A0,</span><span 
class="aesltt-10x-x-109">&#x00A0;A1,</span><span 
class="aesltt-10x-x-109">&#x00A0;1),</span><br class="fancyvrb" /><a 
 id="x19-93027r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;effects=list(i0,</span><span 
class="aesltt-10x-x-109">&#x00A0;i1,</span>
<br class="fancyvrb" /><a 
 id="x19-93029r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data.frame(mu1=1,</span><span 
class="aesltt-10x-x-109">&#x00A0;h=hh)))</span></div>
<!--l. 183--><p class="noindent" >where <span 
class="aett-10x-x-109">i0 </span>is similar to <span 
class="aett-10x-x-109">i1 </span>and the elements <span 
class="aett-10x-x-109">mu1 </span>and <span 
class="aett-10x-x-109">h </span>in the second element of the effects
<span 
class="aett-10x-x-109">data.frame </span>is for <span 
class="cmmib-10x-x-109">&#x03BC;</span><sub><span 
class="cmmi-8">&#x03BE;</span></sub>.
</p><!--l. 186--><p class="indent" >   The formula take these things into account
</p>
   <div class="fancyvrb" id="fancyvrb625"><a 
 id="x19-93031r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;form</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;y</span><span 
class="aesltt-10x-x-109">&#x00A0;~</span><span 
class="aesltt-10x-x-109">&#x00A0;0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;mu1</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;h</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;###</span><span 
class="aesltt-10x-x-109">&#x00A0;to</span><span 
class="aesltt-10x-x-109">&#x00A0;fit</span><span 
class="aesltt-10x-x-109">&#x00A0;mu_beta</span>
<br class="fancyvrb" /><a 
 id="x19-93033r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;f(i0,</span><span 
class="aesltt-10x-x-109">&#x00A0;model=spde,</span><span 
class="aesltt-10x-x-109">&#x00A0;group=i0.group,</span><span 
class="aesltt-10x-x-109">&#x00A0;control.group=list(model=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">ar1</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">))</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span>
<br class="fancyvrb" /><a 
 id="x19-93035r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;f(i1,</span><span 
class="aesltt-10x-x-109">&#x00A0;model=spde,</span><span 
class="aesltt-10x-x-109">&#x00A0;group=i1.group,</span><span 
class="aesltt-10x-x-109">&#x00A0;control.group=list(model=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">ar1</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">))</span></div>
<!--l. 195--><p class="indent" >   As we have Gaussian likelihood there is no approximation in the fitting process. The first
step of the INLA algorithm is the optimization to find the mode of the <span 
class="cmr-10x-x-109">7 </span>hyperparameters in the
model. By choosing good starting values it will be needed less iteractions in this optimization
process. Below, we define starting values for the hyperparameters in the internal scale
considering the values used to simute the data
                                                                                 
                                                                                 
</p>
   <div class="fancyvrb" id="fancyvrb626"><a 
 id="x19-93037r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;(theta.ini</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;c(log(taue),</span><br class="fancyvrb" /><a 
 id="x19-93039r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;-log(4*pi*sigma2[1]*kappa[1]^2)/2,</span><span 
class="aesltt-10x-x-109">&#x00A0;log(kappa[1]),</span>
<br class="fancyvrb" /><a 
 id="x19-93041r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;log((1+rho[1])/(1-rho[1])),</span>
<br class="fancyvrb" /><a 
 id="x19-93043r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;-log(4*pi*sigma2[2]*kappa[2]^2)/2,</span><span 
class="aesltt-10x-x-109">&#x00A0;log(kappa[2]),</span>
<br class="fancyvrb" /><a 
 id="x19-93045r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;log((1+rho[2])/(1-rho[2]))))</span></div>
<!--l. 207--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb627"><a 
 id="x19-93047r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.995732</span><span 
class="aett-10x-x-109">&#x00A0;-3.221524</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.302585</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.734601</span><span 
class="aett-10x-x-109">&#x00A0;-3.057272</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.484907</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.098612</span></div>
<!--l. 211--><p class="noindent" >This step takes around few minutes to fit, and with bigger <span 
class="aett-10x-x-109">tolerance </span>value in <span 
class="aett-10x-x-109">inla.control</span>, it will
makes fewer posterior evaluations.
</p><!--l. 215--><p class="indent" >   The integration step when using the CCD strategy, will integrates over 79 hyperparameter
configurations, as we have <span 
class="cmr-10x-x-109">7 </span>hyperparameters. However, in the following <span 
class="aett-10x-x-109">inla() </span>call we avoid
it.
</p><!--l. 219--><p class="indent" >   Fitting the model considering the initial values defined above
</p>
   <div class="fancyvrb" id="fancyvrb628"><a 
 id="x19-93049r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;(res</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla(form,</span><span 
class="aesltt-10x-x-109">&#x00A0;family=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">gaussian</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;data=inla.stack.data(stk.y),</span>
<br class="fancyvrb" /><a 
 id="x19-93051r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;control.predictor=list(A=inla.stack.A(stk.y)),</span>
<br class="fancyvrb" /><a 
 id="x19-93053r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;control.inla=list(int.strategy=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">eb</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;###</span><span 
class="aesltt-10x-x-109">&#x00A0;no</span><span 
class="aesltt-10x-x-109">&#x00A0;integration</span><span 
class="aesltt-10x-x-109">&#x00A0;wr</span><span 
class="aesltt-10x-x-109">&#x00A0;theta</span>
<br class="fancyvrb" /><a 
 id="x19-93055r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;tolerance=0.1),</span><span 
class="aesltt-10x-x-109">&#x00A0;###</span><span 
class="aesltt-10x-x-109">&#x00A0;not</span><span 
class="aesltt-10x-x-109">&#x00A0;too</span><span 
class="aesltt-10x-x-109">&#x00A0;acurate</span><span 
class="aesltt-10x-x-109">&#x00A0;(fast</span><span 
class="aesltt-10x-x-109">&#x00A0;and</span><span 
class="aesltt-10x-x-109">&#x00A0;crude</span><span 
class="aesltt-10x-x-109">&#x00A0;result)</span>
<br class="fancyvrb" /><a 
 id="x19-93057r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;control.mode=list(theta=theta.ini,</span><span 
class="aesltt-10x-x-109">&#x00A0;###</span><span 
class="aesltt-10x-x-109">&#x00A0;initial</span><span 
class="aesltt-10x-x-109">&#x00A0;theta</span><span 
class="aesltt-10x-x-109">&#x00A0;value</span>
<br class="fancyvrb" /><a 
 id="x19-93059r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;restart=TRUE)))$cpu</span></div>
<!--l. 229--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb629"><a 
 id="x19-93061r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Pre-processing</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Running</span><span 
class="aett-10x-x-109">&#x00A0;inla</span><span 
class="aett-10x-x-109">&#x00A0;Post-processing</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Total</span>
<br class="fancyvrb" /><a 
 id="x19-93063r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.6937158</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;63.0077260</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.2377534</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;63.9391952</span></div>
<!--l. 235--><p class="indent" >   Summary of the <span 
class="cmmi-10x-x-109">&#x03BC;</span><sub><span 
class="cmmi-8">&#x03B2;</span></sub>:
</p>
   <div class="fancyvrb" id="fancyvrb630"><a 
 id="x19-93065r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;round(cbind(true=mu.beta,</span><span 
class="aesltt-10x-x-109">&#x00A0;res$summary.fix),</span><span 
class="aesltt-10x-x-109">&#x00A0;4)</span></div>
<!--l. 240--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb631"><a 
 id="x19-93067r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;true</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mean</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sd</span><span 
class="aett-10x-x-109">&#x00A0;0.025quant</span><span 
class="aett-10x-x-109">&#x00A0;0.5quant</span><span 
class="aett-10x-x-109">&#x00A0;0.975quant</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mode</span><span 
class="aett-10x-x-109">&#x00A0;kld</span>
<br class="fancyvrb" /><a 
 id="x19-93069r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mu1</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-5</span><span 
class="aett-10x-x-109">&#x00A0;-4.9197</span><span 
class="aett-10x-x-109">&#x00A0;0.1875</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-5.2878</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-4.9197</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-4.5519</span><span 
class="aett-10x-x-109">&#x00A0;-4.9197</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span>
<br class="fancyvrb" /><a 
 id="x19-93071r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;h</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.9574</span><span 
class="aett-10x-x-109">&#x00A0;0.0785</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.8032</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.9574</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.1115</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.9574</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span></div>
<!--l. 247--><p class="indent" >   The results for the random fields
</p>
   <div class="fancyvrb" id="fancyvrb632"><a 
 id="x19-93073r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;rf12</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;list(rf1=inla.spde2.result(res,</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">i0</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;spde),</span>
<br class="fancyvrb" /><a 
 id="x19-93075r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;rf2=inla.spde2.result(res,</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">i1</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;spde))</span></div>
<!--l. 255--><p class="indent" >   We can see the posterior marginal distributions for the model hyperparameters and the range
for each spatio-temporal process in Figure&#x00A0;<a 
href="#x19-931021">15.1<!--tex4ht:ref: fig:hd3pmds --></a>.
</p>
   <div class="fancyvrb" id="fancyvrb633"><a 
 id="x19-93077r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;par(mfrow=c(3,</span><span 
class="aesltt-10x-x-109">&#x00A0;3),</span><span 
class="aesltt-10x-x-109">&#x00A0;mar=c(2.5,2.5,0.3,0.3),</span><span 
class="aesltt-10x-x-109">&#x00A0;mgp=c(1.5,0.5,0))</span>
<br class="fancyvrb" /><a 
 id="x19-93079r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;for</span><span 
class="aesltt-10x-x-109">&#x00A0;(i</span><span 
class="aesltt-10x-x-109">&#x00A0;in</span><span 
class="aesltt-10x-x-109">&#x00A0;1:2)</span><span 
class="aesltt-10x-x-109">&#x00A0;for</span><span 
class="aesltt-10x-x-109">&#x00A0;(j</span><span 
class="aesltt-10x-x-109">&#x00A0;in</span><span 
class="aesltt-10x-x-109">&#x00A0;15:17)</span><span 
class="aesltt-10x-x-109">&#x00A0;{</span><br class="fancyvrb" /><a 
 id="x19-93081r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(rf12[[i]][[j]][[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Density</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x19-93083r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=paste(</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">rf</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;i,</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">.</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;substring(names(rf12[[i]])[j],11),</span><span 
class="aesltt-10x-x-109">&#x00A0;sep=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">))</span>
<br class="fancyvrb" /><a 
 id="x19-93085r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;abline(v=c(kappa[i],</span><span 
class="aesltt-10x-x-109">&#x00A0;sigma2[i],</span><span 
class="aesltt-10x-x-109">&#x00A0;sqrt(8*1)/kappa[i])[j-14],</span><span 
class="aesltt-10x-x-109">&#x00A0;col=4)</span>
<br class="fancyvrb" /><a 
 id="x19-93087r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;}</span><br class="fancyvrb" /><a 
 id="x19-93089r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;for</span><span 
class="aesltt-10x-x-109">&#x00A0;(i</span><span 
class="aesltt-10x-x-109">&#x00A0;in</span><span 
class="aesltt-10x-x-109">&#x00A0;1:2)</span><span 
class="aesltt-10x-x-109">&#x00A0;{</span><br class="fancyvrb" /><a 
 id="x19-93091r8"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(res$marginals.hy[[c(4,7)[i]]],</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x19-93093r9"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=bquote(rho[.(i)]),</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Density</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span><br class="fancyvrb" /><a 
 id="x19-93095r10"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;abline(v=rho[i],</span><span 
class="aesltt-10x-x-109">&#x00A0;col=4)</span>
<br class="fancyvrb" /><a 
 id="x19-93097r11"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;}</span><br class="fancyvrb" /><a 
 id="x19-93099r12"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(res$marginals.hy[[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=expression(tau[E]),</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Density</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span>
<br class="fancyvrb" /><a 
 id="x19-93101r13"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;abline(v=taue,</span><span 
class="aesltt-10x-x-109">&#x00A0;col=4)</span></div>
                                                                                 
                                                                                 
<hr class="figure" /><div class="figure" 
><a 
 id="x19-931021"></a><img 
src="spde-tutorial104x.png" alt="PIC" class="graphics" width="422.52936pt" height="281.69817pt"  /><!--tex4ht:graphics  
name="spde-tutorial104x.png" src="figs/dynamic-hd3pmdsf.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;15.1: </span><span  
class="content">Posterior marginal distributions for the dynamic continuous spatial model
hyperparameters</span></div><!--tex4ht:label?: x19-931021 -->
   </div><hr class="endfigure" />
                                                                                 
                                                                                 
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialch16.html" >next</a>] [<a 
href="spde-tutorialch14.html" >prev</a>] [<a 
href="spde-tutorialch14.html#tailspde-tutorialch14.html" >prev-tail</a>] [<a 
href="spde-tutorialch15.html" >front</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch15.html" >up</a>] </p></div>
<!--l. 1--><p class="indent" >   <a 
 id="tailspde-tutorialch15.html"></a>  </p> 
</body></html> 
