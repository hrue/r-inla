<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>6 Semicontinuous model to daily rainfall</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- xhtml,html,frames,2 --> 
<meta name="src" content="spde-tutorial.tex" /> 
<meta name="date" content="2017-01-22 14:18:00" /> 
<link rel="stylesheet" type="text/css" href="spde-tutorial.css" /> 
</head><body 
>
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialch7.html" >next</a>] [<a 
href="spde-tutorialch5.html" >prev</a>] [<a 
href="spde-tutorialch5.html#tailspde-tutorialch5.html" >prev-tail</a>] [<a 
href="#tailspde-tutorialch6.html">tail</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch6.html" >up</a>] </p></div>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;6</span><br /><a 
 id="x10-430006"></a>Semicontinuous model to daily rainfall</h2>
<!--l. 5--><p class="noindent" >This chapter is better presented in the last chapter of&#x00A0;<span class="cite">[<a 
href="spde-tutorialli2.html#XblangiardoC:2015">Blangiardo and Cameletti,
2015</a>]</span>.
</p><!--l. 8--><p class="indent" >   In some applications we have data with is hard to fit a single distribution to. For example,
when whe have more zeros than the expected under a Poisson distribution. In that case there is
a waste literature considering zero-inflated models. These models are implemented in many
softwares as well.
</p><!--l. 17--><p class="indent" >   With hierarchical models, sometimes a random effect is sufficient to explain the zeroinflation.
This is true in same sense where a random effect is sufficient to explain the extra variation,
considering the overdispersion models. These cases happens when a specified random effect is
sufficient to explain the zeroinflation (or the overdispersion).
</p><!--l. 29--><p class="indent" >   A different problem happens with daily rainfall. In this case is not easy to fit a simple model.
There are days without rain and when we have precipitation on a day, we have a continuous
amount of water. A particular case in this problem is that the daily cumulated precipitation is
commonly very asymmetric.
</p>
   <h3 class="sectionHead"><span class="titlemark">6.1   </span> <a 
 id="x10-440006.1"></a>The hurdle continuous model</h3>
<!--l. 40--><p class="noindent" >In this section we build a jointly model for occurrence and rainfall amount. We call it a
semicontinuous model because we have zeros and positive continuous values.
</p><!--l. 46--><p class="indent" >   Let <span 
class="cmmi-10x-x-109">r</span><sub><span 
class="cmmi-8">i</span></sub> the rainfall amount at location <span 
class="cmmi-10x-x-109">i</span>. We define two new variables. One is the occurence
variable
</p>
   <center class="math-display" >
<img 
src="spde-tutorial49x.png" alt="     {
      1,  if r &#x003E; 0
zi =         i
      0,  otherwise
" class="math-display"  /></center>
<!--l. 55--><p class="nopar" > and other the rainfall amoung variable
</p>
   <center class="math-display" >
<img 
src="spde-tutorial50x.png" alt="     {N A,  if r = 0
yi =           i
      ri,   otherwise
" class="math-display"  /></center>
<!--l. 63--><p class="nopar" >
</p><!--l. 65--><p class="indent" >   Now we can define a model for each one variable. We use a model with two likelihoods. We
use the Bernoulli likelihood for <span 
class="cmmi-10x-x-109">z</span><sub><span 
class="cmmi-8">i</span></sub> and the gamma for <span 
class="cmmi-10x-x-109">y</span><sub><span 
class="cmmi-8">i</span></sub>.
</p>
   <center class="math-display" >
<img 
src="spde-tutorial51x.png" alt="zi ~ Bernoulli(pi)yi ~ Gamma (ai,bi)
" class="math-display"  /></center>
<!--l. 72--><p class="nopar" >
</p><!--l. 74--><p class="indent" >   We define the linear predictor to first component by
</p>
   <center class="math-display" >
<img 
src="spde-tutorial52x.png" alt="logit(p ) = &#x03B1; + x
      i     z   i
" class="math-display"  /></center>
<!--l. 77--><p class="nopar" > where <span 
class="cmmi-10x-x-109">&#x03B1;</span><sub><span 
class="cmmi-8">z</span></sub> is an intercept and <span 
class="cmmi-10x-x-109">x</span><sub><span 
class="cmmi-8">i</span></sub> is a random effect modeled by a Gaussian field through the
SPDE approach.
</p><!--l. 82--><p class="indent" >   To second component we consider that <span 
class="cmmi-10x-x-109">E</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">y</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">) = </span><span 
class="cmmi-10x-x-109">&#x03BC;</span><sub><span 
class="cmmi-8">i</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">a</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmmi-10x-x-109">&#x2215;b</span><sub><span 
class="cmmi-8">i</span></sub> and <span 
class="cmmi-10x-x-109">V </span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">y</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">) = </span><span 
class="cmmi-10x-x-109">a</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmmi-10x-x-109">&#x2215;b</span><sub><span 
class="cmmi-8">i</span></sub><sup><span 
class="cmr-8">2</span></sup> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">&#x03BC;</span><sub><span 
class="cmmi-8">i</span></sub><sup><span 
class="cmr-8">2</span></sup><span 
class="cmmi-10x-x-109">&#x2215;&#x03D5;</span>,
where <span 
class="cmmi-10x-x-109">&#x03D5; </span>us a precision parameter and we define a linear predictor to log<span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">&#x03BC;</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">)</span>. We
have
</p>
   <center class="math-display" >
<img 
src="spde-tutorial53x.png" alt="log(&#x03BC;i) = &#x03B1;y + &#x03B2;xxi
" class="math-display"  /></center>
<!--l. 89--><p class="nopar" > where <span 
class="cmmi-10x-x-109">&#x03B1;</span><sub><span 
class="cmmi-8">y</span></sub> is an intercept and <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmmi-8">x</span></sub> is a scaling parameter to <span 
class="cmmi-10x-x-109">x</span><sub><span 
class="cmmi-8">i</span></sub> that is a shared random effect with
the first component of the model.
</p><!--l. 95--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">6.2   </span> <a 
 id="x10-450006.2"></a>The daily rainfall data</h3>
<!--l. 97--><p class="noindent" >We use a rainfall data collected by the Brasilian National Wather Agency. We have a dataset
collected at 616 gauge stations for each day of 2011. These stations covers the Paraná State in
South of Brasil.
</p><!--l. 104--><p class="indent" >   These data are available on <span 
class="aessbx-10x-x-109">INLA </span>package and can be called by
</p>
   <div class="fancyvrb" id="fancyvrb294"><a 
 id="x10-45002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data(PRprec)</span></div>
<!--l. 111--><p class="noindent" >and we have, at first three columns, the coordinates and altitude. We can see this informations and
the rainfall for the first seven days at three stations with
</p>
   <div class="fancyvrb" id="fancyvrb295"><a 
 id="x10-45004r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;PRprec[1:3,</span><span 
class="aesltt-10x-x-109">&#x00A0;1:10]</span></div>
<!--l. 120--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb296"><a 
 id="x10-45006r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Longitude</span><span 
class="aett-10x-x-109">&#x00A0;Latitude</span><span 
class="aett-10x-x-109">&#x00A0;Altitude</span><span 
class="aett-10x-x-109">&#x00A0;d0101</span><span 
class="aett-10x-x-109">&#x00A0;d0102</span><span 
class="aett-10x-x-109">&#x00A0;d0103</span><span 
class="aett-10x-x-109">&#x00A0;d0104</span><span 
class="aett-10x-x-109">&#x00A0;d0105</span><span 
class="aett-10x-x-109">&#x00A0;d0106</span><span 
class="aett-10x-x-109">&#x00A0;d0107</span>
<br class="fancyvrb" /><a 
 id="x10-45008r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-50.8744</span><span 
class="aett-10x-x-109">&#x00A0;-22.8511</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;365</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.0</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.5</span>
<br class="fancyvrb" /><a 
 id="x10-45010r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;3</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-50.7711</span><span 
class="aett-10x-x-109">&#x00A0;-22.9597</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;344</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.0</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;6.0</span>
<br class="fancyvrb" /><a 
 id="x10-45012r4"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;4</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-50.6497</span><span 
class="aett-10x-x-109">&#x00A0;-22.9500</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;904</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;3.3</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;5.1</span></div>
<!--l. 127--><p class="noindent" >Also considering the first seven days, A summary over stations for the first seven days and the
number of stations with rain
</p>
   <div class="fancyvrb" id="fancyvrb297"><a 
 id="x10-45014r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;sapply(PRprec[,4:10],</span><span 
class="aesltt-10x-x-109">&#x00A0;summary)</span></div>
<!--l. 134--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb298"><a 
 id="x10-45016r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;d0101</span><span 
class="aett-10x-x-109">&#x00A0;d0102</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;d0103</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;d0104</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;d0105</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;d0106</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;d0107</span>
<br class="fancyvrb" /><a 
 id="x10-45018r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Min.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.0000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.00</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.000</span>
<br class="fancyvrb" /><a 
 id="x10-45020r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1st</span><span 
class="aett-10x-x-109">&#x00A0;Qu.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.0000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.00</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.000</span>
<br class="fancyvrb" /><a 
 id="x10-45022r4"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Median</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.0000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.00</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.300</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.000</span>
<br class="fancyvrb" /><a 
 id="x10-45024r5"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Mean</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.8074</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.87</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;5.928</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;3.567</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.793</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;4.059</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;5.999</span>
<br class="fancyvrb" /><a 
 id="x10-45026r6"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;3rd</span><span 
class="aett-10x-x-109">&#x00A0;Qu.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.0000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.10</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;7.000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;3.475</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.600</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;3.850</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;6.700</span>
<br class="fancyvrb" /><a 
 id="x10-45028r7"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Max.</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;43.8000</span><span 
class="aett-10x-x-109">&#x00A0;55.60</span><span 
class="aett-10x-x-109">&#x00A0;78.500</span><span 
class="aett-10x-x-109">&#x00A0;62.900</span><span 
class="aett-10x-x-109">&#x00A0;64.100</span><span 
class="aett-10x-x-109">&#x00A0;81.400</span><span 
class="aett-10x-x-109">&#x00A0;75.700</span>
<br class="fancyvrb" /><a 
 id="x10-45030r8"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;NA</span><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">s</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;6.0000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;7.00</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;7.000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;6.000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;6.000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;8.000</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;8.000</span></div>
                                                                                 
                                                                                 
<!--l. 144--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb299"><a 
 id="x10-45032r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;colSums(PRprec[,4:10]&#x003E;0,</span><span 
class="aesltt-10x-x-109">&#x00A0;na.rm=TRUE)</span></div>
<!--l. 147--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb300"><a 
 id="x10-45034r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;d0101</span><span 
class="aett-10x-x-109">&#x00A0;d0102</span><span 
class="aett-10x-x-109">&#x00A0;d0103</span><span 
class="aett-10x-x-109">&#x00A0;d0104</span><span 
class="aett-10x-x-109">&#x00A0;d0105</span><span 
class="aett-10x-x-109">&#x00A0;d0106</span><span 
class="aett-10x-x-109">&#x00A0;d0107</span><br class="fancyvrb" /><a 
 id="x10-45036r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;72</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;210</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;315</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;237</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;181</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;240</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;239</span></div>
<!--l. 152--><p class="noindent" >and we see, for example, that we have that the third quartil for the first day is zero when we have
rain only at 72 stations. We also have missing values.
</p><!--l. 158--><p class="indent" >   On this section we consider the data at third day. We define the two response variables
with
</p>
   <div class="fancyvrb" id="fancyvrb301"><a 
 id="x10-45038r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;jday</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;6</span><br class="fancyvrb" /><a 
 id="x10-45040r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;z</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;(PRprec[,jday]&#x003E;0)</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;0</span><br class="fancyvrb" /><a 
 id="x10-45042r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;y</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;ifelse(PRprec[,jday]&#x003E;0,</span><span 
class="aesltt-10x-x-109">&#x00A0;PRprec[,jday],</span><span 
class="aesltt-10x-x-109">&#x00A0;NA)</span></div>
<!--l. 169--><p class="indent" >   The map of this data are showed on the left graph of the Figure&#x00A0;<a 
href="#x10-450591">6.1<!--tex4ht:ref: fig:rain --></a>. Also, the histogram of
the positive precipitation are on the rigth graph of this Figure. Both produced by the code
below
</p>
   <div class="fancyvrb" id="fancyvrb302"><a 
 id="x10-45044r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;par(mfrow=c(1,</span><span 
class="aesltt-10x-x-109">&#x00A0;2),</span><span 
class="aesltt-10x-x-109">&#x00A0;mar=c(3,3,.5,0),</span><span 
class="aesltt-10x-x-109">&#x00A0;mgp=c(1.5,0.5,0))</span><br class="fancyvrb" /><a 
 id="x10-45046r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;hist(y,</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">mm</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;col=gray(.9),</span><span 
class="aesltt-10x-x-109">&#x00A0;main=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">)</span>
<br class="fancyvrb" /><a 
 id="x10-45048r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;par(mar=c(0,0,0,0))</span><br class="fancyvrb" /><a 
 id="x10-45050r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(PRprec[,1:2],</span><span 
class="aesltt-10x-x-109">&#x00A0;cex=0.3</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;PRprec[,jday]/20,</span><span 
class="aesltt-10x-x-109">&#x00A0;asp=1,</span>
<br class="fancyvrb" /><a 
 id="x10-45052r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;col=c(</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">red</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">blue</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)[z+1],</span><span 
class="aesltt-10x-x-109">&#x00A0;axes=FALSE)</span><br class="fancyvrb" /><a 
 id="x10-45054r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;q.y</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;c(0,</span><span 
class="aesltt-10x-x-109">&#x00A0;quantile(y,</span><span 
class="aesltt-10x-x-109">&#x00A0;0:7/7,</span><span 
class="aesltt-10x-x-109">&#x00A0;na.rm=T))</span>
<br class="fancyvrb" /><a 
 id="x10-45056r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;legend(</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">topright</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;format(q.y,</span><span 
class="aesltt-10x-x-109">&#x00A0;dig=2),</span><span 
class="aesltt-10x-x-109">&#x00A0;pch=1,</span><span 
class="aesltt-10x-x-109">&#x00A0;bty=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">n</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x10-45058r8"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;pt.cex=0.3+q.y/20,</span><span 
class="aesltt-10x-x-109">&#x00A0;col=c(</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">red</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,rep(</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">blue</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,length(q.y)-1)))</span></div>
<hr class="figure" /><div class="figure" 
><a 
 id="x10-450591"></a><img 
src="spde-tutorial54x.png" alt="PIC" class="graphics" width="422.52936pt" height="172.84985pt"  /><!--tex4ht:graphics  
name="spde-tutorial54x.png" src="figs/semicont-vrain.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;6.1: </span><span  
class="content">Histogram of rainfall amount and map of precipitation.</span></div><!--tex4ht:label?: x10-450591 -->
   </div><hr class="endfigure" />
<!--l. 194--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">6.3   </span> <a 
 id="x10-460006.3"></a>Model fitting and some results</h3>
<!--l. 196--><p class="noindent" >First we need to define the mesh and prepare the data to fit the model.
</p>
   <div class="fancyvrb" id="fancyvrb303"><a 
 id="x10-46002r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;871</span></div>
<!--l. 204--><p class="indent" >   The SPDE model definition is made by
                                                                                 
                                                                                 
</p>
   <div class="fancyvrb" id="fancyvrb304"><a 
 id="x10-46004r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;spde</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde2.matern(mesh,</span><span 
class="aesltt-10x-x-109">&#x00A0;alpha=2)</span></div>
<!--l. 211--><p class="indent" >   We have to prepare the data in addequate form using the stack functionality. First we get
the predictor matrix for the SPDE model effect with
</p>
   <div class="fancyvrb" id="fancyvrb305"><a 
 id="x10-46006r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;A</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde.make.A(mesh,</span><span 
class="aesltt-10x-x-109">&#x00A0;loc=as.matrix(PRprec[,1:2]))</span></div>
<!--l. 221--><p class="indent" >   For comparison pourpose, we can fit a model only with the rainfall occurrence
and another only with rainfall amount. Because we have to fit the joint model, we
prepare the stack for each separated model considering each response and also the
response for the jointly model. For the jointly model, we need to have a two columns
response.
</p><!--l. 231--><p class="indent" >   The stack for the occurrence is
</p>
   <div class="fancyvrb" id="fancyvrb306"><a 
 id="x10-46008r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stk.z</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(tag=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">est.z</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><br class="fancyvrb" /><a 
 id="x10-46010r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=list(z=z,</span><span 
class="aesltt-10x-x-109">&#x00A0;###</span><span 
class="aesltt-10x-x-109">&#x00A0;occurrence</span><span 
class="aesltt-10x-x-109">&#x00A0;for</span><span 
class="aesltt-10x-x-109">&#x00A0;separate</span><span 
class="aesltt-10x-x-109">&#x00A0;model</span>
<br class="fancyvrb" /><a 
 id="x10-46012r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;y=cbind(z,</span><span 
class="aesltt-10x-x-109">&#x00A0;NA)),</span><span 
class="aesltt-10x-x-109">&#x00A0;###</span><span 
class="aesltt-10x-x-109">&#x00A0;z</span><span 
class="aesltt-10x-x-109">&#x00A0;at</span><span 
class="aesltt-10x-x-109">&#x00A0;first</span><span 
class="aesltt-10x-x-109">&#x00A0;column</span><span 
class="aesltt-10x-x-109">&#x00A0;of</span><span 
class="aesltt-10x-x-109">&#x00A0;y</span>
<br class="fancyvrb" /><a 
 id="x10-46014r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;A=list(A,</span><span 
class="aesltt-10x-x-109">&#x00A0;1),</span><br class="fancyvrb" /><a 
 id="x10-46016r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;effects=list(</span>
<br class="fancyvrb" /><a 
 id="x10-46018r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;list(i.z=1:spde$n.spde),</span>
<br class="fancyvrb" /><a 
 id="x10-46020r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;list(z.b0=rep(1,length(z)))))</span></div>
<!--l. 243--><p class="noindent" >The data stack for the precipitation amount is
</p>
   <div class="fancyvrb" id="fancyvrb307"><a 
 id="x10-46022r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stk.y</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(tag=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">est.y</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><br class="fancyvrb" /><a 
 id="x10-46024r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=list(r=y,</span><span 
class="aesltt-10x-x-109">&#x00A0;###</span><span 
class="aesltt-10x-x-109">&#x00A0;rainfall</span><span 
class="aesltt-10x-x-109">&#x00A0;for</span><span 
class="aesltt-10x-x-109">&#x00A0;separate</span><span 
class="aesltt-10x-x-109">&#x00A0;model</span>
<br class="fancyvrb" /><a 
 id="x10-46026r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;y=cbind(NA,</span><span 
class="aesltt-10x-x-109">&#x00A0;y)),</span><span 
class="aesltt-10x-x-109">&#x00A0;###</span><span 
class="aesltt-10x-x-109">&#x00A0;rainfall</span><span 
class="aesltt-10x-x-109">&#x00A0;at</span><span 
class="aesltt-10x-x-109">&#x00A0;second</span><span 
class="aesltt-10x-x-109">&#x00A0;column</span>
<br class="fancyvrb" /><a 
 id="x10-46028r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;A=list(A,</span><span 
class="aesltt-10x-x-109">&#x00A0;1),</span><br class="fancyvrb" /><a 
 id="x10-46030r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;effects=list(</span>
<br class="fancyvrb" /><a 
 id="x10-46032r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;list(i.y=1:spde$n.spde),</span>
<br class="fancyvrb" /><a 
 id="x10-46034r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;list(y.b0=rep(1,length(y)))))</span></div>
<!--l. 256--><p class="indent" >   Fitting the model for each response separately
</p>
   <div class="fancyvrb" id="fancyvrb308"><a 
 id="x10-46036r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res.z</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla(z</span><span 
class="aesltt-10x-x-109">&#x00A0;~</span><span 
class="aesltt-10x-x-109">&#x00A0;0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;z.b0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;f(i.z,</span><span 
class="aesltt-10x-x-109">&#x00A0;model=spde),</span><span 
class="aesltt-10x-x-109">&#x00A0;family=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">binomial</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x10-46038r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=inla.stack.data(stk.z),</span><span 
class="aesltt-10x-x-109">&#x00A0;control.compute=list(dic=TRUE),</span>
<br class="fancyvrb" /><a 
 id="x10-46040r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;control.predictor=list(A=inla.stack.A(stk.z),</span><span 
class="aesltt-10x-x-109">&#x00A0;compute=TRUE))</span>
<br class="fancyvrb" /><a 
 id="x10-46042r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res.y</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla(r</span><span 
class="aesltt-10x-x-109">&#x00A0;~</span><span 
class="aesltt-10x-x-109">&#x00A0;0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;y.b0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;f(i.y,</span><span 
class="aesltt-10x-x-109">&#x00A0;model=spde),</span><span 
class="aesltt-10x-x-109">&#x00A0;family=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">gamma</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x10-46044r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=inla.stack.data(stk.y),</span><span 
class="aesltt-10x-x-109">&#x00A0;control.compute=list(dic=TRUE),</span>
<br class="fancyvrb" /><a 
 id="x10-46046r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;control.predictor=list(A=inla.stack.A(stk.y),</span><span 
class="aesltt-10x-x-109">&#x00A0;compute=TRUE))</span></div>
<!--l. 268--><p class="indent" >   Defining a full data stack that join both responses for jointly model
</p>
   <div class="fancyvrb" id="fancyvrb309"><a 
 id="x10-46048r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;stk.zy</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack(stk.z,</span><span 
class="aesltt-10x-x-109">&#x00A0;stk.y)</span></div>
<!--l. 275--><p class="indent" >   To fit the model, we make inference to <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmmi-8">x</span></sub> using the copy of the strategy with
<span 
class="aett-10x-x-109">fixed=FALSE</span>.
</p>
   <div class="fancyvrb" id="fancyvrb310"><a 
 id="x10-46050r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res.zy</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla(y</span><span 
class="aesltt-10x-x-109">&#x00A0;~</span><span 
class="aesltt-10x-x-109">&#x00A0;0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;z.b0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;y.b0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span>
<br class="fancyvrb" /><a 
 id="x10-46052r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;f(i.z,</span><span 
class="aesltt-10x-x-109">&#x00A0;model=spde)</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;f(i.y,</span><span 
class="aesltt-10x-x-109">&#x00A0;copy=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">i.z</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;fixed=FALSE),</span>
<br class="fancyvrb" /><a 
 id="x10-46054r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;family=c(</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">binomial</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">gamma</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">),</span>
<br class="fancyvrb" /><a 
 id="x10-46056r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=inla.stack.data(stk.zy),</span><span 
class="aesltt-10x-x-109">&#x00A0;control.compute=list(dic=TRUE),</span>
<br class="fancyvrb" /><a 
 id="x10-46058r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;control.predictor=list(A=inla.stack.A(stk.zy),</span><span 
class="aesltt-10x-x-109">&#x00A0;compute=TRUE))</span></div>
<!--l. 288--><p class="indent" >   Also to compare, we fit the model by defining the SPDE model on the rainfall amount
equation and copying it on the occurrence equation
                                                                                 
                                                                                 
</p>
   <div class="fancyvrb" id="fancyvrb311"><a 
 id="x10-46060r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res.yz</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla(y</span><span 
class="aesltt-10x-x-109">&#x00A0;~</span><span 
class="aesltt-10x-x-109">&#x00A0;0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;z.b0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;y.b0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span>
<br class="fancyvrb" /><a 
 id="x10-46062r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;f(i.y,</span><span 
class="aesltt-10x-x-109">&#x00A0;model=spde)</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;f(i.z,</span><span 
class="aesltt-10x-x-109">&#x00A0;copy=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">i.y</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;fixed=FALSE),</span>
<br class="fancyvrb" /><a 
 id="x10-46064r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;family=c(</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">binomial</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">gamma</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">),</span>
<br class="fancyvrb" /><a 
 id="x10-46066r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=inla.stack.data(stk.zy),</span><span 
class="aesltt-10x-x-109">&#x00A0;control.compute=list(dic=TRUE),</span>
<br class="fancyvrb" /><a 
 id="x10-46068r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;control.predictor=list(A=inla.stack.A(stk.zy),</span><span 
class="aesltt-10x-x-109">&#x00A0;compute=TRUE))</span></div>
<!--l. 300--><p class="indent" >   We can see if the spatial effect are correlated by looking at posterior of the <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmmi-8">x</span></sub> parameter. We
see that on both jointly models it is different from zero. So, the rainfall ocurrence and rainfall
amount share the same spatial pattern.
</p>
   <div class="fancyvrb" id="fancyvrb312"><a 
 id="x10-46070r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;round(rbind(beta.zy=res.zy$summary.hy[4,</span><span 
class="aesltt-10x-x-109">&#x00A0;],</span><span 
class="aesltt-10x-x-109">&#x00A0;beta.yz=res.yz$summary.hy[4,</span><span 
class="aesltt-10x-x-109">&#x00A0;]),</span><span 
class="aesltt-10x-x-109">&#x00A0;4)</span></div>
<!--l. 308--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb313"><a 
 id="x10-46072r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mean</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sd</span><span 
class="aett-10x-x-109">&#x00A0;0.025quant</span><span 
class="aett-10x-x-109">&#x00A0;0.5quant</span><span 
class="aett-10x-x-109">&#x00A0;0.975quant</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mode</span>
<br class="fancyvrb" /><a 
 id="x10-46074r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;beta.zy</span><span 
class="aett-10x-x-109">&#x00A0;0.3493</span><span 
class="aett-10x-x-109">&#x00A0;0.0792</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.195</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.3488</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.5058</span><span 
class="aett-10x-x-109">&#x00A0;0.3474</span>
<br class="fancyvrb" /><a 
 id="x10-46076r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;beta.yz</span><span 
class="aett-10x-x-109">&#x00A0;1.7701</span><span 
class="aett-10x-x-109">&#x00A0;0.2196</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.350</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.7656</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.2117</span><span 
class="aett-10x-x-109">&#x00A0;1.7523</span></div>
<!--l. 315--><p class="indent" >   These values for <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmmi-8">x</span></sub> are different due that they are fitted taking into account two factores.
One is relatinship existence between the spatial effect on both linear predictor. We infer this
looking if <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmmi-8">x</span></sub> is less or greater than zero. The second factor is related to the variance of the effect
on the first equation. The value considering the two different orders are equal only if the
variance of the effect on first equation is one. In other words, the probability of rain occurrence
is correlated with the amoung of the rain, like the prefencential sampling problem&#x00A0;<span class="cite">[<a 
href="spde-tutorialli2.html#Xdiggleetal:2010">Diggle et&#x00A0;al.,
2010</a>]</span>.
</p><!--l. 324--><p class="indent" >   We can compare the results obtained of the two separated models with the two joint models
looking at its DIC values. But, we need to take care on DIC value from the joint models. It
computed by summing the local DIC for each observation of both responses. So, we have to
compute the correct DIC value for each response by sum of local DIC values correspoinding to
each one.
</p>
   <div class="fancyvrb" id="fancyvrb314"><a 
 id="x10-46078r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;iz</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.stack.index(stk.zy,</span><span 
class="aesltt-10x-x-109">&#x00A0;tag=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">est.z</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)$data</span>
<br class="fancyvrb" /><a 
 id="x10-46080r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;dic.zy</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;c(dic.z</span><span 
class="aesltt-10x-x-109">&#x00A0;=</span><span 
class="aesltt-10x-x-109">&#x00A0;sum(res.zy$dic$local.dic[iz],</span><span 
class="aesltt-10x-x-109">&#x00A0;na.rm=TRUE),</span>
<br class="fancyvrb" /><a 
 id="x10-46082r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;dic.y</span><span 
class="aesltt-10x-x-109">&#x00A0;=</span><span 
class="aesltt-10x-x-109">&#x00A0;sum(res.zy$dic$local.dic[-iz],</span><span 
class="aesltt-10x-x-109">&#x00A0;na.rm=TRUE))</span>
<br class="fancyvrb" /><a 
 id="x10-46084r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;dic.yz</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;c(dic.z</span><span 
class="aesltt-10x-x-109">&#x00A0;=</span><span 
class="aesltt-10x-x-109">&#x00A0;sum(res.yz$dic$local.dic[iz],</span><span 
class="aesltt-10x-x-109">&#x00A0;na.rm=TRUE),</span>
<br class="fancyvrb" /><a 
 id="x10-46086r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;dic.y</span><span 
class="aesltt-10x-x-109">&#x00A0;=</span><span 
class="aesltt-10x-x-109">&#x00A0;sum(res.yz$dic$local.dic[-iz],</span><span 
class="aesltt-10x-x-109">&#x00A0;na.rm=TRUE))</span></div>
<!--l. 339--><p class="noindent" >We see that, considering occurrence, the DIC from jointly model is similar than one from separate
model, when the SPDE model is declared on the occurrence equation.
</p>
   <div class="fancyvrb" id="fancyvrb315"><a 
 id="x10-46088r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;rbind(sep=c(res.z$dic$dic,</span><span 
class="aesltt-10x-x-109">&#x00A0;res.y$dic$dic),</span><span 
class="aesltt-10x-x-109">&#x00A0;joint.zy=dic.zy,</span><span 
class="aesltt-10x-x-109">&#x00A0;joint.yz=dic.yz)</span></div>
<!--l. 345--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb316"><a 
 id="x10-46090r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;dic.z</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;dic.y</span><br class="fancyvrb" /><a 
 id="x10-46092r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sep</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;703.5910</span><span 
class="aett-10x-x-109">&#x00A0;2080.205</span><br class="fancyvrb" /><a 
 id="x10-46094r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;joint.zy</span><span 
class="aett-10x-x-109">&#x00A0;704.7752</span><span 
class="aett-10x-x-109">&#x00A0;2130.293</span>
<br class="fancyvrb" /><a 
 id="x10-46096r4"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;joint.yz</span><span 
class="aett-10x-x-109">&#x00A0;714.4988</span><span 
class="aett-10x-x-109">&#x00A0;2120.917</span></div>
<!--l. 353--><p class="indent" >   Now, we look at the summary of the posterior distribution for <span 
class="cmmi-10x-x-109">&#x03B1;</span><sub><span 
class="cmmi-8">z</span></sub> considering the three
models fitted that includes this parameter
</p>
   <div class="fancyvrb" id="fancyvrb317"><a 
 id="x10-46098r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;round(rbind(sep=res.z$summary.fix,</span><span 
class="aesltt-10x-x-109">&#x00A0;joint.zy=res.zy$summary.fix[1,],</span>
<br class="fancyvrb" /><a 
 id="x10-46100r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;joint.yz=res.yz$summary.fix[1,]),</span><span 
class="aesltt-10x-x-109">&#x00A0;4)</span></div>
                                                                                 
                                                                                 
<!--l. 360--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb318"><a 
 id="x10-46102r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mean</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sd</span><span 
class="aett-10x-x-109">&#x00A0;0.025quant</span><span 
class="aett-10x-x-109">&#x00A0;0.5quant</span><span 
class="aett-10x-x-109">&#x00A0;0.975quant</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mode</span><span 
class="aett-10x-x-109">&#x00A0;kld</span>
<br class="fancyvrb" /><a 
 id="x10-46104r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sep</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.2304</span><span 
class="aett-10x-x-109">&#x00A0;0.8510</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-1.5061</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.2011</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.1153</span><span 
class="aett-10x-x-109">&#x00A0;0.1634</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span>
<br class="fancyvrb" /><a 
 id="x10-46106r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;joint.zy</span><span 
class="aett-10x-x-109">&#x00A0;0.0681</span><span 
class="aett-10x-x-109">&#x00A0;0.4959</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-0.9323</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.0627</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.1002</span><span 
class="aett-10x-x-109">&#x00A0;0.0545</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span>
<br class="fancyvrb" /><a 
 id="x10-46108r4"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;joint.yz</span><span 
class="aett-10x-x-109">&#x00A0;0.0256</span><span 
class="aett-10x-x-109">&#x00A0;0.3342</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;-0.6511</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.0267</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.6978</span><span 
class="aett-10x-x-109">&#x00A0;0.0290</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span></div>
<!--l. 367--><p class="noindent" >and we see that the posterior mean of these three results are different from separate model to jointly
ones. But, <span 
class="cmmi-10x-x-109">&#x03B1;</span><sub><span 
class="cmmi-8">z</span></sub> still not different from zero, because with separate model, when the posterior
mean value is more far from zero, the posterior standard deviation is greater. Due to it, when we
compute the cumulative distribution at zero, under the posterior distribution from the three
results, the values are similar.
</p>
   <div class="fancyvrb" id="fancyvrb319"><a 
 id="x10-46110r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;sapply(list(sep=res.z$marginals.fix[[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;joint.zy=res.zy$marginals.fix[[1]],</span>
<br class="fancyvrb" /><a 
 id="x10-46112r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;joint.yz=res.yz$marginals.fix[[1]]),</span><span 
class="aesltt-10x-x-109">&#x00A0;function(m)</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.pmarginal(0,</span><span 
class="aesltt-10x-x-109">&#x00A0;m))</span></div>
<!--l. 378--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb320"><a 
 id="x10-46114r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sep</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;joint.zy</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;joint.yz</span><br class="fancyvrb" /><a 
 id="x10-46116r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.3772630</span><span 
class="aett-10x-x-109">&#x00A0;0.4440659</span><span 
class="aett-10x-x-109">&#x00A0;0.4672635</span></div>
<!--l. 384--><p class="indent" >   For <span 
class="cmmi-10x-x-109">&#x03B1;</span><sub><span 
class="cmmi-8">y</span></sub>
</p>
   <div class="fancyvrb" id="fancyvrb321"><a 
 id="x10-46118r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;round(rbind(sep=res.y$summary.fix,</span><span 
class="aesltt-10x-x-109">&#x00A0;joint.zy=res.zy$summary.fix[2,],</span>
<br class="fancyvrb" /><a 
 id="x10-46120r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;joint.yz=res.yz$summary.fix[2,]),</span><span 
class="aesltt-10x-x-109">&#x00A0;4)</span></div>
<!--l. 390--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb322"><a 
 id="x10-46122r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mean</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sd</span><span 
class="aett-10x-x-109">&#x00A0;0.025quant</span><span 
class="aett-10x-x-109">&#x00A0;0.5quant</span><span 
class="aett-10x-x-109">&#x00A0;0.975quant</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mode</span><span 
class="aett-10x-x-109">&#x00A0;kld</span>
<br class="fancyvrb" /><a 
 id="x10-46124r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sep</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.1347</span><span 
class="aett-10x-x-109">&#x00A0;0.1296</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.8781</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.1346</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.3917</span><span 
class="aett-10x-x-109">&#x00A0;2.1345</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span>
<br class="fancyvrb" /><a 
 id="x10-46126r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;joint.zy</span><span 
class="aett-10x-x-109">&#x00A0;2.0848</span><span 
class="aett-10x-x-109">&#x00A0;0.2053</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.6743</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.0869</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.4901</span><span 
class="aett-10x-x-109">&#x00A0;2.0971</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span>
<br class="fancyvrb" /><a 
 id="x10-46128r4"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;joint.yz</span><span 
class="aett-10x-x-109">&#x00A0;1.9044</span><span 
class="aett-10x-x-109">&#x00A0;0.2223</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.4658</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.9037</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;2.3504</span><span 
class="aett-10x-x-109">&#x00A0;1.9046</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0</span></div>
<!--l. 397--><p class="noindent" >we have quite similar posterior mean from the three fitted models.
</p><!--l. 399--><p class="indent" >   We apply the inverse of the link function to look at response scale with
</p>
   <div class="fancyvrb" id="fancyvrb323"><a 
 id="x10-46130r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;c(binomial(link=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">logit</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)$linkinv(res.zy$summary.fix[1,1]),</span><br class="fancyvrb" /><a 
 id="x10-46132r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;exp(res.zy$summary.fix[2,1]))</span></div>
<!--l. 406--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb324"><a 
 id="x10-46134r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;0.5170272</span><span 
class="aett-10x-x-109">&#x00A0;8.0431210</span></div>
<!--l. 410--><p class="noindent" >and it looks similar to observed:
</p>
   <div class="fancyvrb" id="fancyvrb325"><a 
 id="x10-46136r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;c(occ=mean(z,</span><span 
class="aesltt-10x-x-109">&#x00A0;na.rm=TRUE),</span><span 
class="aesltt-10x-x-109">&#x00A0;rain=mean(y,</span><span 
class="aesltt-10x-x-109">&#x00A0;na.rm=TRUE))</span></div>
<!--l. 415--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb326"><a 
 id="x10-46138r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;occ</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;rain</span><br class="fancyvrb" /><a 
 id="x10-46140r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.5172414</span><span 
class="aett-10x-x-109">&#x00A0;11.4606349</span></div>
<!--l. 421--><p class="indent" >   The summary for the posterior marginal distribution of Gamma precision parameter
is
                                                                                 
                                                                                 
</p>
   <div class="fancyvrb" id="fancyvrb327"><a 
 id="x10-46142r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res.yz$summary.hy[1,</span><span 
class="aesltt-10x-x-109">&#x00A0;]</span></div>
<!--l. 427--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb328"><a 
 id="x10-46144r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mean</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;sd</span>
<br class="fancyvrb" /><a 
 id="x10-46146r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Precision</span><span 
class="aett-10x-x-109">&#x00A0;parameter</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;the</span><span 
class="aett-10x-x-109">&#x00A0;Gamma</span><span 
class="aett-10x-x-109">&#x00A0;observations[2]</span><span 
class="aett-10x-x-109">&#x00A0;0.9467355</span><span 
class="aett-10x-x-109">&#x00A0;0.0878996</span>
<br class="fancyvrb" /><a 
 id="x10-46148r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.025quant</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.5quant</span>
<br class="fancyvrb" /><a 
 id="x10-46150r4"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Precision</span><span 
class="aett-10x-x-109">&#x00A0;parameter</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;the</span><span 
class="aett-10x-x-109">&#x00A0;Gamma</span><span 
class="aett-10x-x-109">&#x00A0;observations[2]</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.7820071</span><span 
class="aett-10x-x-109">&#x00A0;0.9442472</span>
<br class="fancyvrb" /><a 
 id="x10-46152r5"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;0.975quant</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mode</span>
<br class="fancyvrb" /><a 
 id="x10-46154r6"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;Precision</span><span 
class="aett-10x-x-109">&#x00A0;parameter</span><span 
class="aett-10x-x-109">&#x00A0;for</span><span 
class="aett-10x-x-109">&#x00A0;the</span><span 
class="aett-10x-x-109">&#x00A0;Gamma</span><span 
class="aett-10x-x-109">&#x00A0;observations[2]</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;1.127399</span><span 
class="aett-10x-x-109">&#x00A0;0.9407374</span></div>
<!--l. 437--><p class="indent" >   We look the posterior marginal distributions of <span 
class="cmmi-10x-x-109">&#x03B1;</span><sub><span 
class="cmmi-8">z</span></sub>, <span 
class="cmmi-10x-x-109">&#x03B1;</span><sub><span 
class="cmmi-8">y</span></sub>, <span 
class="cmmi-10x-x-109">&#x03D5; </span>and <span 
class="cmmi-10x-x-109">&#x03B2; </span>on Figure&#x00A0;<a 
href="#x10-461732">6.2<!--tex4ht:ref: fig:post --></a> with
commands below
</p>
   <div class="fancyvrb" id="fancyvrb329"><a 
 id="x10-46156r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;par(mfrow=c(2,2),</span><span 
class="aesltt-10x-x-109">&#x00A0;mar=c(3,3,.5,.5),</span><span 
class="aesltt-10x-x-109">&#x00A0;mgp=c(1.5,.5,0),</span><span 
class="aesltt-10x-x-109">&#x00A0;las=1)</span>
<br class="fancyvrb" /><a 
 id="x10-46158r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(res.yz$marginals.fix[[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Density</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><br class="fancyvrb" /><a 
 id="x10-46160r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=expression(alpha[z]))</span>
<br class="fancyvrb" /><a 
 id="x10-46162r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(res.yz$marginals.fix[[2]],</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Density</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><br class="fancyvrb" /><a 
 id="x10-46164r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=expression(alpha[y]))</span>
<br class="fancyvrb" /><a 
 id="x10-46166r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(res.yz$marginals.hy[[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Density</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><br class="fancyvrb" /><a 
 id="x10-46168r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=expression(phi))</span>
<br class="fancyvrb" /><a 
 id="x10-46170r8"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(res.yz$marginals.hy[[4]],</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Density</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><br class="fancyvrb" /><a 
 id="x10-46172r9"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=expression(beta))</span></div>
<hr class="figure" /><div class="figure" 
><a 
 id="x10-461732"></a><img 
src="spde-tutorial55x.png" alt="PIC" class="graphics" width="384.11285pt" height="174.72563pt"  /><!--tex4ht:graphics  
name="spde-tutorial55x.png" src="figs/semicont-vpost.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;6.2: </span><span  
class="content">Posterior marginal distributions of <span 
class="cmmi-10x-x-109">&#x03B1;</span><sub><span 
class="cmmi-8">z</span></sub> (top left), <span 
class="cmmi-10x-x-109">&#x03B1;</span><sub><span 
class="cmmi-8">y</span></sub> (top right), <span 
class="cmmi-10x-x-109">&#x03D5; </span>(bottom
left) and <span 
class="cmmi-10x-x-109">&#x03B2; </span>(bottom right).</span></div><!--tex4ht:label?: x10-461732 -->
   </div><hr class="endfigure" />
<!--l. 463--><p class="indent" >   To decide if the occurence rain and the amoung of the rain have spatially dependency, we
want to test the significance of the random effect <span 
class="cmmi-10x-x-109">x</span>.
</p><!--l. 468--><p class="indent" >   One approach is looking at the 2,5% and 97,5% quantiles of each element of the random
effect. If for some of they has both quantiles with same signal, them they are significantly not
null. We see on the Figure&#x00A0;<a 
href="#x10-461863">6.3<!--tex4ht:ref: fig:xq --></a> the mean and this quantiles for each <span 
class="cmmi-10x-x-109">x </span>in order of the posterior
mean, with code below
</p>
   <div class="fancyvrb" id="fancyvrb330"><a 
 id="x10-46175r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;ordx</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;order(res.yz$summary.random$i.z$mean)</span><br class="fancyvrb" /><a 
 id="x10-46177r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;par(mar=c(3,3,0.5,0.5),</span><span 
class="aesltt-10x-x-109">&#x00A0;mgp=c(1.5,0.5,0),</span><span 
class="aesltt-10x-x-109">&#x00A0;las=1)</span>
<br class="fancyvrb" /><a 
 id="x10-46179r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot(res.yz$summary.random$i.z$mean[ordx],</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">x</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x10-46181r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;ylim=range(res.yz$summary.random$i.z[,</span><span 
class="aesltt-10x-x-109">&#x00A0;4:6]))</span>
<br class="fancyvrb" /><a 
 id="x10-46183r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;for</span><span 
class="aesltt-10x-x-109">&#x00A0;(i</span><span 
class="aesltt-10x-x-109">&#x00A0;in</span><span 
class="aesltt-10x-x-109">&#x00A0;c(4,6))</span><span 
class="aesltt-10x-x-109">&#x00A0;lines(res.yz$summary.random$i.z[ordx,i],</span><span 
class="aesltt-10x-x-109">&#x00A0;lty=2)</span><br class="fancyvrb" /><a 
 id="x10-46185r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;abline(h=0,</span><span 
class="aesltt-10x-x-109">&#x00A0;lty=3)</span></div>
                                                                                 
                                                                                 
<hr class="figure" /><div class="figure" 
><a 
 id="x10-461863"></a><img 
src="spde-tutorial56x.png" alt="PIC" class="graphics" width="422.52936pt" height="187.79436pt"  /><!--tex4ht:graphics  
name="spde-tutorial56x.png" src="figs/semicont-vxq.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;6.3: </span><span  
class="content">Posterior man of each <span 
class="cmmi-10x-x-109">x</span><sub><span 
class="cmmi-8">i</span></sub> (continuous line) and its 2.5% and 97.5% quantiles
of the posterior marginal distributions (dashed lines).</span></div><!--tex4ht:label?: x10-461863 -->
   </div><hr class="endfigure" />
<!--l. 494--><p class="indent" >   Other approach is to compare the DIC of the model with <span 
class="cmmi-10x-x-109">x </span>with the DIC of the model
without it.
</p><!--l. 497--><p class="indent" >   We fit the model without <span 
class="cmmi-10x-x-109">x </span>with
</p>
   <div class="fancyvrb" id="fancyvrb331"><a 
 id="x10-46188r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res.yz0</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla(y</span><span 
class="aesltt-10x-x-109">&#x00A0;~</span><span 
class="aesltt-10x-x-109">&#x00A0;0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;z.b0</span><span 
class="aesltt-10x-x-109">&#x00A0;+</span><span 
class="aesltt-10x-x-109">&#x00A0;y.b0,</span><br class="fancyvrb" /><a 
 id="x10-46190r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;family=c(</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">binomial</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">gamma</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">),</span>
<br class="fancyvrb" /><a 
 id="x10-46192r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data=inla.stack.data(stk.zy),</span><span 
class="aesltt-10x-x-109">&#x00A0;control.compute=list(dic=TRUE),</span>
<br class="fancyvrb" /><a 
 id="x10-46194r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;control.predictor=list(A=inla.stack.A(stk.zy),</span><span 
class="aesltt-10x-x-109">&#x00A0;compute=TRUE))</span></div>
<!--l. 506--><p class="noindent" >and we have
</p>
   <div class="fancyvrb" id="fancyvrb332"><a 
 id="x10-46196r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;rbind(dic.0=c(dic.yz0=sum(res.yz0$dic$local.dic[iz],</span><span 
class="aesltt-10x-x-109">&#x00A0;na.rm=TRUE),</span>
<br class="fancyvrb" /><a 
 id="x10-46198r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;dic.yz0=sum(res.yz0$dic$local.dic[-iz],</span><span 
class="aesltt-10x-x-109">&#x00A0;na.rm=TRUE)),</span><span 
class="aesltt-10x-x-109">&#x00A0;dic.s=dic.yz)</span></div>
<!--l. 512--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb333"><a 
 id="x10-46200r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;dic.yz0</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;dic.yz0</span><br class="fancyvrb" /><a 
 id="x10-46202r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;dic.0</span><span 
class="aett-10x-x-109">&#x00A0;845.5270</span><span 
class="aett-10x-x-109">&#x00A0;2157.415</span><br class="fancyvrb" /><a 
 id="x10-46204r3"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;dic.s</span><span 
class="aett-10x-x-109">&#x00A0;714.4988</span><span 
class="aett-10x-x-109">&#x00A0;2120.917</span></div>
<!--l. 518--><p class="noindent" >and conclude that the spatial random effect is significative for both occurence and amoung of
rainfall.
</p><!--l. 521--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">6.4   </span> <a 
 id="x10-470006.4"></a>Results for the spatial random effect</h3>
<!--l. 523--><p class="noindent" >The spatial random effect modeled by the SPDE approach has the <span 
class="cmmi-10x-x-109">&#x03BA; </span>scaling parameter, the
marginal variance parameter <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">x</span></sub><sup><span 
class="cmr-8">2</span></sup> and the practical range, <span class="cite">[<a 
href="spde-tutorialli2.html#XlindgrenRL:2011">Lindgren et&#x00A0;al., 2011</a>]</span>.
</p><!--l. 528--><p class="indent" >   To obtain results for the variance and for the practical range we need a post processing. We
obtain the marginal distribution for both by
</p>
   <div class="fancyvrb" id="fancyvrb334"><a 
 id="x10-47002r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;res.yz.f</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.spde2.result(res.yz,</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">i.y</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;spde,</span><span 
class="aesltt-10x-x-109">&#x00A0;do.transf=TRUE)</span></div>
<!--l. 536--><p class="noindent" >The posterior mean for the marginal variance
</p>
   <div class="fancyvrb" id="fancyvrb335"><a 
 id="x10-47004r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.emarginal(function(x)</span><span 
class="aesltt-10x-x-109">&#x00A0;x,</span><span 
class="aesltt-10x-x-109">&#x00A0;res.yz.f$marginals.variance.nominal[[1]])</span></div>
                                                                                 
                                                                                 
<!--l. 541--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb336"><a 
 id="x10-47006r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;0.5150864</span></div>
<!--l. 545--><p class="noindent" >And to the practical range of the process we have
</p>
   <div class="fancyvrb" id="fancyvrb337"><a 
 id="x10-47008r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.emarginal(function(x)</span><span 
class="aesltt-10x-x-109">&#x00A0;x,</span><span 
class="aesltt-10x-x-109">&#x00A0;res.yz.f$marginals.range.nominal[[1]])</span></div>
<!--l. 550--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb338"><a 
 id="x10-47010r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;1.077892</span></div>
<!--l. 555--><p class="indent" >   At the Figure&#x00A0;<a 
href="#x10-470254">6.4<!--tex4ht:ref: fig:xpars --></a> we look the posterior distribution to <span 
class="cmmi-10x-x-109">&#x03BA;</span>, <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">x</span></sub><sup><span 
class="cmr-8">2</span></sup> and of the practical range. The
<span 
class="cmmi-10x-x-109">&#x03BA; </span>and practical range are on degrees units.
</p>
   <div class="fancyvrb" id="fancyvrb339"><a 
 id="x10-47012r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;par(mfrow=c(1,3),</span><span 
class="aesltt-10x-x-109">&#x00A0;mar=c(3,3.5,0,0),</span><span 
class="aesltt-10x-x-109">&#x00A0;mgp=c(1.5,</span><span 
class="aesltt-10x-x-109">&#x00A0;.5,</span><span 
class="aesltt-10x-x-109">&#x00A0;0),</span><span 
class="aesltt-10x-x-109">&#x00A0;las=0)</span>
<br class="fancyvrb" /><a 
 id="x10-47014r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot.default(inla.tmarginal(function(x)</span><span 
class="aesltt-10x-x-109">&#x00A0;exp(x),</span><span 
class="aesltt-10x-x-109">&#x00A0;res.yz$marginals.hy[[3]]),</span>
<br class="fancyvrb" /><a 
 id="x10-47016r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=expression(kappa),</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Density</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span>
<br class="fancyvrb" /><a 
 id="x10-47018r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot.default(res.yz.f$marginals.variance.nominal[[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x10-47020r5"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=expression(sigma[x]^2),</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Density</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span>
<br class="fancyvrb" /><a 
 id="x10-47022r6"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;plot.default(res.yz.f$marginals.range.nominal[[1]],</span><span 
class="aesltt-10x-x-109">&#x00A0;type=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">l</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span>
<br class="fancyvrb" /><a 
 id="x10-47024r7"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Practical</span><span 
class="aesltt-10x-x-109">&#x00A0;range</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">Density</span><span 
class="tcst-1095">'</span><span 
class="aesltt-10x-x-109">)</span></div>
<hr class="figure" /><div class="figure" 
><a 
 id="x10-470254"></a><img 
src="spde-tutorial57x.png" alt="PIC" class="graphics" width="422.52936pt" height="169.01889pt"  /><!--tex4ht:graphics  
name="spde-tutorial57x.png" src="figs/semicont-vxpars.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;6.4: </span><span  
class="content">Posterior marginal distribution of <span 
class="cmmi-10x-x-109">&#x03BA; </span>(left), <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">x</span></sub><sup><span 
class="cmr-8">2</span></sup>  (mid) and of the practical
range (right).</span></div><!--tex4ht:label?: x10-470254 -->
   </div><hr class="endfigure" />
<!--l. 578--><p class="indent" >   Another interesting result is the map of the random field. To get it we use get the projector
with
</p>
   <div class="fancyvrb" id="fancyvrb340"><a 
 id="x10-47027r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;data(PRborder)</span><br class="fancyvrb" /><a 
 id="x10-47029r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;(nxy</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;round(c(diff(range(PRborder[,1])),</span><span 
class="aesltt-10x-x-109">&#x00A0;diff(range(PRborder[,2])))/.02))</span></div>
<!--l. 585--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb341"><a 
 id="x10-47031r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;[1]</span><span 
class="aett-10x-x-109">&#x00A0;330</span><span 
class="aett-10x-x-109">&#x00A0;210</span></div>
<!--l. 588--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb342"><a 
 id="x10-47033r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;projgrid</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.projector(mesh,</span><span 
class="aesltt-10x-x-109">&#x00A0;xlim=range(PRborder[,1]),</span>
<br class="fancyvrb" /><a 
 id="x10-47035r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;ylim=range(PRborder[,2]),</span><span 
class="aesltt-10x-x-109">&#x00A0;dims=nxy)</span></div>
                                                                                 
                                                                                 
<!--l. 593--><p class="noindent" >and get the posterior mean and posterior standard deviation with
</p>
   <div class="fancyvrb" id="fancyvrb343"><a 
 id="x10-47037r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xmean</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.project(projgrid,</span><span 
class="aesltt-10x-x-109">&#x00A0;res.yz$summary.random$i.z$mean)</span>
<br class="fancyvrb" /><a 
 id="x10-47039r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xsd</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inla.mesh.project(projgrid,</span><span 
class="aesltt-10x-x-109">&#x00A0;res.yz$summary.random$i.z$sd)</span></div>
<!--l. 601--><p class="indent" >   To good visualization, we make NA the values corresponding of the points of the grid out of
the border of the Paraná state. To do it, we use the function <span 
class="aett-10x-x-109">inout() </span>on <span 
class="aeb10-x-x-109">splancs </span>package,
with
</p>
   <div class="fancyvrb" id="fancyvrb344"><a 
 id="x10-47041r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;table(xy.in</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;inout(projgrid$lattice$loc,</span><span 
class="aesltt-10x-x-109">&#x00A0;PRborder))</span></div>
<!--l. 609--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb345"><a 
 id="x10-47043r1"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;FALSE</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;TRUE</span><br class="fancyvrb" /><a 
 id="x10-47045r2"></a><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;25188</span><span 
class="aett-10x-x-109">&#x00A0;44112</span></div>
<!--l. 613--><p class="noindent" >
</p>
   <div class="fancyvrb" id="fancyvrb346"><a 
 id="x10-47047r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xmean[!xy.in]</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;xsd[!xy.in]</span><span 
class="aesltt-10x-x-109">&#x00A0;&#x003C;-</span><span 
class="aesltt-10x-x-109">&#x00A0;NA</span></div>
<!--l. 617--><p class="noindent" >We visualize the this on Figure&#x00A0;<a 
href="#x10-470565">6.5<!--tex4ht:ref: fig:xrain3 --></a>. with code below
</p>
   <div class="fancyvrb" id="fancyvrb347"><a 
 id="x10-47049r1"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;grid.arrange(levelplot(xmean,</span><span 
class="aesltt-10x-x-109">&#x00A0;col.regions=topo.colors(99),</span>
<br class="fancyvrb" /><a 
 id="x10-47051r2"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;scales=list(draw=FALSE)),</span>
<br class="fancyvrb" /><a 
 id="x10-47053r3"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;levelplot(xsd,</span><span 
class="aesltt-10x-x-109">&#x00A0;col.regions=topo.colors(99),</span>
<br class="fancyvrb" /><a 
 id="x10-47055r4"></a><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;</span><span 
class="aesltt-10x-x-109">&#x00A0;xlab=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;ylab=</span><span 
class="tcst-1095">''</span><span 
class="aesltt-10x-x-109">,</span><span 
class="aesltt-10x-x-109">&#x00A0;scales=list(draw=FALSE)),</span><span 
class="aesltt-10x-x-109">&#x00A0;nrow=1)</span></div>
<hr class="figure" /><div class="figure" 
><a 
 id="x10-470565"></a><img 
src="spde-tutorial58x.png" alt="PIC" class="graphics" width="422.52936pt" height="169.01227pt"  /><!--tex4ht:graphics  
name="spde-tutorial58x.png" src="figs/semicont-xrain3.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;6.5: </span><span  
class="content">Posterior mean (left) and standard deviation (right) of the random field.</span></div><!--tex4ht:label?: x10-470565 -->
   </div><hr class="endfigure" />
<!--l. 635--><p class="indent" >   Comparing the left graph on Figure&#x00A0;<a 
href="#x10-470565">6.5<!--tex4ht:ref: fig:xrain3 --></a> with the right graph on the Figure&#x00A0;<a 
href="#x10-450591">6.1<!--tex4ht:ref: fig:rain --></a> we have a
more clear pattern of the rain on third day of 2012 on Paraná state. We see that in fact we have
rain near the sea (the right border of the map), at south and a small point on northeast. Also we
have no rain in some parts of nothwest.
                                                                                 
                                                                                 
</p>
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialch7.html" >next</a>] [<a 
href="spde-tutorialch5.html" >prev</a>] [<a 
href="spde-tutorialch5.html#tailspde-tutorialch5.html" >prev-tail</a>] [<a 
href="spde-tutorialch6.html" >front</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch6.html" >up</a>] </p></div>
<!--l. 1--><p class="indent" >   <a 
 id="tailspde-tutorialch6.html"></a>  </p> 
</body></html> 
