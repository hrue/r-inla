<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>1 Introduction</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,html,frames,2 --> 
<meta name="src" content="spde-tutorial.tex" /> 
<link rel="stylesheet" type="text/css" href="spde-tutorial.css" /> 
</head><body 
>
   <!--l. 5--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialch2.html" >next</a>] [<a 
href="spde-tutorialli1.html" >prev</a>] [<a 
href="spde-tutorialli1.html#tailspde-tutorialli1.html" >prev-tail</a>] [<a 
href="#tailspde-tutorialch1.html">tail</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch1.html" >up</a>] </p></div>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;1</span><br /><a 
 id="x5-40001"></a>Introduction</h2>
<!--l. 7--><p class="noindent" >This content is part of the book available at <a 
href="http://www.r-inla.org/spde-book" class="url" ><span 
class="aett-10x-x-109">http://www.r-inla.org/spde-book</span></a>, whose
Gitbook version is freely available along all the code and datasets.
</p>
   <h3 class="sectionHead"><span class="titlemark">1.1   </span> <a 
 id="x5-50001.1"></a>Introduction and main results from <span class="cite">[<a 
href="spde-tutorialli2.html#XlindgrenRL:2011">Lindgren et&#x00A0;al., 2011</a>]</span></h3>
<!--l. 14--><p class="noindent" >The R source code for this introduction is available at
<a 
href="http://inla.r-inla-download.org/r-inla.org/tutorials/spde/R/spde-tutorial-introduction.R" class="url" ><span 
class="aett-10x-x-109">http://inla.r-inla-download.org/r-inla.org/tutorials/spde/R/spde-tutorial-introduction.R</span></a>
</p><!--l. 17--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.1.1   </span> <a 
 id="x5-60001.1.1"></a>Spatial variation</h4>
<!--l. 19--><p class="noindent" >A point-referenced dataset is made up of any data measured at known locations. These
locations may be in any coordinate reference system, most often longitude and latitude.
Point-referenced data are common in many areas of science. This type of data appears in
mining, climate modeling, ecology, agriculture and elsewhere. If we want to incorporate
the influence of location in a model for the data we need a model for geo-referenced
data.
</p><!--l. 31--><p class="indent" >   A regression model can be built using the location&#8217;s coordinates as a covariates. In some
cases it will be necessary a complicated function based on the coordinates to adequately describe
the effect of the location. For example, we can consider basis functions on the coordinates and
use it as covariates in order to build a complex function. This model explictly the trend on the
mean.
</p><!--l. 41--><p class="indent" >   Alternatively, it may be more natural to model explictly the variations of the outcome
considering that it maybe similar at nearby locations. The first law of geography asserts:
&#8220;Everything is related to everything else, but near things are more related than distant things&#8221;,
<span class="cite">[<a 
href="spde-tutorialli2.html#Xtobler:1970">Tobler, 1970</a>]</span>. We need a model that incorporates the property that an observation is
more correlated with an observation collected at a neighboring location than with
another observation that is collected from farther away. A spatially-structured random
effects model incorporates such spatial dependency rather than simply one consistent
spatial trend across a domain. Sometimes it is appropriate to include both terms in a
model.
</p><!--l. 57--><p class="indent" >   The models that accounts for spatial dependency may be defined depending whether the
locations are areas (cities for example) or points. The latter case is usually divided when
considering the locations as fixed (geostatistics or point-referenced data) or random (point
process), <span class="cite">[<a 
href="spde-tutorialli2.html#Xcressie:1993">Cressie, 1993</a>]</span>.
</p><!--l. 65--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.1.2   </span> <a 
 id="x5-70001.1.2"></a>The Gaussian random field</h4>
<!--l. 67--><p class="noindent" >To introduce some notation, let <span 
class="cmmi-10x-x-109">s </span>be any location in a study area and let <span 
class="cmmi-10x-x-109">U</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>be the random
(spatial) effect at that location. <span 
class="cmmi-10x-x-109">U</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>is a stochastic process, with <span 
class="cmmi-10x-x-109">s </span><span 
class="cmsy-10x-x-109">&#x2208;</span> <span 
class="cmmib-10x-x-109">D</span>, where <span 
class="cmmib-10x-x-109">D</span> is the domain
of the study area and <span 
class="cmmib-10x-x-109">D</span> <span 
class="cmsy-10x-x-109">&#x2208;&#x211C;</span><sup><span 
class="cmmi-8">d</span></sup>. Suppose, for example, that <span 
class="cmmib-10x-x-109">D</span> is one country and
we have data measured at geographical locations, over <span 
class="cmmi-10x-x-109">d </span><span 
class="cmr-10x-x-109">= 2 </span>dimensions within this
country.
</p><!--l. 76--><p class="indent" >   Suppose we assume that we have a realization of <span 
class="cmmi-10x-x-109">u</span><span 
class="cmr-10x-x-109">(</span><span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">)</span>, <span 
class="cmmi-10x-x-109">i </span><span 
class="cmr-10x-x-109">= 1</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmr-10x-x-109">2</span><span 
class="cmmi-10x-x-109">,...,n</span>, a realization of <span 
class="cmmi-10x-x-109">U</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>in
<span 
class="cmmi-10x-x-109">n </span>locations. It is commonly assumed that <span 
class="cmmi-10x-x-109">u</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>has a multivariate Gaussian distribution. If we
assume that <span 
class="cmmi-10x-x-109">U</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>is continuous over space, we have a continuously-indexed Gaussian field (GF).
This implies that it is possible to collect these data at any finite set of locations within the study
                                                                                 
                                                                                 
region. To complete the specification of the distribution of <span 
class="cmmi-10x-x-109">u</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">s</span><span 
class="cmr-10x-x-109">)</span>, it is necessary to define its mean
and covariance.
</p><!--l. 88--><p class="indent" >   A very simple option is to define a correlation function based only on the Euclidean distance
between locations. This assumes that if we have two pairs of points separated by the same
distance <span 
class="cmmi-10x-x-109">h</span>, both pairs have same degree of correlation. It is intuitive to choose a function that
decrease with distance, <span 
class="cmmi-10x-x-109">h</span>. <span class="cite">[<a 
href="spde-tutorialli2.html#Xabrahamsen:1997">Abrahamsen, 1997</a>]</span> presents Gaussian random fields and correlation
functions.
</p><!--l. 99--><p class="indent" >   Now suppose that we have data <span 
class="cmmi-10x-x-109">y</span><sub><span 
class="cmmi-8">i</span></sub> observed at locations <span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmmi-8">i</span></sub>, <span 
class="cmmi-10x-x-109">i </span><span 
class="cmr-10x-x-109">= 1</span><span 
class="cmmi-10x-x-109">,...,n</span>. If an underlying GF
generated these data, we can fit the parameters of this process considering <span 
class="cmmi-10x-x-109">y</span><span 
class="cmr-10x-x-109">(</span><span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">) = </span><span 
class="cmmi-10x-x-109">u</span><span 
class="cmr-10x-x-109">(</span><span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">)</span>, where
the observation <span 
class="cmmi-10x-x-109">y</span><span 
class="cmr-10x-x-109">(</span><span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">) </span>is assumed to be a realization of the GF at the location <span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmmi-8">i</span></sub>. If we assume
<span 
class="cmmi-10x-x-109">y</span><span 
class="cmr-10x-x-109">(</span><span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">) = </span><span 
class="cmmi-10x-x-109">&#x03BC; </span><span 
class="cmr-10x-x-109">+ </span><span 
class="cmmi-10x-x-109">u</span><span 
class="cmr-10x-x-109">(</span><span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">)</span>, we have one more parameter to estimate. It is worth mentioning that the
distribution for <span 
class="cmmi-10x-x-109">u</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>at a finite number of points is considered a realization of a multivariate
distribution. In this case, the likelihood function is the multivariate distribution with covariance
<span 
class="cmr-10x-x-109">&#x03A3;</span>.
</p><!--l. 115--><p class="indent" >   In many situations we assume that there is an underlying GF but we cannot observe direclty.
Instead we observe data with a measurement error
</p><table 
class="align">
                                 <tr><td 
class="align-odd"><span 
class="cmmi-10x-x-109">y</span><span 
class="cmr-10x-x-109">(</span><span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">) = </span><span 
class="cmmi-10x-x-109">u</span><span 
class="cmr-10x-x-109">(</span><span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">) + </span><span 
class="cmmi-10x-x-109">e</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmmi-10x-x-109">.</span></td>                                 <td 
class="align-even"></td>                                 <td 
class="align-label"><a 
 id="x5-7001r1"></a>(1.1)                                 </td></tr></table>
<!--l. 121--><p class="indent" >   It is common to assume that <span 
class="cmmi-10x-x-109">e</span><sub><span 
class="cmmi-8">i</span></sub> is independent of <span 
class="cmmi-10x-x-109">e</span><sub><span 
class="cmmi-8">j</span></sub> for all <span 
class="cmmi-10x-x-109">i</span><span 
class="cmmi-10x-x-109">&#x2260;</span><span 
class="cmmi-10x-x-109">j </span>and <span 
class="cmmi-10x-x-109">e</span><sub><span 
class="cmmi-8">i</span></sub> <span 
class="cmsy-10x-x-109">~ </span><span 
class="cmmi-10x-x-109">N</span><span 
class="cmr-10x-x-109">(0</span><span 
class="cmmi-10x-x-109">,&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><span 
class="cmr-10x-x-109">)</span>. This
additional parameter, <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub>, measures the remaining noise and is called the nugget effect.
The covariance of the marginal distribution of <span 
class="cmmi-10x-x-109">y</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>at a finite number of locations
is <span 
class="cmr-10x-x-109">&#x03A3;</span><sub><span 
class="cmmi-8">y</span></sub> <span 
class="cmr-10x-x-109">= &#x03A3; + </span><span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmr-8">2</span></sup><span 
class="cmbx-10x-x-109">I</span>. This is a short extension of the basic GF model, and gives one
additional parameter to estimate. For more about this model see <span class="cite">[<a 
href="spde-tutorialli2.html#Xdiggleribeiro:2007">Diggle and Ribeiro Jr,
2007</a>]</span>.
</p><!--l. 134--><p class="indent" >   To usual way to evaluate the likelihood function, which is just a multivariate Gaussian
density for the model in Eq.&#x00A0;<a 
href="#x5-7001r1">1.1<!--tex4ht:ref: eq:toy0 --></a>, usually considers a Cholesky factorization of the covariance
matrix. Because this matrix is a dense, this is a operation of order <span 
class="cmmi-10x-x-109">O</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">n</span><sup><span 
class="cmr-8">3</span></sup><span 
class="cmr-10x-x-109">)</span>, so this is a &#8217;big n
problem&#8217;. Some software for geostatistical analysis uses an empirical variogram to fit the
parameters of the correlation function. However, this option does not make any assumption
about a likelihood function for the data or uses a multivariate Gaussian distribution for the
spatially structured random effect. A good description of these techniques is available in <span class="cite">[<a 
href="spde-tutorialli2.html#Xcressie:1993">Cressie,
1993</a>]</span>.
</p><!--l. 151--><p class="indent" >   When extending the model to deal with non-Gaussian data, it is usual to assume a likelihood
for the data conditional on an unobserved random effect, which is GF to model the spatial
dependence. Such spatial mixed effects model is under the the model based geostatistics
approach, citediggleribeiro:2007. It is possible to describe the model in Eq.&#x00A0;<a 
href="#x5-7001r1">1.1<!--tex4ht:ref: eq:toy0 --></a> within a larger
class of models, hierarchical models. Suppose that we have observations <span 
class="cmmi-10x-x-109">y</span><sub><span 
class="cmmi-8">i</span></sub> for locations <span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmmi-8">i</span></sub>,
                                                                                 
                                                                                 
<span 
class="cmmi-10x-x-109">i </span><span 
class="cmr-10x-x-109">= 1</span><span 
class="cmmi-10x-x-109">,...,n</span>. We start with
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-7002r2"></a>
   <center class="math-display" >
<img 
src="spde-tutorial0x.png" alt="yi|&#x03B8;,&#x03B2;,ui,Fi ~ P(yi|&#x03BC;i,&#x03D5; )
     u ~ GF  (0,&#x03A3; )
" class="math-display"  /></center></td><td class="equation-label">(1.2)</td></tr></table>
<!--l. 165--><p class="nopar" >
 where <span 
class="cmmi-10x-x-109">&#x03BC;</span><sub><span 
class="cmmi-8">i</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">h</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmbx-10x-x-109">F</span><sub><span 
class="cmmi-8">i</span></sub><sup><span 
class="cmmi-8">T</span> </sup><span 
class="cmmi-10x-x-109">&#x03B2; </span><span 
class="cmr-10x-x-109">+ </span><span 
class="cmmi-10x-x-109">u</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">)</span>, <span 
class="cmbx-10x-x-109">F </span>is a matrix of covariates, <span 
class="cmbx-10x-x-109">u </span>is the random effect, <span 
class="cmmi-10x-x-109">&#x03B8; </span>are parameters
for the random effect, <span 
class="cmmi-10x-x-109">&#x03B2; </span>are covariate coefficients, <span 
class="cmmi-10x-x-109">h</span><span 
class="cmr-10x-x-109">() </span>is a function mapping the linear predictor
<span 
class="cmbx-10x-x-109">F</span><sub><span 
class="cmmi-8">i</span></sub><sup><span 
class="cmmi-8">T</span> </sup><span 
class="cmmi-10x-x-109">&#x03B2; </span><span 
class="cmr-10x-x-109">+ </span><span 
class="cmmi-10x-x-109">u</span><sub><span 
class="cmmi-8">i</span></sub> to E<span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">y</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">) = </span><span 
class="cmmi-10x-x-109">&#x03BC;</span><sub><span 
class="cmmi-8">i</span></sub> and <span 
class="cmmi-10x-x-109">&#x03D5; </span>is a dispersion parameter of the distribution, in the exponential
family, which is assumed for <span 
class="cmmi-10x-x-109">y</span><sub><span 
class="cmmi-8">i</span></sub>. To write the GF with a nugget effect, we replace
<span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub> with <span 
class="cmbx-10x-x-109">F</span><sub><span 
class="cmmi-8">i</span></sub><sup><span 
class="cmmi-8">T</span> </sup><span 
class="cmmi-10x-x-109">&#x03B2;</span>, assume a Gaussian distribution for <span 
class="cmmi-10x-x-109">y</span><sub><span 
class="cmmi-8">i</span></sub>, with variance <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmr-8">2</span></sup> and <span 
class="cmbx-10x-x-109">u </span>as a
GF. However, at times one does consider a multivariate Gaussian distribution for
the random effect, it becomes impractical to use covariance directly for model-based
inference.
</p><!--l. 184--><p class="indent" >   In another area of spatial statistics, the analysis of areal data, there are models specified by
conditional distributions that imply a joint distribution with a sparse precision matrix. These
models are called Gaussian Markov random fields (GMRF) and a good reference is <span class="cite">[<a 
href="spde-tutorialli2.html#XRueHeld:2005">Rue and
Held, 2005</a>]</span>. It is computationally easier to make Bayesian inference when we use a GMRF than
when we use a GF, because the cost in computation of working with a sparse precision
matrix in GMRF models is <span 
class="cmmi-10x-x-109">O</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">n</span><sup><span 
class="cmr-8">3</span><span 
class="cmmi-8">&#x2215;</span><span 
class="cmr-8">2</span></sup><span 
class="cmr-10x-x-109">)</span>. This makes it easier to conduct analyses with big
&#8217;n&#8217;.
</p><!--l. 199--><p class="indent" >   We can extend this basic hierarchical model in many ways, and we return to some extensions
later. If we know the properties of the GF, we can study all the practical models that contain or
are based on, this random effect.
</p><!--l. 205--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.1.3   </span> <a 
 id="x5-80001.1.3"></a>The Matérn covariance</h4>
<!--l. 207--><p class="noindent" >A very popular correlation function is the Matérn correlation function. It has a scale parameter
<span 
class="cmmi-10x-x-109">&#x03BA; &#x003E; </span><span 
class="cmr-10x-x-109">0 </span>and a smoothness parameter <span 
class="cmmi-10x-x-109">&#x03BD; &#x003E; </span><span 
class="cmr-10x-x-109">0</span>. For two locations <span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmmi-8">i</span></sub> and <span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmmi-8">j</span></sub>, the stationary and
isotropic Matérn correlation function is:
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-8001r3"></a>
   <center class="math-display" >
<img 
src="spde-tutorial1x.png" alt="                     21-&#x03BD;             &#x03BD;
CorM  (U(si),U (sj)) = &#x0393;-(&#x03BD;-)(&#x03BA; &#x2225; si - sj &#x2225;) K &#x03BD;(&#x03BA; &#x2225; si - sj &#x2225;)
" class="math-display"  /></center></td><td class="equation-label">(1.3)</td></tr></table>
<!--l. 218--><p class="nopar" >
where <span 
class="cmsy-10x-x-109">&#x2225; </span><span 
class="cmmi-10x-x-109">. </span><span 
class="cmsy-10x-x-109">&#x2225; </span>denotes the Euclidean distance and <span 
class="cmmi-10x-x-109">K</span><sub><span 
class="cmmi-8">&#x03BD;</span></sub> is the modified Bessel function of the second
order. The Matérn covariance function is <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">u</span></sub><span 
class="cmmi-10x-x-109">Cor</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">U</span><span 
class="cmr-10x-x-109">(</span><span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">)</span><span 
class="cmmi-10x-x-109">,U</span><span 
class="cmr-10x-x-109">(</span><span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmmi-8">j</span></sub><span 
class="cmr-10x-x-109">))</span>, where <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">u</span></sub> is the marginal variance
of the process.
</p><!--l. 226--><p class="indent" >   If we have a realization <span 
class="cmmi-10x-x-109">u</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>from <span 
class="cmmi-10x-x-109">U</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>at <span 
class="cmmi-10x-x-109">n </span>locations, <span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmr-8">1</span></sub><span 
class="cmmi-10x-x-109">,...,</span><span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmmi-8">n</span></sub>, we can define its joint
covariance matrix. Each entry of this joint covariance matrix <span 
class="cmr-10x-x-109">&#x03A3; </span>is <span 
class="cmr-10x-x-109">&#x03A3;</span><sub><span 
class="cmmi-8">i,j</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">u</span></sub><span 
class="cmmi-10x-x-109">Cor</span><sub><span 
class="cmmi-8">M</span></sub><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">u</span><span 
class="cmr-10x-x-109">(</span><span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">)</span><span 
class="cmmi-10x-x-109">,u</span><span 
class="cmr-10x-x-109">(</span><span 
class="aebx-10x-x-109">s</span><sub><span 
class="cmmi-8">j</span></sub><span 
class="cmr-10x-x-109">))</span>.
It is common to assume that <span 
class="cmmi-10x-x-109">U</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">.</span><span 
class="cmr-10x-x-109">) </span>has a zero mean. We have now completely defined a
multivariate distribution for <span 
class="cmmi-10x-x-109">u</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">s</span><span 
class="cmr-10x-x-109">)</span>.
</p><!--l. 235--><p class="indent" >   To gain a better feel about the Matérn correlation we can drawn samples from the RF
process and look at it. A sample <span 
class="cmbx-10x-x-109">u </span>is drawn considering <span 
class="cmbx-10x-x-109">u </span><span 
class="cmr-10x-x-109">=</span> <span 
class="cmbx-10x-x-109">Lz</span> where <span 
class="cmbx-10x-x-109">L </span>is the Cholesky
decomposition of the covariance at <span 
class="cmmi-10x-x-109">n </span>locations and <span 
class="cmmi-10x-x-109">z </span>is a vector with <span 
class="cmmi-10x-x-109">n </span>samples drawn from
a standard Gaussian distribution. It implies that E<span 
class="cmr-10x-x-109">(</span><span 
class="cmbx-10x-x-109">u</span><span 
class="cmr-10x-x-109">) =</span> E<span 
class="cmr-10x-x-109">(</span><span 
class="cmbx-10x-x-109">Lz</span><span 
class="cmr-10x-x-109">) = </span><span 
class="cmbx-10x-x-109">L</span>E<span 
class="cmr-10x-x-109">(</span><span 
class="cmbx-10x-x-109">z</span><span 
class="cmr-10x-x-109">) = 0 </span>and
<span 
class="cmmi-10x-x-109">V ar</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmbx-10x-x-109">u</span><span 
class="cmr-10x-x-109">) = </span><span 
class="cmbx-10x-x-109">L</span><span 
class="cmsy-10x-x-109">&#x2032;</span>Var<span 
class="cmr-10x-x-109">(</span><span 
class="cmbx-10x-x-109">z</span><span 
class="cmr-10x-x-109">)</span><span 
class="cmbx-10x-x-109">L </span><span 
class="cmr-10x-x-109">= </span><span 
class="cmbx-10x-x-109">L</span><span 
class="cmsy-10x-x-109">&#x2032;</span><span 
class="cmbx-10x-x-109">L</span>. We define functions to do the sampling bellow  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1"><span 
class="aett-10x-x-109">cMatern</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor4"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor5"><span 
class="aett-10x-x-109">h</span></span><span id="textcolor6"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor7"><span 
class="aett-10x-x-109">nu</span></span><span id="textcolor8"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor9"><span 
class="aett-10x-x-109">kappa</span></span><span id="textcolor10"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor11"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;Matern</span><span 
class="aeitt-10x-x-109">&#x00A0;correlation</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor12"><span 
class="aett-10x-x-109">besselK</span></span><span id="textcolor13"><span 
class="aett-10x-x-109">(h</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor14"><span 
class="aett-10x-x-109">*</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor15"><span 
class="aett-10x-x-109">kappa,</span><span 
class="aett-10x-x-109">&#x00A0;nu)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor16"><span 
class="aett-10x-x-109">*</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor17"><span 
class="aett-10x-x-109">(h</span></span><span id="textcolor18"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor19"><span 
class="aett-10x-x-109">kappa)</span></span><span id="textcolor20"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor21"><span 
class="aett-10x-x-109">nu</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor22"><span 
class="aett-10x-x-109">/</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor23"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor24"><span 
class="aett-10x-x-109">gamma</span></span><span id="textcolor25"><span 
class="aett-10x-x-109">(nu)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor26"><span 
class="aett-10x-x-109">*</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor27"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor28"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor29"><span 
class="aett-10x-x-109">(nu</span></span><span id="textcolor30"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor31"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor32"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor33"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;function</span><span 
class="aeitt-10x-x-109">&#x00A0;to</span><span 
class="aeitt-10x-x-109">&#x00A0;sample</span><span 
class="aeitt-10x-x-109">&#x00A0;from</span><span 
class="aeitt-10x-x-109">&#x00A0;zero</span><span 
class="aeitt-10x-x-109">&#x00A0;mean</span><span 
class="aeitt-10x-x-109">&#x00A0;multivariate</span><span 
class="aeitt-10x-x-109">&#x00A0;normal</span></span>
<br /><span id="textcolor34"><span 
class="aett-10x-x-109">rmvnorm0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor35"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor36"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor37"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor38"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor39"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor40"><span 
class="aett-10x-x-109">cov</span></span><span id="textcolor41"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor42"><span 
class="aett-10x-x-109">L</span></span><span id="textcolor43"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor44"><span 
class="aett-10x-x-109">NULL</span></span><span id="textcolor45"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor46"><span 
class="aett-10x-x-109">if</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor47"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor48"><span 
class="aett-10x-x-109">is.null</span></span><span id="textcolor49"><span 
class="aett-10x-x-109">(L))</span><span 
class="aett-10x-x-109">&#x00A0;L</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor50"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor51"><span 
class="aett-10x-x-109">chol</span></span><span id="textcolor52"><span 
class="aett-10x-x-109">(cov)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor53"><span 
class="aett-10x-x-109">return</span></span><span id="textcolor54"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor55"><span 
class="aett-10x-x-109">crossprod</span></span><span id="textcolor56"><span 
class="aett-10x-x-109">(L,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor57"><span 
class="aett-10x-x-109">matrix</span></span><span id="textcolor58"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor59"><span 
class="aett-10x-x-109">rnorm</span></span><span id="textcolor60"><span 
class="aett-10x-x-109">(n</span></span><span id="textcolor61"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor62"><span 
class="aett-10x-x-109">ncol</span></span><span id="textcolor63"><span 
class="aett-10x-x-109">(L)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor64"><span 
class="aett-10x-x-109">ncol</span></span><span id="textcolor65"><span 
class="aett-10x-x-109">(L))))</span></span>
<br /><span id="textcolor66"><span 
class="aett-10x-x-109">}</span></span>
</div>
</div>
   </div>
These steps are collected into the function <span 
class="aett-10x-x-109">rMatern </span>that is available at
<a 
href="http://inla.r-inla-download.org/r-inla.org/tutorials/spde/R/spde-tutorial-functions.R" class="url" ><span 
class="aett-10x-x-109">http://inla.r-inla-download.org/r-inla.org/tutorials/spde/R/spde-tutorial-functions.R</span></a>
<!--l. 268--><p class="indent" >   In order to simplify the visualization of the properties, we consider a set of <span 
class="cmmi-10x-x-109">n </span><span 
class="cmr-10x-x-109">= 249 </span>locations
in the one-dimensional space from 0 to <span 
class="cmr-10x-x-109">25</span>.  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor67"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;define</span><span 
class="aeitt-10x-x-109">&#x00A0;locations</span><span 
class="aeitt-10x-x-109">&#x00A0;and</span><span 
class="aeitt-10x-x-109">&#x00A0;distance</span><span 
class="aeitt-10x-x-109">&#x00A0;matrix</span></span>
<br /><span id="textcolor68"><span 
class="aett-10x-x-109">loc</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor69"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor70"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor71"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor72"><span 
class="aett-10x-x-109">249</span></span><span id="textcolor73"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor74"><span 
class="aett-10x-x-109">25</span></span>
<br /><span id="textcolor75"><span 
class="aett-10x-x-109">mdist</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor76"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor77"><span 
class="aett-10x-x-109">as.matrix</span></span><span id="textcolor78"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor79"><span 
class="aett-10x-x-109">dist</span></span><span id="textcolor80"><span 
class="aett-10x-x-109">(loc))</span></span>
</div>
</div>
   </div>
<!--l. 281--><p class="indent" >   We consider four values for the smoothness parameter <span 
class="cmmi-10x-x-109">&#x03BD;</span>. The values for the <span 
class="cmmi-10x-x-109">&#x03BA; </span>parameter was
determined from the practical range expression <img 
src="spde-tutorial2x.png" alt="&#x221A; ---
  8&#x03BD;"  class="sqrt"  /><span 
class="cmmi-10x-x-109">&#x2215;&#x03BA;</span>, which is the distance that gives
correlation near <span 
class="cmr-10x-x-109">0</span><span 
class="cmmi-10x-x-109">.</span><span 
class="cmr-10x-x-109">13</span>. By combining the four values for <span 
class="cmmi-10x-x-109">&#x03BD; </span>with two values for the practical range
we have eight parameter configurations.  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
                                                                                 
                                                                                 
<div class="obeylines-v">
<span id="textcolor81"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;define</span><span 
class="aeitt-10x-x-109">&#x00A0;parameters</span></span>
<br /><span id="textcolor82"><span 
class="aett-10x-x-109">nu</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor83"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor84"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor85"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor86"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor87"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor88"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor89"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor90"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor91"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor92"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor93"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor94"><span 
class="aett-10x-x-109">pract.range</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor95"><span 
class="aett-10x-x-109">=</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor96"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor97"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor98"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor99"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor100"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor101"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor102"><span 
class="aett-10x-x-109">kappa</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor103"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor104"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor105"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor106"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor107"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor108"><span 
class="aett-10x-x-109">8</span></span><span id="textcolor109"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor110"><span 
class="aett-10x-x-109">nu)</span></span><span id="textcolor111"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor112"><span 
class="aett-10x-x-109">pract.range[</span></span><span id="textcolor113"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor114"><span 
class="aett-10x-x-109">],</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor115"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor116"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor117"><span 
class="aett-10x-x-109">8</span></span><span id="textcolor118"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor119"><span 
class="aett-10x-x-109">nu)</span></span><span id="textcolor120"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor121"><span 
class="aett-10x-x-109">pract.range[</span></span><span id="textcolor122"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor123"><span 
class="aett-10x-x-109">])</span></span>
<br /><span id="textcolor124"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;covariance</span><span 
class="aeitt-10x-x-109">&#x00A0;parameter</span><span 
class="aeitt-10x-x-109">&#x00A0;scenarios</span></span>
<br /><span id="textcolor125"><span 
class="aett-10x-x-109">params</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor126"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor127"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor128"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor129"><span 
class="aett-10x-x-109">nu</span></span><span id="textcolor130"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor131"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor132"><span 
class="aett-10x-x-109">(nu,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor133"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor134"><span 
class="aett-10x-x-109">(pract.range)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor135"><span 
class="aett-10x-x-109">kappa</span></span><span id="textcolor136"><span 
class="aett-10x-x-109">=kappa,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor137"><span 
class="aett-10x-x-109">r</span></span><span id="textcolor138"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor139"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor140"><span 
class="aett-10x-x-109">(pract.range,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor141"><span 
class="aett-10x-x-109">each</span></span><span id="textcolor142"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor143"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor144"><span 
class="aett-10x-x-109">(nu)))</span></span>
</div>
</div>
   </div>
<!--l. 306--><p class="indent" >   The sample value depends on the covariance matrix and on the noise considered from the
standard Gaussian distribution, <span 
class="cmmi-10x-x-109">z</span>. We consider a set of five vectors of size <span 
class="cmmi-10x-x-109">n </span>drawn from the
standard Gaussian distribution. These five standard Gaussian were the same among the eight
parameter configurations in order to keep track what the different parameter configuration are
doing.  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor145"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;sample</span><span 
class="aeitt-10x-x-109">&#x00A0;error</span></span>
<br /><span id="textcolor146"><span 
class="aett-10x-x-109">set.seed</span></span><span id="textcolor147"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor148"><span 
class="aett-10x-x-109">123</span></span><span id="textcolor149"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor150"><span 
class="aett-10x-x-109">z</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor151"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor152"><span 
class="aett-10x-x-109">matrix</span></span><span id="textcolor153"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor154"><span 
class="aett-10x-x-109">rnorm</span></span><span id="textcolor155"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor156"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor157"><span 
class="aett-10x-x-109">(mdist)</span></span><span id="textcolor158"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor159"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor160"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor161"><span 
class="aett-10x-x-109">ncol</span></span><span id="textcolor162"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor163"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor164"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<!--l. 325--><p class="indent" >   Therefore, we have a set of <span 
class="cmr-10x-x-109">40 </span>different realizations, five for each parameter configuration
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor165"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;compute</span><span 
class="aeitt-10x-x-109">&#x00A0;the</span><span 
class="aeitt-10x-x-109">&#x00A0;correlated</span><span 
class="aeitt-10x-x-109">&#x00A0;samples</span></span>
<br /><span id="textcolor166"><span 
class="aett-10x-x-109">yy</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor167"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor168"><span 
class="aett-10x-x-109">lapply</span></span><span id="textcolor169"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor170"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor171"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor172"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor173"><span 
class="aett-10x-x-109">(params),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor174"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor175"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor176"><span 
class="aett-10x-x-109">j</span></span><span id="textcolor177"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor178"><span 
class="aeitt-10x-x-109">##</span><span 
class="aeitt-10x-x-109">&#x00A0;scenarios</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor179"><span 
class="aett-10x-x-109">v</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor180"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor181"><span 
class="aett-10x-x-109">cMatern</span></span><span id="textcolor182"><span 
class="aett-10x-x-109">(mdist,</span><span 
class="aett-10x-x-109">&#x00A0;params[j,</span></span><span id="textcolor183"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor184"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;params[j,</span></span><span id="textcolor185"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor186"><span 
class="aett-10x-x-109">])</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor187"><span 
class="aett-10x-x-109">diag</span></span><span id="textcolor188"><span 
class="aett-10x-x-109">(v)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor189"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor190"><span 
class="aett-10x-x-109">1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor191"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor192"><span 
class="aett-10x-x-109">1e-10</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor193"><span 
class="aett-10x-x-109">return</span></span><span id="textcolor194"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor195"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor196"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor197"><span 
class="aett-10x-x-109">params</span></span><span id="textcolor198"><span 
class="aett-10x-x-109">=params[j,],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor199"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;parameter</span><span 
class="aeitt-10x-x-109">&#x00A0;scenario</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor200"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor201"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor202"><span 
class="aett-10x-x-109">crossprod</span></span><span id="textcolor203"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor204"><span 
class="aett-10x-x-109">chol</span></span><span id="textcolor205"><span 
class="aett-10x-x-109">(v),</span><span 
class="aett-10x-x-109">&#x00A0;z)))</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor206"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;compute</span><span 
class="aeitt-10x-x-109">&#x00A0;sample</span></span>
<br /><span id="textcolor207"><span 
class="aett-10x-x-109">})</span></span>
</div>
</div>
   </div>
<!--l. 341--><p class="indent" >   These samples are shown in the eight plots in Figure&#x00A0;<a 
href="#x5-80001.1.3">1.1.3<!--tex4ht:ref: fig:maternsamples --></a>.
                                                                                 
                                                                                 
</p>
   <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor208"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;visualize</span></span>
<br /><span id="textcolor209"><span 
class="aett-10x-x-109">(ry</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor210"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor211"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor212"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor213"><span 
class="aett-10x-x-109">unlist</span></span><span id="textcolor214"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor215"><span 
class="aett-10x-x-109">lapply</span></span><span id="textcolor216"><span 
class="aett-10x-x-109">(yy,</span><span 
class="aett-10x-x-109">&#x00A0;tail,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor217"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor218"><span 
class="aett-10x-x-109">))))</span></span>
<br /><span id="textcolor219"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor220"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor221"><span 
class="aett-10x-x-109">mfcol</span></span><span id="textcolor222"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor223"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor224"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor225"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor226"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor227"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor228"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor229"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor230"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor231"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor232"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor233"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor234"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor235"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor236"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor237"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor238"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor239"><span 
class="aett-10x-x-109">.1</span></span><span id="textcolor240"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor241"><span 
class="aett-10x-x-109">mgp</span></span><span id="textcolor242"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor243"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor244"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor245"><span 
class="aett-10x-x-109">1.5</span></span><span id="textcolor246"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor247"><span 
class="aett-10x-x-109">0.7</span></span><span id="textcolor248"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor249"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor250"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor251"><span 
class="aett-10x-x-109">las</span></span><span id="textcolor252"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor253"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor254"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor255"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor256"><span 
class="aett-10x-x-109">(i</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor257"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor258"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor259"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor260"><span 
class="aett-10x-x-109">length</span></span><span id="textcolor261"><span 
class="aett-10x-x-109">(yy))</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor262"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;each</span><span 
class="aeitt-10x-x-109">&#x00A0;scenario</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor263"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor264"><span 
class="aett-10x-x-109">(loc,</span><span 
class="aett-10x-x-109">&#x00A0;yy[[i]]</span></span><span id="textcolor265"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor266"><span 
class="aett-10x-x-109">y[,</span></span><span id="textcolor267"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor268"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor269"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor270"><span 
class="aett-10x-x-109">=ry,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor271"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor272"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor273"><span 
class="tctt-1095">''</span></span><span id="textcolor274"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor275"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor276"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor277"><span 
class="tctt-1095">''</span></span><span id="textcolor278"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor279"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor280"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor281"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">n</span><span 
class="tctt-1095">'</span></span><span id="textcolor282"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor283"><span 
class="aett-10x-x-109">main</span></span><span id="textcolor284"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor285"><span 
class="aett-10x-x-109">as.expression</span></span><span id="textcolor286"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor287"><span 
class="aett-10x-x-109">bquote</span></span><span id="textcolor288"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor289"><span 
class="aett-10x-x-109">paste</span></span><span id="textcolor290"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor291"><span 
class="aett-10x-x-109">nu</span></span><span id="textcolor292"><span 
class="aett-10x-x-109">==</span></span><span id="textcolor293"><span 
class="aett-10x-x-109">.</span></span><span id="textcolor294"><span 
class="aett-10x-x-109">(yy[[i]]</span></span><span id="textcolor295"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor296"><span 
class="aett-10x-x-109">params[</span></span><span id="textcolor297"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor298"><span 
class="aett-10x-x-109">]),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor299"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="tctt-1095">'</span></span><span id="textcolor300"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor301"><span 
class="aett-10x-x-109">kappa</span></span><span id="textcolor302"><span 
class="aett-10x-x-109">==</span></span><span id="textcolor303"><span 
class="aett-10x-x-109">.</span></span><span id="textcolor304"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor305"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor306"><span 
class="aett-10x-x-109">(yy[[i]]</span></span><span id="textcolor307"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor308"><span 
class="aett-10x-x-109">params[</span></span><span id="textcolor309"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor310"><span 
class="aett-10x-x-109">],</span></span><span id="textcolor311"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor312"><span 
class="aett-10x-x-109">)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor313"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="tctt-1095">'</span></span><span id="textcolor314"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor315"><span 
class="aett-10x-x-109">r</span></span><span id="textcolor316"><span 
class="aett-10x-x-109">==</span></span><span id="textcolor317"><span 
class="aett-10x-x-109">.</span></span><span id="textcolor318"><span 
class="aett-10x-x-109">(yy[[i]]</span></span><span id="textcolor319"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor320"><span 
class="aett-10x-x-109">params[</span></span><span id="textcolor321"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor322"><span 
class="aett-10x-x-109">])))))</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor323"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor324"><span 
class="aett-10x-x-109">(k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor325"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor326"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor327"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor328"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor329"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor330"><span 
class="aett-10x-x-109">lines</span></span><span id="textcolor331"><span 
class="aett-10x-x-109">(loc,</span><span 
class="aett-10x-x-109">&#x00A0;yy[[i]]</span></span><span id="textcolor332"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor333"><span 
class="aett-10x-x-109">y[,k],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor334"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor335"><span 
class="aett-10x-x-109">=k)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor336"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;each</span><span 
class="aeitt-10x-x-109">&#x00A0;sample</span><span 
class="aeitt-10x-x-109">&#x00A0;</span></span>
<br /><span id="textcolor337"><span 
class="aett-10x-x-109">}</span></span>
</div>
</div>
   </div>
<hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x5-80021"></a>
                                                                                 
                                                                                 
<!--l. 366--><p class="noindent" ><img 
src="spde-tutorial3x.png" alt="PIC" class="graphics" width="413" height="579"  /><!--tex4ht:graphics  
name="spde-tutorial3x.png" src="figs/intromaternsamplesfig-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;1.1:  </span><span  
class="content">Five  samples  from  the  one-dimensional  Matérn  correlation  function  for
two different ranges (each column of plots) and four different value for the smoothness
parameter (each line of plots).</span></div><!--tex4ht:label?: x5-80021 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 375--><p class="indent" >   One important point to observe in Figure&#x00A0;<a 
href="#x5-80001.1.3">1.1.3<!--tex4ht:ref: fig:maternsamples --></a> is the main feature on the samples. It almost
does not depends on the smoothness parameter. To see it consider one of the five samples (one of
the colors) and compare it for different smoothness. Also, image if we add a noise on a smooth
process, it will becomes hard them to distinguish what is due to noise from what is due to
smoothness. Therefore, in practice we usually fix the smoothness parameter and add a noise
term.
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.1.4   </span> <a 
 id="x5-90001.1.4"></a>Simulation of a toy data set</h4>
<!--l. 390--><p class="noindent" >We will now draw a sample from the model in Eq.&#x00A0;<a 
href="#x5-7001r1">1.1<!--tex4ht:ref: eq:toy0 --></a> and use in Section&#x00A0;<a 
href="#x5-130001.2">1.2<!--tex4ht:ref: sec:toyexample --></a>. We consider a set
of <span 
class="cmmi-10x-x-109">n </span><span 
class="cmr-10x-x-109">= 100 </span>locations within a square of area one and bottom left and top right limits of (0,0) and
(1,1). We choose a higher density of locations in the bottom left corner than in the top right
corner. The <span 
class="aeb10-x-x-109">R </span>code to do this is:  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor338"><span 
class="aett-10x-x-109">n</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor339"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor340"><span 
class="aett-10x-x-109">200</span></span><span id="textcolor341"><span 
class="aett-10x-x-109">;</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor342"><span 
class="aett-10x-x-109">set.seed</span></span><span id="textcolor343"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor344"><span 
class="aett-10x-x-109">123</span></span><span id="textcolor345"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor346"><span 
class="aett-10x-x-109">pts</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor347"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor348"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor349"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor350"><span 
class="aett-10x-x-109">s1</span></span><span id="textcolor351"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor352"><span 
class="aett-10x-x-109">sample</span></span><span id="textcolor353"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor354"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor355"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor356"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor357"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor358"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor359"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor360"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor361"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor362"><span 
class="aett-10x-x-109">n)</span></span><span id="textcolor363"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor364"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor365"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor366"><span 
class="aett-10x-x-109">s2</span></span><span id="textcolor367"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor368"><span 
class="aett-10x-x-109">sample</span></span><span id="textcolor369"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor370"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor371"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor372"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor373"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor374"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor375"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor376"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor377"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor378"><span 
class="aett-10x-x-109">n)</span></span><span id="textcolor379"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor380"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor381"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
To get a (lower triangle) matrix of distances we call  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor382"><span 
class="aett-10x-x-109">dmat</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor383"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor384"><span 
class="aett-10x-x-109">dist</span></span><span id="textcolor385"><span 
class="aett-10x-x-109">(pts)</span></span>
</div>
</div>
   </div>
<!--l. 415--><p class="indent" >   We choose parameter values for the Matérn as <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">u</span></sub><sup><span 
class="cmr-8">2</span></sup> <span 
class="cmr-10x-x-109">= 5</span>, <span 
class="cmmi-10x-x-109">&#x03BA; </span><span 
class="cmr-10x-x-109">= 7 </span>and <span 
class="cmmi-10x-x-109">&#x03BD; </span><span 
class="cmr-10x-x-109">= 1</span>. We define the mean
<span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub> <span 
class="cmr-10x-x-109">= 10 </span>and the nugget parameter <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmr-8">2</span></sup> <span 
class="cmr-10x-x-109">= 0</span><span 
class="cmmi-10x-x-109">.</span><span 
class="cmr-10x-x-109">3</span>. We declare values for these parameters using
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor386"><span 
class="aett-10x-x-109">beta0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor387"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor388"><span 
class="aett-10x-x-109">10</span></span><span id="textcolor389"><span 
class="aett-10x-x-109">;</span><span 
class="aett-10x-x-109">&#x00A0;sigma2e</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor390"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor391"><span 
class="aett-10x-x-109">0.3</span></span><span id="textcolor392"><span 
class="aett-10x-x-109">;</span><span 
class="aett-10x-x-109">&#x00A0;sigma2u</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor393"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor394"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor395"><span 
class="aett-10x-x-109">;</span><span 
class="aett-10x-x-109">&#x00A0;kappa</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor396"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor397"><span 
class="aett-10x-x-109">7</span></span><span id="textcolor398"><span 
class="aett-10x-x-109">;</span><span 
class="aett-10x-x-109">&#x00A0;nu</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor399"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor400"><span 
class="aett-10x-x-109">1</span></span>
</div>
</div>
   </div>
<!--l. 428--><p class="indent" >   Now we need to sample from a multivariate distribution with constant mean equals
<span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub> and covariance <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmr-8">2</span></sup><span 
class="cmmi-10x-x-109">I </span><span 
class="cmr-10x-x-109">+ &#x03A3;</span>, which is the marginal covariance of the observations.
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
                                                                                 
                                                                                 
<div class="obeylines-v">
<span id="textcolor401"><span 
class="aett-10x-x-109">mcor</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor402"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor403"><span 
class="aett-10x-x-109">as.matrix</span></span><span id="textcolor404"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor405"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor406"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor407"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor408"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor409"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor410"><span 
class="aett-10x-x-109">nu)</span></span><span id="textcolor411"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor412"><span 
class="aett-10x-x-109">(kappa</span></span><span id="textcolor413"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor414"><span 
class="aett-10x-x-109">dmat)</span></span><span id="textcolor415"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor416"><span 
class="aett-10x-x-109">nu</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor417"><span 
class="aett-10x-x-109">*</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor418"><span 
class="aett-10x-x-109">besselK</span></span><span id="textcolor419"><span 
class="aett-10x-x-109">(dmat</span></span><span id="textcolor420"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor421"><span 
class="aett-10x-x-109">kappa,nu)</span></span><span id="textcolor422"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor423"><span 
class="aett-10x-x-109">gamma</span></span><span id="textcolor424"><span 
class="aett-10x-x-109">(nu))</span></span>
<br /><span id="textcolor425"><span 
class="aett-10x-x-109">diag</span></span><span id="textcolor426"><span 
class="aett-10x-x-109">(mcor)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor427"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor428"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor429"><span 
class="aett-10x-x-109">;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;mcov</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor430"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor431"><span 
class="aett-10x-x-109">sigma2e</span></span><span id="textcolor432"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor433"><span 
class="aett-10x-x-109">diag</span></span><span id="textcolor434"><span 
class="aett-10x-x-109">(n)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor435"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor436"><span 
class="aett-10x-x-109">sigma2u</span></span><span id="textcolor437"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor438"><span 
class="aett-10x-x-109">mcor</span></span>
</div>
</div>
   </div>
We can now sample considering the Cholesky factor times a unit variance noise and add the
mean  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor439"><span 
class="aett-10x-x-109">L</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor440"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor441"><span 
class="aett-10x-x-109">chol</span></span><span id="textcolor442"><span 
class="aett-10x-x-109">(mcov);</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor443"><span 
class="aett-10x-x-109">set.seed</span></span><span id="textcolor444"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor445"><span 
class="aett-10x-x-109">234</span></span><span id="textcolor446"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor447"><span 
class="aett-10x-x-109">y1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor448"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor449"><span 
class="aett-10x-x-109">beta0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor450"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor451"><span 
class="aett-10x-x-109">drop</span></span><span id="textcolor452"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor453"><span 
class="aett-10x-x-109">crossprod</span></span><span id="textcolor454"><span 
class="aett-10x-x-109">(L,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor455"><span 
class="aett-10x-x-109">rnorm</span></span><span id="textcolor456"><span 
class="aett-10x-x-109">(n)))</span></span>
</div>
</div>
   </div>
<!--l. 452--><p class="indent" >   We show these simulated data in a graph of the locations where the size of the points is
proportional to the simulated values. Figure&#x00A0;<a 
href="#x5-90001.1.4">1.1.4<!--tex4ht:ref: fig:grf1 --></a> was produced with the code below
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor457"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor458"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor459"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor460"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor461"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor462"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor463"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor464"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor465"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor466"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor467"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor468"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor469"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor470"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor471"><span 
class="aett-10x-x-109">mgp</span></span><span id="textcolor472"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor473"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor474"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor475"><span 
class="aett-10x-x-109">1.7</span></span><span id="textcolor476"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor477"><span 
class="aett-10x-x-109">0.7</span></span><span id="textcolor478"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor479"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor480"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor481"><span 
class="aett-10x-x-109">las</span></span><span id="textcolor482"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor483"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor484"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor485"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor486"><span 
class="aett-10x-x-109">(pts,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor487"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor488"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor489"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor490"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor491"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor492"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor493"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor494"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor495"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor496"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor497"><span 
class="aett-10x-x-109">1.2</span></span><span id="textcolor498"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor499"><span 
class="aett-10x-x-109">cex</span></span><span id="textcolor500"><span 
class="aett-10x-x-109">=y1</span></span><span id="textcolor501"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor502"><span 
class="aett-10x-x-109">10</span></span><span id="textcolor503"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor504"><span 
class="aett-10x-x-109">q</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor505"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor506"><span 
class="aett-10x-x-109">quantile</span></span><span id="textcolor507"><span 
class="aett-10x-x-109">(y1,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor508"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor509"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor510"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor511"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor512"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor513"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor514"><span 
class="aett-10x-x-109">legend</span></span><span id="textcolor515"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor516"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">topright</span><span 
class="tctt-1095">'</span></span><span id="textcolor517"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor518"><span 
class="aett-10x-x-109">format</span></span><span id="textcolor519"><span 
class="aett-10x-x-109">(q,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor520"><span 
class="aett-10x-x-109">dig</span></span><span id="textcolor521"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor522"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor523"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor524"><span 
class="aett-10x-x-109">pch</span></span><span id="textcolor525"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor526"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor527"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor528"><span 
class="aett-10x-x-109">pt.cex</span></span><span id="textcolor529"><span 
class="aett-10x-x-109">=q</span></span><span id="textcolor530"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor531"><span 
class="aett-10x-x-109">10</span></span><span id="textcolor532"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x5-90012"></a>
                                                                                 
                                                                                 
<!--l. 470--><p class="noindent" ><img 
src="spde-tutorial4x.png" alt="PIC" class="graphics" width="397" height="339"  /><!--tex4ht:graphics  
name="spde-tutorial4x.png" src="figs/introplot1-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;1.2: </span><span  
class="content">The simulated toy example data.</span></div><!--tex4ht:label?: x5-90012 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 476--><p class="indent" >   This data will be used as a toy example in this tutorial. It is available in the <span 
class="aett-10x-x-109">R-INLA </span>package
and can be loaded by  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor533"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor534"><span 
class="aett-10x-x-109">(SPDEtoy)</span></span>
</div>
</div>
   </div>
   <h4 class="subsectionHead"><span class="titlemark">1.1.5   </span> <a 
 id="x5-100001.1.5"></a>The SPDE approach</h4>
<!--l. 489--><p class="noindent" >In this section we summarizes the main results in <span class="cite">[<a 
href="spde-tutorialli2.html#XlindgrenRL:2011">Lindgren et&#x00A0;al., 2011</a>]</span>. If your purpose does
not includes understanding the methodology, you can skip this section. If you keep
reading this section and have difficulty, do not be discouraged. You may still be able
to use INLA effectively even if you have only a limited grasp of what&#8217;s &#8217;under the
hood.&#8217;
</p><!--l. 498--><p class="indent" >   <span class="cite">[<a 
href="spde-tutorialli2.html#XrueT:2002">Rue and Tjelmeland, 2002</a>]</span> proposed to approximate a continuous field using a Gaussian
Markov Random Field - GMRF. This idea is not so strange since there are continuous random
fields that are Markov. This is the case when the continuous field is a solution of a linear
stochastic partial differential equation, see <span class="cite">[<a 
href="spde-tutorialli2.html#Xrozanov:1977">Rozanov, 1977</a>]</span>. <span class="cite">[<a 
href="spde-tutorialli2.html#XlindgrenRL:2011">Lindgren et&#x00A0;al., 2011</a>]</span> provided that
the GRF with Matérn correlation is a solution for an stochastic partial differential equation
(SPDE).
</p><!--l. 509--><p class="indent" >   If you want to get an intuition about the approach, we tried to provide it in this section.
However, if you want to know all the details, they are in the Appendix of <span class="cite">[<a 
href="spde-tutorialli2.html#XlindgrenRL:2011">Lindgren
et&#x00A0;al., 2011</a>]</span>. In few words it uses the Finite Element Method (FEM) along with basis
functions carefully chosen to preserve the sparse structure of the resulting precision
matrix for the random field at a set of mesh nodes. This provides an explicit link
between a continuous random field and a GMRF representation, which allows efficient
computations.
</p><!--l. 521--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><a 
 id="x5-110001.1.5"></a>First result</h5>
<!--l. 523--><p class="noindent" >Lindgren&#8217;s first main provided that a GF with a generalized covariance function, obtained when
<span 
class="cmmi-10x-x-109">&#x03BD; </span><span 
class="cmsy-10x-x-109">&#x2192; </span><span 
class="cmr-10x-x-109">0 </span>in the Matérn correlation function, is a solution of a SPDE. This extends the result
obtained by <span class="cite">[<a 
href="spde-tutorialli2.html#Xbesag:1981">Besag, 1981</a>]</span>. A more statistical way of considering this result is when taking a
regular two-dimensional lattice with number of sites tending to infinity. In this case the full
conditional at the site <span 
class="cmmi-10x-x-109">ij </span>has
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-11001r4"></a>
   <center class="math-display" >
                                                                                 
                                                                                 
<img 
src="spde-tutorial5x.png" alt="              1
E (uij|u-ij) = a(ui-1,j + ui+1,j + ui,j-1 + ui,j+1)
" class="math-display"  /></center></td><td class="equation-label">(1.4)</td></tr></table>
<!--l. 533--><p class="nopar" >
and <span 
class="cmmi-10x-x-109">V ar</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">u</span><sub><span 
class="cmmi-8">ij</span></sub><span 
class="cmsy-10x-x-109">|</span><span 
class="cmmi-10x-x-109">u</span><sub><span 
class="cmsy-8">-</span><span 
class="cmmi-8">ij</span></sub><span 
class="cmr-10x-x-109">) = 1</span><span 
class="cmmi-10x-x-109">&#x2215;a </span>for <span 
class="cmsy-10x-x-109">|</span><span 
class="cmmi-10x-x-109">a</span><span 
class="cmsy-10x-x-109">| </span><span 
class="cmmi-10x-x-109">&#x003E; </span><span 
class="cmr-10x-x-109">4</span>. In the representation using a precision matrix, we have, for
a single site, only the upper right quadrant and with <span 
class="cmmi-10x-x-109">a </span>as the central element, such
that
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-11002r5"></a>
   <center class="math-display" >
<img 
src="spde-tutorial6x.png" alt="|
| -1
--a----1--
" class="math-display"  /></center></td><td class="equation-label">(1.5)</td></tr></table>
<!--l. 544--><p class="nopar" >
</p><!--l. 546--><p class="indent" >   A GF <span 
class="cmmi-10x-x-109">U</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">s</span><span 
class="cmr-10x-x-109">) </span>with Matérn covariance is a solution to the following linear fractional
SPDE
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-11003r6"></a>
   <center class="math-display" >
<img 
src="spde-tutorial7x.png" alt="  2     &#x03B1;&#x2215;2                  d
(&#x03BA;  - &#x0394; )  u (s) = W  (s),s &#x2208; &#x211D; ,&#x03B1; = &#x03BD; + d&#x2215;2,&#x03BA; &#x003E; 0,&#x03BD; &#x003E; 0,
" class="math-display"  /></center></td><td class="equation-label">(1.6)</td></tr></table>
<!--l. 551--><p class="nopar" >
<span class="cite">[<a 
href="spde-tutorialli2.html#XlindgrenRL:2011">Lindgren et&#x00A0;al., 2011</a>]</span> show that for <span 
class="cmmi-10x-x-109">&#x03BD; </span><span 
class="cmr-10x-x-109">= 1 </span>and <span 
class="cmmi-10x-x-109">&#x03BD; </span><span 
class="cmr-10x-x-109">= 2</span>, the GMRF representations are
convolutions of (<a 
href="#x5-11002r5">1.5<!--tex4ht:ref: eq:q0 --></a>). So, for <span 
class="cmmi-10x-x-109">&#x03BD; </span><span 
class="cmr-10x-x-109">= 1 </span>in that representation we have:
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-11004r7"></a>
   <center class="math-display" >
<img 
src="spde-tutorial8x.png" alt="|  1
| -2a    2
|    2
-4+a-----2a--1--
" class="math-display"  /></center></td><td class="equation-label">(1.7)</td></tr></table>
<!--l. 562--><p class="nopar" >
 and, for <span 
class="cmmi-10x-x-109">&#x03BD; </span><span 
class="cmr-10x-x-109">= 2</span>:
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-11005r8"></a>
   <center class="math-display" >
<img 
src="spde-tutorial9x.png" alt="|
|   -1
|   3a         -3
|-3(a2+3)      6a     -3
-a(a2+12)----3(a2+3-)--3a---1--
" class="math-display"  /></center></td><td class="equation-label">(1.8)</td></tr></table>
<!--l. 572--><p class="nopar" >
</p><!--l. 574--><p class="indent" >   Interpreting the result intuitively, as the smoothness parameter <span 
class="cmmi-10x-x-109">&#x03BD; </span>increases the precision
matrix in the GMRF representation becomes less sparse. Greater density of the matrix is
because the conditional distributions depend on a wider neighborhood. The precision matrix for
<span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 2</span>, <span 
class="cmmib-10x-x-109">Q</span><sub><span 
class="cmr-8">2</span></sub> <span 
class="cmr-10x-x-109">=</span> <span 
class="cmmib-10x-x-109">Q</span><sub><span 
class="cmr-8">1</span></sub><span 
class="cmmib-10x-x-109">C</span><sup><span 
class="cmsy-8">-</span><span 
class="cmr-8">1</span></sup><span 
class="cmmib-10x-x-109">Q</span><sub><span 
class="cmr-8">1</span></sub>, is a standardized square of the precision matrix for <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 1</span>,
<span 
class="cmmib-10x-x-109">Q</span><sub><span 
class="cmr-8">1</span></sub>.
</p><!--l. 585--><p class="indent" >   However, the denser matrix does not imply that the conditional mean is an average over a
wider neighborhood. The conceptual parallel is going from a first order random walk to a second
order one. To understand this point let us consider the precision matrix for the first order
random walk, its square and the precision matrix for the second order random walk.
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor535"><span 
class="aett-10x-x-109">(q1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor536"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor537"><span 
class="aett-10x-x-109">INLA</span></span><span id="textcolor538"><span 
class="aett-10x-x-109">:::</span></span><span id="textcolor539"><span 
class="aett-10x-x-109">inla.rw1</span></span><span id="textcolor540"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor541"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor542"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor543"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor544"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-2">
##&#x00A0;5&#x00A0;x&#x00A0;5&#x00A0;sparse&#x00A0;Matrix&#x00A0;of&#x00A0;class&#x00A0;"dgTMatrix"
&#x00A0;<br />##
&#x00A0;<br />##&#x00A0;[1,]&#x00A0;&#x00A0;1&#x00A0;-1&#x00A0;&#x00A0;.&#x00A0;&#x00A0;.&#x00A0;&#x00A0;.
&#x00A0;<br />##&#x00A0;[2,]&#x00A0;-1&#x00A0;&#x00A0;2&#x00A0;-1&#x00A0;&#x00A0;.&#x00A0;&#x00A0;.
&#x00A0;<br />##&#x00A0;[3,]&#x00A0;&#x00A0;.&#x00A0;-1&#x00A0;&#x00A0;2&#x00A0;-1&#x00A0;&#x00A0;.
&#x00A0;<br />##&#x00A0;[4,]&#x00A0;&#x00A0;.&#x00A0;&#x00A0;.&#x00A0;-1&#x00A0;&#x00A0;2&#x00A0;-1
&#x00A0;<br />##&#x00A0;[5,]&#x00A0;&#x00A0;.&#x00A0;&#x00A0;.&#x00A0;&#x00A0;.&#x00A0;-1&#x00A0;&#x00A0;1
</div>
<!--l. 606--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor545"><span 
class="aett-10x-x-109">crossprod</span></span><span id="textcolor546"><span 
class="aett-10x-x-109">(q1)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor547"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;same</span><span 
class="aeitt-10x-x-109">&#x00A0;inner</span><span 
class="aeitt-10x-x-109">&#x00A0;pattern</span><span 
class="aeitt-10x-x-109">&#x00A0;as</span><span 
class="aeitt-10x-x-109">&#x00A0;for</span><span 
class="aeitt-10x-x-109">&#x00A0;RW2</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-3">
##&#x00A0;5&#x00A0;x&#x00A0;5&#x00A0;sparse&#x00A0;Matrix&#x00A0;of&#x00A0;class&#x00A0;"dsCMatrix"
&#x00A0;<br />##
&#x00A0;<br />##&#x00A0;[1,]&#x00A0;&#x00A0;2&#x00A0;-3&#x00A0;&#x00A0;1&#x00A0;&#x00A0;.&#x00A0;&#x00A0;.
&#x00A0;<br />##&#x00A0;[2,]&#x00A0;-3&#x00A0;&#x00A0;6&#x00A0;-4&#x00A0;&#x00A0;1&#x00A0;&#x00A0;.
&#x00A0;<br />##&#x00A0;[3,]&#x00A0;&#x00A0;1&#x00A0;-4&#x00A0;&#x00A0;6&#x00A0;-4&#x00A0;&#x00A0;1
&#x00A0;<br />##&#x00A0;[4,]&#x00A0;&#x00A0;.&#x00A0;&#x00A0;1&#x00A0;-4&#x00A0;&#x00A0;6&#x00A0;-3
&#x00A0;<br />##&#x00A0;[5,]&#x00A0;&#x00A0;.&#x00A0;&#x00A0;.&#x00A0;&#x00A0;1&#x00A0;-3&#x00A0;&#x00A0;2
</div>
<!--l. 618--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor548"><span 
class="aett-10x-x-109">INLA</span></span><span id="textcolor549"><span 
class="aett-10x-x-109">:::</span></span><span id="textcolor550"><span 
class="aett-10x-x-109">inla.rw2</span></span><span id="textcolor551"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor552"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor553"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor554"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor555"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-4">
##&#x00A0;5&#x00A0;x&#x00A0;5&#x00A0;sparse&#x00A0;Matrix&#x00A0;of&#x00A0;class&#x00A0;"dgTMatrix"
&#x00A0;<br />##
&#x00A0;<br />##&#x00A0;[1,]&#x00A0;&#x00A0;1&#x00A0;-2&#x00A0;&#x00A0;1&#x00A0;&#x00A0;.&#x00A0;&#x00A0;.
&#x00A0;<br />##&#x00A0;[2,]&#x00A0;-2&#x00A0;&#x00A0;5&#x00A0;-4&#x00A0;&#x00A0;1&#x00A0;&#x00A0;.
&#x00A0;<br />##&#x00A0;[3,]&#x00A0;&#x00A0;1&#x00A0;-4&#x00A0;&#x00A0;6&#x00A0;-4&#x00A0;&#x00A0;1
&#x00A0;<br />##&#x00A0;[4,]&#x00A0;&#x00A0;.&#x00A0;&#x00A0;1&#x00A0;-4&#x00A0;&#x00A0;5&#x00A0;-2
&#x00A0;<br />##&#x00A0;[5,]&#x00A0;&#x00A0;.&#x00A0;&#x00A0;.&#x00A0;&#x00A0;1&#x00A0;-2&#x00A0;&#x00A0;1
</div>
<!--l. 630--><p class="nopar" >
</p>
   </div>
We can see that the difference is only in the corners.
<!--l. 636--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><a 
 id="x5-120001.1.5"></a>Second result</h5>
<!--l. 638--><p class="noindent" >It is common point data are not located on a grid, but instead are distributed irregularly.
<span class="cite">[<a 
href="spde-tutorialli2.html#XlindgrenRL:2011">Lindgren et&#x00A0;al., 2011</a>]</span> provide a second set of results that provide a solution for the case
irregular grids. They use the finite element method technique (FEM), a tool that is used widely
in engineering and applied mathematics to solve differential equations.
</p><!--l. 647--><p class="indent" >   The domain can be divided into a set of non-intersecting triangles, which may be
irregular, where any two triangles meet in at most a common edge or corner. The three
corners of a triangle are named vertices or nodes. The solution for the SPDE and its
properties will depend on the basis functions used. <span class="cite">[<a 
href="spde-tutorialli2.html#XlindgrenRL:2011">Lindgren et&#x00A0;al., 2011</a>]</span> choose basis
functions carefully in order to preserve the sparse structure of the resulting precision
matrix.
</p><!--l. 659--><p class="indent" >   The approximation is
</p>
   <center class="math-display" >
<img 
src="spde-tutorial10x.png" alt="      &#x2211;m
u(s) =    &#x03C8;k(s)wk
      k=1
" class="math-display"  /></center>
<!--l. 660--><p class="nopar" > where <span 
class="cmmi-10x-x-109">&#x03C8;</span><sub><span 
class="cmmi-8">k</span></sub> are basis functions, <span 
class="cmmi-10x-x-109">w</span><sub><span 
class="cmmi-8">k</span></sub> are Gaussian distributed weights, <span 
class="cmmi-10x-x-109">k </span><span 
class="cmr-10x-x-109">= 1</span><span 
class="cmmi-10x-x-109">,...,m </span>with <span 
class="cmmi-10x-x-109">m</span>
the number of vertices in the triangulation. Because <span 
class="cmmi-10x-x-109">&#x03C8;</span><sub><span 
class="cmmi-8">k</span></sub> is piecewise linear within
each triangle, with <span 
class="cmmi-10x-x-109">&#x03C8;</span><sub><span 
class="cmmi-8">k</span></sub> is equal to 1 at vertices <span 
class="cmmi-10x-x-109">k </span>and 0 at all other vertices, we <span 
class="cmmi-10x-x-109">w</span><sub><span 
class="cmmi-8">k</span></sub> is
the value of the field at the vertex <span 
class="cmmi-10x-x-109">k</span>. A stochastic weak solution was considered to
show that the joint distribution for the weights determines the full distribution in the
continuous domain. These weights can be interpolated for any point inside the triangulated
domain.
</p><!--l. 674--><p class="indent" >   We will now focus on the resulting precision matrix. It does consider the triangulation and
the basis functions. It matches the first result when applying for a regular grid. Consider the set
of <span 
class="cmmi-10x-x-109">m </span><span 
class="cmsy-10x-x-109">&#x00D7; </span><span 
class="cmmi-10x-x-109">m </span>matrices <span 
class="cmmib-10x-x-109">C</span>, <span 
class="cmmib-10x-x-109">G</span> and <span 
class="cmmib-10x-x-109">K</span><sub><span 
class="cmmi-8">&#x03BA;</span></sub> with entries
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-12001r9"></a>
                                                                                 
                                                                                 
   <center class="math-display" >
<img 
src="spde-tutorial11x.png" alt="C   = &#x27E8;&#x03C8; ,&#x03C8; &#x27E9;,G   = &#x27E8;&#x2207; &#x03C8; ,&#x2207; &#x03C8; &#x27E9;,(K   )  = &#x03BA;2C   + G   .
  i,j    i  j    i,j      i    j     &#x03BA;i,j       i,j    i,j
" class="math-display"  /></center></td><td class="equation-label">(1.9)</td></tr></table>
<!--l. 683--><p class="nopar" >
The precision matrix <span 
class="cmmib-10x-x-109">Q</span><sub><span 
class="cmmi-8">&#x03B1;,&#x03BA;</span></sub> as a function of <span 
class="cmmi-10x-x-109">&#x03BA;</span><sup><span 
class="cmr-8">2</span></sup> and <span 
class="cmmi-10x-x-109">&#x03B1; </span>can be written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-12002r10"></a>
   <center class="math-display" >
<img 
src="spde-tutorial12x.png" alt="               Q1,&#x03BA; = K &#x03BA;,
            Q   = K   C- 1K  ,
            -21,&#x03BA;     &#x03BA;-1    &#x03BA;
Q &#x03B1;,&#x03BA; = K &#x03BA;C   Q &#x03B1;-2,&#x03BA;C   K &#x03BA;,for&#x03B1; = 3,4,....
" class="math-display"  /></center></td><td class="equation-label">(1.10)</td></tr></table>
<!--l. 691--><p class="nopar" >
The actual <span 
class="cmmib-10x-x-109">K</span><sub><span 
class="cmmi-8">&#x03BA;</span></sub> matrix consider
</p>
   <center class="math-display" >
<img 
src="spde-tutorial13x.png" alt=" &#x02DC;
Ci,j = &#x27E8;&#x03C8;i,1&#x27E9;
" class="math-display"  /></center>
<!--l. 693--><p class="nopar" > instead, which is common when working with FEM. Since <img 
src="spde-tutorial14x.png" alt=" &#x02DC;
C"  class="tilde"  /> is diagonal <span 
class="cmmib-10x-x-109">K</span><sub><span 
class="cmmi-8">&#x03BA;</span></sub> is as sparse as
<span 
class="cmmib-10x-x-109">G</span>.
</p><!--l. 698--><p class="indent" >   The projection of the weight for any location inside the mesh domain considers a linear
interpolation in 2D. It uses the barycentric coordinates of the point with respect to the
coordinates of the triangle vertices. For this particular case they are known also as
areal coordinates. When a point is inside a triangle we have three non-zero values in
the corresponding line of <span 
class="cmmib-10x-x-109">A</span>. When it is along an edge, we have two non-zeros and
when the point is on top of a triangle vertex we have only one non-zero which equals
one.
</p><!--l. 711--><p class="indent" >   The following code creates a set of six points, builds a mesh around them and extracts the
FEM matrices (<span 
class="cmbx-10x-x-109">C</span>, <span 
class="cmbx-10x-x-109">G </span>and <span 
class="cmbx-10x-x-109">A</span>):  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor556"><span 
class="aett-10x-x-109">s</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor557"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor558"><span 
class="aett-10x-x-109">3</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor559"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;this</span><span 
class="aeitt-10x-x-109">&#x00A0;factor</span><span 
class="aeitt-10x-x-109">&#x00A0;will</span><span 
class="aeitt-10x-x-109">&#x00A0;only</span><span 
class="aeitt-10x-x-109">&#x00A0;changes</span><span 
class="aeitt-10x-x-109">&#x00A0;C,</span><span 
class="aeitt-10x-x-109">&#x00A0;not</span><span 
class="aeitt-10x-x-109">&#x00A0;G</span></span>
<br /><span id="textcolor560"><span 
class="aett-10x-x-109">pts</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor561"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor562"><span 
class="aett-10x-x-109">rbind</span></span><span id="textcolor563"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor564"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor565"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor566"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor567"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor568"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor569"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor570"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor571"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor572"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor573"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor574"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor575"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor576"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor577"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor578"><span 
class="aett-10x-x-109">2.6</span></span><span id="textcolor579"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor580"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor581"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor582"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor583"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor584"><span 
class="aett-10x-x-109">0.7</span></span><span id="textcolor585"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor586"><span 
class="aett-10x-x-109">1.7</span></span><span id="textcolor587"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor588"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor589"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor590"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor591"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor592"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor593"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor594"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor595"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor596"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor597"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor598"><span 
class="aett-10x-x-109">1.7</span></span><span id="textcolor599"><span 
class="aett-10x-x-109">))</span></span><span id="textcolor600"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor601"><span 
class="aett-10x-x-109">s</span></span>
<br /><span id="textcolor602"><span 
class="aett-10x-x-109">n</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor603"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor604"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor605"><span 
class="aett-10x-x-109">(pts)</span></span>
<br /><span id="textcolor606"><span 
class="aett-10x-x-109">mesh0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor607"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor608"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor609"><span 
class="aett-10x-x-109">(pts[</span></span><span id="textcolor610"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor611"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor612"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor613"><span 
class="aett-10x-x-109">,],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor614"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor615"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor616"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor617"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor618"><span 
class="aett-10x-x-109">s,</span></span>
                                                                                 
                                                                                 
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor619"><span 
class="aett-10x-x-109">offset</span></span><span id="textcolor620"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor621"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor622"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor623"><span 
class="aett-10x-x-109">s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor624"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor625"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor626"><span 
class="aett-10x-x-109">6</span></span><span id="textcolor627"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor628"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor629"><span 
class="aett-10x-x-109">=s</span></span><span id="textcolor630"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor631"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor632"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor633"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor634"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor635"><span 
class="aett-10x-x-109">mesh</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor636"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor637"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor638"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor639"><span 
class="aett-10x-x-109">rbind</span></span><span id="textcolor640"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor641"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor642"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor643"><span 
class="aett-10x-x-109">3.3</span></span><span id="textcolor644"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor645"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor646"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor647"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor648"><span 
class="aett-10x-x-109">s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor649"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor650"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor651"><span 
class="aett-10x-x-109">2.4</span></span><span id="textcolor652"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor653"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor654"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor655"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor656"><span 
class="aett-10x-x-109">s,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor657"><span 
class="aett-10x-x-109">mesh0</span></span><span id="textcolor658"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor659"><span 
class="aett-10x-x-109">loc[</span></span><span id="textcolor660"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor661"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor662"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor663"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor664"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor665"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor666"><span 
class="aett-10x-x-109">),</span></span><span id="textcolor667"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor668"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor669"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor670"><span 
class="aett-10x-x-109">]),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor671"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor672"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor673"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor674"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor675"><span 
class="aett-10x-x-109">s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor676"><span 
class="aett-10x-x-109">offset</span></span><span id="textcolor677"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor678"><span 
class="aett-10x-x-109">1e-5</span></span><span id="textcolor679"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor680"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor681"><span 
class="aett-10x-x-109">=s</span></span><span id="textcolor682"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor683"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor684"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor685"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor686"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor687"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor688"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor689"><span 
class="aett-10x-x-109">100</span></span><span id="textcolor690"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor691"><span 
class="aett-10x-x-109">(m</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor692"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor693"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor694"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor695"><span 
class="aett-10x-x-109">n)</span></span>
<br /><span id="textcolor696"><span 
class="aett-10x-x-109">dmesh</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor697"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor698"><span 
class="aett-10x-x-109">inla.mesh.dual</span></span><span id="textcolor699"><span 
class="aett-10x-x-109">(mesh)</span></span>
<br /><span id="textcolor700"><span 
class="aett-10x-x-109">fem</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor701"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor702"><span 
class="aett-10x-x-109">inla.mesh.fem</span></span><span id="textcolor703"><span 
class="aett-10x-x-109">(mesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor704"><span 
class="aett-10x-x-109">order</span></span><span id="textcolor705"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor706"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor707"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor708"><span 
class="aett-10x-x-109">A</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor709"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor710"><span 
class="aett-10x-x-109">inla.spde.make.A</span></span><span id="textcolor711"><span 
class="aett-10x-x-109">(mesh,</span><span 
class="aett-10x-x-109">&#x00A0;pts)</span></span>
</div>
</div>
   </div>
<!--l. 734--><p class="indent" >   We can gain intuition about this result by considering the structure of each matrix which is
detailed in Appendix A.2 in <span class="cite">[<a 
href="spde-tutorialli2.html#XlindgrenRL:2011">Lindgren et&#x00A0;al., 2011</a>]</span>. It may be easier to understand it by
considering the plots in Figure&#x00A0;<a 
href="#x5-120001.1.5">1.1.5<!--tex4ht:ref: fig:mesh0 --></a>. In this figure we have a mesh with 8 nodes, shown in
thicker border lines. The corresponding dual mesh form a collection of polygons around each
mesh vertex.
</p>
   <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor712"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor713"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor714"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor715"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor716"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor717"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor718"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor719"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor720"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor721"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor722"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor723"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor724"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor725"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor726"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor727"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor728"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor729"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor730"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor731"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor732"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor733"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor734"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor735"><span 
class="aett-10x-x-109">(mesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor736"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor737"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor738"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor739"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor740"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor741"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor742"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor743"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor744"><span 
class="aett-10x-x-109">edge.color</span></span><span id="textcolor745"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor746"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor747"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor748"><span 
class="aett-10x-x-109">box</span></span><span id="textcolor749"><span 
class="aett-10x-x-109">();</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor750"><span 
class="aett-10x-x-109">axis</span></span><span id="textcolor751"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor752"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor753"><span 
class="aett-10x-x-109">);</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor754"><span 
class="aett-10x-x-109">axis</span></span><span id="textcolor755"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor756"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor757"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor758"><span 
class="aett-10x-x-109">points</span></span><span id="textcolor759"><span 
class="aett-10x-x-109">(mesh</span></span><span id="textcolor760"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor761"><span 
class="aett-10x-x-109">loc,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor762"><span 
class="aett-10x-x-109">cex</span></span><span id="textcolor763"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor764"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor765"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor766"><span 
class="aett-10x-x-109">text</span></span><span id="textcolor767"><span 
class="aett-10x-x-109">(mesh</span></span><span id="textcolor768"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor769"><span 
class="aett-10x-x-109">loc[,</span></span><span id="textcolor770"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor771"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor772"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor773"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor774"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor775"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor776"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor777"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor778"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor779"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor780"><span 
class="aett-10x-x-109">),</span></span><span id="textcolor781"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor782"><span 
class="aett-10x-x-109">(m</span></span><span id="textcolor783"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor784"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor785"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor786"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor787"><span 
class="aett-10x-x-109">))</span></span><span id="textcolor788"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor789"><span 
class="aett-10x-x-109">s,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor790"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor791"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor792"><span 
class="aett-10x-x-109">loc[,</span></span><span id="textcolor793"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor794"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor795"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor796"><span 
class="aett-10x-x-109">.2</span></span><span id="textcolor797"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor798"><span 
class="aett-10x-x-109">s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor799"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor800"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor801"><span 
class="aett-10x-x-109">m,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor802"><span 
class="aett-10x-x-109">cex</span></span><span id="textcolor803"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor804"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor805"><span 
class="aett-10x-x-109">)</span></span>
<br />
<br /><span id="textcolor806"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor807"><span 
class="aett-10x-x-109">(dmesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor808"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor809"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor810"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor811"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor812"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor813"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor814"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor815"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor816"><span 
class="aett-10x-x-109">main</span></span><span id="textcolor817"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor818"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Dual</span><span 
class="aett-10x-x-109">&#x00A0;mesh</span><span 
class="aett-10x-x-109">&#x00A0;overlayed</span><span 
class="tctt-1095">'</span></span><span id="textcolor819"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor820"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor821"><span 
class="aett-10x-x-109">(mesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor822"><span 
class="aett-10x-x-109">add</span></span><span id="textcolor823"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor824"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor825"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor826"><span 
class="aett-10x-x-109">box</span></span><span id="textcolor827"><span 
class="aett-10x-x-109">();</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor828"><span 
class="aett-10x-x-109">axis</span></span><span id="textcolor829"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor830"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor831"><span 
class="aett-10x-x-109">);</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor832"><span 
class="aett-10x-x-109">axis</span></span><span id="textcolor833"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor834"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor835"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor836"><span 
class="aett-10x-x-109">points</span></span><span id="textcolor837"><span 
class="aett-10x-x-109">(mesh</span></span><span id="textcolor838"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor839"><span 
class="aett-10x-x-109">loc,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor840"><span 
class="aett-10x-x-109">cex</span></span><span id="textcolor841"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor842"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor843"><span 
class="aett-10x-x-109">)</span></span>
<br />
<br /><span id="textcolor844"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor845"><span 
class="aett-10x-x-109">(mesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor846"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor847"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor848"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor849"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor850"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor851"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor852"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor853"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor854"><span 
class="aett-10x-x-109">edge.color</span></span><span id="textcolor855"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor856"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor857"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor858"><span 
class="aett-10x-x-109">main</span></span><span id="textcolor859"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor860"><span 
class="tctt-1095">''</span></span><span id="textcolor861"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor862"><span 
class="aett-10x-x-109">title</span></span><span id="textcolor863"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor864"><span 
class="aett-10x-x-109">main</span></span><span id="textcolor865"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor866"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Mesh</span><span 
class="aett-10x-x-109">&#x00A0;and</span><span 
class="aett-10x-x-109">&#x00A0;points</span><span 
class="tctt-1095">'</span></span><span id="textcolor867"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor868"><span 
class="aett-10x-x-109">box</span></span><span id="textcolor869"><span 
class="aett-10x-x-109">();</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor870"><span 
class="aett-10x-x-109">axis</span></span><span id="textcolor871"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor872"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor873"><span 
class="aett-10x-x-109">);</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor874"><span 
class="aett-10x-x-109">axis</span></span><span id="textcolor875"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor876"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor877"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor878"><span 
class="aett-10x-x-109">points</span></span><span id="textcolor879"><span 
class="aett-10x-x-109">(mesh</span></span><span id="textcolor880"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor881"><span 
class="aett-10x-x-109">loc,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor882"><span 
class="aett-10x-x-109">cex</span></span><span id="textcolor883"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor884"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor885"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor886"><span 
class="aett-10x-x-109">points</span></span><span id="textcolor887"><span 
class="aett-10x-x-109">(pts,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor888"><span 
class="aett-10x-x-109">pch</span></span><span id="textcolor889"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor890"><span 
class="aett-10x-x-109">8</span></span><span id="textcolor891"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor892"><span 
class="aett-10x-x-109">cex</span></span><span id="textcolor893"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor894"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor895"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor896"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor897"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor898"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor899"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor900"><span 
class="aett-10x-x-109">text</span></span><span id="textcolor901"><span 
class="aett-10x-x-109">(pts[,</span></span><span id="textcolor902"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor903"><span 
class="aett-10x-x-109">],</span><span 
class="aett-10x-x-109">&#x00A0;pts[,</span></span><span id="textcolor904"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor905"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor906"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor907"><span 
class="aett-10x-x-109">0.2</span></span><span id="textcolor908"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor909"><span 
class="aett-10x-x-109">s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor910"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor911"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor912"><span 
class="aett-10x-x-109">n,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor913"><span 
class="aett-10x-x-109">cex</span></span><span id="textcolor914"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor915"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor916"><span 
class="aett-10x-x-109">)</span></span>
<br />
<br /><span id="textcolor917"><span 
class="aett-10x-x-109">A</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor918"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor919"><span 
class="aett-10x-x-109">as</span></span><span id="textcolor920"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor921"><span 
class="aett-10x-x-109">Matrix</span></span><span id="textcolor922"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor923"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor924"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor925"><span 
class="aett-10x-x-109">as.matrix</span></span><span id="textcolor926"><span 
class="aett-10x-x-109">(A),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor927"><span 
class="aett-10x-x-109">10</span></span><span id="textcolor928"><span 
class="aett-10x-x-109">)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor929"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;force</span><span 
class="aeitt-10x-x-109">&#x00A0;zero</span><span 
class="aeitt-10x-x-109">&#x00A0;as</span><span 
class="aeitt-10x-x-109">&#x00A0;zero</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor930"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">dgTMatrix</span><span 
class="tctt-1095">'</span></span><span id="textcolor931"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor932"><span 
class="aett-10x-x-109">cc</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor933"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor934"><span 
class="aett-10x-x-109">as</span></span><span id="textcolor935"><span 
class="aett-10x-x-109">(fem</span></span><span id="textcolor936"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor937"><span 
class="aett-10x-x-109">c0,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor938"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">dgTMatrix</span><span 
class="tctt-1095">'</span></span><span id="textcolor939"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor940"><span 
class="aett-10x-x-109">gg</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor941"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor942"><span 
class="aett-10x-x-109">as</span></span><span id="textcolor943"><span 
class="aett-10x-x-109">(fem</span></span><span id="textcolor944"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor945"><span 
class="aett-10x-x-109">g1,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor946"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">dgTMatrix</span><span 
class="tctt-1095">'</span></span><span id="textcolor947"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor948"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor949"><span 
class="aett-10x-x-109">(gridExtra)</span></span>
<br /><span id="textcolor950"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor951"><span 
class="aett-10x-x-109">(latticeExtra)</span></span>
<br /><span id="textcolor952"><span 
class="aett-10x-x-109">grid.arrange</span></span><span id="textcolor953"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor954"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor955"><span 
class="aett-10x-x-109">(cc,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor956"><span 
class="aett-10x-x-109">colorkey</span></span><span id="textcolor957"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor958"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor959"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor960"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor961"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor962"><span 
class="tctt-1095">''</span></span><span id="textcolor963"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor964"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor965"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor966"><span 
class="tctt-1095">''</span></span><span id="textcolor967"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor968"><span 
class="aett-10x-x-109">sub</span></span><span id="textcolor969"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor970"><span 
class="tctt-1095">''</span></span><span id="textcolor971"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor972"><span 
class="aett-10x-x-109">+</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor973"><span 
class="aett-10x-x-109">layer</span></span><span id="textcolor974"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor975"><span 
class="aett-10x-x-109">panel.text</span></span><span id="textcolor976"><span 
class="aett-10x-x-109">(cc</span></span><span id="textcolor977"><span 
class="aett-10x-x-109">@</span></span><span id="textcolor978"><span 
class="aett-10x-x-109">j</span></span><span id="textcolor979"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor980"><span 
class="aett-10x-x-109">1L</span></span><span id="textcolor981"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;cc</span></span><span id="textcolor982"><span 
class="aett-10x-x-109">@</span></span><span id="textcolor983"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor984"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor985"><span 
class="aett-10x-x-109">1L</span></span><span id="textcolor986"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor987"><span 
class="aett-10x-x-109">paste0</span></span><span id="textcolor988"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor989"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor990"><span 
class="aett-10x-x-109">(cc</span></span><span id="textcolor991"><span 
class="aett-10x-x-109">@</span></span><span id="textcolor992"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor993"><span 
class="aett-10x-x-109">)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor994"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor995"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor996"><span 
class="aett-10x-x-109">gray</span></span><span id="textcolor997"><span 
class="aett-10x-x-109">(cc</span></span><span id="textcolor998"><span 
class="aett-10x-x-109">@</span></span><span id="textcolor999"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor1000"><span 
class="aett-10x-x-109">&#x003E;</span></span><span id="textcolor1001"><span 
class="aett-10x-x-109">30</span></span><span id="textcolor1002"><span 
class="aett-10x-x-109">))),</span></span>
                                                                                 
                                                                                 
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1003"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor1004"><span 
class="aett-10x-x-109">(gg,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1005"><span 
class="aett-10x-x-109">colorkey</span></span><span id="textcolor1006"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1007"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor1008"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1009"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor1010"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1011"><span 
class="tctt-1095">''</span></span><span id="textcolor1012"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1013"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor1014"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1015"><span 
class="tctt-1095">''</span></span><span id="textcolor1016"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1017"><span 
class="aett-10x-x-109">sub</span></span><span id="textcolor1018"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1019"><span 
class="tctt-1095">''</span></span><span id="textcolor1020"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1021"><span 
class="aett-10x-x-109">+</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1022"><span 
class="aett-10x-x-109">layer</span></span><span id="textcolor1023"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1024"><span 
class="aett-10x-x-109">panel.text</span></span><span id="textcolor1025"><span 
class="aett-10x-x-109">(gg</span></span><span id="textcolor1026"><span 
class="aett-10x-x-109">@</span></span><span id="textcolor1027"><span 
class="aett-10x-x-109">j</span></span><span id="textcolor1028"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor1029"><span 
class="aett-10x-x-109">1L</span></span><span id="textcolor1030"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;gg</span></span><span id="textcolor1031"><span 
class="aett-10x-x-109">@</span></span><span id="textcolor1032"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor1033"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor1034"><span 
class="aett-10x-x-109">1L</span></span><span id="textcolor1035"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1036"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor1037"><span 
class="aett-10x-x-109">(gg</span></span><span id="textcolor1038"><span 
class="aett-10x-x-109">@</span></span><span id="textcolor1039"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor1040"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor1041"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor1042"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1043"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor1044"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1045"><span 
class="aett-10x-x-109">gray</span></span><span id="textcolor1046"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1047"><span 
class="aett-10x-x-109">abs</span></span><span id="textcolor1048"><span 
class="aett-10x-x-109">(gg</span></span><span id="textcolor1049"><span 
class="aett-10x-x-109">@</span></span><span id="textcolor1050"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor1051"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor1052"><span 
class="aett-10x-x-109">&#x003E;</span></span><span id="textcolor1053"><span 
class="aett-10x-x-109">1.5</span></span><span id="textcolor1054"><span 
class="aett-10x-x-109">))),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1055"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor1056"><span 
class="aett-10x-x-109">(A,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1057"><span 
class="aett-10x-x-109">colorkey</span></span><span id="textcolor1058"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1059"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor1060"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1061"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor1062"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1063"><span 
class="tctt-1095">''</span></span><span id="textcolor1064"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1065"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor1066"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1067"><span 
class="tctt-1095">''</span></span><span id="textcolor1068"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1069"><span 
class="aett-10x-x-109">sub</span></span><span id="textcolor1070"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1071"><span 
class="tctt-1095">''</span></span><span id="textcolor1072"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1073"><span 
class="aett-10x-x-109">+</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1074"><span 
class="aett-10x-x-109">layer</span></span><span id="textcolor1075"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1076"><span 
class="aett-10x-x-109">panel.text</span></span><span id="textcolor1077"><span 
class="aett-10x-x-109">(A</span></span><span id="textcolor1078"><span 
class="aett-10x-x-109">@</span></span><span id="textcolor1079"><span 
class="aett-10x-x-109">j</span></span><span id="textcolor1080"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor1081"><span 
class="aett-10x-x-109">1L</span></span><span id="textcolor1082"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;A</span></span><span id="textcolor1083"><span 
class="aett-10x-x-109">@</span></span><span id="textcolor1084"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor1085"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor1086"><span 
class="aett-10x-x-109">1L</span></span><span id="textcolor1087"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1088"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor1089"><span 
class="aett-10x-x-109">(A</span></span><span id="textcolor1090"><span 
class="aett-10x-x-109">@</span></span><span id="textcolor1091"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor1092"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1093"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor1094"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1095"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor1096"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1097"><span 
class="aett-10x-x-109">gray</span></span><span id="textcolor1098"><span 
class="aett-10x-x-109">(A</span></span><span id="textcolor1099"><span 
class="aett-10x-x-109">@</span></span><span id="textcolor1100"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor1101"><span 
class="aett-10x-x-109">&#x003E;</span></span><span id="textcolor1102"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor1103"><span 
class="aett-10x-x-109">))),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1104"><span 
class="aett-10x-x-109">ncol</span></span><span id="textcolor1105"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1106"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor1107"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x5-120033"></a>
                                                                                 
                                                                                 
<!--l. 790--><p class="noindent" ><img 
src="spde-tutorial15x.png" alt="PIC" class="graphics" width="422" height="140"  /><!--tex4ht:graphics  
name="spde-tutorial15x.png" src="figs/intromesh0fig-1.eps"  
-->
</p><!--l. 792--><p class="noindent" ><img 
src="spde-tutorial16x.png" alt="PIC" class="graphics" width="422" height="140"  /><!--tex4ht:graphics  
name="spde-tutorial16x.png" src="figs/intromesh0fig-2.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;1.3: </span><span  
class="content">A mesh and its nodes identified (top left), the dual mesh polygons (top mid)
and the mesh with some points identified (top right). The associated <span 
class="cmmib-10x-x-109">C</span> matrix (bottom
left), <span 
class="cmmib-10x-x-109">G</span> matrix (bottom mid) and <span 
class="cmmib-10x-x-109">A</span> matrix (bottom right).</span></div><!--tex4ht:label?: x5-120033 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 802--><p class="indent" >   The <img 
src="spde-tutorial17x.png" alt="&#x02DC;C"  class="tilde"  /> matrix is diagonal for <img 
src="spde-tutorial18x.png" alt="C&#x02DC;"  class="tilde"  /><sub><span 
class="cmmi-8">ii</span></sub> equals the area of the polygons formed from the dual mesh.
The <img 
src="spde-tutorial19x.png" alt="&#x02DC;
C"  class="tilde"  /><sub><span 
class="cmmi-8">ii</span></sub> is equal the sum of one third the area of each triangle that the vertice <span 
class="cmmi-10x-x-109">i </span>is part of.
Notice that each polygon around each mesh node is formed by one third of the triangles that it
is part of.
</p><!--l. 809--><p class="indent" >   The <span 
class="cmmib-10x-x-109">G</span> matrix reflects the connectivity of the mesh nodes. Nodes not connected by edges
have corresponding entry as zero. The values do not depend on the size of the triangles as they
are scaled by the area of the triangles. For more detailed information, see A.2 in <span class="cite">[<a 
href="spde-tutorialli2.html#XlindgrenRL:2011">Lindgren
et&#x00A0;al., 2011</a>]</span>.
</p><!--l. 816--><p class="indent" >   We have seen that the resulting precision matrix for increasing <span 
class="cmmi-10x-x-109">&#x03BD; </span>is a convolution of the
precision matrix for <span 
class="cmmi-10x-x-109">&#x03BD; </span><span 
class="cmsy-10x-x-109">- </span><span 
class="cmr-10x-x-109">1 </span>with a scaled <span 
class="cmmib-10x-x-109">K</span><sub><span 
class="cmmi-8">&#x03BA;</span></sub>. It still implies denser the precision matrix when
working with <span 
class="cmmi-10x-x-109">&#x03BA;</span><span 
class="cmmib-10x-x-109">C</span> <span 
class="cmr-10x-x-109">+</span> <span 
class="cmmib-10x-x-109">G</span>.
</p><!--l. 824--><p class="indent" >   The <span 
class="cmmib-10x-x-109">Q</span> precision matrix is generalized for a fractional values of <span 
class="cmmi-10x-x-109">&#x03B1; </span>(or <span 
class="cmmi-10x-x-109">&#x03BD;</span>) using a
Taylor approximation. See the author&#8217;s discussion response in <span class="cite">[<a 
href="spde-tutorialli2.html#XlindgrenRL:2011">Lindgren et&#x00A0;al., 2011</a>]</span>.
From this approximation, we have the polynomial of order <span 
class="cmmi-10x-x-109">p </span><span 
class="cmr-10x-x-109">= </span><span 
class="cmsy-10x-x-109">&#x2308;</span><span 
class="cmmi-10x-x-109">&#x03B1;</span><span 
class="cmsy-10x-x-109">&#x2309; </span>for the precision
matrix
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-12004r11"></a>
   <center class="math-display" >
<img 
src="spde-tutorial20x.png" alt="     &#x2211;p       - 1  i
Q  =    biC (C   G) .
     i=0
" class="math-display"  /></center></td><td class="equation-label">(1.11)</td></tr></table>
<!--l. 831--><p class="nopar" >
For <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 1 </span>and <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 2 </span>we have (<a 
href="#x5-12002r10">1.10<!--tex4ht:ref: eq:Qalpha --></a>). For <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 1</span>, we have <span 
class="cmmi-10x-x-109">b</span><sub><span 
class="cmr-8">0</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">&#x03BA;</span><sup><span 
class="cmr-8">2</span></sup> and <span 
class="cmmi-10x-x-109">b</span><sub><span 
class="cmr-8">1</span></sub> <span 
class="cmr-10x-x-109">= 1</span>, and for <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 2</span>, we
have <span 
class="cmmi-10x-x-109">b</span><sub><span 
class="cmr-8">0</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">&#x03BA;</span><sup><span 
class="cmr-8">4</span></sup>, <span 
class="cmmi-10x-x-109">b</span><sub><span 
class="cmr-8">1</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">&#x03B1;&#x03BA;</span><sup><span 
class="cmr-8">4</span></sup> and <span 
class="cmmi-10x-x-109">b</span><sub><span 
class="cmr-8">2</span></sub> <span 
class="cmr-10x-x-109">= 1</span>. For fractional <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 1</span><span 
class="cmmi-10x-x-109">&#x2215;</span><span 
class="cmr-10x-x-109">2</span>, <span 
class="cmmi-10x-x-109">b</span><sub><span 
class="cmr-8">0</span></sub> <span 
class="cmr-10x-x-109">= 3</span><span 
class="cmmi-10x-x-109">&#x03BA;&#x2215;</span><span 
class="cmr-10x-x-109">4 </span>and <span 
class="cmmi-10x-x-109">b</span><sub><span 
class="cmr-8">1</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">&#x03BA;</span><sup><span 
class="cmsy-8">-</span><span 
class="cmr-8">1</span></sup><span 
class="cmr-10x-x-109">3</span><span 
class="cmmi-10x-x-109">&#x2215;</span><span 
class="cmr-10x-x-109">8</span>. And for
<span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 3</span><span 
class="cmmi-10x-x-109">&#x2215;</span><span 
class="cmr-10x-x-109">2 </span>(<span 
class="cmmi-10x-x-109">&#x03BD; </span><span 
class="cmr-10x-x-109">= 0</span><span 
class="cmmi-10x-x-109">.</span><span 
class="cmr-10x-x-109">5</span>, the exponential case), <span 
class="cmmi-10x-x-109">b</span><sub><span 
class="cmr-8">0</span></sub> <span 
class="cmr-10x-x-109">= 15</span><span 
class="cmmi-10x-x-109">&#x03BA;</span><sup><span 
class="cmr-8">3</span></sup><span 
class="cmmi-10x-x-109">&#x2215;</span><span 
class="cmr-10x-x-109">16</span>, <span 
class="cmmi-10x-x-109">b</span><sub><span 
class="cmr-8">1</span></sub> <span 
class="cmr-10x-x-109">= 15</span><span 
class="cmmi-10x-x-109">&#x03BA;&#x2215;</span><span 
class="cmr-10x-x-109">8</span>, <span 
class="cmmi-10x-x-109">b</span><sub><span 
class="cmr-8">2</span></sub> <span 
class="cmr-10x-x-109">= 15</span><span 
class="cmmi-10x-x-109">&#x03BA;</span><sup><span 
class="cmsy-8">-</span><span 
class="cmr-8">1</span></sup><span 
class="cmmi-10x-x-109">&#x2215;</span><span 
class="cmr-10x-x-109">128</span>. Using these
results combined with recursive construction, for <span 
class="cmmi-10x-x-109">&#x03B1; &#x003E; </span><span 
class="cmr-10x-x-109">2</span>, we have GMRF approximations for all
positive integers and half-integers.
</p>
   <h3 class="sectionHead"><span class="titlemark">1.2   </span> <a 
 id="x5-130001.2"></a>A toy example</h3>
<!--l. 3--><p class="noindent" >This content is part of the book available at <a 
href="http://www.r-inla.org/spde-book" class="url" ><span 
class="aett-10x-x-109">http://www.r-inla.org/spde-book</span></a>, whose
Gitbook version is freely available along all the code and datasets.
</p><!--l. 10--><p class="indent" >   In this example we will fit a simple geostatistical model for the toy dataset simulated in
Section&#x00A0;<a 
href="#x5-90001.1.4">1.1.4<!--tex4ht:ref: sec:simulatoy --></a>.  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1108"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor1109"><span 
class="aett-10x-x-109">(SPDEtoy)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   </div>
This dataset is a three-column <span 
class="aett-10x-x-109">data.frame</span>. Coordinates are in the first two clomuns and the
response is in the third column.  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1110"><span 
class="aett-10x-x-109">str</span></span><span id="textcolor1111"><span 
class="aett-10x-x-109">(SPDEtoy)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-5">
##&#x00A0;'data.frame': 200&#x00A0;obs.&#x00A0;of&#x00A0;&#x00A0;3&#x00A0;variables:
&#x00A0;<br />##&#x00A0;&#x00A0;$&#x00A0;s1:&#x00A0;num&#x00A0;&#x00A0;0.0827&#x00A0;0.6123&#x00A0;0.162&#x00A0;0.7526&#x00A0;0.851&#x00A0;...
&#x00A0;<br />##&#x00A0;&#x00A0;$&#x00A0;s2:&#x00A0;num&#x00A0;&#x00A0;0.0564&#x00A0;0.9168&#x00A0;0.357&#x00A0;0.2576&#x00A0;0.1541&#x00A0;...
&#x00A0;<br />##&#x00A0;&#x00A0;$&#x00A0;y&#x00A0;:&#x00A0;num&#x00A0;&#x00A0;11.52&#x00A0;5.28&#x00A0;6.9&#x00A0;13.18&#x00A0;14.6&#x00A0;...
</div>
<!--l. 32--><p class="nopar" >
</p>
   </div>
<!--l. 36--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.2.1   </span> <a 
 id="x5-140001.2.1"></a>SPDE model definition</h4>
<!--l. 38--><p class="noindent" >We have <span 
class="cmmi-10x-x-109">n </span>observations <span 
class="cmmi-10x-x-109">y</span><sub><span 
class="cmmi-8">i</span></sub>, <span 
class="cmmi-10x-x-109">i </span><span 
class="cmr-10x-x-109">= 1</span><span 
class="cmmi-10x-x-109">,...,n</span>, at locations <span 
class="cmmi-10x-x-109">s</span><sub><span 
class="cmmi-8">i</span></sub> and we define the following
model
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-14001r12"></a>
   <center class="math-display" >
<img 
src="spde-tutorial21x.png" alt="y |&#x03B2;0,u,&#x03C3;2e ~ N (&#x03B2;0 + Au, &#x03C3;2e)
       u ~ GF  (0,&#x03A3; )
" class="math-display"  /></center></td><td class="equation-label">(1.12)</td></tr></table>
<!--l. 44--><p class="nopar" >
where <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub> is the intercept, <span 
class="cmmib-10x-x-109">A</span> is the projector matrix and <span 
class="cmmi-10x-x-109">x </span>is a spatial Gaussian random
field.
</p><!--l. 49--><p class="indent" >   The first step in working with SPDE is to build a mesh. We will use as a mesh a collection of
triangles, formed by <span 
class="cmmi-10x-x-109">m </span>vertices and the edges connecting them. This mesh has to cover
the entire spatial domain of interest. More details on the mesh building are given in
section&#x00A0;<a 
href="#x5-270001.3">1.3<!--tex4ht:ref: sec:mesh --></a>. Here we will use the fifth mesh built in Section&#x00A0;<a 
href="#x5-300001.3.3">1.3.3<!--tex4ht:ref: sec:meshestoy --></a> using the following code
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1112"><span 
class="aett-10x-x-109">pl.dom</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1113"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1114"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor1115"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1116"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor1117"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1118"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor1119"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor1120"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1121"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor1122"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1123"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor1124"><span 
class="aett-10x-x-109">0.7</span></span><span id="textcolor1125"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor1126"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor1127"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1128"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor1129"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1130"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor1131"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor1132"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor1133"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor1134"><span 
class="aett-10x-x-109">0.7</span></span><span id="textcolor1135"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor1136"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1137"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor1138"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1139"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor1140"><span 
class="aett-10x-x-109">mesh5</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1141"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1142"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor1143"><span 
class="aett-10x-x-109">(,</span><span 
class="aett-10x-x-109">&#x00A0;pl.dom,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1144"><span 
class="aett-10x-x-109">max.e</span></span><span id="textcolor1145"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1146"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor1147"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1148"><span 
class="aett-10x-x-109">0.092</span></span><span id="textcolor1149"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1150"><span 
class="aett-10x-x-109">0.2</span></span><span id="textcolor1151"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
                                                                                 
                                                                                 
<!--l. 66--><p class="indent" >   The SPDE model in the original parameterization can be built using the function
<span 
class="aett-10x-x-109">inla.spde2.matern() </span></p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1152"><span 
class="aett-10x-x-109">args</span></span><span id="textcolor1153"><span 
class="aett-10x-x-109">(inla.spde2.matern)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-6">
##&#x00A0;function&#x00A0;(mesh,&#x00A0;alpha&#x00A0;=&#x00A0;2,&#x00A0;param&#x00A0;=&#x00A0;NULL,&#x00A0;constr&#x00A0;=&#x00A0;FALSE,&#x00A0;extraconstr.int&#x00A0;=&#x00A0;NULL,
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;extraconstr&#x00A0;=&#x00A0;NULL,&#x00A0;fractional.method&#x00A0;=&#x00A0;c("parsimonious",
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;"null"),&#x00A0;B.tau&#x00A0;=&#x00A0;matrix(c(0,&#x00A0;1,&#x00A0;0),&#x00A0;1,&#x00A0;3),&#x00A0;B.kappa&#x00A0;=&#x00A0;matrix(c(0,
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0,&#x00A0;1),&#x00A0;1,&#x00A0;3),&#x00A0;prior.variance.nominal&#x00A0;=&#x00A0;1,&#x00A0;prior.range.nominal&#x00A0;=&#x00A0;NULL,
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;prior.tau&#x00A0;=&#x00A0;NULL,&#x00A0;prior.kappa&#x00A0;=&#x00A0;NULL,&#x00A0;theta.prior.mean&#x00A0;=&#x00A0;NULL,
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;theta.prior.prec&#x00A0;=&#x00A0;0.1,&#x00A0;n.iid.group&#x00A0;=&#x00A0;1,&#x00A0;...)
&#x00A0;<br />##&#x00A0;NULL
</div>
<!--l. 81--><p class="nopar" >
</p>
   </div>
The principal arguments are the mesh object and the <span 
class="cmmi-10x-x-109">&#x03B1; </span>parameter, related to the smoothness
parameter of the process.
<!--l. 88--><p class="indent" >   We will choose our parameters based instead on the marginal variance and the practical
range, <img 
src="spde-tutorial22x.png" alt="&#x221A; ---
  8&#x03BD;"  class="sqrt"  /><span 
class="cmmi-10x-x-109">&#x2215;&#x03BA;</span>. For details on this parameterization see <span class="cite">[<a 
href="spde-tutorialli2.html#Xlindgren:2012">Lindgren, 2012</a>]</span>. When defining the
SPDE model we will need also to set priors for both the parameters. The smoothness
parameter <span 
class="cmmi-10x-x-109">&#x03BD; </span>is fixed as <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">&#x03BD; </span><span 
class="cmr-10x-x-109">+ </span><span 
class="cmmi-10x-x-109">d&#x2215;</span><span 
class="cmr-10x-x-109">2 </span><span 
class="cmsy-10x-x-109">&#x2208; </span><span 
class="cmr-10x-x-109">[1</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmr-10x-x-109">2]</span>. The <span 
class="aett-10x-x-109">inla.spde2.pcmatern() </span>uses this
parameterization to set the Penealized Complexity prior, PC-prior, as derived in <span class="cite">[<a 
href="spde-tutorialli2.html#Xfuglstadetal:2017">Fuglstad
et&#x00A0;al., 2017</a>]</span>.
</p><!--l. 102--><p class="indent" >   Our example domain is the <span 
class="cmr-10x-x-109">[0</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmr-10x-x-109">1] </span><span 
class="cmsy-10x-x-109">&#x00D7; </span><span 
class="cmr-10x-x-109">[0</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmr-10x-x-109">1] </span>square. We set the prior median to <span 
class="cmr-10x-x-109">0</span><span 
class="cmmi-10x-x-109">.</span><span 
class="cmr-10x-x-109">3</span>.
We set the probability that the marginal standard deviation exceeds 1 to 1%. The
toy dataset was simulated with <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 2 </span>and it is considered to fit the model as well.
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1154"><span 
class="aett-10x-x-109">spde5</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1155"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1156"><span 
class="aett-10x-x-109">inla.spde2.pcmatern</span></span><span id="textcolor1157"><span 
class="aett-10x-x-109">(</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1158"><span 
class="aett-10x-x-109">mesh</span></span><span id="textcolor1159"><span 
class="aett-10x-x-109">=mesh5,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1160"><span 
class="aett-10x-x-109">alpha</span></span><span id="textcolor1161"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1162"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor1163"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1164"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;mesh</span><span 
class="aeitt-10x-x-109">&#x00A0;and</span><span 
class="aeitt-10x-x-109">&#x00A0;smoothness</span><span 
class="aeitt-10x-x-109">&#x00A0;parameter</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1165"><span 
class="aett-10x-x-109">prior.range</span></span><span id="textcolor1166"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1167"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor1168"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1169"><span 
class="aett-10x-x-109">0.3</span></span><span id="textcolor1170"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1171"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor1172"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1173"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;P(practic.range&#x003C;0.3)=0.5</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1174"><span 
class="aett-10x-x-109">prior.sigma</span></span><span id="textcolor1175"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1176"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor1177"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1178"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1179"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1180"><span 
class="aett-10x-x-109">0.01</span></span><span id="textcolor1181"><span 
class="aett-10x-x-109">))</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1182"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;P(sigma&#x003E;1)=0.01</span></span>
</div>
</div>
   </div>
<!--l. 119--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.2.2   </span> <a 
 id="x5-150001.2.2"></a>Projector matrix</h4>
<!--l. 121--><p class="noindent" >The second step in preparing to use SPDE is to build a projector matrix. This will project the
random field modeled at the mesh nodes. For details, see section&#x00A0;<a 
href="#x5-120001.1.5">1.1.5<!--tex4ht:ref: sec:secres --></a>. The projector matrix can
be built with the <span 
class="aett-10x-x-109">inla.spde.make.A </span>function. Considering that each mesh vertex has a weight,
the value for one point within one triangle is the projection of the plane (formed by these three
weights) at this point location. The projection is a weighted average using weights computed by
the <span 
class="aett-10x-x-109">inla.spde.make.A() </span>function. Using the toy data set and example mesh number five, we
have  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
                                                                                 
                                                                                 
<div class="obeylines-v">
<span id="textcolor1183"><span 
class="aett-10x-x-109">coords</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1184"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1185"><span 
class="aett-10x-x-109">as.matrix</span></span><span id="textcolor1186"><span 
class="aett-10x-x-109">(SPDEtoy[,</span></span><span id="textcolor1187"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1188"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor1189"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor1190"><span 
class="aett-10x-x-109">])</span></span>
<br /><span id="textcolor1191"><span 
class="aett-10x-x-109">A5</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1192"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1193"><span 
class="aett-10x-x-109">inla.spde.make.A</span></span><span id="textcolor1194"><span 
class="aett-10x-x-109">(mesh5,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1195"><span 
class="aett-10x-x-109">loc</span></span><span id="textcolor1196"><span 
class="aett-10x-x-109">=coords)</span></span>
</div>
</div>
   </div>
<!--l. 144--><p class="indent" >   This matrix has dimension equal to the number of data locations times the number of
vertices in the mesh  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1197"><span 
class="aett-10x-x-109">dim</span></span><span id="textcolor1198"><span 
class="aett-10x-x-109">(A5)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-7">
##&#x00A0;[1]&#x00A0;200&#x00A0;490
</div>
<!--l. 153--><p class="nopar" >
</p>
   </div>
Because each point location is inside one of the triangles there are exactly three non-zero
elements on each line  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1199"><span 
class="aett-10x-x-109">table</span></span><span id="textcolor1200"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1201"><span 
class="aett-10x-x-109">rowSums</span></span><span id="textcolor1202"><span 
class="aett-10x-x-109">(A5</span></span><span id="textcolor1203"><span 
class="aett-10x-x-109">&#x003E;</span></span><span id="textcolor1204"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor1205"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-8">
##
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;3
&#x00A0;<br />##&#x00A0;200
</div>
<!--l. 167--><p class="nopar" >
</p>
   </div>
because each point location is inside one of the triangles. These three elements on each line sum
to one.  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1206"><span 
class="aett-10x-x-109">table</span></span><span id="textcolor1207"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1208"><span 
class="aett-10x-x-109">rowSums</span></span><span id="textcolor1209"><span 
class="aett-10x-x-109">(A5))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-9">
##
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;1
&#x00A0;<br />##&#x00A0;200
</div>
<!--l. 181--><p class="nopar" >
</p>
   </div>
The reason they sum to one is that multiplication with any vector of weights at mesh nodes
times this matrix is the projection of these weights at the point locations.
<!--l. 188--><p class="indent" >   There are some columns in the projector matrix all of whose elements equal zero.
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1210"><span 
class="aett-10x-x-109">table</span></span><span id="textcolor1211"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1212"><span 
class="aett-10x-x-109">colSums</span></span><span id="textcolor1213"><span 
class="aett-10x-x-109">(A5)</span></span><span id="textcolor1214"><span 
class="aett-10x-x-109">&#x003E;</span></span><span id="textcolor1215"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor1216"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-10">
##
&#x00A0;<br />##&#x00A0;FALSE&#x00A0;&#x00A0;TRUE
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;242&#x00A0;&#x00A0;&#x00A0;248
</div>
<!--l. 199--><p class="nopar" >
</p>
   </div>
These columns correspond to triangles with no point location inside. These columns can be
dropped. The <span 
class="aett-10x-x-109">inla.stack() </span>function (section&#x00A0;<a 
href="#x5-160001.2.3">1.2.3<!--tex4ht:ref: sec:stack --></a>) does this automatically.
<!--l. 208--><p class="indent" >   When we have a mesh where every pont location is on a mesh vertex, each line on the
projector matrix has exacty one nonzero element. This is the case for the <span 
class="aett-10x-x-109">mesh1 </span>built in section
<a 
href="#x5-300001.3.3">1.3.3<!--tex4ht:ref: sec:meshestoy --></a>.
</p>
   <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1217"><span 
class="aett-10x-x-109">A1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1218"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1219"><span 
class="aett-10x-x-109">inla.spde.make.A</span></span><span id="textcolor1220"><span 
class="aett-10x-x-109">(mesh1,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1221"><span 
class="aett-10x-x-109">loc</span></span><span id="textcolor1222"><span 
class="aett-10x-x-109">=coords)</span></span>
<br /><span id="textcolor1223"><span 
class="aett-10x-x-109">table</span></span><span id="textcolor1224"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1225"><span 
class="aett-10x-x-109">rowSums</span></span><span id="textcolor1226"><span 
class="aett-10x-x-109">(A1</span></span><span id="textcolor1227"><span 
class="aett-10x-x-109">&#x003E;</span></span><span id="textcolor1228"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor1229"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-11">
##
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;1
&#x00A0;<br />##&#x00A0;200
</div>
<!--l. 224--><p class="nopar" >
</p>
   </div>
and all these elements are equal to one  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1230"><span 
class="aett-10x-x-109">table</span></span><span id="textcolor1231"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1232"><span 
class="aett-10x-x-109">rowSums</span></span><span id="textcolor1233"><span 
class="aett-10x-x-109">(A1))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-12">
##
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;1
&#x00A0;<br />##&#x00A0;200
</div>
<!--l. 237--><p class="nopar" >
</p>
   </div>
Each element equals one because in this instance the projections to the location points are equal
to the weight at the corresponding node (at the same location) of the mesh.
<!--l. 245--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.2.3   </span> <a 
 id="x5-160001.2.3"></a>The data stack</h4>
<!--l. 247--><p class="noindent" >The <span 
class="aett-10x-x-109">inla.stack() </span>function is usefull for organizing data, covariates, indices and
projector matrices. All are relevant to SPDE models. <span 
class="aett-10x-x-109">inla.stack() </span>helps to control the
way effects are projected in the linear predictor. Detailed examples including one
dimensional, replicated random field and spacetime models are presented in <span class="cite">[<a 
href="spde-tutorialli2.html#Xlindgren:2012">Lindgren,
2012</a>]</span>.
</p><!--l. 256--><p class="indent" >   In the toy example we have a linear predictor that can be written as
</p>
   <center class="math-display" >
<img 
src="spde-tutorial23x.png" alt="&#x03B7;* = 1&#x03B2;0 + Au.
" class="math-display"  /></center>
<!--l. 260--><p class="nopar" > The first half of the right side represents the intercept. The term on the far right represents the
spatial effect. Each component is represented as a product of a projector matrix and an
effect.
</p><!--l. 266--><p class="indent" >   The Finite Element Method solution considered for implementing the SPDE models build
the model over the mesh nodes. Usually the number of nodes is not equal to the number of
locations for which we have observations. The <span 
class="aett-10x-x-109">inla.stack </span>function allows us to work with
predictors that includes terms with different dimensions. The three main <span 
class="aett-10x-x-109">inla.stack()</span>
arguments are the <span 
class="aett-10x-x-109">data </span>vectors list, a list of projector matrices (each related to one block effect)
and the effects.
</p><!--l. 279--><p class="indent" >   We need two projector matrices: the projector matrix for the latent field and a matrix that is
a one-to-one map of the covariate and the response. The latter matrix can simply be a constant
rather than a diagonal matrix. Thus we have  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1234"><span 
class="aett-10x-x-109">stk5</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1235"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1236"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor1237"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1238"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor1239"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1240"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1241"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1242"><span 
class="aett-10x-x-109">resp</span></span><span id="textcolor1243"><span 
class="aett-10x-x-109">=SPDEtoy</span></span><span id="textcolor1244"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1245"><span 
class="aett-10x-x-109">y),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1246"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor1247"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1248"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1249"><span 
class="aett-10x-x-109">(A5,</span></span><span id="textcolor1250"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1251"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1252"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor1253"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1254"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1255"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1256"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor1257"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1258"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1259"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor1260"><span 
class="aett-10x-x-109">spde5</span></span><span id="textcolor1261"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1262"><span 
class="aett-10x-x-109">n.spde,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1263"><span 
class="aett-10x-x-109">m</span></span><span id="textcolor1264"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1265"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor1266"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1267"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1268"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor1269"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor1270"><span 
class="aett-10x-x-109">(SPDEtoy))),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1271"><span 
class="aett-10x-x-109">tag</span></span><span id="textcolor1272"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1273"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">est</span><span 
class="tctt-1095">'</span></span><span id="textcolor1274"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
                                                                                 
                                                                                 
<!--l. 294--><p class="indent" >   The <span 
class="aett-10x-x-109">inla.stack() </span>function automatically eliminates the any column in a projector matrix
that has a zero sum. It generates a new and simplified matrix. The <span 
class="aett-10x-x-109">inla.stack.A() </span>extracts a
simplified predictor matrix to use with the <span 
class="aett-10x-x-109">inla() </span>function, while the <span 
class="aett-10x-x-109">inla.stack.data()</span>
function extracts the corresponding data.
</p><!--l. 303--><p class="indent" >   The simplified projector matrix from the stack consists of the simplified projector matrices,
where each column holds one effect block.  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1275"><span 
class="aett-10x-x-109">dim</span></span><span id="textcolor1276"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1277"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor1278"><span 
class="aett-10x-x-109">(stk5))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-13">
##&#x00A0;[1]&#x00A0;200&#x00A0;249
</div>
<!--l. 313--><p class="nopar" >
</p>
   </div>
In the toy example we have one column more than the number of columns with non-null
elements in the projector matrix.
<!--l. 319--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.2.4   </span> <a 
 id="x5-170001.2.4"></a>Model fitting and some results</h4>
<!--l. 321--><p class="noindent" >To fit the model, we need to remove the intercept from the formula and add it as a covariate
term, so that all the formula&#8217;s covariate terms can be captured in a projector matrix. Them the
matrix of predictors is passed to the <span 
class="aett-10x-x-109">inla() </span>function in its <span 
class="aett-10x-x-109">control.predictor </span>argument
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1279"><span 
class="aett-10x-x-109">res5</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1280"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1281"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor1282"><span 
class="aett-10x-x-109">(resp</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1283"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1284"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1285"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1286"><span 
class="aett-10x-x-109">m</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1287"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1288"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor1289"><span 
class="aett-10x-x-109">(i,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1290"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor1291"><span 
class="aett-10x-x-109">=spde5),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1292"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor1293"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1294"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor1295"><span 
class="aett-10x-x-109">(stk5),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1296"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor1297"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1298"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1299"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1300"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor1301"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1302"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor1303"><span 
class="aett-10x-x-109">(stk5)))</span></span>
</div>
</div>
   </div>
<!--l. 337--><p class="indent" >   The <span 
class="aett-10x-x-109">inla() </span>function returns an object that is a set of several results. It includes summaries,
marginal posterior densities of each parameter in the model, the regression parameters, each
element that is a latent field, and all the hyperparameters.
</p><!--l. 343--><p class="indent" >   The summary of <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub> is obtained by  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1304"><span 
class="aett-10x-x-109">res5</span></span><span id="textcolor1305"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1306"><span 
class="aett-10x-x-109">summary.fix</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-14">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant&#x00A0;0.5quant&#x00A0;0.975quant&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mode&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;kld
&#x00A0;<br />##&#x00A0;m&#x00A0;9.558931&#x00A0;0.5310826&#x00A0;&#x00A0;&#x00A0;8.473508&#x00A0;9.566945&#x00A0;&#x00A0;&#x00A0;10.59886&#x00A0;9.581144&#x00A0;1.501347e-10
</div>
<!--l. 352--><p class="nopar" >
</p>
   </div>
and the summary of <span 
class="cmr-10x-x-109">1</span><span 
class="cmmi-10x-x-109">&#x2215;&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmr-8">2</span></sup> by  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1307"><span 
class="aett-10x-x-109">res5</span></span><span id="textcolor1308"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1309"><span 
class="aett-10x-x-109">summary.hy[</span></span><span id="textcolor1310"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1311"><span 
class="aett-10x-x-109">,]</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-15">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant
&#x00A0;<br />##&#x00A0;Precision&#x00A0;for&#x00A0;the&#x00A0;Gaussian&#x00A0;observations&#x00A0;2.721868&#x00A0;0.4294628&#x00A0;&#x00A0;&#x00A0;1.971006
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.5quant&#x00A0;0.975quant&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mode
&#x00A0;<br />##&#x00A0;Precision&#x00A0;for&#x00A0;the&#x00A0;Gaussian&#x00A0;observations&#x00A0;2.690161&#x00A0;&#x00A0;&#x00A0;3.657818&#x00A0;2.629512
</div>
<!--l. 366--><p class="nopar" >
</p>
   </div>
<!--l. 370--><p class="indent" >   A marginal distribution in <span 
class="aett-10x-x-109">inla() </span>output consists of two vectors. One is a set of values on
the range of the parameter space with posterior marginal density bigger than zero and another is
the posterior marginal density at each one of these values. Any posterior marginal can be
transformed. If we want the posterior marginal for <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub>, the square root of <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmr-8">2</span></sup>, for example, we
use  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1312"><span 
class="aett-10x-x-109">post.se</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1313"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1314"><span 
class="aett-10x-x-109">inla.tmarginal</span></span><span id="textcolor1315"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1316"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor1317"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1318"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor1319"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1320"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor1321"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1322"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1323"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor1324"><span 
class="aett-10x-x-109">x),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1325"><span 
class="aett-10x-x-109">res5</span></span><span id="textcolor1326"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1327"><span 
class="aett-10x-x-109">marginals.hy[[</span></span><span id="textcolor1328"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1329"><span 
class="aett-10x-x-109">]])</span></span>
</div>
</div>
   </div>
Now we are able to summarize this distribution.  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1330"><span 
class="aett-10x-x-109">inla.emarginal</span></span><span id="textcolor1331"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1332"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor1333"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1334"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor1335"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;x,</span><span 
class="aett-10x-x-109">&#x00A0;post.se)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-16">
##&#x00A0;[1]&#x00A0;0.611737
</div>
<!--l. 396--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor1336"><span 
class="aett-10x-x-109">inla.qmarginal</span></span><span id="textcolor1337"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1338"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor1339"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1340"><span 
class="aett-10x-x-109">0.025</span></span><span id="textcolor1341"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1342"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor1343"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1344"><span 
class="aett-10x-x-109">0.975</span></span><span id="textcolor1345"><span 
class="aett-10x-x-109">),</span><span 
class="aett-10x-x-109">&#x00A0;post.se)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-17">
##&#x00A0;[1]&#x00A0;0.5235280&#x00A0;0.6096069&#x00A0;0.7112972
</div>
<!--l. 402--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor1346"><span 
class="aett-10x-x-109">inla.hpdmarginal</span></span><span id="textcolor1347"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1348"><span 
class="aett-10x-x-109">0.95</span></span><span id="textcolor1349"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;post.se)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-18">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;low&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;high
&#x00A0;<br />##&#x00A0;level:0.95&#x00A0;0.5198993&#x00A0;0.7070243
</div>
<!--l. 409--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor1350"><span 
class="aett-10x-x-109">inla.pmarginal</span></span><span id="textcolor1351"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1352"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor1353"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1354"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor1355"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1356"><span 
class="aett-10x-x-109">0.7</span></span><span id="textcolor1357"><span 
class="aett-10x-x-109">),</span><span 
class="aett-10x-x-109">&#x00A0;post.se)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-19">
##&#x00A0;[1]&#x00A0;0.004992597&#x00A0;0.960367656
</div>
<!--l. 415--><p class="nopar" >
</p>
   </div>
and, of course, we can visualize it.
<!--l. 420--><p class="indent" >   The parameters of the latent field is parametrized as <span 
class="cmmi-10x-x-109">log</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">&#x03BA;</span><span 
class="cmr-10x-x-109">) </span>and <span 
class="cmmi-10x-x-109">log</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">&#x03C4;</span><span 
class="cmr-10x-x-109">)</span>, where <span 
class="cmmi-10x-x-109">&#x03C4; </span>is the local
variance parameter. We have the posterior marginals for <span 
class="cmmi-10x-x-109">&#x03BA;</span>, <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">x</span></sub><sup><span 
class="cmr-8">2</span></sup> and for the nominal range (the
distance that we have correlation equals 0.1). This can be done with the <span 
class="aett-10x-x-109">inla.spde2.result</span>
function  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1358"><span 
class="aett-10x-x-109">res5.field</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1359"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1360"><span 
class="aett-10x-x-109">inla.spde2.result</span></span><span id="textcolor1361"><span 
class="aett-10x-x-109">(res5,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1362"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">i</span><span 
class="tctt-1095">'</span></span><span id="textcolor1363"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;spde5,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1364"><span 
class="aett-10x-x-109">do.transf</span></span><span id="textcolor1365"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1366"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor1367"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
and we get the posterior mean of each of these parameters by  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1368"><span 
class="aett-10x-x-109">inla.emarginal</span></span><span id="textcolor1369"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1370"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor1371"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1372"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor1373"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;x,</span><span 
class="aett-10x-x-109">&#x00A0;res5.field</span></span><span id="textcolor1374"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1375"><span 
class="aett-10x-x-109">marginals.kappa[[</span></span><span id="textcolor1376"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1377"><span 
class="aett-10x-x-109">]])</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-20">
##&#x00A0;[1]&#x00A0;9.147793
</div>
<!--l. 443--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor1378"><span 
class="aett-10x-x-109">inla.emarginal</span></span><span id="textcolor1379"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1380"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor1381"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1382"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor1383"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;x,</span><span 
class="aett-10x-x-109">&#x00A0;res5.field</span></span><span id="textcolor1384"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1385"><span 
class="aett-10x-x-109">marginals.variance.nominal[[</span></span><span id="textcolor1386"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1387"><span 
class="aett-10x-x-109">]])</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-21">
##&#x00A0;[1]&#x00A0;2.927698
</div>
<!--l. 449--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor1388"><span 
class="aett-10x-x-109">inla.emarginal</span></span><span id="textcolor1389"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1390"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor1391"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1392"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor1393"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;x,</span><span 
class="aett-10x-x-109">&#x00A0;res5.field</span></span><span id="textcolor1394"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1395"><span 
class="aett-10x-x-109">marginals.range.nominal[[</span></span><span id="textcolor1396"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1397"><span 
class="aett-10x-x-109">]])</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-22">
##&#x00A0;[1]&#x00A0;0.3197369
</div>
<!--l. 455--><p class="nopar" >
</p>
   </div>
also we can get other summary statistics, HPD interval and visualize it.
<!--l. 461--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.2.5   </span> <a 
 id="x5-180001.2.5"></a>Prediction of the random field</h4>
<!--l. 463--><p class="noindent" >A very common objective when we have spatial data collected on some locations is the
prediction on a fine grid to get hight resolution maps. In this subsection we show two approaches
to make prediction of the random field, one is after the estimation process and other is jointly on
estimation process. To compare both approaches, we predict the random field on three target
locations: (0.1,0.1), (0.5,0.55), (0.7,0.9).  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1398"><span 
class="aett-10x-x-109">pts3</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1399"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1400"><span 
class="aett-10x-x-109">rbind</span></span><span id="textcolor1401"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1402"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor1403"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1404"><span 
class="aett-10x-x-109">.1</span></span><span id="textcolor1405"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor1406"><span 
class="aett-10x-x-109">.1</span></span><span id="textcolor1407"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1408"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor1409"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1410"><span 
class="aett-10x-x-109">.5</span></span><span id="textcolor1411"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor1412"><span 
class="aett-10x-x-109">.55</span></span><span id="textcolor1413"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1414"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor1415"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1416"><span 
class="aett-10x-x-109">.7</span></span><span id="textcolor1417"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor1418"><span 
class="aett-10x-x-109">.9</span></span><span id="textcolor1419"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
<!--l. 480--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><a 
 id="x5-190001.2.5"></a>Jointly with the estimation process</h5>
<!--l. 482--><p class="noindent" >The prediction of the random field joint the parameter estimation process in Bayesian inference
is the common approach. This approach is made by the computation of the marginal posterior
distribution of the random field at target locations. If the target points are on the mesh, so we
have automatically this distribution. If the target points are not on the mesh, we must define the
projector matrix for the target points.
</p><!--l. 494--><p class="indent" >   The predictor matrix for the target locations is  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1420"><span 
class="aett-10x-x-109">dim</span></span><span id="textcolor1421"><span 
class="aett-10x-x-109">(A5pts3</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1422"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1423"><span 
class="aett-10x-x-109">inla.spde.make.A</span></span><span id="textcolor1424"><span 
class="aett-10x-x-109">(mesh5,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1425"><span 
class="aett-10x-x-109">loc</span></span><span id="textcolor1426"><span 
class="aett-10x-x-109">=pts3))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-23">
##&#x00A0;[1]&#x00A0;&#x00A0;&#x00A0;3&#x00A0;490
</div>
<!--l. 502--><p class="nopar" >
</p>
   </div>
We can show the columns with non-zero elements of this matrix  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1427"><span 
class="aett-10x-x-109">(jj3</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1428"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1429"><span 
class="aett-10x-x-109">which</span></span><span id="textcolor1430"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1431"><span 
class="aett-10x-x-109">colSums</span></span><span id="textcolor1432"><span 
class="aett-10x-x-109">(A5pts3)</span></span><span id="textcolor1433"><span 
class="aett-10x-x-109">&#x003E;</span></span><span id="textcolor1434"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor1435"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-24">
##&#x00A0;[1]&#x00A0;&#x00A0;85&#x00A0;&#x00A0;89&#x00A0;153&#x00A0;162&#x00A0;197&#x00A0;242&#x00A0;244&#x00A0;285&#x00A0;290
</div>
<!--l. 514--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor1436"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor1437"><span 
class="aett-10x-x-109">(A5pts3[,</span><span 
class="aett-10x-x-109">&#x00A0;jj3],</span></span><span id="textcolor1438"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor1439"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-25">
##&#x00A0;3&#x00A0;x&#x00A0;9&#x00A0;sparse&#x00A0;Matrix&#x00A0;of&#x00A0;class&#x00A0;"dgCMatrix"
&#x00A0;<br />##
&#x00A0;<br />##&#x00A0;[1,]&#x00A0;.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.094&#x00A0;.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.513&#x00A0;0.393&#x00A0;.
&#x00A0;<br />##&#x00A0;[2,]&#x00A0;0.219&#x00A0;.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.324&#x00A0;.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.458&#x00A0;.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;.
&#x00A0;<br />##&#x00A0;[3,]&#x00A0;.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.119&#x00A0;.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.268&#x00A0;.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.612
</div>
<!--l. 524--><p class="nopar" >
</p>
   </div>
<!--l. 528--><p class="indent" >   We have to define a data stack for the prediction and join it with the data stack of the
observations. The prediction data stack contais the effect set, predictor matrices and assign NA
to response  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1440"><span 
class="aett-10x-x-109">stk5p.rf</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1441"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1442"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor1443"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1444"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor1445"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1446"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1447"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1448"><span 
class="aett-10x-x-109">resp</span></span><span id="textcolor1449"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1450"><span 
class="aett-10x-x-109">NA</span></span><span id="textcolor1451"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1452"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor1453"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1454"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1455"><span 
class="aett-10x-x-109">(A5pts3),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1456"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor1457"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1458"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1459"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1460"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor1461"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1462"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1463"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor1464"><span 
class="aett-10x-x-109">spde5</span></span><span id="textcolor1465"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1466"><span 
class="aett-10x-x-109">n.spde),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1467"><span 
class="aett-10x-x-109">tag</span></span><span id="textcolor1468"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1469"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">prd5r</span><span 
class="tctt-1095">'</span></span><span id="textcolor1470"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
Also, we join both stacks by  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1471"><span 
class="aett-10x-x-109">stk5.jp</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1472"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1473"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor1474"><span 
class="aett-10x-x-109">(stk5,</span><span 
class="aett-10x-x-109">&#x00A0;stk5p.rf)</span></span>
</div>
</div>
   </div>
and fit the model again with the full stack setting <span 
class="aett-10x-x-109">compute=TRUE </span>on <span 
class="aett-10x-x-109">control.predictor</span>
<div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1475"><span 
class="aett-10x-x-109">res5p</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1476"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1477"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor1478"><span 
class="aett-10x-x-109">(resp</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1479"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1480"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1481"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1482"><span 
class="aett-10x-x-109">m</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1483"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1484"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor1485"><span 
class="aett-10x-x-109">(i,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1486"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor1487"><span 
class="aett-10x-x-109">=spde5),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1488"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor1489"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1490"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor1491"><span 
class="aett-10x-x-109">(stk5.jp),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1492"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor1493"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1494"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1495"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1496"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor1497"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1498"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor1499"><span 
class="aett-10x-x-109">(stk5.jp),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1500"><span 
class="aett-10x-x-109">compute</span></span><span id="textcolor1501"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1502"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor1503"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
<!--l. 560--><p class="indent" >   To access the posterior marginal distribution of the random field at the target locations, we
extract the index from the full stack using the adequate <span 
class="aett-10x-x-109">tag</span>.  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
                                                                                 
                                                                                 
<div class="obeylines-v">
<span id="textcolor1504"><span 
class="aett-10x-x-109">(indd5p</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1505"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1506"><span 
class="aett-10x-x-109">inla.stack.index</span></span><span id="textcolor1507"><span 
class="aett-10x-x-109">(stk5.jp,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1508"><span 
class="aett-10x-x-109">tag</span></span><span id="textcolor1509"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1510"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">prd5r</span><span 
class="tctt-1095">'</span></span><span id="textcolor1511"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor1512"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1513"><span 
class="aett-10x-x-109">data)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-26">
##&#x00A0;[1]&#x00A0;201&#x00A0;202&#x00A0;203
</div>
<!--l. 571--><p class="nopar" >
</p>
   </div>
The summary of the posterior distributions of the random field on the target locations is
<div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1514"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor1515"><span 
class="aett-10x-x-109">(res5p</span></span><span id="textcolor1516"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1517"><span 
class="aett-10x-x-109">summary.linear.pred[indd5p,],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1518"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor1519"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-27">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant&#x00A0;0.5quant&#x00A0;0.975quant&#x00A0;&#x00A0;&#x00A0;&#x00A0;mode&#x00A0;kld
&#x00A0;<br />##&#x00A0;APredictor.201&#x00A0;&#x00A0;0.1226&#x00A0;0.6354&#x00A0;&#x00A0;&#x00A0;&#x00A0;-1.1047&#x00A0;&#x00A0;&#x00A0;0.1122&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.4117&#x00A0;&#x00A0;0.0936&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />##&#x00A0;APredictor.202&#x00A0;&#x00A0;2.9730&#x00A0;0.8163&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.3825&#x00A0;&#x00A0;&#x00A0;2.9677&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4.5943&#x00A0;&#x00A0;2.9575&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />##&#x00A0;APredictor.203&#x00A0;-2.7016&#x00A0;1.0888&#x00A0;&#x00A0;&#x00A0;&#x00A0;-4.8496&#x00A0;&#x00A0;-2.6988&#x00A0;&#x00A0;&#x00A0;&#x00A0;-0.5694&#x00A0;-2.6934&#x00A0;&#x00A0;&#x00A0;0
</div>
<!--l. 586--><p class="nopar" >
</p>
   </div>
that includes the posterior mean, standard deviation, quantiles and mode.
<!--l. 592--><p class="indent" >   Because it is a full bayesian analysis, we also we have the marginal distributions. We extract
the marginals posterior distributions with  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1520"><span 
class="aett-10x-x-109">marg3</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1521"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1522"><span 
class="aett-10x-x-109">res5p</span></span><span id="textcolor1523"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1524"><span 
class="aett-10x-x-109">marginals.linear[indd5p]</span></span>
</div>
</div>
   </div>
and get the 95% HPD interval for the random field at the second target location by
<div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1525"><span 
class="aett-10x-x-109">inla.hpdmarginal</span></span><span id="textcolor1526"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1527"><span 
class="aett-10x-x-109">0.95</span></span><span id="textcolor1528"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;marg3[[</span></span><span id="textcolor1529"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor1530"><span 
class="aett-10x-x-109">]])</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-28">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;low&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;high
&#x00A0;<br />##&#x00A0;level:0.95&#x00A0;1.370391&#x00A0;4.580516
</div>
<!--l. 612--><p class="nopar" >
</p>
   </div>
and see that around the point (0.5,0.5) the random field has positive values, see Figure&#x00A0;<a 
href="#x5-250001.2.6">1.2.6<!--tex4ht:ref: fig:pgrid --></a>.
<!--l. 618--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><a 
 id="x5-200001.2.5"></a>After the estimation process</h5>
<!--l. 620--><p class="noindent" >If we need just the prediction we can do the prediction after the estimation process with a very
small computational cost. It is just a matrix operation in way that we just project the posterior
mean of the the random field on mesh nodes to target locations, using the correspondent
projector matrix.
</p><!--l. 629--><p class="indent" >   So, we &#8217;project&#8217; the posterior mean of the latend random field to the target locations by
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1531"><span 
class="aett-10x-x-109">drop</span></span><span id="textcolor1532"><span 
class="aett-10x-x-109">(A5pts3</span></span><span id="textcolor1533"><span 
class="aett-10x-x-109">%*%</span></span><span id="textcolor1534"><span 
class="aett-10x-x-109">res5</span></span><span id="textcolor1535"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1536"><span 
class="aett-10x-x-109">summary.random</span></span><span id="textcolor1537"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1538"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor1539"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1540"><span 
class="aett-10x-x-109">mean)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-29">
##&#x00A0;[1]&#x00A0;&#x00A0;0.1222806&#x00A0;&#x00A0;2.9728843&#x00A0;-2.7014696
</div>
<!--l. 638--><p class="nopar" >
</p>
   </div>
or using the <span 
class="aett-10x-x-109">inla.mesh.projector() </span>function  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1541"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor1542"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1543"><span 
class="aett-10x-x-109">inla.mesh.projector</span></span><span id="textcolor1544"><span 
class="aett-10x-x-109">(mesh5,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1545"><span 
class="aett-10x-x-109">loc</span></span><span id="textcolor1546"><span 
class="aett-10x-x-109">=pts3),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1547"><span 
class="aett-10x-x-109">res5</span></span><span id="textcolor1548"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1549"><span 
class="aett-10x-x-109">summary.random</span></span><span id="textcolor1550"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1551"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor1552"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1553"><span 
class="aett-10x-x-109">mean)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-30">
##&#x00A0;[1]&#x00A0;&#x00A0;0.1222806&#x00A0;&#x00A0;2.9728843&#x00A0;-2.7014696
</div>
<!--l. 650--><p class="nopar" >
</p>
   </div>
and see that for the mean we have similar values than those on previous subsection.
<!--l. 656--><p class="indent" >   Also, we can get the standard deviation  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1554"><span 
class="aett-10x-x-109">drop</span></span><span id="textcolor1555"><span 
class="aett-10x-x-109">(A5pts3</span></span><span id="textcolor1556"><span 
class="aett-10x-x-109">%*%</span></span><span id="textcolor1557"><span 
class="aett-10x-x-109">res5</span></span><span id="textcolor1558"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1559"><span 
class="aett-10x-x-109">summary.random</span></span><span id="textcolor1560"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1561"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor1562"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1563"><span 
class="aett-10x-x-109">sd)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-31">
##&#x00A0;[1]&#x00A0;0.7389992&#x00A0;0.9920801&#x00A0;1.2677818
</div>
<!--l. 664--><p class="nopar" >
</p>
   </div>
and we have a little difference.  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1564"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor1565"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1566"><span 
class="aett-10x-x-109">drop</span></span><span id="textcolor1567"><span 
class="aett-10x-x-109">((A5pts3</span></span><span id="textcolor1568"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor1569"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor1570"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor1571"><span 
class="aett-10x-x-109">%*%</span></span><span id="textcolor1572"><span 
class="aett-10x-x-109">(res5</span></span><span id="textcolor1573"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1574"><span 
class="aett-10x-x-109">summary.random</span></span><span id="textcolor1575"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1576"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor1577"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1578"><span 
class="aett-10x-x-109">sd</span></span><span id="textcolor1579"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor1580"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor1581"><span 
class="aett-10x-x-109">)))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-32">
##&#x00A0;[1]&#x00A0;0.4894069&#x00A0;0.6144520&#x00A0;0.8630550
</div>
<!--l. 675--><p class="nopar" >
</p>
   </div>
<!--l. 679--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><a 
 id="x5-210001.2.5"></a>Projection on a grid</h5>
<!--l. 681--><p class="noindent" >The approach by the projection of the posterior mean random field is computationaly cheap. So,
it can be used to get the map of the random field on a fine grid. The <span 
class="aett-10x-x-109">inla.mesh.projector()</span>
function get the projector matrix automatically for a grid of points over a square that contains
the mesh.
</p><!--l. 689--><p class="indent" >   To get projection on a grid at the domain <span 
class="cmr-10x-x-109">(0</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmr-10x-x-109">1) </span><span 
class="cmsy-10x-x-109">&#x00D7; </span><span 
class="cmr-10x-x-109">(0</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmr-10x-x-109">1) </span>we just inform these limits
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1582"><span 
class="aett-10x-x-109">pgrid0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1583"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1584"><span 
class="aett-10x-x-109">inla.mesh.projector</span></span><span id="textcolor1585"><span 
class="aett-10x-x-109">(mesh5,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1586"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor1587"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1588"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor1589"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor1590"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1591"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1592"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor1593"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1594"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor1595"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor1596"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1597"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1598"><span 
class="aett-10x-x-109">dims</span></span><span id="textcolor1599"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1600"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor1601"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1602"><span 
class="aett-10x-x-109">101</span></span><span id="textcolor1603"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor1604"><span 
class="aett-10x-x-109">101</span></span><span id="textcolor1605"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
and we project the posterior mean and the posterior standard deviation on the both grid with
<div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1606"><span 
class="aett-10x-x-109">prd0.m</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1607"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1608"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor1609"><span 
class="aett-10x-x-109">(pgrid0,</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;res5</span></span><span id="textcolor1610"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1611"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor1612"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1613"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor1614"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1615"><span 
class="aett-10x-x-109">mean)</span></span>
<br /><span id="textcolor1616"><span 
class="aett-10x-x-109">prd0.s</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1617"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1618"><span 
class="aett-10x-x-109">inla.mesh.project</span></span><span id="textcolor1619"><span 
class="aett-10x-x-109">(pgrid0,</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;res5</span></span><span id="textcolor1620"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1621"><span 
class="aett-10x-x-109">summary.ran</span></span><span id="textcolor1622"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1623"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor1624"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1625"><span 
class="aett-10x-x-109">s)</span></span>
</div>
</div>
   </div>
We visualize this values projected on the grid on Figure&#x00A0;<a 
href="#x5-250001.2.6">1.2.6<!--tex4ht:ref: fig:pgrid --></a>.
<!--l. 711--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.2.6   </span> <a 
 id="x5-220001.2.6"></a>Prediction of the response</h4>
<!--l. 713--><p class="noindent" >Another commom result that we want on spatially continuous modelling is the prediction of the
response on a target locations that we don&#8217;t have data observed. In similar way that on past
subsection, it is possible to find the marginal distribution or to make a projection of some
functional of the response.
                                                                                 
                                                                                 
</p><!--l. 721--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><a 
 id="x5-230001.2.6"></a>By the posterior distribution</h5>
<!--l. 723--><p class="noindent" >In this case, we want to define a adequate predictor of the response and build the model again.
This is similar to the stack to predict the random field, but here we add the intercept on the list
of predictor matrix and on the list of effects  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1626"><span 
class="aett-10x-x-109">stk5.presp</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1627"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1628"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor1629"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1630"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor1631"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1632"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1633"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1634"><span 
class="aett-10x-x-109">resp</span></span><span id="textcolor1635"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1636"><span 
class="aett-10x-x-109">NA</span></span><span id="textcolor1637"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1638"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor1639"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1640"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1641"><span 
class="aett-10x-x-109">(A5pts3,</span></span><span id="textcolor1642"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1643"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1644"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor1645"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1646"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1647"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1648"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor1649"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1650"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1651"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor1652"><span 
class="aett-10x-x-109">spde5</span></span><span id="textcolor1653"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1654"><span 
class="aett-10x-x-109">n.spde,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1655"><span 
class="aett-10x-x-109">m</span></span><span id="textcolor1656"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1657"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor1658"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1659"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1660"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor1661"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor1662"><span 
class="aett-10x-x-109">)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1663"><span 
class="aett-10x-x-109">tag</span></span><span id="textcolor1664"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1665"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">prd5.resp</span><span 
class="tctt-1095">'</span></span><span id="textcolor1666"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
and join with the data stack to build the model again  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1667"><span 
class="aett-10x-x-109">stk5.full</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1668"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1669"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor1670"><span 
class="aett-10x-x-109">(stk5,</span><span 
class="aett-10x-x-109">&#x00A0;stk5.presp)</span></span>
<br /><span id="textcolor1671"><span 
class="aett-10x-x-109">r5presp</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1672"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1673"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor1674"><span 
class="aett-10x-x-109">(resp</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1675"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1676"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1677"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1678"><span 
class="aett-10x-x-109">m</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1679"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1680"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor1681"><span 
class="aett-10x-x-109">(i,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1682"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor1683"><span 
class="aett-10x-x-109">=spde5),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1684"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor1685"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1686"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor1687"><span 
class="aett-10x-x-109">(stk5.full),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1688"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor1689"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1690"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1691"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1692"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor1693"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1694"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor1695"><span 
class="aett-10x-x-109">(stk5.full),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1696"><span 
class="aett-10x-x-109">compute</span></span><span id="textcolor1697"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1698"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor1699"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
<!--l. 750--><p class="indent" >   We find the index of the predictor that corresponds the predicted values of the response on
the target locations. We extract the index from the full stack by  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1700"><span 
class="aett-10x-x-109">(indd3r</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1701"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1702"><span 
class="aett-10x-x-109">inla.stack.index</span></span><span id="textcolor1703"><span 
class="aett-10x-x-109">(stk5.full,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1704"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">prd5.resp</span><span 
class="tctt-1095">'</span></span><span id="textcolor1705"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor1706"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1707"><span 
class="aett-10x-x-109">data)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-33">
##&#x00A0;[1]&#x00A0;201&#x00A0;202&#x00A0;203
</div>
<!--l. 761--><p class="nopar" >
</p>
   </div>
<!--l. 765--><p class="indent" >   To get the summary of the posterior distributions of the response on target locations we do
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1708"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor1709"><span 
class="aett-10x-x-109">(r5presp</span></span><span id="textcolor1710"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1711"><span 
class="aett-10x-x-109">summary.fitted.values[indd3r,],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1712"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor1713"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-34">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mean&#x00A0;&#x00A0;&#x00A0;&#x00A0;sd&#x00A0;0.025quant&#x00A0;0.5quant&#x00A0;0.975quant&#x00A0;&#x00A0;&#x00A0;mode
&#x00A0;<br />##&#x00A0;fitted.APredictor.201&#x00A0;&#x00A0;9.681&#x00A0;0.344&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;9.008&#x00A0;&#x00A0;&#x00A0;&#x00A0;9.680&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;10.358&#x00A0;&#x00A0;9.679
&#x00A0;<br />##&#x00A0;fitted.APredictor.202&#x00A0;12.532&#x00A0;0.625&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;11.308&#x00A0;&#x00A0;&#x00A0;12.531&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;13.762&#x00A0;12.529
&#x00A0;<br />##&#x00A0;fitted.APredictor.203&#x00A0;&#x00A0;6.857&#x00A0;0.976&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4.948&#x00A0;&#x00A0;&#x00A0;&#x00A0;6.853&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;8.788&#x00A0;&#x00A0;6.845
</div>
<!--l. 777--><p class="nopar" >
</p>
   </div>
Also, we extract the marginals posterior distributions with  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1714"><span 
class="aett-10x-x-109">marg3r</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1715"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1716"><span 
class="aett-10x-x-109">r5presp</span></span><span id="textcolor1717"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1718"><span 
class="aett-10x-x-109">marginals.fitted.values[indd3r]</span></span>
</div>
</div>
   </div>
and get the 95% HPD interval for the response at second target location by  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1719"><span 
class="aett-10x-x-109">inla.hpdmarginal</span></span><span id="textcolor1720"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1721"><span 
class="aett-10x-x-109">0.95</span></span><span id="textcolor1722"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;marg3r[[</span></span><span id="textcolor1723"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor1724"><span 
class="aett-10x-x-109">]])</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-35">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;low&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;high
&#x00A0;<br />##&#x00A0;level:0.95&#x00A0;11.30451&#x00A0;13.75794
</div>
<!--l. 799--><p class="nopar" >
</p>
   </div>
and see that around the point (0.5,0.5) we have the values of the response significantly larger
than <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub>, see Figure&#x00A0;<a 
href="#x5-250001.2.6">1.2.6<!--tex4ht:ref: fig:pgrid --></a>.
<!--l. 806--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><a 
 id="x5-240001.2.6"></a>By sum of linear predictor components</h5>
<!--l. 808--><p class="noindent" >A computational cheap approach is to (naively) sum the projected posterior mean
to the regression term. In this toy example we just sum the posterior mean of the
intercept to the posterior mean of the random field to get the posterior mean of the
response.
</p><!--l. 815--><p class="indent" >   If there are covariates, the prediction also can be made in similar way, see&#x00A0;. That approach
can be used here considering just the intercept  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1725"><span 
class="aett-10x-x-109">res5</span></span><span id="textcolor1726"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1727"><span 
class="aett-10x-x-109">summary.fix[</span></span><span id="textcolor1728"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1729"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor1730"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1731"><span 
class="aett-10x-x-109">]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1732"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1733"><span 
class="aett-10x-x-109">drop</span></span><span id="textcolor1734"><span 
class="aett-10x-x-109">(A5pts3</span></span><span id="textcolor1735"><span 
class="aett-10x-x-109">%*%</span></span><span id="textcolor1736"><span 
class="aett-10x-x-109">res5</span></span><span id="textcolor1737"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1738"><span 
class="aett-10x-x-109">summary.random</span></span><span id="textcolor1739"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1740"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor1741"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1742"><span 
class="aett-10x-x-109">mean)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-36">
##&#x00A0;[1]&#x00A0;&#x00A0;9.681211&#x00A0;12.531815&#x00A0;&#x00A0;6.857461
</div>
<!--l. 826--><p class="nopar" >
</p>
   </div>
For the standard error, we need to take into account the error of the covariate values and
regression coefficients.
   <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1743"><span 
class="aett-10x-x-109">summary</span></span><span id="textcolor1744"><span 
class="aett-10x-x-109">(rvar</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1745"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1746"><span 
class="aett-10x-x-109">res5</span></span><span id="textcolor1747"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1748"><span 
class="aett-10x-x-109">summary.random</span></span><span id="textcolor1749"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1750"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor1751"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1752"><span 
class="aett-10x-x-109">sd</span></span><span id="textcolor1753"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor1754"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor1755"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-37">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;Min.&#x00A0;1st&#x00A0;Qu.&#x00A0;&#x00A0;Median&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mean&#x00A0;3rd&#x00A0;Qu.&#x00A0;&#x00A0;&#x00A0;&#x00A0;Max.
&#x00A0;<br />##&#x00A0;&#x00A0;0.3385&#x00A0;&#x00A0;0.7888&#x00A0;&#x00A0;1.1684&#x00A0;&#x00A0;1.9654&#x00A0;&#x00A0;2.1542&#x00A0;&#x00A0;8.2618
</div>
<!--l. 843--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor1756"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor1757"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1758"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1759"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor1760"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor1761"><span 
class="aett-10x-x-109">+</span></span><span id="textcolor1762"><span 
class="aett-10x-x-109">res5</span></span><span id="textcolor1763"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1764"><span 
class="aett-10x-x-109">summary.fix[</span></span><span id="textcolor1765"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1766"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor1767"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor1768"><span 
class="aett-10x-x-109">]</span></span><span id="textcolor1769"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor1770"><span 
class="aett-10x-x-109">2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1771"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1772"><span 
class="aett-10x-x-109">drop</span></span><span id="textcolor1773"><span 
class="aett-10x-x-109">(A5pts3</span></span><span id="textcolor1774"><span 
class="aett-10x-x-109">%*%</span></span><span id="textcolor1775"><span 
class="aett-10x-x-109">rvar))</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-38">
##&#x00A0;[1]&#x00A0;1.353252&#x00A0;1.509747&#x00A0;1.700649
</div>
<!--l. 849--><p class="nopar" >
</p>
   </div>
<!--l. 853--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><a 
 id="x5-250001.2.6"></a>Response on a grid</h5>
<!--l. 855--><p class="noindent" >The computation of all marginal posterior distributions on a grid is computationally expensive.
But, we usually not uses the marginal distributions. We usually uses just the mean and standard
deviation. So, we don&#8217;t need the storage of all the marginal distributions! Also, we don&#8217;t need
the quantiles of the marginal distributions.
</p><!--l. 863--><p class="indent" >   On the code below, we build the model again but we disable the storage of the marginal
posterior distributions to random effects and to posterior predictor values. Also, we
disable the computation of the quantiles. Only the mean and standard defiation are
stored.
</p><!--l. 870--><p class="indent" >   We use the projector matrix on the projector object that we use to project the posterior
mean on the grid  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1776"><span 
class="aett-10x-x-109">stkgrid</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1777"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1778"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor1779"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1780"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor1781"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1782"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1783"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1784"><span 
class="aett-10x-x-109">resp</span></span><span id="textcolor1785"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1786"><span 
class="aett-10x-x-109">NA</span></span><span id="textcolor1787"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1788"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor1789"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1790"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1791"><span 
class="aett-10x-x-109">(pgrid0</span></span><span id="textcolor1792"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1793"><span 
class="aett-10x-x-109">proj</span></span><span id="textcolor1794"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1795"><span 
class="aett-10x-x-109">A,</span></span><span id="textcolor1796"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1797"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1798"><span 
class="aett-10x-x-109">effects</span></span><span id="textcolor1799"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1800"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1801"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1802"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor1803"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1804"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1805"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor1806"><span 
class="aett-10x-x-109">spde5</span></span><span id="textcolor1807"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1808"><span 
class="aett-10x-x-109">n.spde,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1809"><span 
class="aett-10x-x-109">m</span></span><span id="textcolor1810"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1811"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor1812"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1813"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1814"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor1815"><span 
class="aett-10x-x-109">101</span></span><span id="textcolor1816"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor1817"><span 
class="aett-10x-x-109">101</span></span><span id="textcolor1818"><span 
class="aett-10x-x-109">)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1819"><span 
class="aett-10x-x-109">tag</span></span><span id="textcolor1820"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1821"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">prd.gr</span><span 
class="tctt-1095">'</span></span><span id="textcolor1822"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor1823"><span 
class="aett-10x-x-109">stk.all</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1824"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1825"><span 
class="aett-10x-x-109">inla.stack</span></span><span id="textcolor1826"><span 
class="aett-10x-x-109">(stk5,</span><span 
class="aett-10x-x-109">&#x00A0;stkgrid)</span></span>
<br /><span id="textcolor1827"><span 
class="aett-10x-x-109">res5g</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1828"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1829"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor1830"><span 
class="aett-10x-x-109">(resp</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1831"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1832"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1833"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1834"><span 
class="aett-10x-x-109">m</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1835"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1836"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor1837"><span 
class="aett-10x-x-109">(i,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1838"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor1839"><span 
class="aett-10x-x-109">=spde5),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1840"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor1841"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1842"><span 
class="aett-10x-x-109">inla.stack.data</span></span><span id="textcolor1843"><span 
class="aett-10x-x-109">(stk.all),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1844"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor1845"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1846"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1847"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1848"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor1849"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1850"><span 
class="aett-10x-x-109">inla.stack.A</span></span><span id="textcolor1851"><span 
class="aett-10x-x-109">(stk.all),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1852"><span 
class="aett-10x-x-109">compute</span></span><span id="textcolor1853"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1854"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor1855"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1856"><span 
class="aett-10x-x-109">quantiles</span></span><span id="textcolor1857"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1858"><span 
class="aett-10x-x-109">NULL</span></span><span id="textcolor1859"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1860"><span 
class="aett-10x-x-109">control.results</span></span><span id="textcolor1861"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1862"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1863"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1864"><span 
class="aett-10x-x-109">return.marginals.random</span></span><span id="textcolor1865"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1866"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor1867"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1868"><span 
class="aett-10x-x-109">return.marginals.predictor</span></span><span id="textcolor1869"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1870"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor1871"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor1872"><span 
class="aett-10x-x-109">res5g</span></span><span id="textcolor1873"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1874"><span 
class="aett-10x-x-109">cpu</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-39">
##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Pre&#x00A0;&#x00A0;&#x00A0;&#x00A0;Running&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Post&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Total
&#x00A0;<br />##&#x00A0;0.38548446&#x00A0;6.41950345&#x00A0;0.09945011&#x00A0;6.90443802
</div>
<!--l. 890--><p class="nopar" >
</p>
   </div>
<!--l. 894--><p class="indent" >   We get the indexes  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1875"><span 
class="aett-10x-x-109">igr</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1876"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1877"><span 
class="aett-10x-x-109">inla.stack.index</span></span><span id="textcolor1878"><span 
class="aett-10x-x-109">(stk.all,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1879"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">prd.gr</span><span 
class="tctt-1095">'</span></span><span id="textcolor1880"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor1881"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1882"><span 
class="aett-10x-x-109">data</span></span>
</div>
</div>
   </div>
and use it to visualize, together the prediction of the random field on previous subsection, on
Figure&#x00A0;<a 
href="#x5-250001.2.6">1.2.6<!--tex4ht:ref: fig:pgrid --></a> with the commands bellow  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor1883"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor1884"><span 
class="aett-10x-x-109">(gridExtra)</span></span>
<br /><span id="textcolor1885"><span 
class="aett-10x-x-109">grid.arrange</span></span><span id="textcolor1886"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1887"><span 
class="aett-10x-x-109">levelplot</span></span><span id="textcolor1888"><span 
class="aett-10x-x-109">(prd0.m,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1889"><span 
class="aett-10x-x-109">col.regions</span></span><span id="textcolor1890"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1891"><span 
class="aett-10x-x-109">topo.colors</span></span><span id="textcolor1892"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1893"><span 
class="aett-10x-x-109">99</span></span><span id="textcolor1894"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1895"><span 
class="aett-10x-x-109">main</span></span><span id="textcolor1896"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1897"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">latent</span><span 
class="aett-10x-x-109">&#x00A0;field</span><span 
class="aett-10x-x-109">&#x00A0;mean</span><span 
class="tctt-1095">'</span></span><span id="textcolor1898"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1899"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor1900"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1901"><span 
class="tctt-1095">''</span></span><span id="textcolor1902"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1903"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor1904"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1905"><span 
class="tctt-1095">''</span></span><span id="textcolor1906"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1907"><span 
class="aett-10x-x-109">scales</span></span><span id="textcolor1908"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1909"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1910"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1911"><span 
class="aett-10x-x-109">draw</span></span><span id="textcolor1912"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1913"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor1914"><span 
class="aett-10x-x-109">)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1915"><span 
class="aett-10x-x-109">levelplot</span></span><span id="textcolor1916"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1917"><span 
class="aett-10x-x-109">matrix</span></span><span id="textcolor1918"><span 
class="aett-10x-x-109">(res5g</span></span><span id="textcolor1919"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1920"><span 
class="aett-10x-x-109">summary.fitt[igr,</span></span><span id="textcolor1921"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor1922"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1923"><span 
class="aett-10x-x-109">101</span></span><span id="textcolor1924"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1925"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor1926"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1927"><span 
class="tctt-1095">''</span></span><span id="textcolor1928"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1929"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor1930"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1931"><span 
class="tctt-1095">''</span></span><span id="textcolor1932"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1933"><span 
class="aett-10x-x-109">main</span></span><span id="textcolor1934"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1935"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">response</span><span 
class="aett-10x-x-109">&#x00A0;mean</span><span 
class="tctt-1095">'</span></span><span id="textcolor1936"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1937"><span 
class="aett-10x-x-109">col.regions</span></span><span id="textcolor1938"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1939"><span 
class="aett-10x-x-109">topo.colors</span></span><span id="textcolor1940"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1941"><span 
class="aett-10x-x-109">99</span></span><span id="textcolor1942"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1943"><span 
class="aett-10x-x-109">scales</span></span><span id="textcolor1944"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1945"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1946"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1947"><span 
class="aett-10x-x-109">draw</span></span><span id="textcolor1948"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1949"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor1950"><span 
class="aett-10x-x-109">)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1951"><span 
class="aett-10x-x-109">levelplot</span></span><span id="textcolor1952"><span 
class="aett-10x-x-109">(prd0.s,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1953"><span 
class="aett-10x-x-109">col.regions</span></span><span id="textcolor1954"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1955"><span 
class="aett-10x-x-109">topo.colors</span></span><span id="textcolor1956"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1957"><span 
class="aett-10x-x-109">99</span></span><span id="textcolor1958"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1959"><span 
class="aett-10x-x-109">main</span></span><span id="textcolor1960"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1961"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">latent</span><span 
class="aett-10x-x-109">&#x00A0;field</span><span 
class="aett-10x-x-109">&#x00A0;SD</span><span 
class="tctt-1095">'</span></span><span id="textcolor1962"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1963"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor1964"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1965"><span 
class="tctt-1095">''</span></span><span id="textcolor1966"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1967"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor1968"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1969"><span 
class="tctt-1095">''</span></span><span id="textcolor1970"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1971"><span 
class="aett-10x-x-109">scales</span></span><span id="textcolor1972"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1973"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor1974"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1975"><span 
class="aett-10x-x-109">draw</span></span><span id="textcolor1976"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1977"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor1978"><span 
class="aett-10x-x-109">)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1979"><span 
class="aett-10x-x-109">levelplot</span></span><span id="textcolor1980"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor1981"><span 
class="aett-10x-x-109">matrix</span></span><span id="textcolor1982"><span 
class="aett-10x-x-109">(res5g</span></span><span id="textcolor1983"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor1984"><span 
class="aett-10x-x-109">summary.fitt[igr,</span></span><span id="textcolor1985"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor1986"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1987"><span 
class="aett-10x-x-109">101</span></span><span id="textcolor1988"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1989"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor1990"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1991"><span 
class="tctt-1095">''</span></span><span id="textcolor1992"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1993"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor1994"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1995"><span 
class="tctt-1095">''</span></span><span id="textcolor1996"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor1997"><span 
class="aett-10x-x-109">main</span></span><span id="textcolor1998"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor1999"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">response</span><span 
class="aett-10x-x-109">&#x00A0;SD</span><span 
class="tctt-1095">'</span></span><span id="textcolor2000"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2001"><span 
class="aett-10x-x-109">col.regions</span></span><span id="textcolor2002"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2003"><span 
class="aett-10x-x-109">topo.colors</span></span><span id="textcolor2004"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2005"><span 
class="aett-10x-x-109">99</span></span><span id="textcolor2006"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2007"><span 
class="aett-10x-x-109">scales</span></span><span id="textcolor2008"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2009"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor2010"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2011"><span 
class="aett-10x-x-109">draw</span></span><span id="textcolor2012"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2013"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor2014"><span 
class="aett-10x-x-109">)),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2015"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor2016"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2017"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2018"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x5-250014"></a>
                                                                                 
                                                                                 
<!--l. 926--><p class="noindent" ><img 
src="spde-tutorial24x.png" alt="PIC" class="graphics" width="413" height="386"  /><!--tex4ht:graphics  
name="spde-tutorial24x.png" src="figs/toyunnamed-chunk-1-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;1.4: </span><span  
class="content">The mean and standard deviation of the random field (top left and bottom
left) and the mean and standard variation of the response (top right and bottom right)</span></div><!--tex4ht:label?: x5-250014 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 935--><p class="indent" >   We see on Figure&#x00A0;<a 
href="#x5-250001.2.6">1.2.6<!--tex4ht:ref: fig:pgrid --></a> that we have a variation from -4 to 4 on the spatial effect.
Considering also that we have standard deviations around 0.8 to 1.6, the spatial dependence is
significantly.
</p><!--l. 941--><p class="indent" >   Another thing is that the standard deviation of both, random field and the response, are less
near the corner (0, 0) and greater near the corner (1,1). This is just proportional to the locations
density.
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.2.7   </span> <a 
 id="x5-260001.2.7"></a>Results from different meshes</h4>
<!--l. 949--><p class="noindent" >In this subsection we compare six results for the toy dataset based on the six different meshs
builded on Section&#x00A0;<a 
href="#x5-270001.3">1.3<!--tex4ht:ref: sec:mesh --></a>. To do this comparison, we just plot the posterior marginal distributions
of the model parameters. We evaluate the meshes by the addiction of the true values used on the
simulation of the toy dataset. Also, we add the maximum likelihood estimates from <span 
class="aeb10-x-x-109">geoR</span>
package, <span class="cite">[<a 
href="spde-tutorialli2.html#XgeoR">Ribeiro Jr and Diggle, 2001</a>]</span>.
</p><!--l. 961--><p class="indent" >   We fit the model, using each one of the six meshes, and put the results in a list with the code
bellow  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor2019"><span 
class="aett-10x-x-109">lrf</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2020"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2021"><span 
class="aett-10x-x-109">lres</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2022"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2023"><span 
class="aett-10x-x-109">l.dat</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2024"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2025"><span 
class="aett-10x-x-109">l.spde</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2026"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2027"><span 
class="aett-10x-x-109">l.a</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2028"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2029"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor2030"><span 
class="aett-10x-x-109">()</span></span>
<br /><span id="textcolor2031"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2032"><span 
class="aett-10x-x-109">(k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2033"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2034"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2035"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor2036"><span 
class="aett-10x-x-109">6</span></span><span id="textcolor2037"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2038"><span 
class="aett-10x-x-109">l.a[[k]]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2039"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2040"><span 
class="aett-10x-x-109">inla.spde.make.A</span></span><span id="textcolor2041"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2042"><span 
class="aett-10x-x-109">get</span></span><span id="textcolor2043"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2044"><span 
class="aett-10x-x-109">paste</span></span><span id="textcolor2045"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2046"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">mesh</span><span 
class="tctt-1095">'</span></span><span id="textcolor2047"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;k,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2048"><span 
class="aett-10x-x-109">sep</span></span><span id="textcolor2049"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2050"><span 
class="tctt-1095">''</span></span><span id="textcolor2051"><span 
class="aett-10x-x-109">)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2052"><span 
class="aett-10x-x-109">loc</span></span><span id="textcolor2053"><span 
class="aett-10x-x-109">=coords)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2054"><span 
class="aett-10x-x-109">l.spde[[k]]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2055"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2056"><span 
class="aett-10x-x-109">inla.spde2.matern</span></span><span id="textcolor2057"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2058"><span 
class="aett-10x-x-109">get</span></span><span id="textcolor2059"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2060"><span 
class="aett-10x-x-109">paste</span></span><span id="textcolor2061"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2062"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">mesh</span><span 
class="tctt-1095">'</span></span><span id="textcolor2063"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;k,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2064"><span 
class="aett-10x-x-109">sep</span></span><span id="textcolor2065"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2066"><span 
class="tctt-1095">''</span></span><span id="textcolor2067"><span 
class="aett-10x-x-109">)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2068"><span 
class="aett-10x-x-109">alpha</span></span><span id="textcolor2069"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2070"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2071"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2072"><span 
class="aett-10x-x-109">l.dat[[k]]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2073"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2074"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor2075"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2076"><span 
class="aett-10x-x-109">y</span></span><span id="textcolor2077"><span 
class="aett-10x-x-109">=SPDEtoy[,</span></span><span id="textcolor2078"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2079"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2080"><span 
class="aett-10x-x-109">i</span></span><span id="textcolor2081"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2082"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2083"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor2084"><span 
class="aett-10x-x-109">ncol</span></span><span id="textcolor2085"><span 
class="aett-10x-x-109">(l.a[[k]]),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2086"><span 
class="aett-10x-x-109">m</span></span><span id="textcolor2087"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2088"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor2089"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2090"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2091"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2092"><span 
class="aett-10x-x-109">ncol</span></span><span id="textcolor2093"><span 
class="aett-10x-x-109">(l.a[[k]])))</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2094"><span 
class="aett-10x-x-109">lres[[k]]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2095"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2096"><span 
class="aett-10x-x-109">inla</span></span><span id="textcolor2097"><span 
class="aett-10x-x-109">(y</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2098"><span 
class="aett-10x-x-109">~</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2099"><span 
class="aett-10x-x-109">0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2100"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2101"><span 
class="aett-10x-x-109">m</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2102"><span 
class="aett-10x-x-109">+</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2103"><span 
class="aett-10x-x-109">f</span></span><span id="textcolor2104"><span 
class="aett-10x-x-109">(i,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2105"><span 
class="aett-10x-x-109">model</span></span><span id="textcolor2106"><span 
class="aett-10x-x-109">=l.spde[[k]]),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2107"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor2108"><span 
class="aett-10x-x-109">=l.dat[[k]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2109"><span 
class="aett-10x-x-109">control.predictor</span></span><span id="textcolor2110"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2111"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor2112"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2113"><span 
class="aett-10x-x-109">A</span></span><span id="textcolor2114"><span 
class="aett-10x-x-109">=l.a[[k]]))</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2115"><span 
class="aett-10x-x-109">lrf[[k]]</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2116"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2117"><span 
class="aett-10x-x-109">inla.spde2.result</span></span><span id="textcolor2118"><span 
class="aett-10x-x-109">(lres[[k]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2119"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">i</span><span 
class="tctt-1095">'</span></span><span id="textcolor2120"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;l.spde[[k]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2121"><span 
class="aett-10x-x-109">do.transf</span></span><span id="textcolor2122"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2123"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor2124"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor2125"><span 
class="aett-10x-x-109">}</span></span>
</div>
</div>
   </div>
<!--l. 980--><p class="indent" >   The mesh size influences the computational time needed to fit the model. More nodes on the
mesh need more computational time. The time running inla for these six meshes are
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor2126"><span 
class="aett-10x-x-109">round</span></span><span id="textcolor2127"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2128"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor2129"><span 
class="aett-10x-x-109">(lres,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2130"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor2131"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2132"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor2133"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;x</span></span><span id="textcolor2134"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2135"><span 
class="aett-10x-x-109">cpu[</span></span><span id="textcolor2136"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2137"><span 
class="aett-10x-x-109">]),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2138"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2139"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-40">
##&#x00A0;Running&#x00A0;Running&#x00A0;Running&#x00A0;Running&#x00A0;Running&#x00A0;Running
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;8.39&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.17&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.64&#x00A0;&#x00A0;&#x00A0;&#x00A0;8.91&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.94&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.74
</div>
<!--l. 992--><p class="nopar" >
</p>
   </div>
<!--l. 996--><p class="indent" >   We compute the distribution for <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmr-8">2</span></sup> for each fitted model  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor2140"><span 
class="aett-10x-x-109">s2.marg</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2141"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2142"><span 
class="aett-10x-x-109">lapply</span></span><span id="textcolor2143"><span 
class="aett-10x-x-109">(lres,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2144"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor2145"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2146"><span 
class="aett-10x-x-109">m</span></span><span id="textcolor2147"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2148"><span 
class="aett-10x-x-109">inla.tmarginal</span></span><span id="textcolor2149"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2150"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor2151"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2152"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor2153"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2154"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2155"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor2156"><span 
class="aett-10x-x-109">x,</span><span 
class="aett-10x-x-109">&#x00A0;m</span></span><span id="textcolor2157"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2158"><span 
class="aett-10x-x-109">marginals.hy[[</span></span><span id="textcolor2159"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2160"><span 
class="aett-10x-x-109">]]))</span></span>
</div>
</div>
   </div>
<!--l. 1007--><p class="indent" >   The true values are: <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub> <span 
class="cmr-10x-x-109">= 10</span>, <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmr-8">2</span></sup> <span 
class="cmr-10x-x-109">= 0</span><span 
class="cmmi-10x-x-109">.</span><span 
class="cmr-10x-x-109">3</span>, <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">x</span></sub><sup><span 
class="cmr-8">2</span></sup> <span 
class="cmr-10x-x-109">= 5</span>, <span 
class="cmmi-10x-x-109">&#x03BA; </span><span 
class="cmr-10x-x-109">= 7 </span>and <span 
class="cmmi-10x-x-109">&#x03BD; </span><span 
class="cmr-10x-x-109">= 1</span>. The <span 
class="cmmi-10x-x-109">&#x03BD; </span>parameter
is fixed on the true value when we define <span 
class="cmmi-10x-x-109">&#x03B1; </span><span 
class="cmr-10x-x-109">= 2 </span>on definition of the SPDE model.
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor2161"><span 
class="aett-10x-x-109">beta0</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2162"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2163"><span 
class="aett-10x-x-109">10</span></span><span id="textcolor2164"><span 
class="aett-10x-x-109">;</span><span 
class="aett-10x-x-109">&#x00A0;sigma2e</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2165"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2166"><span 
class="aett-10x-x-109">0.3</span></span><span id="textcolor2167"><span 
class="aett-10x-x-109">;</span><span 
class="aett-10x-x-109">&#x00A0;sigma2u</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2168"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2169"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor2170"><span 
class="aett-10x-x-109">;</span><span 
class="aett-10x-x-109">&#x00A0;kappa</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2171"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2172"><span 
class="aett-10x-x-109">7</span></span><span id="textcolor2173"><span 
class="aett-10x-x-109">;</span><span 
class="aett-10x-x-109">&#x00A0;nu</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2174"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2175"><span 
class="aett-10x-x-109">1</span></span>
</div>
</div>
   </div>
and the maximum likelihood one can have using the <span 
class="aessbx-10x-x-109">geoR </span>package, <span class="cite">[<a 
href="spde-tutorialli2.html#XgeoR">Ribeiro Jr and Diggle,
2001</a>]</span>, are  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor2176"><span 
class="aett-10x-x-109">lk.est</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2177"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2178"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor2179"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2180"><span 
class="aett-10x-x-109">beta</span></span><span id="textcolor2181"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2182"><span 
class="aett-10x-x-109">9.54</span></span><span id="textcolor2183"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2184"><span 
class="aett-10x-x-109">s2e</span></span><span id="textcolor2185"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2186"><span 
class="aett-10x-x-109">0.374</span></span><span id="textcolor2187"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2188"><span 
class="aett-10x-x-109">s2u</span></span><span id="textcolor2189"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2190"><span 
class="aett-10x-x-109">3.32</span></span><span id="textcolor2191"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2192"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2193"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2194"><span 
class="aett-10x-x-109">0.336</span></span><span id="textcolor2195"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<!--l. 1028--><p class="indent" >   We want to visualize the posterior marginal distributions for <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub>, <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmr-8">2</span></sup>, <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">x</span></sub><sup><span 
class="cmr-8">2</span></sup>, <span 
class="cmmi-10x-x-109">&#x03BA;</span>, nominal range
and the local variance <span 
class="cmmi-10x-x-109">&#x03C4;</span>. This can be done with the code bellow  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
                                                                                 
                                                                                 
<div class="obeylines-v">
<span id="textcolor2196"><span 
class="aett-10x-x-109">rcols</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2197"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2198"><span 
class="aett-10x-x-109">rainbow</span></span><span id="textcolor2199"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2200"><span 
class="aett-10x-x-109">6</span></span><span id="textcolor2201"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor2202"><span 
class="aeitt-10x-x-109">##c(rgb(4:1/4,0:3/5,0),</span><span 
class="aeitt-10x-x-109">&#x00A0;c(rgb(0,0:3/5,4:1/4)))</span></span>
<br /><span id="textcolor2203"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor2204"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2205"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor2206"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2207"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor2208"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2209"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2210"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor2211"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2212"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2213"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor2214"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2215"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor2216"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2217"><span 
class="aett-10x-x-109">2.5</span></span><span id="textcolor2218"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor2219"><span 
class="aett-10x-x-109">2.5</span></span><span id="textcolor2220"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor2221"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2222"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor2223"><span 
class="aett-10x-x-109">.5</span></span><span id="textcolor2224"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2225"><span 
class="aett-10x-x-109">mgp</span></span><span id="textcolor2226"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2227"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor2228"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2229"><span 
class="aett-10x-x-109">1.5</span></span><span id="textcolor2230"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor2231"><span 
class="aett-10x-x-109">.5</span></span><span id="textcolor2232"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor2233"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor2234"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2235"><span 
class="aett-10x-x-109">las</span></span><span id="textcolor2236"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2237"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2238"><span 
class="aett-10x-x-109">)</span></span>
<br />
<br /><span id="textcolor2239"><span 
class="aett-10x-x-109">xrange</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2240"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2241"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2242"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2243"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor2244"><span 
class="aett-10x-x-109">(lres,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2245"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor2246"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2247"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor2248"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2249"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2250"><span 
class="aett-10x-x-109">(x</span></span><span id="textcolor2251"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2252"><span 
class="aett-10x-x-109">marginals.fix[[</span></span><span id="textcolor2253"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2254"><span 
class="aett-10x-x-109">]][,</span></span><span id="textcolor2255"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2256"><span 
class="aett-10x-x-109">])))</span></span>
<br /><span id="textcolor2257"><span 
class="aett-10x-x-109">yrange</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2258"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2259"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2260"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2261"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor2262"><span 
class="aett-10x-x-109">(lres,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2263"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor2264"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2265"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor2266"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2267"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2268"><span 
class="aett-10x-x-109">(x</span></span><span id="textcolor2269"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2270"><span 
class="aett-10x-x-109">marginals.fix[[</span></span><span id="textcolor2271"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2272"><span 
class="aett-10x-x-109">]][,</span></span><span id="textcolor2273"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2274"><span 
class="aett-10x-x-109">])))</span></span>
<br /><span id="textcolor2275"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor2276"><span 
class="aett-10x-x-109">(lres[[</span></span><span id="textcolor2277"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2278"><span 
class="aett-10x-x-109">]]</span></span><span id="textcolor2279"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2280"><span 
class="aett-10x-x-109">marginals.fix[[</span></span><span id="textcolor2281"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2282"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2283"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor2284"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2285"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor2286"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2287"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor2288"><span 
class="aett-10x-x-109">=xrange,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2289"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor2290"><span 
class="aett-10x-x-109">=yrange,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2291"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor2292"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2293"><span 
class="aett-10x-x-109">expression</span></span><span id="textcolor2294"><span 
class="aett-10x-x-109">(beta[</span></span><span id="textcolor2295"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor2296"><span 
class="aett-10x-x-109">]),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2297"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor2298"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2299"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Density</span><span 
class="tctt-1095">'</span></span><span id="textcolor2300"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor2301"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2302"><span 
class="aett-10x-x-109">(k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2303"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2304"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2305"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor2306"><span 
class="aett-10x-x-109">6</span></span><span id="textcolor2307"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2308"><span 
class="aett-10x-x-109">lines</span></span><span id="textcolor2309"><span 
class="aett-10x-x-109">(lres[[k]]</span></span><span id="textcolor2310"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2311"><span 
class="aett-10x-x-109">marginals.fix[[</span></span><span id="textcolor2312"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2313"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2314"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor2315"><span 
class="aett-10x-x-109">=rcols[k],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2316"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor2317"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2318"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2319"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor2320"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor2321"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2322"><span 
class="aett-10x-x-109">v</span></span><span id="textcolor2323"><span 
class="aett-10x-x-109">=beta0,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2324"><span 
class="aett-10x-x-109">lty</span></span><span id="textcolor2325"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2326"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2327"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2328"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor2329"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2330"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2331"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2332"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor2333"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2334"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2335"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor2336"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor2337"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2338"><span 
class="aett-10x-x-109">v</span></span><span id="textcolor2339"><span 
class="aett-10x-x-109">=lk.est[</span></span><span id="textcolor2340"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2341"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2342"><span 
class="aett-10x-x-109">lty</span></span><span id="textcolor2343"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2344"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2345"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2346"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor2347"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2348"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2349"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2350"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor2351"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2352"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2353"><span 
class="aett-10x-x-109">)</span></span>
<br />
<br /><span id="textcolor2354"><span 
class="aett-10x-x-109">xrange</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2355"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2356"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2357"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2358"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor2359"><span 
class="aett-10x-x-109">(s2.marg,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2360"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor2361"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2362"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor2363"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2364"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2365"><span 
class="aett-10x-x-109">(x[,</span></span><span id="textcolor2366"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2367"><span 
class="aett-10x-x-109">])))</span></span>
<br /><span id="textcolor2368"><span 
class="aett-10x-x-109">yrange</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2369"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2370"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2371"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2372"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor2373"><span 
class="aett-10x-x-109">(s2.marg,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2374"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor2375"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2376"><span 
class="aett-10x-x-109">x</span></span><span id="textcolor2377"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2378"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2379"><span 
class="aett-10x-x-109">(x[,</span></span><span id="textcolor2380"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2381"><span 
class="aett-10x-x-109">])))</span></span>
<br /><span id="textcolor2382"><span 
class="aett-10x-x-109">plot.default</span></span><span id="textcolor2383"><span 
class="aett-10x-x-109">(s2.marg[[</span></span><span id="textcolor2384"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2385"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2386"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor2387"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2388"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor2389"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2390"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor2391"><span 
class="aett-10x-x-109">=xrange,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2392"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor2393"><span 
class="aett-10x-x-109">=yrange,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2394"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor2395"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2396"><span 
class="aett-10x-x-109">expression</span></span><span id="textcolor2397"><span 
class="aett-10x-x-109">(sigma[e]</span></span><span id="textcolor2398"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor2399"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2400"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2401"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor2402"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2403"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Density</span><span 
class="tctt-1095">'</span></span><span id="textcolor2404"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor2405"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2406"><span 
class="aett-10x-x-109">(k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2407"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2408"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2409"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor2410"><span 
class="aett-10x-x-109">6</span></span><span id="textcolor2411"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2412"><span 
class="aett-10x-x-109">lines</span></span><span id="textcolor2413"><span 
class="aett-10x-x-109">(s2.marg[[k]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2414"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor2415"><span 
class="aett-10x-x-109">=rcols[k],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2416"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor2417"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2418"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2419"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor2420"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor2421"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2422"><span 
class="aett-10x-x-109">v</span></span><span id="textcolor2423"><span 
class="aett-10x-x-109">=sigma2e,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2424"><span 
class="aett-10x-x-109">lty</span></span><span id="textcolor2425"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2426"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2427"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2428"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor2429"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2430"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2431"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2432"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor2433"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2434"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2435"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor2436"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor2437"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2438"><span 
class="aett-10x-x-109">v</span></span><span id="textcolor2439"><span 
class="aett-10x-x-109">=lk.est[</span></span><span id="textcolor2440"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2441"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2442"><span 
class="aett-10x-x-109">lty</span></span><span id="textcolor2443"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2444"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2445"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2446"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor2447"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2448"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2449"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2450"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor2451"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2452"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2453"><span 
class="aett-10x-x-109">)</span></span>
<br />
<br /><span id="textcolor2454"><span 
class="aett-10x-x-109">xrange</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2455"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2456"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2457"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2458"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor2459"><span 
class="aett-10x-x-109">(lrf,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2460"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor2461"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2462"><span 
class="aett-10x-x-109">r</span></span><span id="textcolor2463"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2464"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2465"><span 
class="aett-10x-x-109">(r</span></span><span id="textcolor2466"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2467"><span 
class="aett-10x-x-109">marginals.variance.nominal[[</span></span><span id="textcolor2468"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2469"><span 
class="aett-10x-x-109">]][,</span></span><span id="textcolor2470"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2471"><span 
class="aett-10x-x-109">])))</span></span>
<br /><span id="textcolor2472"><span 
class="aett-10x-x-109">yrange</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2473"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2474"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2475"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2476"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor2477"><span 
class="aett-10x-x-109">(lrf,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2478"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor2479"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2480"><span 
class="aett-10x-x-109">r</span></span><span id="textcolor2481"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2482"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2483"><span 
class="aett-10x-x-109">(r</span></span><span id="textcolor2484"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2485"><span 
class="aett-10x-x-109">marginals.variance.nominal[[</span></span><span id="textcolor2486"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2487"><span 
class="aett-10x-x-109">]][,</span></span><span id="textcolor2488"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2489"><span 
class="aett-10x-x-109">])))</span></span>
<br /><span id="textcolor2490"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor2491"><span 
class="aett-10x-x-109">(lrf[[</span></span><span id="textcolor2492"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2493"><span 
class="aett-10x-x-109">]]</span></span><span id="textcolor2494"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2495"><span 
class="aett-10x-x-109">marginals.variance.nominal[[</span></span><span id="textcolor2496"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2497"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2498"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor2499"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2500"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor2501"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2502"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor2503"><span 
class="aett-10x-x-109">=xrange,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2504"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor2505"><span 
class="aett-10x-x-109">=yrange,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2506"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor2507"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2508"><span 
class="aett-10x-x-109">expression</span></span><span id="textcolor2509"><span 
class="aett-10x-x-109">(sigma[x]</span></span><span id="textcolor2510"><span 
class="aett-10x-x-109">^</span></span><span id="textcolor2511"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2512"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2513"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor2514"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2515"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Density</span><span 
class="tctt-1095">'</span></span><span id="textcolor2516"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor2517"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2518"><span 
class="aett-10x-x-109">(k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2519"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2520"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2521"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor2522"><span 
class="aett-10x-x-109">6</span></span><span id="textcolor2523"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2524"><span 
class="aett-10x-x-109">lines</span></span><span id="textcolor2525"><span 
class="aett-10x-x-109">(lrf[[k]]</span></span><span id="textcolor2526"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2527"><span 
class="aett-10x-x-109">marginals.variance.nominal[[</span></span><span id="textcolor2528"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2529"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2530"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor2531"><span 
class="aett-10x-x-109">=rcols[k],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2532"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor2533"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2534"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2535"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor2536"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor2537"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2538"><span 
class="aett-10x-x-109">v</span></span><span id="textcolor2539"><span 
class="aett-10x-x-109">=sigma2u,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2540"><span 
class="aett-10x-x-109">lty</span></span><span id="textcolor2541"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2542"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2543"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2544"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor2545"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2546"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2547"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2548"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor2549"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2550"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2551"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor2552"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor2553"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2554"><span 
class="aett-10x-x-109">v</span></span><span id="textcolor2555"><span 
class="aett-10x-x-109">=lk.est[</span></span><span id="textcolor2556"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2557"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2558"><span 
class="aett-10x-x-109">lty</span></span><span id="textcolor2559"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2560"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2561"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2562"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor2563"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2564"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2565"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2566"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor2567"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2568"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2569"><span 
class="aett-10x-x-109">)</span></span>
<br />
<br /><span id="textcolor2570"><span 
class="aett-10x-x-109">xrange</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2571"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2572"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2573"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2574"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor2575"><span 
class="aett-10x-x-109">(lrf,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2576"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor2577"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2578"><span 
class="aett-10x-x-109">r</span></span><span id="textcolor2579"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2580"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2581"><span 
class="aett-10x-x-109">(r</span></span><span id="textcolor2582"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2583"><span 
class="aett-10x-x-109">marginals.kappa[[</span></span><span id="textcolor2584"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2585"><span 
class="aett-10x-x-109">]][,</span></span><span id="textcolor2586"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2587"><span 
class="aett-10x-x-109">])))</span></span>
<br /><span id="textcolor2588"><span 
class="aett-10x-x-109">yrange</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2589"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2590"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2591"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2592"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor2593"><span 
class="aett-10x-x-109">(lrf,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2594"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor2595"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2596"><span 
class="aett-10x-x-109">r</span></span><span id="textcolor2597"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2598"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2599"><span 
class="aett-10x-x-109">(r</span></span><span id="textcolor2600"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2601"><span 
class="aett-10x-x-109">marginals.kappa[[</span></span><span id="textcolor2602"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2603"><span 
class="aett-10x-x-109">]][,</span></span><span id="textcolor2604"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2605"><span 
class="aett-10x-x-109">])))</span></span>
<br /><span id="textcolor2606"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor2607"><span 
class="aett-10x-x-109">(lrf[[</span></span><span id="textcolor2608"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2609"><span 
class="aett-10x-x-109">]]</span></span><span id="textcolor2610"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2611"><span 
class="aett-10x-x-109">marginals.kappa[[</span></span><span id="textcolor2612"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2613"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2614"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor2615"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2616"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor2617"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2618"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor2619"><span 
class="aett-10x-x-109">=xrange,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2620"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor2621"><span 
class="aett-10x-x-109">=yrange,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2622"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor2623"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2624"><span 
class="aett-10x-x-109">expression</span></span><span id="textcolor2625"><span 
class="aett-10x-x-109">(kappa),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2626"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor2627"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2628"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Density</span><span 
class="tctt-1095">'</span></span><span id="textcolor2629"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor2630"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2631"><span 
class="aett-10x-x-109">(k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2632"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2633"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2634"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor2635"><span 
class="aett-10x-x-109">6</span></span><span id="textcolor2636"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2637"><span 
class="aett-10x-x-109">lines</span></span><span id="textcolor2638"><span 
class="aett-10x-x-109">(lrf[[k]]</span></span><span id="textcolor2639"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2640"><span 
class="aett-10x-x-109">marginals.kappa[[</span></span><span id="textcolor2641"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2642"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2643"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor2644"><span 
class="aett-10x-x-109">=rcols[k],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2645"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor2646"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2647"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2648"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor2649"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor2650"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2651"><span 
class="aett-10x-x-109">v</span></span><span id="textcolor2652"><span 
class="aett-10x-x-109">=kappa,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2653"><span 
class="aett-10x-x-109">lty</span></span><span id="textcolor2654"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2655"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2656"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2657"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor2658"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2659"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2660"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2661"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor2662"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2663"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2664"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor2665"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor2666"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2667"><span 
class="aett-10x-x-109">v</span></span><span id="textcolor2668"><span 
class="aett-10x-x-109">=lk.est[</span></span><span id="textcolor2669"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor2670"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2671"><span 
class="aett-10x-x-109">lty</span></span><span id="textcolor2672"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2673"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2674"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2675"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor2676"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2677"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2678"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2679"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor2680"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2681"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2682"><span 
class="aett-10x-x-109">)</span></span>
<br />
<br /><span id="textcolor2683"><span 
class="aett-10x-x-109">xrange</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2684"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2685"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2686"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2687"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor2688"><span 
class="aett-10x-x-109">(lrf,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2689"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor2690"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2691"><span 
class="aett-10x-x-109">r</span></span><span id="textcolor2692"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2693"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2694"><span 
class="aett-10x-x-109">(r</span></span><span id="textcolor2695"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2696"><span 
class="aett-10x-x-109">marginals.range.nominal[[</span></span><span id="textcolor2697"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2698"><span 
class="aett-10x-x-109">]][,</span></span><span id="textcolor2699"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2700"><span 
class="aett-10x-x-109">])))</span></span>
<br /><span id="textcolor2701"><span 
class="aett-10x-x-109">yrange</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2702"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2703"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2704"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2705"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor2706"><span 
class="aett-10x-x-109">(lrf,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2707"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor2708"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2709"><span 
class="aett-10x-x-109">r</span></span><span id="textcolor2710"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2711"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2712"><span 
class="aett-10x-x-109">(r</span></span><span id="textcolor2713"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2714"><span 
class="aett-10x-x-109">marginals.range.nominal[[</span></span><span id="textcolor2715"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2716"><span 
class="aett-10x-x-109">]][,</span></span><span id="textcolor2717"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2718"><span 
class="aett-10x-x-109">])))</span></span>
<br /><span id="textcolor2719"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor2720"><span 
class="aett-10x-x-109">(lrf[[</span></span><span id="textcolor2721"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2722"><span 
class="aett-10x-x-109">]]</span></span><span id="textcolor2723"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2724"><span 
class="aett-10x-x-109">marginals.range.nominal[[</span></span><span id="textcolor2725"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2726"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2727"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor2728"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2729"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor2730"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2731"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor2732"><span 
class="aett-10x-x-109">=xrange,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2733"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor2734"><span 
class="aett-10x-x-109">=yrange,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2735"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor2736"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2737"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">nominal</span><span 
class="aett-10x-x-109">&#x00A0;range</span><span 
class="tctt-1095">'</span></span><span id="textcolor2738"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2739"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor2740"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2741"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Density</span><span 
class="tctt-1095">'</span></span><span id="textcolor2742"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor2743"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2744"><span 
class="aett-10x-x-109">(k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2745"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2746"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2747"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor2748"><span 
class="aett-10x-x-109">6</span></span><span id="textcolor2749"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2750"><span 
class="aett-10x-x-109">lines</span></span><span id="textcolor2751"><span 
class="aett-10x-x-109">(lrf[[k]]</span></span><span id="textcolor2752"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2753"><span 
class="aett-10x-x-109">marginals.range.nominal[[</span></span><span id="textcolor2754"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2755"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2756"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor2757"><span 
class="aett-10x-x-109">=rcols[k],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2758"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor2759"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2760"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2761"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor2762"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor2763"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2764"><span 
class="aett-10x-x-109">v</span></span><span id="textcolor2765"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2766"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor2767"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2768"><span 
class="aett-10x-x-109">8</span></span><span id="textcolor2769"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor2770"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor2771"><span 
class="aett-10x-x-109">kappa,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2772"><span 
class="aett-10x-x-109">lty</span></span><span id="textcolor2773"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2774"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2775"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2776"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor2777"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2778"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2779"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2780"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor2781"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2782"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2783"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor2784"><span 
class="aett-10x-x-109">abline</span></span><span id="textcolor2785"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2786"><span 
class="aett-10x-x-109">v</span></span><span id="textcolor2787"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2788"><span 
class="aett-10x-x-109">sqrt</span></span><span id="textcolor2789"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2790"><span 
class="aett-10x-x-109">8</span></span><span id="textcolor2791"><span 
class="aett-10x-x-109">)</span></span><span id="textcolor2792"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor2793"><span 
class="aett-10x-x-109">lk.est[</span></span><span id="textcolor2794"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor2795"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2796"><span 
class="aett-10x-x-109">lty</span></span><span id="textcolor2797"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2798"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2799"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2800"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor2801"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2802"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2803"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2804"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor2805"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2806"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2807"><span 
class="aett-10x-x-109">)</span></span>
<br />
<br /><span id="textcolor2808"><span 
class="aett-10x-x-109">xrange</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2809"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2810"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2811"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2812"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor2813"><span 
class="aett-10x-x-109">(lrf,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2814"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor2815"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2816"><span 
class="aett-10x-x-109">r</span></span><span id="textcolor2817"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2818"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2819"><span 
class="aett-10x-x-109">(r</span></span><span id="textcolor2820"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2821"><span 
class="aett-10x-x-109">marginals.tau[[</span></span><span id="textcolor2822"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2823"><span 
class="aett-10x-x-109">]][,</span></span><span id="textcolor2824"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2825"><span 
class="aett-10x-x-109">])))</span></span>
<br /><span id="textcolor2826"><span 
class="aett-10x-x-109">yrange</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2827"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2828"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2829"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2830"><span 
class="aett-10x-x-109">sapply</span></span><span id="textcolor2831"><span 
class="aett-10x-x-109">(lrf,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2832"><span 
class="aett-10x-x-109">function</span></span><span id="textcolor2833"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2834"><span 
class="aett-10x-x-109">r</span></span><span id="textcolor2835"><span 
class="aett-10x-x-109">)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2836"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor2837"><span 
class="aett-10x-x-109">(r</span></span><span id="textcolor2838"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2839"><span 
class="aett-10x-x-109">marginals.tau[[</span></span><span id="textcolor2840"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2841"><span 
class="aett-10x-x-109">]][,</span></span><span id="textcolor2842"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2843"><span 
class="aett-10x-x-109">])))</span></span>
                                                                                 
                                                                                 
<br /><span id="textcolor2844"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor2845"><span 
class="aett-10x-x-109">(lrf[[</span></span><span id="textcolor2846"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2847"><span 
class="aett-10x-x-109">]]</span></span><span id="textcolor2848"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2849"><span 
class="aett-10x-x-109">marginals.tau[[</span></span><span id="textcolor2850"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2851"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2852"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor2853"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2854"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor2855"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2856"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor2857"><span 
class="aett-10x-x-109">=xrange,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2858"><span 
class="aett-10x-x-109">ylim</span></span><span id="textcolor2859"><span 
class="aett-10x-x-109">=yrange,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2860"><span 
class="aett-10x-x-109">xlab</span></span><span id="textcolor2861"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2862"><span 
class="aett-10x-x-109">expression</span></span><span id="textcolor2863"><span 
class="aett-10x-x-109">(tau),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2864"><span 
class="aett-10x-x-109">ylab</span></span><span id="textcolor2865"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2866"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Density</span><span 
class="tctt-1095">'</span></span><span id="textcolor2867"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor2868"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2869"><span 
class="aett-10x-x-109">(k</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2870"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2871"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2872"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor2873"><span 
class="aett-10x-x-109">6</span></span><span id="textcolor2874"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2875"><span 
class="aett-10x-x-109">lines</span></span><span id="textcolor2876"><span 
class="aett-10x-x-109">(lrf[[k]]</span></span><span id="textcolor2877"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor2878"><span 
class="aett-10x-x-109">marginals.tau[[</span></span><span id="textcolor2879"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2880"><span 
class="aett-10x-x-109">]],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2881"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor2882"><span 
class="aett-10x-x-109">=rcols[k],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2883"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor2884"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2885"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2886"><span 
class="aett-10x-x-109">)</span></span>
<br />
<br /><span id="textcolor2887"><span 
class="aett-10x-x-109">legend</span></span><span id="textcolor2888"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2889"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">topright</span><span 
class="tctt-1095">'</span></span><span id="textcolor2890"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2891"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor2892"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2893"><span 
class="aett-10x-x-109">paste</span></span><span id="textcolor2894"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2895"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">mesh</span><span 
class="tctt-1095">'</span></span><span id="textcolor2896"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2897"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2898"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor2899"><span 
class="aett-10x-x-109">6</span></span><span id="textcolor2900"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2901"><span 
class="aett-10x-x-109">sep</span></span><span id="textcolor2902"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2903"><span 
class="tctt-1095">''</span></span><span id="textcolor2904"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2905"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">True</span><span 
class="tctt-1095">'</span></span><span id="textcolor2906"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2907"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">Likelihood</span><span 
class="tctt-1095">'</span></span><span id="textcolor2908"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2909"><span 
class="aett-10x-x-109">lty</span></span><span id="textcolor2910"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2911"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor2912"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2913"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor2914"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2915"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2916"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor2917"><span 
class="aett-10x-x-109">6</span></span><span id="textcolor2918"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2919"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2920"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2921"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2922"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2923"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor2924"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2925"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor2926"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2927"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2928"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2929"><span 
class="aett-10x-x-109">6</span></span><span id="textcolor2930"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2931"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor2932"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2933"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor2934"><span 
class="aett-10x-x-109">(rcols,</span></span><span id="textcolor2935"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2936"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor2937"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor2938"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2939"><span 
class="aett-10x-x-109">bty</span></span><span id="textcolor2940"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2941"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">n</span><span 
class="tctt-1095">'</span></span><span id="textcolor2942"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<!--l. 1097--><p class="indent" >   At the Figure&#x00A0;<a 
href="#x5-260001.2.7">1.2.7<!--tex4ht:ref: fig:margposttoy --></a> we can see that the posterior marginal distribution for the
intercept has mode on the likelihood estimate, considering the results from all six meshes.
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor2943"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2944"><span 
class="aett-10x-x-109">/</span></span><span id="textcolor2945"><span 
class="aett-10x-x-109">kappa</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-41">
##&#x00A0;[1]&#x00A0;0.1428571
</div>
<!--l. 1108--><p class="nopar" >
</p>
   </div>
<!--l. 1112--><p class="indent" >   The main differences are on the noise variance <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmr-8">2</span></sup> (the nugget effect). The result from the
mesh based on the points and with small triangles mode less than the likelihood estimate, the
second has mode near likelihood estimate and the third large. Considering the other meshes, the
mesh four has mode around likelihood estimate and the other two litle larger, similar to the
third mesh, such is based on points but with some freedom (<span 
class="aett-10x-x-109">cutoff </span>greather than
zero).
</p><!--l. 1125--><p class="indent" >   For the marginal variance of the latent field, <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">x</span></sub><sup><span 
class="cmr-8">2</span></sup>, the results with all meshes had mode near
the likelihood estimate. For the scale parameter <span 
class="cmmi-10x-x-109">&#x03BA; </span>all meshes has mode less than the likelihood
estimate. The posterior distribution from the meshes based on points are that ones with less
mode and that the mode from third mesh are the less. For the practical range the opposite
happens.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x5-260015"></a>
                                                                                 
                                                                                 
<!--l. 1138--><p class="noindent" ><img 
src="spde-tutorial25x.png" alt="PIC" class="graphics" width="426" height="284"  /><!--tex4ht:graphics  
name="spde-tutorial25x.png" src="figs/toyunnamed-chunk-2-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;1.5: </span><span  
class="content">Marginal posterior distribution for <span 
class="cmmi-10x-x-109">&#x03B2;</span><sub><span 
class="cmr-8">0</span></sub>  (top left), <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmr-8">2</span></sup>  (top mid), <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">x</span></sub><sup><span 
class="cmr-8">2</span></sup>  (top
right), <span 
class="cmmi-10x-x-109">&#x03BA; </span>(bottom left), nominal range (bottom mid) and <span 
class="cmmi-10x-x-109">&#x03C4; </span>(bottom right).</span></div><!--tex4ht:label?: x5-260015 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 1147--><p class="indent" >   These results are not conclusive, but a general comment is that is good to have a mesh with
some tune on the points locations, to access noise variance, but with some flexibility to avoid
many variability on the triangles size and shape, to get good latent field parameters
estimation.
</p>
   <h3 class="sectionHead"><span class="titlemark">1.3   </span> <a 
 id="x5-270001.3"></a>Triangulation details and examples</h3>
<!--l. 5--><p class="noindent" >This content is part of the book available at <a 
href="http://www.r-inla.org/spde-book" class="url" ><span 
class="aett-10x-x-109">http://www.r-inla.org/spde-book</span></a>, whose
Gitbook version is freely available along all the code and datasets.
</p><!--l. 10--><p class="indent" >   You can play with the shiny app typing   <span 
class="aett-10x-x-109">demo(mesh2d)</span>
</p><!--l. 17--><p class="indent" >   The first step to fit the model is the construction of the &#8217;mesh&#8217;. This step must
be done VERY CAREFULLY. It is similar to choosing the integration points on a
numeric integration algorithm. Should the boints be regular? How many points are
needed?
</p><!--l. 25--><p class="indent" >   Additionally, we need to add, ALSO CAREFULLY, additional points around the boundary,
the outer extension. This is necessary to avoid a boundary effect where we have a variance twice
as larger at the border than within the domain <span class="cite">[<a 
href="spde-tutorialli2.html#Xlindgren:2012">Lindgren, 2012</a>]</span>. For more about it please see
<span class="cite">[<a 
href="spde-tutorialli2.html#XlindgrenR:2015">Lindgren and Rue, 2015</a>]</span>.
</p><!--l. 34--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.3.1   </span> <a 
 id="x5-280001.3.1"></a>Getting started</h4>
<!--l. 36--><p class="noindent" >For a two dimentional mesh, we have a main function <span 
class="aett-10x-x-109">inla.mesh.2d() </span>that is recommended to
use for building a mesh. This function creates the Constrained Refined Delaunay Triangulation
(CRDT) that we just call mesh. There are a several options:  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor2946"><span 
class="aett-10x-x-109">args</span></span><span id="textcolor2947"><span 
class="aett-10x-x-109">(inla.mesh.2d)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-42">
##&#x00A0;function&#x00A0;(loc&#x00A0;=&#x00A0;NULL,&#x00A0;loc.domain&#x00A0;=&#x00A0;NULL,&#x00A0;offset&#x00A0;=&#x00A0;NULL,&#x00A0;n&#x00A0;=&#x00A0;NULL,
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;boundary&#x00A0;=&#x00A0;NULL,&#x00A0;interior&#x00A0;=&#x00A0;NULL,&#x00A0;max.edge&#x00A0;=&#x00A0;NULL,&#x00A0;min.angle&#x00A0;=&#x00A0;NULL,
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cutoff&#x00A0;=&#x00A0;1e-12,&#x00A0;max.n.strict&#x00A0;=&#x00A0;NULL,&#x00A0;max.n&#x00A0;=&#x00A0;NULL,&#x00A0;plot.delay&#x00A0;=&#x00A0;NULL,
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;crs&#x00A0;=&#x00A0;NULL)
&#x00A0;<br />##&#x00A0;NULL
</div>
<!--l. 53--><p class="nopar" >
</p>
   </div>
<!--l. 57--><p class="indent" >   We need some reference about the study region, which can be provided by the location
points or just a domain. The location, supplied on the <span 
class="aett-10x-x-109">loc </span>argument, are used as initial
triangulation nodes. A single polygon can be supplied to determine the domain extent on the
<span 
class="aett-10x-x-109">loc.domain </span>argument. If we supply the point locations, or the domain is supplied using the
<span 
class="aett-10x-x-109">loc.domain </span>argument, the algorithm find a convex hull mesh. A non convex hull mesh can be
made when we provide a (list of) set of polygons on the <span 
class="aett-10x-x-109">boundary </span>argument, where each
element of this list is of <span 
class="aett-10x-x-109">inla.mesh.segment() </span>class. So, one of these three options is
mandatory.
</p><!--l. 72--><p class="indent" >   The other mandatory argument is the <span 
class="aett-10x-x-109">max.edge</span>. This argument specifies the maximum
allowed triangle edge lengths in the inner domain and in the outer extension. So, it is a scalar or
length two vector. This argument is numeric on the <span 
class="aebx-10x-x-109">SAME SCALE UNIT </span>as the
coordinates.
</p><!--l. 80--><p class="indent" >   The another arguments are used to specify additional conditions. The <span 
class="aett-10x-x-109">offset </span>is a numeric,
or length two vector. If negative it is interpreted as a factor relative to the approximate data
diameter. If positive it is the extension distance on same scale unit to the coordinates
provided.
</p><!--l. 87--><p class="indent" >   The argument <span 
class="aett-10x-x-109">n </span>is the initial number of points on the extended boundary. The <span 
class="aett-10x-x-109">interior </span>is a
list of segments to specify interior constraints, each one of <span 
class="aett-10x-x-109">inla.mesh.segment </span>class. A good
mesh needs to have triangles as regular as possible in size and shape. To help this requirement
in addition to <span 
class="aett-10x-x-109">max.edge</span>, we have the <span 
class="aett-10x-x-109">min.angle </span>argument, which can be scalar or
length two vector, to specify the minimum internal angles of the triangles on the inner
domain and on the outer extension. Values up to 21 guarantee the convergence of the
algorithm.
</p><!--l. 104--><p class="indent" >   To further control the shape of the triangles, we also have the <span 
class="aett-10x-x-109">cutoff </span>argument, which is the
minimum allowed distance between points. It means that points at a closer distance than the
supplied value are replaced by a single vertex. So, it avoids small triangles and must be a
positive number, and is critical when we have some very close points, either for point locations
or on the domain boundary.
</p><!--l. 115--><p class="indent" >   To understand how this function works, we apply it while varying some arguments to the
first five locations of the toy dataset.  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor2948"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor2949"><span 
class="aett-10x-x-109">(SPDEtoy)</span></span>
<br /><span id="textcolor2950"><span 
class="aett-10x-x-109">coords</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2951"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2952"><span 
class="aett-10x-x-109">as.matrix</span></span><span id="textcolor2953"><span 
class="aett-10x-x-109">(SPDEtoy[,</span></span><span id="textcolor2954"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2955"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor2956"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor2957"><span 
class="aett-10x-x-109">])</span><span 
class="aett-10x-x-109">&#x00A0;;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;p5</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2958"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2959"><span 
class="aett-10x-x-109">coords[</span></span><span id="textcolor2960"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2961"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor2962"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor2963"><span 
class="aett-10x-x-109">,]</span></span>
</div>
</div>
                                                                                 
                                                                                 
   </div>
We also build some meshes using the domain and not the points and we define the domain with
<div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor2964"><span 
class="aett-10x-x-109">pl.dom</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2965"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2966"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor2967"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2968"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor2969"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2970"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor2971"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor2972"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2973"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor2974"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2975"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor2976"><span 
class="aett-10x-x-109">0.7</span></span><span id="textcolor2977"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor2978"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor2979"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2980"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor2981"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor2982"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor2983"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor2984"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor2985"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor2986"><span 
class="aett-10x-x-109">0.7</span></span><span id="textcolor2987"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor2988"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2989"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor2990"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor2991"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
<!--l. 136--><p class="indent" >   Creating some meshes for the first five points:  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor2992"><span 
class="aett-10x-x-109">m1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2993"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2994"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor2995"><span 
class="aett-10x-x-109">(p5,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor2996"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor2997"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor2998"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor2999"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3000"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor3001"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3002"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor3003"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor3004"><span 
class="aett-10x-x-109">m2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3005"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3006"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3007"><span 
class="aett-10x-x-109">(p5,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3008"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor3009"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3010"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3011"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3012"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor3013"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3014"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor3015"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3016"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor3017"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3018"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor3019"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor3020"><span 
class="aett-10x-x-109">m3</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3021"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3022"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3023"><span 
class="aett-10x-x-109">(p5,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3024"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor3025"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3026"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3027"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3028"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor3029"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3030"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor3031"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3032"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor3033"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3034"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor3035"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor3036"><span 
class="aett-10x-x-109">m4</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3037"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3038"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3039"><span 
class="aett-10x-x-109">(p5,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3040"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor3041"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3042"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3043"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3044"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor3045"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3046"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor3047"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3048"><span 
class="aett-10x-x-109">offset</span></span><span id="textcolor3049"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3050"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3051"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3052"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3053"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3054"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor3055"><span 
class="aett-10x-x-109">0.65</span></span><span id="textcolor3056"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor3057"><span 
class="aett-10x-x-109">m5</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3058"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3059"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3060"><span 
class="aett-10x-x-109">(,</span><span 
class="aett-10x-x-109">&#x00A0;pl.dom,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3061"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor3062"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3063"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3064"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3065"><span 
class="aett-10x-x-109">0.3</span></span><span id="textcolor3066"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3067"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor3068"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3069"><span 
class="aett-10x-x-109">offset</span></span><span id="textcolor3070"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3071"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3072"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3073"><span 
class="aett-10x-x-109">0.03</span></span><span id="textcolor3074"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3075"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor3076"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor3077"><span 
class="aett-10x-x-109">m6</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3078"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3079"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3080"><span 
class="aett-10x-x-109">(,</span><span 
class="aett-10x-x-109">&#x00A0;pl.dom,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3081"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor3082"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3083"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3084"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3085"><span 
class="aett-10x-x-109">0.3</span></span><span id="textcolor3086"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3087"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor3088"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3089"><span 
class="aett-10x-x-109">offset</span></span><span id="textcolor3090"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3091"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3092"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3093"><span 
class="aett-10x-x-109">0.03</span></span><span id="textcolor3094"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3095"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor3096"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3097"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor3098"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3099"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor3100"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor3101"><span 
class="aett-10x-x-109">m7</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3102"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3103"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3104"><span 
class="aett-10x-x-109">(,</span><span 
class="aett-10x-x-109">&#x00A0;pl.dom,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3105"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor3106"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3107"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3108"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3109"><span 
class="aett-10x-x-109">0.3</span></span><span id="textcolor3110"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3111"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor3112"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3113"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor3114"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3115"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor3116"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3117"><span 
class="aett-10x-x-109">offset</span></span><span id="textcolor3118"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3119"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3120"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3121"><span 
class="aett-10x-x-109">.05</span></span><span id="textcolor3122"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3123"><span 
class="aett-10x-x-109">.1</span></span><span id="textcolor3124"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor3125"><span 
class="aett-10x-x-109">m8</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3126"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3127"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3128"><span 
class="aett-10x-x-109">(,</span><span 
class="aett-10x-x-109">&#x00A0;pl.dom,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3129"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor3130"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3131"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3132"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3133"><span 
class="aett-10x-x-109">.3</span></span><span id="textcolor3134"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3135"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor3136"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3137"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor3138"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3139"><span 
class="aett-10x-x-109">7</span></span><span id="textcolor3140"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3141"><span 
class="aett-10x-x-109">offset</span></span><span id="textcolor3142"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3143"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3144"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3145"><span 
class="aett-10x-x-109">.01</span></span><span id="textcolor3146"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3147"><span 
class="aett-10x-x-109">.3</span></span><span id="textcolor3148"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor3149"><span 
class="aett-10x-x-109">m9</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3150"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3151"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3152"><span 
class="aett-10x-x-109">(,</span><span 
class="aett-10x-x-109">&#x00A0;pl.dom,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3153"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor3154"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3155"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3156"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3157"><span 
class="aett-10x-x-109">.3</span></span><span id="textcolor3158"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3159"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor3160"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3161"><span 
class="aett-10x-x-109">n</span></span><span id="textcolor3162"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3163"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor3164"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3165"><span 
class="aett-10x-x-109">offset</span></span><span id="textcolor3166"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3167"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3168"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3169"><span 
class="aett-10x-x-109">.05</span></span><span id="textcolor3170"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3171"><span 
class="aett-10x-x-109">.3</span></span><span id="textcolor3172"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
We visualize these meshes in Figure&#x00A0;<a 
href="#x5-280001.3.1">1.3.1<!--tex4ht:ref: fig:meshtest --></a>, produced with the code below  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3173"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor3174"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3175"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor3176"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3177"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3178"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3179"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor3180"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3181"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor3182"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3183"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor3184"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3185"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3186"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3187"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3188"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3189"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3190"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3191"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3192"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3193"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3194"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor3195"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3196"><span 
class="aett-10x-x-109">(i</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3197"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3198"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3199"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor3200"><span 
class="aett-10x-x-109">9</span></span><span id="textcolor3201"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3202"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor3203"><span 
class="aett-10x-x-109">(pl.dom,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3204"><span 
class="aett-10x-x-109">type</span></span><span id="textcolor3205"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3206"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">l</span><span 
class="tctt-1095">'</span></span><span id="textcolor3207"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3208"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor3209"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3210"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor3211"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3212"><span 
class="aett-10x-x-109">lwd</span></span><span id="textcolor3213"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3214"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor3215"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor3216"><span 
class="aett-10x-x-109">(i</span></span><span id="textcolor3217"><span 
class="aett-10x-x-109">&#x003E;</span></span><span id="textcolor3218"><span 
class="aett-10x-x-109">4</span></span><span id="textcolor3219"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3220"><span 
class="aett-10x-x-109">xlim</span></span><span id="textcolor3221"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3222"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3223"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3224"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor3225"><span 
class="aett-10x-x-109">0.57</span></span><span id="textcolor3226"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3227"><span 
class="aett-10x-x-109">1.57</span></span><span id="textcolor3228"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3229"><span 
class="aett-10x-x-109">main</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3230"><span 
class="aett-10x-x-109">=</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3231"><span 
class="aett-10x-x-109">paste</span></span><span id="textcolor3232"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3233"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">m</span><span 
class="tctt-1095">'</span></span><span id="textcolor3234"><span 
class="aett-10x-x-109">,i,</span></span><span id="textcolor3235"><span 
class="aett-10x-x-109">sep</span></span><span id="textcolor3236"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3237"><span 
class="tctt-1095">''</span></span><span id="textcolor3238"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3239"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor3240"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3241"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3242"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3243"><span 
class="aett-10x-x-109">axes</span></span><span id="textcolor3244"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3245"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor3246"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3247"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor3248"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3249"><span 
class="aett-10x-x-109">get</span></span><span id="textcolor3250"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3251"><span 
class="aett-10x-x-109">paste</span></span><span id="textcolor3252"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3253"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">m</span><span 
class="tctt-1095">'</span></span><span id="textcolor3254"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;i,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3255"><span 
class="aett-10x-x-109">sep</span></span><span id="textcolor3256"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3257"><span 
class="tctt-1095">''</span></span><span id="textcolor3258"><span 
class="aett-10x-x-109">)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3259"><span 
class="aett-10x-x-109">add</span></span><span id="textcolor3260"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3261"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor3262"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3263"><span 
class="aett-10x-x-109">points</span></span><span id="textcolor3264"><span 
class="aett-10x-x-109">(p5,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3265"><span 
class="aett-10x-x-109">pch</span></span><span id="textcolor3266"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3267"><span 
class="aett-10x-x-109">19</span></span><span id="textcolor3268"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3269"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor3270"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3271"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor3272"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor3273"><span 
class="aett-10x-x-109">}</span></span>
</div>
</div>
   </div>
<hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x5-280016"></a>
                                                                                 
                                                                                 
<!--l. 170--><p class="noindent" ><img 
src="spde-tutorial26x.png" alt="PIC" class="graphics" width="413" height="414"  /><!--tex4ht:graphics  
name="spde-tutorial26x.png" src="figs/meshvvizmesh-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;1.6: </span><span  
class="content">Triangulation with different restrictions.</span></div><!--tex4ht:label?: x5-280016 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 176--><p class="indent" >   The <span 
class="aett-10x-x-109">m1 </span>mesh has two main problems: 1) some triangles with small inner angles, 2) some large
triangles in the inner domain. In the <span 
class="aett-10x-x-109">m2 </span>mesh, we relax the restriction on the locations, because
points with distance less than the cutoff are considered a single vertex. This avoids some of
the triangles (at bottom right side) with small angles on the previous mesh. So the
<span 
class="aebx-10x-x-109">cutoff is a VERY GOOD idea</span>! Each inner triangle in the <span 
class="aett-10x-x-109">m3 </span>mesh on the top
right had edge length less than 0.1 and this mesh looks better than the two previous
ones.
</p><!--l. 189--><p class="indent" >   The <span 
class="aett-10x-x-109">m4 </span>was made without first building a convex hull extension around the points. It has just
the second outer bondary. In this case, the length of inner triangles does not work (first value on
<span 
class="aett-10x-x-109">max.edge </span>argument) and we have triangles with edge lengths up to 0.5. The shape of the
triangles looks good, except for these ones with vertices including the two points at the bottom
right side.
</p><!--l. 199--><p class="indent" >   The <span 
class="aett-10x-x-109">m5 </span>mesh was made just using the domain polygon and it has shape similar to the
domain area. In this mesh we have some small triangles at corners due the fact that is was built
without specifying a <span 
class="aett-10x-x-109">cutoff</span>. Also, we have a (relatively) small first extension and a (relatively)
large second one. On the <span 
class="aett-10x-x-109">m6 </span>mesh we have added the cutoff and got a better mesh than the
previous one.
</p><!--l. 208--><p class="indent" >   In the last tree meshes we change the initial number of extension points. It can be useful to
change in some situations to get convergence. Here we show the shape of the mesh that we got
with, for example, <span 
class="aett-10x-x-109">n=5</span>, in the <span 
class="aett-10x-x-109">m7 </span>mesh. This number produces a mesh that seems inadequate for
this domain because we have a non uniform exension behind the border. The <span 
class="aett-10x-x-109">m9 </span>mesh has very
bad triangles shapes.
</p><!--l. 221--><p class="indent" >   The object returned by the <span 
class="aett-10x-x-109">inla.mesh.2d() </span>function is of class <span 
class="aett-10x-x-109">inla.mesh </span>and contains a
list of things:  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3274"><span 
class="aett-10x-x-109">class</span></span><span id="textcolor3275"><span 
class="aett-10x-x-109">(m1)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-43">
##&#x00A0;[1]&#x00A0;"inla.mesh"
</div>
<!--l. 231--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor3276"><span 
class="aett-10x-x-109">names</span></span><span id="textcolor3277"><span 
class="aett-10x-x-109">(m1)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-44">
##&#x00A0;[1]&#x00A0;"meta"&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;"manifold"&#x00A0;"n"&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;"loc"&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;"graph"&#x00A0;&#x00A0;&#x00A0;&#x00A0;"segm"
&#x00A0;<br />##&#x00A0;[7]&#x00A0;"idx"&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;"crs"
</div>
<!--l. 238--><p class="nopar" >
</p>
   </div>
The number of vertices on each mesh is  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3278"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3279"><span 
class="aett-10x-x-109">(m1</span></span><span id="textcolor3280"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3281"><span 
class="aett-10x-x-109">n,</span><span 
class="aett-10x-x-109">&#x00A0;m2</span></span><span id="textcolor3282"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3283"><span 
class="aett-10x-x-109">n,</span><span 
class="aett-10x-x-109">&#x00A0;m3</span></span><span id="textcolor3284"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3285"><span 
class="aett-10x-x-109">n,</span><span 
class="aett-10x-x-109">&#x00A0;m4</span></span><span id="textcolor3286"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3287"><span 
class="aett-10x-x-109">n,</span><span 
class="aett-10x-x-109">&#x00A0;m5</span></span><span id="textcolor3288"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3289"><span 
class="aett-10x-x-109">n,</span><span 
class="aett-10x-x-109">&#x00A0;m6</span></span><span id="textcolor3290"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3291"><span 
class="aett-10x-x-109">n,</span><span 
class="aett-10x-x-109">&#x00A0;m7</span></span><span id="textcolor3292"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3293"><span 
class="aett-10x-x-109">n,</span><span 
class="aett-10x-x-109">&#x00A0;m8</span></span><span id="textcolor3294"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3295"><span 
class="aett-10x-x-109">n,</span><span 
class="aett-10x-x-109">&#x00A0;m9</span></span><span id="textcolor3296"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3297"><span 
class="aett-10x-x-109">n)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-45">
##&#x00A0;[1]&#x00A0;&#x00A0;61&#x00A0;&#x00A0;36&#x00A0;&#x00A0;79&#x00A0;195&#x00A0;117&#x00A0;&#x00A0;88&#x00A0;&#x00A0;87&#x00A0;&#x00A0;69&#x00A0;&#x00A0;72
</div>
<!--l. 249--><p class="nopar" >
</p>
   </div>
The &#8217;graph&#8217; element represents the CRDT obtained. In addition, the &#8217;graph&#8217; element contains
the matrix that represents the graph of the neighborhood structure. For example, for <span 
class="aett-10x-x-109">m1 </span>we have
&#8217;A&#8217;  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3298"><span 
class="aett-10x-x-109">dim</span></span><span id="textcolor3299"><span 
class="aett-10x-x-109">(m1</span></span><span id="textcolor3300"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3301"><span 
class="aett-10x-x-109">graph</span></span><span id="textcolor3302"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3303"><span 
class="aett-10x-x-109">vv)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-46">
##&#x00A0;[1]&#x00A0;61&#x00A0;61
</div>
<!--l. 263--><p class="nopar" >
</p>
   </div>
The vertices that correspond the location points are identified in the &#8217;idx&#8217; element
<div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3304"><span 
class="aett-10x-x-109">m1</span></span><span id="textcolor3305"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3306"><span 
class="aett-10x-x-109">idx</span></span><span id="textcolor3307"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3308"><span 
class="aett-10x-x-109">loc</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-47">
##&#x00A0;[1]&#x00A0;24&#x00A0;25&#x00A0;26&#x00A0;27&#x00A0;28
</div>
<!--l. 275--><p class="nopar" >
</p>
   </div>
   <h4 class="subsectionHead"><span class="titlemark">1.3.2   </span> <a 
 id="x5-290001.3.2"></a>Non-convex hull meshes</h4>
<!--l. 281--><p class="noindent" >All the meshes in Figure&#x00A0;<a 
href="#x5-280001.3.1">1.3.1<!--tex4ht:ref: fig:meshtest --></a> are made to have a convex hull boundary. A convex hull is a
polygon of triangles out of the domain area, the extension made to avoid the boundary effect. A
triangulation without an additional border can be made by supplying the <span 
class="aett-10x-x-109">boundary </span>argument
instead of the <span 
class="aett-10x-x-109">location </span>or <span 
class="aett-10x-x-109">loc.domain </span>argument. One way is to build a boundary for the points
and supply it on <span 
class="aett-10x-x-109">boundary </span>argument.
</p><!--l. 293--><p class="indent" >   We can also build boundaries using the <span 
class="aett-10x-x-109">inla.nonconvex.hull() </span>function  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3309"><span 
class="aett-10x-x-109">args</span></span><span id="textcolor3310"><span 
class="aett-10x-x-109">(inla.nonconvex.hull)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-48">
##&#x00A0;function&#x00A0;(points,&#x00A0;convex&#x00A0;=&#x00A0;-0.15,&#x00A0;concave&#x00A0;=&#x00A0;convex,&#x00A0;resolution&#x00A0;=&#x00A0;40,
&#x00A0;<br />##&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;eps&#x00A0;=&#x00A0;NULL,&#x00A0;crs&#x00A0;=&#x00A0;NULL)
&#x00A0;<br />##&#x00A0;NULL
</div>
<!--l. 304--><p class="nopar" >
</p>
   </div>
In this function we provide the points and set some constraint. We can control the shape of the
boundary including its convexity, concavity and resolution. Here, we make some boundaries and
build a mesh with each one to better understand it.  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3311"><span 
class="aett-10x-x-109">bound1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3312"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3313"><span 
class="aett-10x-x-109">inla.nonconvex.hull</span></span><span id="textcolor3314"><span 
class="aett-10x-x-109">(p5)</span></span>
<br /><span id="textcolor3315"><span 
class="aett-10x-x-109">bound2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3316"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3317"><span 
class="aett-10x-x-109">inla.nonconvex.hull</span></span><span id="textcolor3318"><span 
class="aett-10x-x-109">(p5,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3319"><span 
class="aett-10x-x-109">convex</span></span><span id="textcolor3320"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3321"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor3322"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3323"><span 
class="aett-10x-x-109">concave</span></span><span id="textcolor3324"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3325"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor3326"><span 
class="aett-10x-x-109">0.15</span></span><span id="textcolor3327"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor3328"><span 
class="aett-10x-x-109">bound3</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3329"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3330"><span 
class="aett-10x-x-109">inla.nonconvex.hull</span></span><span id="textcolor3331"><span 
class="aett-10x-x-109">(p5,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3332"><span 
class="aett-10x-x-109">concave</span></span><span id="textcolor3333"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3334"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor3335"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor3336"><span 
class="aett-10x-x-109">bound4</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3337"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3338"><span 
class="aett-10x-x-109">inla.nonconvex.hull</span></span><span id="textcolor3339"><span 
class="aett-10x-x-109">(p5,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3340"><span 
class="aett-10x-x-109">concave</span></span><span id="textcolor3341"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3342"><span 
class="aett-10x-x-109">0.5</span></span><span id="textcolor3343"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3344"><span 
class="aett-10x-x-109">resolution</span></span><span id="textcolor3345"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3346"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3347"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3348"><span 
class="aett-10x-x-109">20</span></span><span id="textcolor3349"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3350"><span 
class="aett-10x-x-109">20</span></span><span id="textcolor3351"><span 
class="aett-10x-x-109">))</span></span>
<br />
<br /><span id="textcolor3352"><span 
class="aett-10x-x-109">m10</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3353"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3354"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3355"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3356"><span 
class="aett-10x-x-109">boundary</span></span><span id="textcolor3357"><span 
class="aett-10x-x-109">=bound1,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3358"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor3359"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3360"><span 
class="aett-10x-x-109">0.05</span></span><span id="textcolor3361"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3362"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor3363"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3364"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3365"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3366"><span 
class="aett-10x-x-109">.1</span></span><span id="textcolor3367"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3368"><span 
class="aett-10x-x-109">.2</span></span><span id="textcolor3369"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor3370"><span 
class="aett-10x-x-109">m11</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3371"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3372"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3373"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3374"><span 
class="aett-10x-x-109">boundary</span></span><span id="textcolor3375"><span 
class="aett-10x-x-109">=bound2,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3376"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor3377"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3378"><span 
class="aett-10x-x-109">0.05</span></span><span id="textcolor3379"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3380"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor3381"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3382"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3383"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3384"><span 
class="aett-10x-x-109">.1</span></span><span id="textcolor3385"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3386"><span 
class="aett-10x-x-109">.2</span></span><span id="textcolor3387"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor3388"><span 
class="aett-10x-x-109">m12</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3389"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3390"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3391"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3392"><span 
class="aett-10x-x-109">boundary</span></span><span id="textcolor3393"><span 
class="aett-10x-x-109">=bound3,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3394"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor3395"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3396"><span 
class="aett-10x-x-109">0.05</span></span><span id="textcolor3397"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3398"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor3399"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3400"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3401"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3402"><span 
class="aett-10x-x-109">.1</span></span><span id="textcolor3403"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3404"><span 
class="aett-10x-x-109">.2</span></span><span id="textcolor3405"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor3406"><span 
class="aett-10x-x-109">m13</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3407"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3408"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3409"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3410"><span 
class="aett-10x-x-109">boundary</span></span><span id="textcolor3411"><span 
class="aett-10x-x-109">=bound4,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3412"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor3413"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3414"><span 
class="aett-10x-x-109">0.05</span></span><span id="textcolor3415"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3416"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor3417"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3418"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3419"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3420"><span 
class="aett-10x-x-109">.1</span></span><span id="textcolor3421"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3422"><span 
class="aett-10x-x-109">.2</span></span><span id="textcolor3423"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
<!--l. 330--><p class="indent" >   These meshes are visualized in Figure&#x00A0;<a 
href="#x5-290001.3.2">1.3.2<!--tex4ht:ref: fig:nonconmesh --></a> by commands bellow  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3424"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor3425"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3426"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor3427"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3428"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3429"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3430"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor3431"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3432"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor3433"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3434"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor3435"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3436"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3437"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3438"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3439"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3440"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3441"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3442"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3443"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3444"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3445"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor3446"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3447"><span 
class="aett-10x-x-109">(i</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3448"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3449"><span 
class="aett-10x-x-109">10</span></span><span id="textcolor3450"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor3451"><span 
class="aett-10x-x-109">13</span></span><span id="textcolor3452"><span 
class="aett-10x-x-109">)</span><span 
class="aett-10x-x-109">&#x00A0;{</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3453"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor3454"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3455"><span 
class="aett-10x-x-109">get</span></span><span id="textcolor3456"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3457"><span 
class="aett-10x-x-109">paste</span></span><span id="textcolor3458"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3459"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">m</span><span 
class="tctt-1095">'</span></span><span id="textcolor3460"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;i,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3461"><span 
class="aett-10x-x-109">sep</span></span><span id="textcolor3462"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3463"><span 
class="tctt-1095">''</span></span><span id="textcolor3464"><span 
class="aett-10x-x-109">)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3465"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor3466"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3467"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3468"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3469"><span 
class="aett-10x-x-109">main</span></span><span id="textcolor3470"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3471"><span 
class="tctt-1095">''</span></span><span id="textcolor3472"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3473"><span 
class="aett-10x-x-109">points</span></span><span id="textcolor3474"><span 
class="aett-10x-x-109">(p5,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3475"><span 
class="aett-10x-x-109">pch</span></span><span id="textcolor3476"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3477"><span 
class="aett-10x-x-109">19</span></span><span id="textcolor3478"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3479"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor3480"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3481"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor3482"><span 
class="aett-10x-x-109">);</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3483"><span 
class="aett-10x-x-109">title</span></span><span id="textcolor3484"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3485"><span 
class="aett-10x-x-109">main</span></span><span id="textcolor3486"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3487"><span 
class="aett-10x-x-109">paste</span></span><span id="textcolor3488"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3489"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">m</span><span 
class="tctt-1095">'</span></span><span id="textcolor3490"><span 
class="aett-10x-x-109">,</span><span 
class="aett-10x-x-109">&#x00A0;i,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3491"><span 
class="aett-10x-x-109">sep</span></span><span id="textcolor3492"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3493"><span 
class="tctt-1095">''</span></span><span id="textcolor3494"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor3495"><span 
class="aett-10x-x-109">}</span></span>
</div>
</div>
   </div>
<hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x5-290017"></a>
                                                                                 
                                                                                 
<!--l. 346--><p class="noindent" ><img 
src="spde-tutorial27x.png" alt="PIC" class="graphics" width="298" height="298"  /><!--tex4ht:graphics  
name="spde-tutorial27x.png" src="figs/meshvnonconmeshv-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;1.7: </span><span  
class="content">Non-convex meshes with different boundaries.</span></div><!--tex4ht:label?: x5-290017 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 352--><p class="indent" >   The <span 
class="aett-10x-x-109">m10 </span>mesh is built with a boundary that we got using default arguments in
the <span 
class="aett-10x-x-109">inla.nonconvex.hull() </span>function. The default <span 
class="aett-10x-x-109">convex </span>and <span 
class="aett-10x-x-109">concave </span>arguments
are both equal <span 
class="aett-10x-x-109">0.15 </span>proportion of the points domain radius, that is computed by
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3496"><span 
class="aett-10x-x-109">max</span></span><span id="textcolor3497"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3498"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor3499"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3500"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor3501"><span 
class="aett-10x-x-109">(p5[,</span></span><span id="textcolor3502"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3503"><span 
class="aett-10x-x-109">])),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3504"><span 
class="aett-10x-x-109">diff</span></span><span id="textcolor3505"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3506"><span 
class="aett-10x-x-109">range</span></span><span id="textcolor3507"><span 
class="aett-10x-x-109">(p5[,</span></span><span id="textcolor3508"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor3509"><span 
class="aett-10x-x-109">])))</span></span><span id="textcolor3510"><span 
class="aett-10x-x-109">*</span></span><span id="textcolor3511"><span 
class="aett-10x-x-109">.15</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-49">
##&#x00A0;[1]&#x00A0;0.12906
</div>
<!--l. 365--><p class="nopar" >
</p>
   </div>
If we supply a larger convex value, like the one used to generate <span 
class="aett-10x-x-109">m11</span>, we get a larger boundary.
It&#8217;s because all circles with a centre on each point and a radius less than the convex value are
inside the boundary. When we choose a larger concave value, as in the boundary used for the
&#8217;m12&#8217; and &#8217;m13&#8217; meshes, we don&#8217;t have circles with radius less than the concave value
outside the boudary. If we choose a smaller resolution, we get a boundary with small
resolution (in terms of number of points), for example, comparing the <span 
class="aett-10x-x-109">m12 </span>and <span 
class="aett-10x-x-109">m13</span>
meshes.
   <h4 class="subsectionHead"><span class="titlemark">1.3.3   </span> <a 
 id="x5-300001.3.3"></a>Meshes for the toy example</h4>
<!--l. 384--><p class="noindent" >To analyze the toy data set, we use six triangulation options to make comparisons in
section&#x00A0;<a 
href="#x5-260001.2.7">1.2.7<!--tex4ht:ref: sec:meshcompare --></a>. The first mesh forces the location points to be vertices of the mesh.
</p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3512"><span 
class="aett-10x-x-109">mesh1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3513"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3514"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3515"><span 
class="aett-10x-x-109">(coords,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3516"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor3517"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3518"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3519"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3520"><span 
class="aett-10x-x-109">0.035</span></span><span id="textcolor3521"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3522"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor3523"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor3524"><span 
class="aett-10x-x-109">mesh2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3525"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3526"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3527"><span 
class="aett-10x-x-109">(coords,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3528"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor3529"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3530"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3531"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3532"><span 
class="aett-10x-x-109">0.15</span></span><span id="textcolor3533"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3534"><span 
class="aett-10x-x-109">0.2</span></span><span id="textcolor3535"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
<!--l. 398--><p class="indent" >   The second and third meshes are based on the points, but we use a cutoff greather than zero
to avoid small triangles in regions where we have dense observations  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3536"><span 
class="aett-10x-x-109">mesh3</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3537"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3538"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3539"><span 
class="aett-10x-x-109">(coords,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3540"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor3541"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3542"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3543"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3544"><span 
class="aett-10x-x-109">0.15</span></span><span id="textcolor3545"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3546"><span 
class="aett-10x-x-109">0.2</span></span><span id="textcolor3547"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3548"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor3549"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3550"><span 
class="aett-10x-x-109">0.02</span></span><span id="textcolor3551"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<!--l. 410--><p class="indent" >   We also build three other meshes based on the domain area. These are built to have
approximately the same number of vertices as the previous ones  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3552"><span 
class="aett-10x-x-109">mesh4</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3553"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3554"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3555"><span 
class="aett-10x-x-109">(,</span><span 
class="aett-10x-x-109">&#x00A0;pl.dom,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3556"><span 
class="aett-10x-x-109">max.e</span></span><span id="textcolor3557"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3558"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3559"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3560"><span 
class="aett-10x-x-109">0.0355</span></span><span id="textcolor3561"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3562"><span 
class="aett-10x-x-109">0.1</span></span><span id="textcolor3563"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor3564"><span 
class="aett-10x-x-109">mesh5</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3565"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3566"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3567"><span 
class="aett-10x-x-109">(,</span><span 
class="aett-10x-x-109">&#x00A0;pl.dom,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3568"><span 
class="aett-10x-x-109">max.e</span></span><span id="textcolor3569"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3570"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3571"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3572"><span 
class="aett-10x-x-109">0.092</span></span><span id="textcolor3573"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3574"><span 
class="aett-10x-x-109">0.2</span></span><span id="textcolor3575"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor3576"><span 
class="aett-10x-x-109">mesh6</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3577"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3578"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3579"><span 
class="aett-10x-x-109">(,</span><span 
class="aett-10x-x-109">&#x00A0;pl.dom,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3580"><span 
class="aett-10x-x-109">max.e</span></span><span id="textcolor3581"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3582"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3583"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3584"><span 
class="aett-10x-x-109">0.11</span></span><span id="textcolor3585"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3586"><span 
class="aett-10x-x-109">0.2</span></span><span id="textcolor3587"><span 
class="aett-10x-x-109">))</span></span>
                                                                                 
                                                                                 
</div>
</div>
   </div>
<!--l. 424--><p class="indent" >   The number of nodes in each one of these meshes is  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3588"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3589"><span 
class="aett-10x-x-109">(mesh1</span></span><span id="textcolor3590"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3591"><span 
class="aett-10x-x-109">n,</span><span 
class="aett-10x-x-109">&#x00A0;mesh2</span></span><span id="textcolor3592"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3593"><span 
class="aett-10x-x-109">n,</span><span 
class="aett-10x-x-109">&#x00A0;mesh3</span></span><span id="textcolor3594"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3595"><span 
class="aett-10x-x-109">n,</span><span 
class="aett-10x-x-109">&#x00A0;mesh4</span></span><span id="textcolor3596"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3597"><span 
class="aett-10x-x-109">n,</span><span 
class="aett-10x-x-109">&#x00A0;mesh5</span></span><span id="textcolor3598"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3599"><span 
class="aett-10x-x-109">n,</span><span 
class="aett-10x-x-109">&#x00A0;mesh6</span></span><span id="textcolor3600"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3601"><span 
class="aett-10x-x-109">n)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-50">
##&#x00A0;[1]&#x00A0;2900&#x00A0;&#x00A0;488&#x00A0;&#x00A0;371&#x00A0;2878&#x00A0;&#x00A0;490&#x00A0;&#x00A0;375
</div>
<!--l. 432--><p class="nopar" >
</p>
   </div>
<!--l. 436--><p class="indent" >   These six meshes are shown in Figure <a 
href="#x5-300001.3.3">1.3.3<!--tex4ht:ref: fig:crdt1 --></a> with code below  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3602"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor3603"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3604"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor3605"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3606"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3607"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3608"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor3609"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3610"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor3611"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3612"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor3613"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3614"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3615"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3616"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3617"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3618"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3619"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3620"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3621"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3622"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3623"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor3624"><span 
class="aett-10x-x-109">for</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3625"><span 
class="aett-10x-x-109">(i</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3626"><span 
class="aett-10x-x-109">in</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3627"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3628"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor3629"><span 
class="aett-10x-x-109">6</span></span><span id="textcolor3630"><span 
class="aett-10x-x-109">)</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3631"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor3632"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3633"><span 
class="aett-10x-x-109">get</span></span><span id="textcolor3634"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3635"><span 
class="aett-10x-x-109">paste</span></span><span id="textcolor3636"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3637"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">mesh</span><span 
class="tctt-1095">'</span></span><span id="textcolor3638"><span 
class="aett-10x-x-109">,i,</span></span><span id="textcolor3639"><span 
class="aett-10x-x-109">sep</span></span><span id="textcolor3640"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3641"><span 
class="tctt-1095">''</span></span><span id="textcolor3642"><span 
class="aett-10x-x-109">)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3643"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor3644"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3645"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3646"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3647"><span 
class="aett-10x-x-109">main</span></span><span id="textcolor3648"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3649"><span 
class="tctt-1095">''</span></span><span id="textcolor3650"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x5-300018"></a>
                                                                                 
                                                                                 
<!--l. 450--><p class="noindent" ><img 
src="spde-tutorial28x.png" alt="PIC" class="graphics" width="413" height="276"  /><!--tex4ht:graphics  
name="spde-tutorial28x.png" src="figs/meshvplotmesh1-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;1.8: </span><span  
class="content">Six triangulation options for the toy example.</span></div><!--tex4ht:label?: x5-300018 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">1.3.4   </span> <a 
 id="x5-310001.3.4"></a>Meshes for Paraná state</h4>
<!--l. 458--><p class="noindent" >We have some examples using data collected in Paraná state, in Brazil. In this case we need to
take into account two things: one is the shape of this domain area and the other is the
coordinates reference system.
</p><!--l. 464--><p class="indent" >   We have the daily rainfall data  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3651"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor3652"><span 
class="aett-10x-x-109">(PRprec);</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3653"><span 
class="aett-10x-x-109">dim</span></span><span id="textcolor3654"><span 
class="aett-10x-x-109">(PRprec)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-51">
##&#x00A0;[1]&#x00A0;616&#x00A0;368
</div>
<!--l. 472--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor3655"><span 
class="aett-10x-x-109">PRprec[</span></span><span id="textcolor3656"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3657"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor3658"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor3659"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3660"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3661"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor3662"><span 
class="aett-10x-x-109">10</span></span><span id="textcolor3663"><span 
class="aett-10x-x-109">]</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-52">
##&#x00A0;&#x00A0;&#x00A0;Longitude&#x00A0;Latitude&#x00A0;Altitude&#x00A0;d0101&#x00A0;d0102&#x00A0;d0103&#x00A0;d0104&#x00A0;d0105&#x00A0;d0106&#x00A0;d0107
&#x00A0;<br />##&#x00A0;1&#x00A0;&#x00A0;-50.8744&#x00A0;-22.8511&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;365&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;2.5
&#x00A0;<br />##&#x00A0;3&#x00A0;&#x00A0;-50.7711&#x00A0;-22.9597&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;344&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;6.0
</div>
<!--l. 480--><p class="nopar" >
</p>
   </div>
that consists of the daily rainfall data from <span 
class="aett-10x-x-109">616 </span>stations for each day of the 2011 year. The
coordinates (two first colums) are on the latlong projection.
<!--l. 488--><p class="indent" >   Also, we have the Paraná state polygon with  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3664"><span 
class="aett-10x-x-109">data</span></span><span id="textcolor3665"><span 
class="aett-10x-x-109">(PRborder);</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3666"><span 
class="aett-10x-x-109">dim</span></span><span id="textcolor3667"><span 
class="aett-10x-x-109">(PRborder)</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-53">
##&#x00A0;[1]&#x00A0;2055&#x00A0;&#x00A0;&#x00A0;&#x00A0;2
</div>
<!--l. 496--><p class="nopar" >
</p>
   </div>
that consists of a set of <span 
class="aett-10x-x-109">2055 </span>points on the latlong projection.
<!--l. 502--><p class="indent" >   In this case is best to use a non-convex hull mesh. We start by building a non-convex domain
with  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3668"><span 
class="aett-10x-x-109">prdomain</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3669"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3670"><span 
class="aett-10x-x-109">inla.nonconvex.hull</span></span><span id="textcolor3671"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3672"><span 
class="aett-10x-x-109">as.matrix</span></span><span id="textcolor3673"><span 
class="aett-10x-x-109">(PRprec[,</span></span><span id="textcolor3674"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3675"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor3676"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor3677"><span 
class="aett-10x-x-109">]),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3678"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor3679"><span 
class="aett-10x-x-109">0.03</span></span><span id="textcolor3680"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3681"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor3682"><span 
class="aett-10x-x-109">0.05</span></span><span id="textcolor3683"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3684"><span 
class="aett-10x-x-109">resolution</span></span><span id="textcolor3685"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3686"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3687"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3688"><span 
class="aett-10x-x-109">100</span></span><span id="textcolor3689"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3690"><span 
class="aett-10x-x-109">100</span></span><span id="textcolor3691"><span 
class="aett-10x-x-109">))</span></span>
</div>
</div>
   </div>
with this defined domain we build two meshes with different resolution (max edge length) on the
inner domain  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3692"><span 
class="aett-10x-x-109">(prmesh1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3693"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3694"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3695"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3696"><span 
class="aett-10x-x-109">boundary</span></span><span id="textcolor3697"><span 
class="aett-10x-x-109">=prdomain,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3698"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor3699"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3700"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3701"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3702"><span 
class="aett-10x-x-109">.7</span></span><span id="textcolor3703"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3704"><span 
class="aett-10x-x-109">.7</span></span><span id="textcolor3705"><span 
class="aett-10x-x-109">),</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3706"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor3707"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3708"><span 
class="aett-10x-x-109">0.35</span></span><span id="textcolor3709"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3710"><span 
class="aett-10x-x-109">offset</span></span><span id="textcolor3711"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3712"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3713"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3714"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor3715"><span 
class="aett-10x-x-109">0.05</span></span><span id="textcolor3716"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3717"><span 
class="aett-10x-x-109">-</span></span><span id="textcolor3718"><span 
class="aett-10x-x-109">0.05</span></span><span id="textcolor3719"><span 
class="aett-10x-x-109">)))</span></span><span id="textcolor3720"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3721"><span 
class="aett-10x-x-109">n</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-54">
##&#x00A0;[1]&#x00A0;187
</div>
<!--l. 522--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor3722"><span 
class="aett-10x-x-109">(prmesh2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3723"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3724"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3725"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3726"><span 
class="aett-10x-x-109">boundary</span></span><span id="textcolor3727"><span 
class="aett-10x-x-109">=prdomain,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3728"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor3729"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3730"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3731"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3732"><span 
class="aett-10x-x-109">.45</span></span><span id="textcolor3733"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3734"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3735"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3736"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor3737"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3738"><span 
class="aett-10x-x-109">0.2</span></span><span id="textcolor3739"><span 
class="aett-10x-x-109">))</span></span><span id="textcolor3740"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3741"><span 
class="aett-10x-x-109">n</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-55">
##&#x00A0;[1]&#x00A0;382
</div>
<!--l. 528--><p class="nopar" >
</p>
   </div>
<!--l. 532--><p class="indent" >   We can visualize both meshes on the Figure&#x00A0;<a 
href="#x5-310001.3.4">1.3.4<!--tex4ht:ref: fig:prmesh --></a> with commands below  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3742"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor3743"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3744"><span 
class="aett-10x-x-109">mfrow</span></span><span id="textcolor3745"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3746"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3747"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3748"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3749"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3750"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor3751"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3752"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor3753"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3754"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3755"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3756"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3757"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3758"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3759"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3760"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3761"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3762"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3763"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor3764"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor3765"><span 
class="aett-10x-x-109">(prmesh1,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3766"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor3767"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3768"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3769"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3770"><span 
class="aett-10x-x-109">main</span></span><span id="textcolor3771"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3772"><span 
class="tctt-1095">''</span></span><span id="textcolor3773"><span 
class="aett-10x-x-109">);</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3774"><span 
class="aett-10x-x-109">lines</span></span><span id="textcolor3775"><span 
class="aett-10x-x-109">(PRborder,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3776"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor3777"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3778"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor3779"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor3780"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor3781"><span 
class="aett-10x-x-109">(prmesh2,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3782"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor3783"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3784"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3785"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3786"><span 
class="aett-10x-x-109">main</span></span><span id="textcolor3787"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3788"><span 
class="tctt-1095">''</span></span><span id="textcolor3789"><span 
class="aett-10x-x-109">);</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3790"><span 
class="aett-10x-x-109">lines</span></span><span id="textcolor3791"><span 
class="aett-10x-x-109">(PRborder,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3792"><span 
class="aett-10x-x-109">col</span></span><span id="textcolor3793"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3794"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor3795"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x5-310019"></a>
                                                                                 
                                                                                 
<!--l. 546--><p class="noindent" ><img 
src="spde-tutorial29x.png" alt="PIC" class="graphics" width="413" height="193"  /><!--tex4ht:graphics  
name="spde-tutorial29x.png" src="figs/meshvprmesh-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;1.9: </span><span  
class="content">Mesh for Paraná state</span></div><!--tex4ht:label?: x5-310019 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">1.3.5   </span> <a 
 id="x5-320001.3.5"></a>Triangulation with a SpatialPolygonsDataFrame</h4>
<!--l. 554--><p class="noindent" >Suppose that we have a map of the domain region. In <span 
class="aeb10-x-x-109">R </span>the representation of a spatial object is
made using object classes in the <span 
class="aeb10-x-x-109">sp </span>package, see&#x00A0;<span class="cite">[<a 
href="spde-tutorialli2.html#Xsp">Pebesma and Bivand, 2005</a>]</span> and <span class="cite">[<a 
href="spde-tutorialli2.html#XBivandetal:2008">Bivand et&#x00A0;al.,
2008</a>]</span>. To show an aplication in this case, we use the North Carolina map, in package <span 
class="aeb10-x-x-109">spdep</span>,
<span class="cite">[<a 
href="spde-tutorialli2.html#Xspdep">Bivand et&#x00A0;al., 2012</a>]</span>.
</p>
   <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3796"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor3797"><span 
class="aett-10x-x-109">(rgdal)</span></span>
<br /><span id="textcolor3798"><span 
class="aett-10x-x-109">nc.sids</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3799"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3800"><span 
class="aett-10x-x-109">readOGR</span></span><span id="textcolor3801"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3802"><span 
class="aett-10x-x-109">system.file</span></span><span id="textcolor3803"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3804"><span 
class="aett-10x-x-109">"shapes/sids.shp"</span></span><span id="textcolor3805"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3806"><span 
class="aett-10x-x-109">package</span></span><span id="textcolor3807"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3808"><span 
class="aett-10x-x-109">"spData"</span></span><span id="textcolor3809"><span 
class="aett-10x-x-109">)[</span></span><span id="textcolor3810"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3811"><span 
class="aett-10x-x-109">])</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-56">
##&#x00A0;OGR&#x00A0;data&#x00A0;source&#x00A0;with&#x00A0;driver:&#x00A0;ESRI&#x00A0;Shapefile
&#x00A0;<br />##&#x00A0;Source:&#x00A0;"/usr/local/lib/R/site-library/spData/shapes/sids.shp",&#x00A0;layer:&#x00A0;"sids"
&#x00A0;<br />##&#x00A0;with&#x00A0;100&#x00A0;features
&#x00A0;<br />##&#x00A0;It&#x00A0;has&#x00A0;22&#x00A0;fields
</div>
<!--l. 573--><p class="nopar" ></p><div class="alltt">
<div class="obeylines-v">
<span id="textcolor3812"><span 
class="aett-10x-x-109">proj4string</span></span><span id="textcolor3813"><span 
class="aett-10x-x-109">(nc.sids)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3814"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3815"><span 
class="aett-10x-x-109">CRS</span></span><span id="textcolor3816"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3817"><span 
class="aett-10x-x-109">"+proj=longlat</span><span 
class="aett-10x-x-109">&#x00A0;+ellps=clrk66"</span></span><span id="textcolor3818"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor3819"><span 
class="aett-10x-x-109">row.names</span></span><span id="textcolor3820"><span 
class="aett-10x-x-109">(nc.sids)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3821"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3822"><span 
class="aett-10x-x-109">as.character</span></span><span id="textcolor3823"><span 
class="aett-10x-x-109">(nc.sids</span></span><span id="textcolor3824"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3825"><span 
class="aett-10x-x-109">FIPS)</span></span>
</div>
</div>
   </div>
<!--l. 581--><p class="indent" >   We simplify this map by uniting all the areas together. To do it, we use the
<span 
class="aett-10x-x-109">unionSpatialPolygons() </span><span 
class="aeb10-x-x-109">maptools </span>function that uses function of the <span 
class="aeb10-x-x-109">rgeos </span>package&#x00A0;<span class="cite">[<a 
href="spde-tutorialli2.html#Xrgeos">Bivand
and Rundel, 2013</a>]</span>.  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3826"><span 
class="aett-10x-x-109">library</span></span><span id="textcolor3827"><span 
class="aett-10x-x-109">(maptools)</span></span>
<br /><span id="textcolor3828"><span 
class="aett-10x-x-109">nc.border</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3829"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3830"><span 
class="aett-10x-x-109">unionSpatialPolygons</span></span><span id="textcolor3831"><span 
class="aett-10x-x-109">(nc.sids,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3832"><span 
class="aett-10x-x-109">rep</span></span><span id="textcolor3833"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3834"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3835"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3836"><span 
class="aett-10x-x-109">nrow</span></span><span id="textcolor3837"><span 
class="aett-10x-x-109">(nc.sids)))</span></span>
</div>
</div>
   </div>
<!--l. 594--><p class="indent" >   Now, we use the <span 
class="aett-10x-x-109">inla.sp2segment() </span>to extract the boundary of the <span 
class="aett-10x-x-109">SpatialPolygons</span>
object that contains the border of the map  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3838"><span 
class="aett-10x-x-109">nc.bdry</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3839"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3840"><span 
class="aett-10x-x-109">inla.sp2segment</span></span><span id="textcolor3841"><span 
class="aett-10x-x-109">(nc.border)</span></span>
</div>
</div>
   </div>
and creates the mesh  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3842"><span 
class="aett-10x-x-109">(nc.mesh</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3843"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3844"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor3845"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3846"><span 
class="aett-10x-x-109">boundary</span></span><span id="textcolor3847"><span 
class="aett-10x-x-109">=nc.bdry,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3848"><span 
class="aett-10x-x-109">cutoff</span></span><span id="textcolor3849"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3850"><span 
class="aett-10x-x-109">0.15</span></span><span id="textcolor3851"><span 
class="aett-10x-x-109">,</span></span>
<br /><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3852"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor3853"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3854"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3855"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3856"><span 
class="aett-10x-x-109">0.3</span></span><span id="textcolor3857"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3858"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3859"><span 
class="aett-10x-x-109">)))</span></span><span id="textcolor3860"><span 
class="aett-10x-x-109">$</span></span><span id="textcolor3861"><span 
class="aett-10x-x-109">n</span></span>
</div>
</div>
                                                                                 
                                                                                 
   <div class="verbatim" id="verbatim-57">
##&#x00A0;[1]&#x00A0;534
</div>
<!--l. 613--><p class="nopar" >
</p>
   </div>
that is visualized on Figure&#x00A0;<a 
href="#x5-320001.3.5">1.3.5<!--tex4ht:ref: fig:ncmesh --></a> with the commands bellow.  <div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3862"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor3863"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3864"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor3865"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3866"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3867"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3868"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3869"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3870"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3871"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3872"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3873"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3874"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3875"><span 
class="aett-10x-x-109">))</span></span>
<br /><span id="textcolor3876"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor3877"><span 
class="aett-10x-x-109">(nc.mesh,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3878"><span 
class="aett-10x-x-109">asp</span></span><span id="textcolor3879"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3880"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor3881"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3882"><span 
class="aett-10x-x-109">main</span></span><span id="textcolor3883"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3884"><span 
class="tctt-1095">''</span></span><span id="textcolor3885"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x5-3200110"></a>
                                                                                 
                                                                                 
<!--l. 629--><p class="noindent" ><img 
src="spde-tutorial30x.png" alt="PIC" class="graphics" width="426" height="160"  /><!--tex4ht:graphics  
name="spde-tutorial30x.png" src="figs/meshncmeshv-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;1.10: </span><span  
class="content">Mesh constructed using the North Carolina map</span></div><!--tex4ht:label?: x5-3200110 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">1.3.6   </span> <a 
 id="x5-330001.3.6"></a>Mesh with holes and physical boundaries</h4>
<!--l. 640--><p class="noindent" >Sometimes we need to deal with physical boundaries. It can be when there is a hole inside the
domain or when the domain shape is not convex. An example of application is when modelling
fish and we have to consider the inland as a physical barrier and, sometimes, islands inside the
domain.
</p><!--l. 645--><p class="indent" >   The polygons in the Figure&#x00A0;<a 
href="#x5-330001.3.6">1.3.6<!--tex4ht:ref: fig:lakehole --></a> were created with the following commands:  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor3886"><span 
class="aett-10x-x-109">pl1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3887"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3888"><span 
class="aett-10x-x-109">Polygon</span></span><span id="textcolor3889"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3890"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor3891"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3892"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3893"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3894"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3895"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3896"><span 
class="aett-10x-x-109">15</span></span><span id="textcolor3897"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3898"><span 
class="aett-10x-x-109">15</span></span><span id="textcolor3899"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3900"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3901"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3902"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3903"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3904"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3905"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3906"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor3907"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3908"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3909"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3910"><span 
class="aett-10x-x-109">20</span></span><span id="textcolor3911"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3912"><span 
class="aett-10x-x-109">20</span></span><span id="textcolor3913"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3914"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor3915"><span 
class="aett-10x-x-109">)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3916"><span 
class="aett-10x-x-109">hole</span></span><span id="textcolor3917"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3918"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor3919"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor3920"><span 
class="aett-10x-x-109">h1</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3921"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3922"><span 
class="aett-10x-x-109">Polygon</span></span><span id="textcolor3923"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3924"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor3925"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3926"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3927"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3928"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor3929"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3930"><span 
class="aett-10x-x-109">7</span></span><span id="textcolor3931"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3932"><span 
class="aett-10x-x-109">7</span></span><span id="textcolor3933"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3934"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor3935"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3936"><span 
class="aett-10x-x-109">5</span></span><span id="textcolor3937"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3938"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3939"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3940"><span 
class="aett-10x-x-109">7</span></span><span id="textcolor3941"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3942"><span 
class="aett-10x-x-109">7</span></span><span id="textcolor3943"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3944"><span 
class="aett-10x-x-109">15</span></span><span id="textcolor3945"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3946"><span 
class="aett-10x-x-109">15</span></span><span id="textcolor3947"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3948"><span 
class="aett-10x-x-109">7</span></span><span id="textcolor3949"><span 
class="aett-10x-x-109">)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3950"><span 
class="aett-10x-x-109">hole</span></span><span id="textcolor3951"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3952"><span 
class="aett-10x-x-109">TRUE</span></span><span id="textcolor3953"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor3954"><span 
class="aett-10x-x-109">pl2</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3955"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3956"><span 
class="aett-10x-x-109">Polygon</span></span><span id="textcolor3957"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3958"><span 
class="aett-10x-x-109">cbind</span></span><span id="textcolor3959"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3960"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3961"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3962"><span 
class="aett-10x-x-109">15</span></span><span id="textcolor3963"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3964"><span 
class="aett-10x-x-109">20</span></span><span id="textcolor3965"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3966"><span 
class="aett-10x-x-109">20</span></span><span id="textcolor3967"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3968"><span 
class="aett-10x-x-109">30</span></span><span id="textcolor3969"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3970"><span 
class="aett-10x-x-109">30</span></span><span id="textcolor3971"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3972"><span 
class="aett-10x-x-109">15</span></span><span id="textcolor3973"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3974"><span 
class="aett-10x-x-109">15</span></span><span id="textcolor3975"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3976"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor3977"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor3978"><span 
class="aett-10x-x-109">10</span></span><span id="textcolor3979"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3980"><span 
class="aett-10x-x-109">10</span></span><span id="textcolor3981"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3982"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3983"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3984"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor3985"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3986"><span 
class="aett-10x-x-109">20</span></span><span id="textcolor3987"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3988"><span 
class="aett-10x-x-109">20</span></span><span id="textcolor3989"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor3990"><span 
class="aett-10x-x-109">10</span></span><span id="textcolor3991"><span 
class="aett-10x-x-109">)),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3992"><span 
class="aett-10x-x-109">hole</span></span><span id="textcolor3993"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor3994"><span 
class="aett-10x-x-109">FALSE</span></span><span id="textcolor3995"><span 
class="aett-10x-x-109">)</span></span>
<br /><span id="textcolor3996"><span 
class="aett-10x-x-109">sp</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3997"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor3998"><span 
class="aett-10x-x-109">SpatialPolygons</span></span><span id="textcolor3999"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4000"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor4001"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4002"><span 
class="aett-10x-x-109">Polygons</span></span><span id="textcolor4003"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4004"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor4005"><span 
class="aett-10x-x-109">(pl1,</span><span 
class="aett-10x-x-109">&#x00A0;h1),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4006"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">0</span><span 
class="tctt-1095">'</span></span><span id="textcolor4007"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4008"><span 
class="aett-10x-x-109">Polygons</span></span><span id="textcolor4009"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4010"><span 
class="aett-10x-x-109">list</span></span><span id="textcolor4011"><span 
class="aett-10x-x-109">(pl2),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4012"><span 
class="tctt-1095">'</span><span 
class="aett-10x-x-109">1</span><span 
class="tctt-1095">'</span></span><span id="textcolor4013"><span 
class="aett-10x-x-109">)))</span></span>
<br /><span id="textcolor4014"><span 
class="aett-10x-x-109">par</span></span><span id="textcolor4015"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4016"><span 
class="aett-10x-x-109">mar</span></span><span id="textcolor4017"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4018"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4019"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4020"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor4021"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4022"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor4023"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4024"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor4025"><span 
class="aett-10x-x-109">,</span></span><span id="textcolor4026"><span 
class="aett-10x-x-109">0</span></span><span id="textcolor4027"><span 
class="aett-10x-x-109">));</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4028"><span 
class="aett-10x-x-109">plot</span></span><span id="textcolor4029"><span 
class="aett-10x-x-109">(sp)</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4030"><span 
class="aeitt-10x-x-109">###</span><span 
class="aeitt-10x-x-109">&#x00A0;to</span><span 
class="aeitt-10x-x-109">&#x00A0;visualize</span><span 
class="aeitt-10x-x-109">&#x00A0;it</span></span>
<br /><span id="textcolor4031"><span 
class="aett-10x-x-109">text</span></span><span id="textcolor4032"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4033"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4034"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4035"><span 
class="aett-10x-x-109">13</span></span><span id="textcolor4036"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4037"><span 
class="aett-10x-x-109">17</span></span><span id="textcolor4038"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4039"><span 
class="aett-10x-x-109">23</span></span><span id="textcolor4040"><span 
class="aett-10x-x-109">),</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4041"><span 
class="aett-10x-x-109">c</span></span><span id="textcolor4042"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4043"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor4044"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4045"><span 
class="aett-10x-x-109">12</span></span><span id="textcolor4046"><span 
class="aett-10x-x-109">,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4047"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor4048"><span 
class="aett-10x-x-109">),</span><span 
class="aett-10x-x-109">&#x00A0;LETTERS[</span></span><span id="textcolor4049"><span 
class="aett-10x-x-109">1</span></span><span id="textcolor4050"><span 
class="aett-10x-x-109">:</span></span><span id="textcolor4051"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor4052"><span 
class="aett-10x-x-109">],</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4053"><span 
class="aett-10x-x-109">cex</span></span><span id="textcolor4054"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4055"><span 
class="aett-10x-x-109">3</span></span><span id="textcolor4056"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x5-3300111"></a>
                                                                                 
                                                                                 
<!--l. 661--><p class="noindent" ><img 
src="spde-tutorial31x.png" alt="PIC" class="graphics" width="426" height="304"  /><!--tex4ht:graphics  
name="spde-tutorial31x.png" src="figs/meshplotlake-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;1.11: </span><span  
class="content">Region with a hole and non convex domain.</span></div><!--tex4ht:label?: x5-3300111 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 667--><p class="indent" >   We have two neighbour regions, one with a hole and one with no convex shape. Suppose that
it is necessary to avoid correlation between near regions separated by land. For example, suppose
that we want to make sure that the correlation between A and C is smaller than between A and
B or between B and C.
</p><!--l. 675--><p class="indent" >   In this example we do not want additional points outer the domain. To have it, we have to
supply a length one value for <span 
class="aett-10x-x-109">max.edge</span>. The following code is to prepare the boundary and built
the mesh.  </p><div class="framedenv" id="kframe-1">
   <div class="alltt">
<div class="obeylines-v">
<span id="textcolor4057"><span 
class="aett-10x-x-109">bound</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4058"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4059"><span 
class="aett-10x-x-109">inla.sp2segment</span></span><span id="textcolor4060"><span 
class="aett-10x-x-109">(sp)</span></span>
<br /><span id="textcolor4061"><span 
class="aett-10x-x-109">mesh</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4062"><span 
class="aett-10x-x-109">&#x003C;-</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4063"><span 
class="aett-10x-x-109">inla.mesh.2d</span></span><span id="textcolor4064"><span 
class="aett-10x-x-109">(</span></span><span id="textcolor4065"><span 
class="aett-10x-x-109">boundary</span></span><span id="textcolor4066"><span 
class="aett-10x-x-109">=bound,</span></span><span 
class="aett-10x-x-109">&#x00A0;</span><span id="textcolor4067"><span 
class="aett-10x-x-109">max.edge</span></span><span id="textcolor4068"><span 
class="aett-10x-x-109">=</span></span><span id="textcolor4069"><span 
class="aett-10x-x-109">2</span></span><span id="textcolor4070"><span 
class="aett-10x-x-109">)</span></span>
</div>
</div>
   </div>
<!--l. 687--><p class="indent" >   The mesh is displayed in the Figure&#x00A0;<a 
href="#x5-330001.3.6">1.3.6<!--tex4ht:ref: fig:meshhole --></a> using the commands below: </p><hr class="figure" /><div class="figure" 
>
                                                                                 
                                                                                 
<a 
 id="x5-3300212"></a>
                                                                                 
                                                                                 
<!--l. 692--><p class="noindent" ><img 
src="spde-tutorial32x.png" alt="PIC" class="graphics" width="298" height="213"  /><!--tex4ht:graphics  
name="spde-tutorial32x.png" src="figs/meshplothex-1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;1.12: </span><span  
class="content">Triangulation with hole and non convex shaped region</span></div><!--tex4ht:label?: x5-3300212 -->
                                                                                 
                                                                                 
   </div><hr class="endfigure" />
<!--l. 698--><p class="indent" >   Notice that when building the SPDE model, the neighborhood structure of the
mesh is taken into account. So, it is easier to reach B from A than C on the related
graph.
                                                                                 
                                                                                 
</p>
   <!--l. 116--><div class="crosslinks"><p class="noindent">[<a 
href="spde-tutorialch2.html" >next</a>] [<a 
href="spde-tutorialli1.html" >prev</a>] [<a 
href="spde-tutorialli1.html#tailspde-tutorialli1.html" >prev-tail</a>] [<a 
href="spde-tutorialch1.html" >front</a>] [<a 
href="spde-tutorial3.html#spde-tutorialch1.html" >up</a>] </p></div>
<!--l. 116--><p class="indent" >   <a 
 id="tailspde-tutorialch1.html"></a>   </p> 
</body></html> 
