#!/usr/bin/env bash
d=INLA/inst/bin
MAC=hrue@hruemac.math.ntnu.no
LINUX=hrue@inla.math.ntnu.no
WINDOWS=$(~/p/inla/builds/windows)

for m in 32 64; do
    for p in inla fmesher; do 
	for f in $(ssh $MAC bin/my.otool builds/build$m/local/bin/$p) builds/build$m/local/bin/$p; do
	    echo sync $f
	    rsync -auv $MAC:$f $d/mac/${m}bit/.
	done
    done
done

for m in 32 64; do
    for p in inla fmesher; do 
	for f in $(ssh $LINUX bin/my.ldd builds/build$m/local/bin/$p) builds/build$m/local/bin/$p; do
	    echo sync $f
	    rsync -auv $LINUX:$f $d/linux/${m}bit/.
	done
    done
done

for m in 32 64; do
    for p in inla fmesher; do 
	for f in $($WINDOWS/bin/my.objdump $WINDOWS/local/bin/$p.exe) $WINDOWS/local/bin/$p.exe; do
	    echo sync $f
	    rsync -auv $f $d/windows/${m}bit/.
	done
    done
done
