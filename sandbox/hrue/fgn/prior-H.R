dist.table <- c(-10.0, 0.00000857756, -9.95, 0.000009017323, -9.9, 0.000009479635, -9.85,
                0.000009965648, -9.8, 0.000010476573, -9.75, 0.000011013697, -9.7,
                0.000011578354, -9.65, 0.000012171959, -9.6, 0.000012795996, -9.55,
                0.000013452027, -9.5, 0.000014141687, -9.45, 0.000014866702, -9.4,
                0.000015628884, -9.35, 0.00001643014, -9.3, 0.000017272474, -9.25,
                0.000018157988, -9.2, 0.000019088894, -9.15, 0.000020067524, -9.1,
                0.000021096318, -9.05, 0.000022177851, -9., 0.000023314826, -8.95,
                0.000024510085, -8.9, 0.00002576661, -8.85, 0.000027087547, -8.8,
                0.000028476194, -8.75, 0.000029936022, -8.7, 0.000031470679, -8.65,
                0.000033083996, -8.6, 0.000034780009, -8.55, 0.000036562953, -8.5,
                0.00003843728, -8.45, 0.000040407679, -8.4, 0.000042479066, -8.35,
                0.000044656617, -8.3, 0.000046945773, -8.25, 0.00004935225, -8.2, 0.00005188206,
                -8.15, 0.000054541519, -8.1, 0.000057337269, -8.05, 0.000060276291, -8.,
                0.000063365925, -7.95, 0.000066613884, -7.9, 0.000070028276, -7.85,
                0.000073617626, -7.8, 0.000077390891, -7.75, 0.000081357491, -7.7,
                0.000085527326, -7.65, 0.000089910799, -7.6, 0.000094518849, -7.55,
                0.000099362972, -7.5, 0.000104455252, -7.45, 0.000109808392, -7.4,
                0.00011543574, -7.35, 0.000121351331, -7.3, 0.000127569913, -7.25,
                0.000134106988, -7.2, 0.000140978851, -7.15, 0.000148202628, -7.1,
                0.000155796316, -7.05, 0.000163778834, -7., 0.000172170064, -6.95,
                0.000180990904, -6.9, 0.000190263313, -6.85, 0.000200010374, -6.8,
                0.000210256341, -6.75, 0.000221026708, -6.7, 0.000232348264, -6.65,
                0.000244249162, -6.6, 0.000256758987, -6.55, 0.000269908829, -6.5,
                0.000283731358, -6.45, 0.000298260904, -6.4, 0.00031353354, -6.35,
                0.00032958717, -6.3, 0.000346461623, -6.25, 0.000364198743, -6.2, 0.0003828425,
                -6.15, 0.000402439087, -6.1, 0.000423037037, -6.05, 0.000444687337, -6.,
                0.000467443551, -5.95, 0.000491361948, -5.9, 0.000516501638, -5.85,
                0.000542924712, -5.8, 0.000570696388, -5.75, 0.000599885167, -5.7,
                0.000630562996, -5.65, 0.000662805437, -5.6, 0.000696691843, -5.55,
                0.000732305546, -5.5, 0.00076973405, -5.45, 0.000809069237, -5.4,
                0.000850407577, -5.35, 0.000893850352, -5.3, 0.00093950389, -5.25,
                0.000987479805, -5.2, 0.001037895257, -5.15, 0.001090873211, -5.1,
                0.001146542718, -5.05, 0.001205039205, -5., 0.001266504773, -4.95,
                0.001331088517, -4.9, 0.001398946849, -4.85, 0.001470243845, -4.8,
                0.001545151597, -4.75, 0.001623850586, -4.7, 0.001706530066, -4.65,
                0.001793388465, -4.6, 0.001884633803, -4.55, 0.001980484124, -4.5,
                0.002081167942, -4.45, 0.00218692471, -4.4, 0.002298005298, -4.35,
                0.002414672495, -4.3, 0.002537201522, -4.25, 0.002665880565, -4.2,
                0.002801011327, -4.15, 0.002942909592, -4.1, 0.003091905809, -4.05,
                0.003248345693, -4., 0.003412590836, -3.95, 0.003585019346, -3.9,
                0.003766026485, -3.85, 0.003956025333, -3.8, 0.004155447462, -3.75,
                0.004364743617, -3.7, 0.004584384412, -3.65, 0.004814861035, -3.6,
                0.00505668596, -3.55, 0.005310393655, -3.5, 0.005576541309, -3.45,
                0.005855709541, -3.4, 0.006148503118, -3.35, 0.006455551659, -3.3,
                0.006777510332, -3.25, 0.007115060531, -3.2, 0.007468910541, -3.15,
                0.007839796171, -3.1, 0.008228481356, -3.05, 0.008635758732, -3.,
                0.009062450154, -2.95, 0.009509407175, -2.9, 0.009977511459, -2.85,
                0.010467675133, -2.8, 0.01098084106, -2.75, 0.011517983027, -2.7,
                0.012080105844, -2.65, 0.012668245327, -2.6, 0.013283468179, -2.55,
                0.013926871728, -2.5, 0.014599583538, -2.45, 0.015302760862, -2.4,
                0.016037589928, -2.35, 0.016805285057, -2.3, 0.01760708758, -2.25,
                0.018444264559, -2.2, 0.01931810729, -2.15, 0.020229929576, -2.1,
                0.021181065764, -2.05, 0.022172868525, -2., 0.023206706376, -1.95,
                0.02428396093, -1.9, 0.025406023865, -1.85, 0.026574293609, -1.8,
                0.027790171732, -1.75, 0.029055059054, -1.7, 0.030370351449, -1.65,
                0.031737435369, -1.6, 0.033157683081, -1.55, 0.034632447631, -1.5,
                0.036163057546, -1.45, 0.037750811296, -1.4, 0.039396971524, -1.35,
                0.041102759089, -1.3, 0.042869346924, -1.25, 0.044697853777, -1.2,
                0.046589337834, -1.15, 0.048544790301, -1.1, 0.050565128965, -1.05,
                0.052651191802, -1., 0.054803730671, -0.95, 0.05702340516, -0.9, 0.059310776637,
                -0.85, 0.061666302573, -0.8, 0.064090331185, -0.75, 0.066583096476, -0.7,
                0.069144713721, -0.65, 0.071775175465, -0.6, 0.074474348088, -0.55,
                0.077241968983, -0.5, 0.080077644406, -0.45, 0.082980848035, -0.4,
                0.085950920268, -0.35, 0.088987068296, -0.3, 0.092088366977, -0.25,
                0.095253760499, -0.2, 0.09848206486, -0.15, 0.101771971145, -0.1,
                0.105122049574, -0.05, 0.108530754318, 0., 0.111996429013, 0.05, 0.115517312964,
                0.1, 0.119091547951, 0.15, 0.122717185594, 0.2, 0.126392195209, 0.25,
                0.130114472072, 0.3, 0.133881846023, 0.35, 0.137692090322, 0.4, 0.141542930678,
                0.45, 0.145432054377, 0.5, 0.149357119406, 0.55, 0.153315763517, 0.6,
                0.157305613146, 0.65, 0.16132429211, 0.7, 0.165369430029, 0.75, 0.1694386704,
                0.8, 0.173529678285, 0.85, 0.177640147556, 0.9, 0.181767807658, 0.95,
                0.185910429875, 1., 0.190065833053, 1.05, 0.19423188879, 1.1, 0.198406526061,
                1.15, 0.202587735289, 1.2, 0.206773571869, 1.25, 0.210962159142, 1.3,
                0.21515169085, 1.35, 0.219340433072, 1.4, 0.223526725685, 1.45, 0.227708983359,
                1.5, 0.231885696122, 1.55, 0.236055429523, 1.6, 0.240216824427, 1.65,
                0.244368596467, 1.7, 0.248509535196, 1.75, 0.252638502957, 1.8, 0.256754433514,
                1.85, 0.260856330471, 1.9, 0.264943265504, 1.95, 0.269014376441, 2.,
                0.273068865204, 2.05, 0.27710599566, 2.1, 0.281125091376, 2.15, 0.285125533323,
                2.2, 0.289106757529, 2.25, 0.29306825272, 2.3, 0.29700955794, 2.35,
                0.300930260186, 2.4, 0.304829992057, 2.45, 0.308708429434, 2.5, 0.312565289197,
                2.55, 0.316400326991, 2.6, 0.320213335044, 2.65, 0.324004140048, 2.7,
                0.327772601097, 2.75, 0.3315186077, 2.8, 0.33524207786, 2.85, 0.338942956231,
                2.9, 0.342621212341, 2.95, 0.346276838895, 3., 0.349909850153, 3.05,
                0.35352028038, 3.1, 0.357108182369, 3.15, 0.360673626041, 3.2, 0.364216697109,
                3.25, 0.367737495821, 3.3, 0.37123613576, 3.35, 0.374712742718, 3.4,
                0.378167453629, 3.45, 0.381600415565, 3.5, 0.385011784793, 3.55, 0.388401725881,
                3.6, 0.391770410869, 3.65, 0.395118018484, 3.7, 0.398444733407, 3.75,
                0.401750745589, 3.8, 0.405036249608, 3.85, 0.408301444074, 3.9, 0.411546531069,
                3.95, 0.414771715631, 4., 0.417977205269, 4.05, 0.421163209517, 4.1,
                0.424329939518, 4.15, 0.427477607637, 4.2, 0.430606427109, 4.25, 0.433716611707,
                4.3, 0.43680837544, 4.35, 0.439881932275, 4.4, 0.442937495878, 4.45,
                0.445975279382, 4.5, 0.448995495166, 4.55, 0.451998354664, 4.6, 0.454984068183,
                4.65, 0.457952844739, 4.7, 0.460904891909, 4.75, 0.463840415698, 4.8,
                0.466759620416, 4.85, 0.469662708575, 4.9, 0.472549880786, 4.95, 0.475421335673,
                5., 0.478277269804, 5.05, 0.481117877612, 5.1, 0.48394335135, 5.15,
                0.486753881027, 5.2, 0.489549654374, 5.25, 0.492330856805, 5.3, 0.495097671385,
                5.35, 0.497850278807, 5.4, 0.500588857372, 5.45, 0.503313582976, 5.5,
                0.506024629101, 5.55, 0.508722166806, 5.6, 0.511406364729, 5.65, 0.514077389087,
                5.7, 0.516735403683, 5.75, 0.51938056991, 5.8, 0.522013046766, 5.85,
                0.524632990865, 5.9, 0.527240556452, 5.95, 0.529835895421, 6., 0.532419157332,
                6.05, 0.534990489436, 6.1, 0.537550036692, 6.15, 0.540097941794, 6.2,
                0.542634345193, 6.25, 0.545159385125, 6.3, 0.547673197634, 6.35, 0.550175916602,
                6.4, 0.552667673777, 6.45, 0.555148598799, 6.5, 0.557618819228, 6.55,
                0.560078460579, 6.6, 0.562527646345, 6.65, 0.564966498029, 6.7, 0.567395135176,
                6.75, 0.5698136754, 6.8, 0.572222234415, 6.85, 0.574620926068, 6.9,
                0.577009862361, 6.95, 0.579389153493, 7., 0.581758907878, 7.05, 0.584119232182,
                7.1, 0.58647023135, 7.15, 0.588812008637, 7.2, 0.591144665633, 7.25,
                0.593468302297, 7.3, 0.595783016983, 7.35, 0.598088906465, 7.4, 0.600386065972,
                7.45, 0.602674589211, 7.5, 0.604954568393, 7.55, 0.607226094263, 7.6,
                0.609489256126, 7.65, 0.611744141871, 7.7, 0.613990838001, 7.75, 0.616229429652,
                7.8, 0.618460000623, 7.85, 0.620682633402, 7.9, 0.622897409183, 7.95,
                0.625104407898, 8., 0.627303708233, 8.05, 0.62949538766, 8.1, 0.631679522448,
                8.15, 0.633856187697, 8.2, 0.636025457352, 8.25, 0.638187404228, 8.3,
                0.640342100027, 8.35, 0.642489615367, 8.4, 0.644630019792, 8.45, 0.646763381799,
                8.5, 0.648889768857, 8.55, 0.651009247421, 8.6, 0.653121882959, 8.65,
                0.655227739961, 8.7, 0.657326881966, 8.75, 0.659419371575, 8.8, 0.661505270467,
                8.85, 0.66358463942, 8.9, 0.665657538326, 8.95, 0.667724026207, 9.,
                0.669784161232, 9.05, 0.67183800073, 9.1, 0.67388560121, 9.15, 0.675927018373,
                9.2, 0.677962307127, 9.25, 0.679991521601, 9.3, 0.682014715163, 9.35,
                0.684031940429, 9.4, 0.686043249279, 9.45, 0.688048692871, 9.5, 0.690048321652,
                9.55, 0.692042185372, 9.6, 0.694030333099, 9.65, 0.696012813226, 9.7,
                0.697989673487, 9.75, 0.699960960969, 9.8, 0.701926722121, 9.85, 0.703887002766,
                9.9, 0.705841848114, 9.95, 0.707791302771, 10.0, 0.709735410751)

len <- length(dist.table)
dist.func <- splinefun(dist.table[seq(1, len, by = 2)], dist.table[seq(2, len, by = 2)],
                       method = "monoH.FC")

log.prior <- function(theta, param, dist.func) {
    ## log.prior for theta = H.intern
    
    to.theta <- function(x) {
        return (log((2 * x - 1) / (2 * (1 - x))))
    }

    from.theta <- function(x) {
        return (0.5 + 0.5 * exp(x) / (1 + exp(x)))
    }

    U.intern = to.theta(param[1])
    lambda = -log(param[2]) / dist.func(U.intern)
    lprior = log(lambda) - lambda * dist.func(theta) + log(abs(dist.func(theta, deriv = 1)))
    return (lprior)
}
    
## parametrs as in inla.doc("fgn")
prior.param <- c(0.9, 0.1)
log.prior(c(-1.1, 0.2, 1.3), prior.param, dist.func)
